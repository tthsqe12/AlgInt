(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   2192099,      51055]
NotebookOptionsPosition[   2159471,      50148]
NotebookOutlinePosition[   2160088,      50170]
CellTagsIndexPosition[   2160045,      50167]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"iIntegrate", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["x", "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "3"]}], ")"}], 
     RowBox[{"1", "/", "3"}]]], ",", "x", ",", "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.702053338232044*^9, 3.702053342912051*^9}, {
  3.7020533776806717`*^9, 3.702053394200576*^9}, {3.702054098683889*^9, 
  3.702054100875721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "3"]}], ")"}], 
    RowBox[{"2", "/", "3"}]]}], "+", 
  RowBox[{"IntPiece", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.702054102206197*^9, 3.702741121055545*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iIntegrate", "[", 
  RowBox[{
   FractionBox["x", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "3"]}], ")"}], 
     RowBox[{"1", "/", "3"}]]], ",", "x", ",", "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.702053338232044*^9, 3.702053342912051*^9}, {
  3.7020533776806717`*^9, 3.702053394200576*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   RowBox[{"Int2ndKind", "[", 
    FractionBox["x", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "3"]}], ")"}], 
       RowBox[{"1", "/", "3"}]]}]], "]"}]}], "+", 
  RowBox[{"IntPiece", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.7020533515818987`*^9, 3.702053395919777*^9}, 
   3.702741124620956*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iIntegrate", "[", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "3"]}], ")"}], 
     RowBox[{"1", "/", "3"}]]], ",", "x", ",", "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.702053338232044*^9, 3.702053342912051*^9}, {
  3.7020533776806717`*^9, 3.702053394200576*^9}, {3.7020541999559307`*^9, 
  3.702054200122938*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntPiece", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1"}], "}"}], "]"}], "+", 
  RowBox[{"RootEvaluate", "[", 
   RowBox[{
    RowBox[{"1", "+", "#1", "+", 
     SuperscriptBox["#1", "2"]}], ",", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "-", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "3"]}], ")"}], 
          RowBox[{"2", "/", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "#1"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["x", "3"], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "#1"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "3"]}], ")"}], 
          RowBox[{"1", "/", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "#1"}]}], ")"}]}]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["x", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "#1"}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["x", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "3"]}], ")"}], 
          RowBox[{"1", "/", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "#1"}], ")"}]}], "-", 
        RowBox[{"x", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["x", "3"]}], ")"}], 
          RowBox[{"2", "/", "3"}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "#1"}]}], ")"}]}]}], "]"}], " ", "#1"}]}]}], 
   "]"}]}]], "Output",
 CellChangeTimes->{{3.702054193460065*^9, 3.702054205625565*^9}, 
   3.702741132919888*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iIntegrate", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SqrtBox["x"], 
     SqrtBox[
      RowBox[{
       SqrtBox["x"], "+", 
       SqrtBox[
        RowBox[{
         SqrtBox["x"], "+", "x"}]]}]]}]], ",", "x", ",", "\[Theta]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.701956707681315*^9, 3.701956708314209*^9}, {
  3.7019569975347347`*^9, 3.701957013901743*^9}, {3.701957076854372*^9, 
  3.701957096624539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox[
    RowBox[{
     SqrtBox["x"], "+", 
     SqrtBox[
      RowBox[{
       SqrtBox["x"], "+", "x"}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", 
      SqrtBox["x"]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{
        SqrtBox["x"], "+", "x"}]]}]}], ")"}]}], "+", 
  RowBox[{"IntPiece", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", "1"}], "}"}], "]"}], "+", 
  RowBox[{"RootEvaluate", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", "8"], "+", 
     SuperscriptBox["#1", "2"]}], ",", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", 
       RowBox[{"4", " ", 
        SqrtBox[
         RowBox[{
          SqrtBox["x"], "+", "x"}]]}], "+", 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             SqrtBox["x"], "+", "x"}]]}]}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SqrtBox["x"], "+", 
          SqrtBox[
           RowBox[{
            SqrtBox["x"], "+", "x"}]]}]], " ", "#1"}], "+", 
       RowBox[{"4", " ", 
        SqrtBox["x"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", " ", 
           SqrtBox[
            RowBox[{
             SqrtBox["x"], "+", 
             SqrtBox[
              RowBox[{
               SqrtBox["x"], "+", "x"}]]}]], " ", "#1"}]}], ")"}]}]}], "]"}], 
     " ", "#1"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.701957044736289*^9, 3.701957081648506*^9, 
  3.70195715205124*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iIntegrate", "[", 
  RowBox[{
   FractionBox["x", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["x", "4"], "+", 
      RowBox[{"4", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"6", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"4", "x"}], "+", "1"}]]], ",", "x", ",", "\[Theta]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.701956508032837*^9, 3.701956559751706*^9}, {
  3.701956753106632*^9, 3.7019567543392563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntPiece", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "}"}], "]"}], "+", 
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     FractionBox["16", "125"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "43"}], "+", 
       RowBox[{"33", " ", 
        SuperscriptBox["x", "2"]}], "-", 
       RowBox[{"44", " ", 
        SuperscriptBox["x", "3"]}], "-", 
       RowBox[{"45", " ", 
        SuperscriptBox["x", "4"]}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["x", "5"]}], "-", 
       SuperscriptBox["x", "6"], "-", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"4", " ", "x"}], "-", 
          RowBox[{"6", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["x", "3"]}], "+", 
          SuperscriptBox["x", "4"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "11"}], "+", 
          RowBox[{"22", " ", "x"}], "+", 
          RowBox[{"30", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["x", "3"]}], "+", 
          SuperscriptBox["x", "4"]}], ")"}]}]}], ")"}]}], "]"}]}]}]], "Output",\

 CellChangeTimes->{{3.701956527451272*^9, 3.701956563263694*^9}, 
   3.701956930660461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["tests", "Title",
 CellChangeTimes->{{3.579376620550087*^9, 3.5793766237948933`*^9}, 
   3.666104616271636*^9, {3.671192555690687*^9, 3.671192556518823*^9}, {
   3.693225391698819*^9, 3.693225392161838*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6932332107339163`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "nf", " ", "should", " ", "be", " ", "a", " ", "finite", " ", "field"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DivisorOrderTEST", "[", 
      RowBox[{
      "div_", ",", "P_", ",", "ord\[Delta]_", ",", "var_", ",", "nf_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k", "=", "0"}], ",", "divk", ",", "ord", ",", "fun", ",", 
         "ind", ",", 
         RowBox[{"succ", "=", "False"}], ",", "fpiece", ",", "limit", ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "ord\[Delta]", "]"}]}]}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<entering DivisorOrder: \>\"", ",", 
           RowBox[{"DivisorPrint", "[", "div", "]"}], ",", "\"\< over \>\"", 
           ",", "nf"}], "]"}], ";"}], "*)"}], "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"limit", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCard", "[", "nf", "]"}], "===", "\[Infinity]"}], ",",
             "7", ",", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"NumCard", "[", "nf", "]"}], "]"}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Total", "[", "ord\[Delta]", "]"}], "-", "n", "+", 
                  "1"}], ")"}]}], ")"}]}], "]"}]}], "]"}]}], ";"}], "*)"}], 
       "\n", "\t", 
       RowBox[{
        RowBox[{"limit", "=", "12"}], ";", "\n", "\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DivisorDegree", "[", 
            RowBox[{"div", ",", "var", ",", "nf"}], "]"}], "===", "0"}], ",", 
          "\"\<degree in DivisorOrder\>\""}], "]"}], ";", "\n", "\t", 
        RowBox[{"divk", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
          "}"}]}], ";", "\n", "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"!", "succ"}], ",", 
            RowBox[{
             RowBox[{"++", "k"}], "\[LessEqual]", "limit"}]}], "]"}], ",", 
          "\n", "\t\t", 
          RowBox[{
           RowBox[{"divk", "=", 
            RowBox[{"DivisorTimes", "[", 
             RowBox[{"divk", ",", "div", ",", "P", ",", "var", ",", "nf"}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ord", ",", "fun"}], "}"}], "=", 
            RowBox[{"DivisorRRSpace", "[", 
             RowBox[{
             "divk", ",", "P", ",", "ord\[Delta]", ",", "var", ",", "nf"}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"ind", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"ord", ",", 
               RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
           "\t\t", 
           RowBox[{"divk", "=", 
            RowBox[{"DivisorDivide", "[", 
             RowBox[{"divk", ",", 
              RowBox[{"DivisorMakePrincipal", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"fun", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                  
                  RowBox[{
                  "fun", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "P", ",", 
                "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", "P", ",", 
              "var", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"TimePrint", "[", 
              RowBox[{"\"\<div^\>\"", ",", "k", ",", "\"\<: \>\"", ",", 
               RowBox[{"DivisorPrint", "[", "divk", "]"}]}], "]"}], ";"}], 
            "*)"}], "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "ord", "\[LeftDoubleBracket]", "ind", "\[RightDoubleBracket]"}],
               "===", "0"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t", "]"}], ";",
         "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", ">", "limit"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<error in DivisorOrder: limit \>\"", ",", "limit", ",", 
               "\"\< reached \>\""}], "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "*)"}], "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", ">", "limit"}], ",", "\[Infinity]", ",", "k"}], 
         "]"}]}]}], "\n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DivisorIsTorsionTEST", "[", 
      RowBox[{
      "div_", ",", "P_", ",", "ord\[Delta]_", ",", "mm_", ",", "var_", ",", 
       "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "=", "mm"}], ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "ord\[Delta]", "]"}]}], ",", "p", ",", "q", 
         ",", "rediv", ",", "redP", ",", "redorder", ",", "nfp", ",", "nfq", 
         ",", "\n", "divk", ",", "fk", ",", "div2k", ",", "f2k", ",", "ord", 
         ",", "fun", ",", "ind", ",", "succ", ",", "func", ",", "powk", ",", 
         "pow2k"}], "}"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"DivisorIsPrincipal", "[", 
           RowBox[{
            RowBox[{"DivisorPower", "[", 
             RowBox[{"div", ",", 
              RowBox[{"op", "*", 
               RowBox[{"p", "^", "kp"}]}]}], "]"}], ",", "P", ",", 
            "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", 
          RowBox[{"op", "*", 
           RowBox[{"p", "^", "kp"}]}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<DivisorIsTorsion: \>\"", ",", 
           RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";"}], "*)"}], 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"divk", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
          "}"}]}], ";", 
        RowBox[{"powk", "=", "0"}], ";", 
        RowBox[{"pow2k", "=", "1"}], ";", "\n", "\t\t", 
        RowBox[{"fk", "=", 
         RowBox[{"MakeBaseElement", "[", 
          RowBox[{
           RowBox[{
           "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "1", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"div2k", "=", "div"}], ";", "\n", "\t\t", 
        RowBox[{"f2k", "=", "fk"}], ";", "\n", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TimePrint", "[", 
           RowBox[{"\"\<testing canditate order \>\"", ",", "m"}], "]"}], 
          ";"}], "*)"}], "\n", "\t\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OddQ", "[", "m", "]"}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"divk", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{
                "divk", ",", "div2k", ",", "P", ",", "var", ",", "nf"}], 
                "]"}]}], ";", 
              RowBox[{"powk", "+=", "pow2k"}], ";", "\n", "\t\t\t\t", 
              RowBox[{"fk", "=", 
               RowBox[{"PieceTimes", "[", 
                RowBox[{
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "fk", ",", "f2k", ",", "nf"}], "]"}]}], ";", "\n", 
              "\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ord", ",", "fun"}], "}"}], "=", 
               RowBox[{"DivisorRRSpace", "[", 
                RowBox[{
                "divk", ",", "P", ",", "ord\[Delta]", ",", "var", ",", "nf"}],
                 "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"ind", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"ord", ",", 
                  RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
              "\n", "\t\t\t\t", 
              RowBox[{"divk", "=", 
               RowBox[{"DivisorDivide", "[", 
                RowBox[{"divk", ",", 
                 RowBox[{"DivisorMakePrincipal", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "P", ",", 
                   "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", "P", 
                 ",", "var", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"fk", "=", 
               RowBox[{"PieceTimes", "[", 
                RowBox[{
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "fk", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"TimePrint", "[", 
               RowBox[{"\"\<divk \>\"", ",", "powk", ",", "\"\<: \>\"", ",", 
                RowBox[{"DivisorPrint", "[", "divk", "]"}], ",", 
                "\"\< * \>\"", ",", "fk"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\n", "\t\t\t", "]"}], ";", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"m", "=", 
            RowBox[{"Quotient", "[", 
             RowBox[{"m", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"m", ">", "0"}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"div2k", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{
                "div2k", ",", "div2k", ",", "P", ",", "var", ",", "nf"}], 
                "]"}]}], ";", 
              RowBox[{"pow2k", "+=", "pow2k"}], ";", "\n", "\t\t\t\t", 
              RowBox[{"f2k", "=", 
               RowBox[{"PieceTimes", "[", 
                RowBox[{
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "f2k", ",", "f2k", ",", "nf"}], "]"}]}], ";", "\n", 
              "\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ord", ",", "fun"}], "}"}], "=", 
               RowBox[{"DivisorRRSpace", "[", 
                RowBox[{
                "div2k", ",", "P", ",", "ord\[Delta]", ",", "var", ",", 
                 "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"ind", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"ord", ",", 
                  RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
              "\n", "\t\t\t\t", 
              RowBox[{"div2k", "=", 
               RowBox[{"DivisorDivide", "[", 
                RowBox[{"div2k", ",", 
                 RowBox[{"DivisorMakePrincipal", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "P", ",", 
                   "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", "P", 
                 ",", "var", ",", "nf"}], "]"}]}], ";", "\[IndentingNewLine]",
               "\t\t\t", 
              RowBox[{"f2k", "=", 
               RowBox[{"PieceTimes", "[", 
                RowBox[{
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "f2k", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"TimePrint", "[", 
               RowBox[{"\"\<div2k \>\"", ",", "pow2k", ",", "\"\<: \>\"", ",", 
                RowBox[{"DivisorPrint", "[", "div2k", "]"}], ",", 
                "\"\< * \>\"", ",", "f2k"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\t\t\t", "]"}], ";"}]}], "\n", 
         RowBox[{"(*", "\t\t\t", 
          RowBox[{
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<div^\>\"", ",", "powk", ",", "\"\<: \>\"", ",", 
             RowBox[{"DivisorPrint", "[", "divk", "]"}], ",", "\"\< * \>\"", 
             ",", "fk"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\t\t",
          "]"}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"succ", ",", "func"}], "}"}], "=", 
         RowBox[{"DivisorIsPrincipal", "[", 
          RowBox[{
          "divk", ",", "P", ",", "ord\[Delta]", ",", "var", ",", "nf"}], 
          "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"succ", ",", "\n", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{"succ", ",", 
            RowBox[{"PieceTimes", "[", 
             RowBox[{
              RowBox[{
              "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "func", ",", "fk", ",", "nf"}], "]"}], ",", "m"}], "}"}], 
          ",", "\n", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{"False", ",", "Null", ",", "Null"}], "}"}]}], "\n", "\t\t",
          "]"}]}]}], "\n", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.693233211848668*^9, 3.693233242604725*^9}, {
   3.693233366212673*^9, 3.693233366544245*^9}, {3.693233951915638*^9, 
   3.693234005069675*^9}, {3.6932340581047564`*^9, 3.69323406151163*^9}, {
   3.693234193983466*^9, 3.693234199319848*^9}, {3.6932342694540873`*^9, 
   3.693234288730398*^9}, {3.693234329359274*^9, 3.693234414336502*^9}, {
   3.6932344616735373`*^9, 3.693234465232605*^9}, {3.6932345229095984`*^9, 
   3.693234524397039*^9}, {3.693234564695278*^9, 3.693234590707062*^9}, {
   3.693234624394247*^9, 3.6932346316484327`*^9}, {3.693234849071471*^9, 
   3.6932348609790382`*^9}, {3.693234943030614*^9, 3.693234943373999*^9}, {
   3.693235602047476*^9, 3.6932356118068647`*^9}, {3.693236710159583*^9, 
   3.693236719015506*^9}, 3.693238116508711*^9, {3.693253399676469*^9, 
   3.6932534056893177`*^9}, {3.693253462918746*^9, 3.6932535710017138`*^9}, {
   3.693253608950141*^9, 3.693253624792553*^9}, {3.693254110791708*^9, 
   3.693254111793962*^9}, {3.69325442371567*^9, 3.6932544246788273`*^9}, {
   3.694182807077571*^9, 3.69418280796491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ei", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], ";", 
  RowBox[{"a", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0"},
          {"0", "1"}
         }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", 
           RowBox[{"-", "1"}]},
          {"0", "\[Xi]"}
         }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"b", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0"},
          {"0", "1"}
         }], ")"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "1"},
          {"0", "\[Xi]"}
         }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"progress", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"deg", "=", "4"}], ";", 
    RowBox[{"f", "=", 
     RowBox[{"x", "^", "deg"}]}], ";", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Discriminant", "[", 
        RowBox[{"f", ",", "x"}], "]"}], "===", "0"}], ",", 
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"x", "^", "deg"}], "+", 
        RowBox[{
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
           RowBox[{"deg", "-", "1"}]}], "]"}], ".", 
         RowBox[{"x", "^", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"deg", "-", "2"}]}], "]"}]}]}]}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"progress", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
        "progress", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "+", "1"}], ",", "f"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ff", "=", 
     RowBox[{"ToFunctionAlgebra", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"y", "^", "2"}], "-", "f"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"div", "=", 
     RowBox[{"DivisorDivide", "[", 
      RowBox[{"b", ",", "a", ",", 
       RowBox[{"ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"badred", "=", 
     RowBox[{"Discriminant", "[", 
      RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ord", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "=", "13"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"badred", ",", "p"}], "]"}], "===", "0"}], ",", 
          RowBox[{
           RowBox[{"p", "=", 
            RowBox[{"NextPrime", "[", "p", "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eip", "=", 
         RowBox[{"NF", "[", 
          RowBox[{"p", ",", "\[Theta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"p", ",", 
          RowBox[{"DivisorOrderTEST", "[", 
           RowBox[{"div", ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "eip"}], "]"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"NextPrime", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"badred", ",", "p"}], "]"}], "===", "0"}], ",", 
          RowBox[{
           RowBox[{"p", "=", 
            RowBox[{"NextPrime", "[", "p", "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eip", "=", 
         RowBox[{"NF", "[", 
          RowBox[{"p", ",", "\[Theta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"p", ",", 
          RowBox[{"DivisorOrderTEST", "[", 
           RowBox[{"div", ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "eip"}], "]"}]}], 
         "}"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ord", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
        "\[Infinity]"}], "&&", 
       RowBox[{
        RowBox[{"ord", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
        "\[Infinity]"}], "&&", 
       RowBox[{
        RowBox[{"ord", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "===", 
        RowBox[{"ord", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<y^2=\>\"", ",", "f", ",", "\"\<  ord: \>\"", ",", "ord"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"DivisorIsTorsionTEST", "[", 
         RowBox[{"div", ",", 
          RowBox[{
          "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"Print", "[", "res", "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", "5000", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.693241393964962*^9, 3.693241396915201*^9}, {
   3.6932414312997293`*^9, 3.6932414809081163`*^9}, {3.693241527593803*^9, 
   3.693241621444376*^9}, 3.693241697032311*^9, {3.693241750992618*^9, 
   3.693241753262474*^9}, {3.693253886012422*^9, 3.6932538860988092`*^9}, {
   3.69325393993202*^9, 3.693253945890815*^9}, {3.6932541337944317`*^9, 
   3.6932541547840767`*^9}, {3.693254189872802*^9, 3.693254203364234*^9}, 
   3.69325491923986*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"58", "+", 
    RowBox[{"12", " ", "x"}], "-", 
    RowBox[{"27", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "5"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 58 + 12 $CellContext`x - 27 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 5}, {17, 5}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6932544428598137`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"80", "-", 
    RowBox[{"21", " ", "x"}], "-", 
    RowBox[{"95", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "10"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 80 - 21 $CellContext`x - 95 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 10}, {17, 10}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.69325449501785*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"61", "+", 
    RowBox[{"14", " ", "x"}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "7"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 61 + 14 $CellContext`x - 16 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 7}, {17, 7}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254525235024*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"72", "+", 
    RowBox[{"49", " ", "x"}], "+", 
    RowBox[{"13", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "6"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 72 + 49 $CellContext`x + 13 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 6}, {17, 6}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6932545524537983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "94"}], "+", 
    RowBox[{"18", " ", "x"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "8"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", -94 + 18 $CellContext`x - 2 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 8}, {17, 8}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254564427121*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"80", "+", 
    RowBox[{"28", " ", "x"}], "-", 
    RowBox[{"10", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "9"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 80 + 28 $CellContext`x - 10 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 9}, {17, 9}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254593461458*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"23", "-", 
    RowBox[{"23", " ", "x"}], "-", 
    RowBox[{"40", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "9"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 23 - 23 $CellContext`x - 40 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 9}, {17, 9}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254595607621*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "59"}], "+", 
    RowBox[{"92", " ", "x"}], "+", 
    RowBox[{"67", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "3"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", -59 + 92 $CellContext`x + 67 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 3}, {17, 3}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6932545991692457`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "78"}], "+", 
    RowBox[{"53", " ", "x"}], "+", 
    RowBox[{"50", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "3"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", -78 + 53 $CellContext`x + 50 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 3}, {17, 3}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.69325462310651*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"40", "-", 
    RowBox[{"21", " ", "x"}], "+", 
    RowBox[{"13", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "6"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 40 - 21 $CellContext`x + 13 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 6}, {17, 6}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254627681964*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "45"}], "-", 
    RowBox[{"27", " ", "x"}], "-", 
    RowBox[{"34", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "11"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", -45 - 27 $CellContext`x - 34 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 11}, {17, 11}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254674083663*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"52", "+", 
    RowBox[{"4", " ", "x"}], "-", 
    RowBox[{"15", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "5"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 52 + 4 $CellContext`x - 15 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 5}, {17, 5}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254707519993*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "55"}], "-", 
    RowBox[{"40", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"17", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "2"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", -55 - 40 $CellContext`x^2 + $CellContext`x^4, "  ord: ", {{17, 2}, {
   19, 2}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.69325474330939*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox["x", "2"], "20"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "20"]}]}], "}"}], ",", "1"}], "}"}], ",", "0"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.693254743347686*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y^2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"26", "+", 
    RowBox[{"50", " ", "x"}], "+", 
    RowBox[{"35", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    SuperscriptBox["x", "4"]}], "\[InvisibleSpace]", "\<\"  ord: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "7"}], "}"}]}], "}"}]}],
  SequenceForm[
  "y^2=", 26 + 50 $CellContext`x + 35 $CellContext`x^2 + $CellContext`x^4, 
   "  ord: ", {{13, 7}, {17, 7}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.693254757697139*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ei", "=", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", "3"}], "]"}]}], ")"}], "/", "2"}]}], "]"}]}], ";", 
    RowBox[{"a", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", 
             RowBox[{"-", "1"}]},
            {"0", "1", 
             RowBox[{"-", "1"}]},
            {"0", "0", "\[Xi]"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";", 
    RowBox[{"b", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", 
             RowBox[{"1", "+", "\[Theta]"}]},
            {"0", "1", 
             RowBox[{"-", "\[Theta]"}]},
            {"0", "0", "\[Xi]"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";", 
    RowBox[{"c", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", 
             RowBox[{"-", "\[Theta]"}]},
            {"0", "1", 
             RowBox[{"1", "+", "\[Theta]"}]},
            {"0", "0", "\[Xi]"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"progress", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"deg", "=", "6"}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"x", "^", "deg"}]}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Discriminant", "[", 
           RowBox[{"f", ",", "x"}], "]"}], "===", "0"}], "||", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"f", "/.", 
            RowBox[{"x", "\[Rule]", "0"}]}], ")"}], "===", "0"}], "||", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"f", ",", "x"}], "]"}], "/.", 
            RowBox[{"x", "\[Rule]", "0"}]}], ")"}], "===", "0"}]}], ",", 
        RowBox[{"f", "=", 
         RowBox[{
          RowBox[{"x", "^", "deg"}], "+", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", "deg"}], "]"}], 
           ".", 
           RowBox[{"x", "^", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"deg", "-", "1"}]}], "]"}]}]}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"progress", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "progress", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "+", "1"}], ",", "f"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ToFunctionAlgebra", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"y", "^", "3"}], "-", "f"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"div", "=", 
       RowBox[{"DivisorTimes", "[", 
        RowBox[{
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"b", ",", "a", ",", 
           RowBox[{
           "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}], ",", 
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"c", ",", "a", ",", 
           RowBox[{
           "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}], ",", 
         RowBox[{"ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<div: \>\"", ",", 
          RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"disc", "=", 
       RowBox[{"Discriminant", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ord", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "=", "13"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", "3"}], "]"}], "=!=", "1"}], "||", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"disc", ",", "p"}], "]"}], "===", "0"}]}], ",", 
            RowBox[{
             RowBox[{"p", "=", 
              RowBox[{"NextPrime", "[", "p", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{
            RowBox[{"FactorList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], 
              ",", 
              RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"eip", ",", "\[Theta]"}], "]"}], "===", "1"}], ",", 
            "\"\<exponent problem\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{"NF", "[", 
            RowBox[{"p", ",", "eip"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"DivisorOrderTEST", "[", 
             RowBox[{"div", ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "eip"}], "]"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"NextPrime", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", "3"}], "]"}], "=!=", "1"}], "||", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"disc", ",", "p"}], "]"}], "===", "0"}]}], ",", 
            RowBox[{
             RowBox[{"p", "=", 
              RowBox[{"NextPrime", "[", "p", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{
            RowBox[{"FactorList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], 
              ",", 
              RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"eip", ",", "\[Theta]"}], "]"}], "===", "1"}], ",", 
            "\"\<exponent problem\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{"NF", "[", 
            RowBox[{"p", ",", "eip"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"DivisorOrderTEST", "[", 
             RowBox[{"div", ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "eip"}], "]"}]}], 
           "}"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
          "\[Infinity]"}], "&&", 
         RowBox[{
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
          "\[Infinity]"}], "&&", 
         RowBox[{
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "===", 
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<f: \>\"", ",", "f", ",", "\"\<  ord: \>\"", ",", "ord"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"DivisorIsTorsionTEST", "[", 
           RowBox[{"div", ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"ord", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Print", "[", "res", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", "5000", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6932325468344517`*^9, 3.6932325742004633`*^9}, {
   3.693232662224133*^9, 3.693232807469927*^9}, {3.6932328406415157`*^9, 
   3.693233010779352*^9}, 3.6932330441857853`*^9, {3.693233141414412*^9, 
   3.693233153029642*^9}, {3.693233269946761*^9, 3.693233305349737*^9}, {
   3.69323337277455*^9, 3.693233375030047*^9}, {3.693233508886705*^9, 
   3.6932335905399714`*^9}, {3.693233622750045*^9, 3.6932336407403507`*^9}, {
   3.693234231281499*^9, 3.693234232771653*^9}, {3.6932347157187223`*^9, 
   3.693234751591178*^9}, {3.693235001884212*^9, 3.69323501826305*^9}, {
   3.693235146537736*^9, 3.693235148071838*^9}, {3.693235293632351*^9, 
   3.693235445489781*^9}, {3.693235522717307*^9, 3.6932355866658983`*^9}, {
   3.69323562372978*^9, 3.693235641203829*^9}, {3.693235880024972*^9, 
   3.693235932380849*^9}, {3.693236251825012*^9, 3.6932362645517178`*^9}, {
   3.6932366980016613`*^9, 3.693236699921792*^9}, {3.693236730338429*^9, 
   3.693236730729183*^9}, {3.6932381175484962`*^9, 3.693238118261195*^9}, {
   3.693241379783373*^9, 3.6932413817990313`*^9}, {3.693242532329689*^9, 
   3.693242535934251*^9}, {3.6932434971234207`*^9, 3.693243497405105*^9}, {
   3.693249755589472*^9, 3.693249785252054*^9}, {3.69325262833364*^9, 
   3.693252641007663*^9}, {3.693252671687574*^9, 3.69325271863805*^9}, {
   3.693253389273938*^9, 3.693253390337208*^9}, {3.6932536147870913`*^9, 
   3.693253615368511*^9}, {3.693254930594626*^9, 3.6932549347870073`*^9}, {
   3.693315192476708*^9, 3.6933152033359737`*^9}, {3.693315351208909*^9, 
   3.6933153538066883`*^9}, {3.693315957167225*^9, 3.693315957943345*^9}, {
   3.69331601294306*^9, 3.693316014746599*^9}, {3.69332800239573*^9, 
   3.693328002874097*^9}, {3.694182759211754*^9, 3.6941827947061787`*^9}, {
   3.69418284040875*^9, 3.6941828454290037`*^9}, {3.694182888129087*^9, 
   3.6941828891683397`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.6941828374008713`*^9, 3.694182883880562*^9, 
  3.694207708295542*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ei", "=", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"-", "3"}], "]"}]}], ")"}], "/", "2"}]}], "]"}]}], ";", 
    RowBox[{"a", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", 
             RowBox[{"-", "1"}]},
            {"0", "1", 
             RowBox[{"-", "1"}]},
            {"0", "0", "\[Xi]"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";", 
    RowBox[{"b", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", 
             RowBox[{"1", "+", "\[Theta]"}]},
            {"0", "1", 
             RowBox[{"-", "\[Theta]"}]},
            {"0", "0", "\[Xi]"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";", 
    RowBox[{"c", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0"},
            {"0", "1", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", 
             RowBox[{"-", "\[Theta]"}]},
            {"0", "1", 
             RowBox[{"1", "+", "\[Theta]"}]},
            {"0", "0", "\[Xi]"}
           }], "\[NoBreak]", ")"}], ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"progress", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "progress", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "++"}], ";", "\[IndentingNewLine]", 
      RowBox[{"deg", "=", "1"}], ";", 
      RowBox[{"g", "=", 
       RowBox[{"x", "^", "deg"}]}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Discriminant", "[", 
          RowBox[{"g", ",", "x"}], "]"}], "===", "0"}], ",", 
        RowBox[{"g", "=", 
         RowBox[{
          RowBox[{"x", "^", "deg"}], "+", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
             RowBox[{"deg", "-", "1"}]}], "]"}], ".", 
           RowBox[{"x", "^", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"deg", "-", "1"}]}], "]"}]}]}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deg", "=", "4"}], ";", 
      RowBox[{"f", "=", 
       RowBox[{"x", "^", "deg"}]}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Discriminant", "[", 
           RowBox[{"f", ",", "x"}], "]"}], "===", "0"}], "||", 
         RowBox[{
          RowBox[{"Resultant", "[", 
           RowBox[{"f", ",", "g", ",", "x"}], "]"}], "===", "0"}]}], ",", 
        RowBox[{"f", "=", 
         RowBox[{
          RowBox[{"x", "^", "deg"}], "+", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", 
             RowBox[{"deg", "-", "1"}]}], "]"}], ".", 
           RowBox[{"x", "^", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"deg", "-", "2"}]}], "]"}]}]}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"progress", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "progress", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "+", "1"}], ",", 
         RowBox[{"f", "*", 
          RowBox[{"g", "^", "2"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ToFunctionAlgebra", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"y", "^", "3"}], "-", 
            RowBox[{"f", "*", 
             RowBox[{"g", "^", "2"}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"div", "=", 
       RowBox[{"DivisorDivide", "[", 
        RowBox[{"b", ",", "a", ",", 
         RowBox[{"ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"badred", "=", 
       RowBox[{
        RowBox[{"Discriminant", "[", 
         RowBox[{"f", ",", "x"}], "]"}], "*", 
        RowBox[{"Discriminant", "[", 
         RowBox[{"g", ",", "x"}], "]"}], "*", 
        RowBox[{"Resultant", "[", 
         RowBox[{"f", ",", "g", ",", "x"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ord", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "=", "13"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", "3"}], "]"}], "=!=", "1"}], "||", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"badred", ",", "p"}], "]"}], "===", "0"}]}], ",", 
            RowBox[{
             RowBox[{"p", "=", 
              RowBox[{"NextPrime", "[", "p", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{
            RowBox[{"FactorList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], 
              ",", 
              RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"eip", ",", "\[Theta]"}], "]"}], "===", "1"}], ",", 
            "\"\<exponent problem\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{"NF", "[", 
            RowBox[{"p", ",", "eip"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"DivisorOrderTEST", "[", 
             RowBox[{"div", ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "eip"}], "]"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p", "=", 
           RowBox[{"NextPrime", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"p", ",", "3"}], "]"}], "=!=", "1"}], "||", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"badred", ",", "p"}], "]"}], "===", "0"}]}], ",", 
            RowBox[{
             RowBox[{"p", "=", 
              RowBox[{"NextPrime", "[", "p", "]"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{
            RowBox[{"FactorList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], 
              ",", 
              RowBox[{"Modulus", "\[Rule]", "p"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"eip", ",", "\[Theta]"}], "]"}], "===", "1"}], ",", 
            "\"\<exponent problem\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"eip", "=", 
           RowBox[{"NF", "[", 
            RowBox[{"p", ",", "eip"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"DivisorOrderTEST", "[", 
             RowBox[{"div", ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "eip"}], "]"}]}], 
           "}"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
          "\[Infinity]"}], "&&", 
         RowBox[{
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
          "\[Infinity]"}], "&&", 
         RowBox[{
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "===", 
          RowBox[{"ord", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<y^3=\>\"", ",", 
           RowBox[{"Factor", "[", 
            RowBox[{"f", "*", 
             RowBox[{"g", "^", "2"}]}], "]"}], ",", "\"\<  ord: \>\"", ",", 
           "ord"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"DivisorIsTorsionTEST", "[", 
           RowBox[{"div", ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "ff", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"ord", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "ei"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Print", "[", "res", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", "5000", "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6932371897697287`*^9, 3.6932372918186493`*^9}, {
  3.693237326956912*^9, 3.6932373308150806`*^9}, {3.69323742592763*^9, 
  3.693237564464744*^9}, {3.693238095303948*^9, 3.693238135377088*^9}, {
  3.693239842380273*^9, 3.693239843827051*^9}, {3.693239908223198*^9, 
  3.693239961675438*^9}, {3.693240140240354*^9, 3.693240151891427*^9}, {
  3.693240193286269*^9, 3.693240197417169*^9}, {3.693240252571727*^9, 
  3.693240273049294*^9}, {3.693240327705038*^9, 3.69324035320583*^9}, {
  3.6932404874767723`*^9, 3.693240584977434*^9}, {3.693241182160244*^9, 
  3.693241187105714*^9}, {3.693241319518989*^9, 3.69324132200933*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.693241353740966*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AlgInt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       SuperscriptBox["y", "3"], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["x", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "+", 
            SuperscriptBox["x", "2"]}], ")"}], "2"]}], ")"}]}]}], "}"}], 
    "}"}], ",", 
   FractionBox["x", "y"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.693240407309518*^9, 3.6932404354601*^9}, {
  3.693240777253364*^9, 3.693240785100803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Int", "[", "0", "]"}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"Log", "[", 
    RowBox[{
     FractionBox["1", "20"], " ", 
     RowBox[{"(", 
      RowBox[{"20", "-", 
       RowBox[{"9", " ", 
        SuperscriptBox["x", "4"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"9", " ", 
           SuperscriptBox["x", "2"]}]}], ")"}], " ", "y"}], "-", 
       FractionBox[
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["x", "2"]}]}], ")"}], " ", 
         SuperscriptBox["y", "2"]}], 
        RowBox[{"2", "+", 
         SuperscriptBox["x", "2"]}]]}], ")"}]}], "]"}]}], "+", 
  RowBox[{"RootPlus", "[", 
   RowBox[{
    RowBox[{
     FractionBox["3", "4"], "+", 
     SuperscriptBox["#1", "2"]}], ",", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["x", "2"], " ", "#1"}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["y", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "#1"}]}], ")"}]}], 
          RowBox[{"2", "+", 
           SuperscriptBox["x", "2"]}]], "+", 
         RowBox[{"y", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"2", " ", "#1"}]}], ")"}]}]}], ")"}]}], "]"}], " ", 
     "#1"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.693240438905149*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ex", "Title",
 CellChangeTimes->{{3.579376620550087*^9, 3.5793766237948933`*^9}, 
   3.666104616271636*^9, {3.671192555690687*^9, 3.671192556518823*^9}}],

Cell[TextData[{
 StyleBox["QBasisForRootSpan",
  FontWeight->"Bold"],
 " is only implemented for the number field ",
 Cell[BoxData[
  FormBox["\[DoubleStruckCapitalQ]", TraditionalForm]]],
 " (i.e. ",
 StyleBox["NF[0,\[Theta]]",
  FontWeight->"Bold"],
 "), so we restrict the integrands to this field only."
}], "Text",
 CellChangeTimes->{{3.6673379057334948`*^9, 3.667337974455368*^9}}],

Cell[TextData[{
 "The integral ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "n"]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "n"}]], 
     RowBox[{"\[DifferentialD]", "x"}]}]}], TraditionalForm]]],
 " can be done with the substitution ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{"x", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "n"]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "/", "n"}]]}]}], TraditionalForm]]],
 ", but this does not produce the nicest answers. For example ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", "d"}], "\[InvisibleComma]", 
    RowBox[{"x", "/", "y"}]}], TraditionalForm]]],
 " on ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["y", "2"], "=", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]}], TraditionalForm]]],
 " is usually integrated as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["tan", 
     RowBox[{"-", "1"}]], "(", 
    RowBox[{"x", "/", "y"}], ")"}], TraditionalForm]]],
 ". The procedure produces the integration ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", " ", 
    RowBox[{
     SuperscriptBox["tan", 
      RowBox[{"-", "1"}]], "(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "y"}], ")"}], "/", "x"}], ")"}]}], TraditionalForm]]],
 ", which shows that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "/", "y"}], TraditionalForm]]],
 " is, in some sense, like a square when inside the arctangent. The integral \
for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "4"}], TraditionalForm]]],
 " should be compared to the answer returned by FriCAS:"
}], "Text",
 CellChangeTimes->{{3.667337987738529*^9, 3.667338057183422*^9}, {
   3.667338206472328*^9, 3.667338294402351*^9}, {3.66733844544879*^9, 
   3.6673385299841537`*^9}, 3.667338852584599*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        SqrtBox["2"], "2"], 
       RowBox[{"ArcTan", "[", 
        FractionBox["x", 
         RowBox[{
          RowBox[{"x", 
           SqrtBox[
            FractionBox[
             RowBox[{
              RowBox[{"2", 
               SuperscriptBox["y", "2"]}], "-", 
              RowBox[{"2", "x", 
               SqrtBox["2"], "y"}], "+", 
              RowBox[{"2", 
               SuperscriptBox["x", "2"]}]}], 
             SuperscriptBox["x", "2"]]]}], "+", 
          RowBox[{
           SqrtBox["2"], "y"}], "-", "x"}]], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        SqrtBox["2"], "2"], 
       RowBox[{"ArcTan", "[", 
        FractionBox["x", 
         RowBox[{
          RowBox[{"x", 
           SqrtBox[
            FractionBox[
             RowBox[{
              RowBox[{"2", 
               SuperscriptBox["y", "2"]}], "+", 
              RowBox[{"2", "x", 
               SqrtBox["2"], "y"}], "+", 
              RowBox[{"2", 
               SuperscriptBox["x", "2"]}]}], 
             SuperscriptBox["x", "2"]]]}], "+", 
          RowBox[{
           SqrtBox["2"], "y"}], "+", "x"}]], "]"}]}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{
       FractionBox[
        SqrtBox["2"], "8"], 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"2", 
           SuperscriptBox["y", "2"]}], "+", 
          RowBox[{"2", "x", 
           SqrtBox["2"], "y"}], "+", 
          RowBox[{"2", 
           SuperscriptBox["x", "2"]}]}], 
         SuperscriptBox["x", "2"]], "]"}]}], "-", 
      RowBox[{
       FractionBox[
        SqrtBox["2"], "8"], 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"2", 
           SuperscriptBox["y", "2"]}], "-", 
          RowBox[{"2", "x", 
           SqrtBox["2"], "y"}], "+", 
          RowBox[{"2", 
           SuperscriptBox["x", "2"]}]}], 
         SuperscriptBox["x", "2"]], "]"}]}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "4"]}], ")"}], 
       RowBox[{"1", "/", "4"}]]}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", ",", "x"}], "]"}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.667338545442354*^9, 3.667338842408266*^9}, {
  3.667340074694873*^9, 3.667340124855846*^9}}],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "4"]}], ")"}], 
   RowBox[{"1", "/", "4"}]]]], "Output",
 CellChangeTimes->{{3.6673386830559397`*^9, 3.667338711782839*^9}, {
  3.667338765855846*^9, 3.667338781256015*^9}, {3.66733882978344*^9, 
  3.667338843273123*^9}, {3.667340117281636*^9, 3.667340126923215*^9}}]
}, Open  ]],

Cell["where as our answer here is much nicer", "Text",
 CellChangeTimes->{{3.6673399683210077`*^9, 3.667339986825502*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"ArcTan", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "y"}], "-", 
          RowBox[{
           SuperscriptBox["x", "2"], " ", "y"}], "-", 
          SuperscriptBox["y", "3"]}], 
         RowBox[{
          SqrtBox["2"], " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]], "]"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], 
       RowBox[{"ArcTanh", "[", 
        FractionBox[
         RowBox[{"y", "+", 
          RowBox[{
           SuperscriptBox["x", "2"], " ", "y"}], "-", 
          SuperscriptBox["y", "3"]}], 
         RowBox[{
          SqrtBox["2"], " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]], "]"}]}]}], "/.", 
     RowBox[{"y", "\[Rule]", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "4"]}], ")"}], 
       RowBox[{"1", "/", "4"}]]}]}], ",", "x"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6673399970796747`*^9, 3.667340013714875*^9}, {
  3.6673401334353733`*^9, 3.667340145326117*^9}}],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "4"]}], ")"}], 
   RowBox[{"1", "/", "4"}]]]], "Output",
 CellChangeTimes->{{3.6673400084647293`*^9, 3.667340014216997*^9}, 
   3.667340145981715*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}], ")"}]}]}], "}"}], ",", 
      FractionBox["1", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{
  3.6673166289384317`*^9, {3.667333069407978*^9, 3.6673330701116953`*^9}, {
   3.667333473825678*^9, 3.667333500096284*^9}, {3.667334154281261*^9, 
   3.667334156359899*^9}, {3.667744752207773*^9, 3.66774477043764*^9}, 
   3.6677448457346067`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.003362`3.9781427025994254", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"new curve \"\>", "\[InvisibleSpace]", 
   RowBox[{"1", "-", 
    SuperscriptBox["X", "2"], "+", 
    SuperscriptBox["Y", "2"]}], "\[InvisibleSpace]", "\<\" after change \"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      FractionBox["1", "X"]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox["Y", "X"]}]}], "}"}]}],
  SequenceForm[
  0.003362`3.9781427025994254, ": ", "new curve ", 
   1 - $CellContext`X^2 + $CellContext`Y^2, 
   " after change ", {$CellContext`x -> $CellContext`X^(-1), $CellContext`y -> \
$CellContext`X^(-1) $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178039474*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"normal integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm["normal integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178058773*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"change of basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm["change of basis: ", {{1, 0}, {0, 1}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.66776717806085*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"product: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "2"]}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "product: ", {{{1, 0}, {0, 1}}, {{0, 1}, {-1 + $CellContext`X^2, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178062817*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trace: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}],
  SequenceForm["trace: ", {2, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178064762*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"orders: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}],
  SequenceForm["orders: ", {0, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178066593*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"derivative: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["X", "2"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0"},
       {"0", "X"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["derivative: ", (-1 + $CellContext`X^2)^(-1), "*", 
   MatrixForm[{{0, 0}, {0, $CellContext`X}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178068644*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"absolutely irreducible components: \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["absolutely irreducible components: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671780704527`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"genus: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["genus: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178072241*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"discriminant: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "X"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "X"}], ")"}]}]}],
  SequenceForm["discriminant: ", (-1 + $CellContext`X) (1 + $CellContext`X)],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178074089*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"different: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm["different: ", 
   Row[{1, "*", 
     MatrixForm[{{-1 + $CellContext`X^2, 0}, {0, 1}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178076447*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"square free factors: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          GridBox[{{
             RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}], "}"}]}],
  SequenceForm["square free factors: ", {
    Row[{1, "*", 
      MatrixForm[{{1, 0}, {0, 1}}]}], 
    Row[{1, "*", 
      MatrixForm[{{-1 + $CellContext`X^2, 0}, {0, 1}}]}]}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.66776717807931*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bad reduction: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "4"}], "}"}]}],
  SequenceForm["bad reduction: ", {1, 4, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178081402*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.035927`5.006965947470976", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm[
  0.035927`5.006965947470976, ": ", "integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671780834503`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.03603`5.008209255618541", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "X"}], "+", 
     SuperscriptBox["X", "3"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm[
  0.03603`5.008209255618541, ": ", 
   "integrand: ", (-$CellContext`X + $CellContext`X^3)^(-1), "*", {0, -1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178085586*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.036649`5.015607122530229", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "X"}], "+", 
     SuperscriptBox["X", "3"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm[
  0.036649`5.015607122530229, ": ", 
   "integrand: ", (-$CellContext`X + $CellContext`X^3)^(-1), "*", {0, -1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671780875177`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.0377`5.027886343701764", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"respiece: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"], " ", "#1"}]}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", "1"}], "}"}], "&"}]}],
  SequenceForm[
  0.0377`5.027886343701764, ": ", 
   "respiece: ", {{# - (3 $CellContext`X^2) #, -1}, 1}& ],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178089158*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.03867`5.038919165569034", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"normres: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"1", "+", 
     SuperscriptBox["#1", "2"], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["X", "4"], " ", 
      SuperscriptBox["#1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["X", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox["#1", "2"]}]}], ")"}]}]}], "&"}]}],
  SequenceForm[
  0.03867`5.038919165569034, ": ", "normres: ", 
   1 + #^2 + (9 $CellContext`X^4) #^2 + $CellContext`X^2 (-1 - 6 #^2)& ],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178090951*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.050168`5.151971781263263", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "1", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"X", "0"}, {"0", "X"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["X", "2"], ",", "1"}], "}"}]}],
  SequenceForm[
  0.050168`5.151971781263263, ": ", "B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{$CellContext`X, 0}, {0, $CellContext`X}}]}], 
   " , norm of B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", {$CellContext`X^2, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178092819*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.051666`5.164749833110678", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"1", "+", 
    SuperscriptBox["z$3199", "2"]}]}],
  SequenceForm[
  0.051666`5.164749833110678, ": ", "residues from ramification index ", 1, 
   ": ", 1 + $CellContext`z$3199^2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178095182*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.053417`5.179224487064684", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "X"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "X"}], ")"}]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.053417`5.179224487064684, ": ", "B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{-1 + $CellContext`X^2, 0}, {0, 1}}]}], 
   " , norm of B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", {(-1 + $CellContext`X) (1 + $CellContext`X), 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178097093*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.055007`5.191962953316242", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.055007`5.191962953316242, ": ", "residues from ramification index ", 2, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178099634*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.058045`5.215309809027377", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"DATA: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", "\[Theta]", "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", 
              RowBox[{"-", "\[Theta]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[0.058045`5.215309809027377, ": ", "DATA: ", 
   MatrixForm[{
     $CellContext`belem["2a", 
      $CellContext`NF[
      0, 1 + $CellContext`\[Theta]^2], {$CellContext`\[Theta]}, \
-$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
      1 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[
       0, 1 + $CellContext`\[Theta]^2], {$CellContext`\[Theta], \
-$CellContext`\[Theta]}, {{1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
        $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
        1}}, {}]}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178101869*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.058532`5.2189383574209165", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", "\[Theta]", "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{"-", "\[Theta]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.058532`5.2189383574209165, ": ", 
   "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[
    0, 1 + $CellContext`\[Theta]^2], {$CellContext`\[Theta]}, -$CellContext`\
\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
    1 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[
     0, 1 + $CellContext`\[Theta]^2], {$CellContext`\[Theta], -$CellContext`\
\[Theta]}, {{1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
      $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
      1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178104289*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781064587`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.07296`5.314629818816336", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "\[Theta]"}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.07296`5.314629818816336, ": ", "ideal: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, $CellContext`\[Theta]}, {0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781081676`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "\[Theta]"}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, $CellContext`\[Theta]}, {0, $CellContext`X^2}}]}], 
   " over ", 
   $CellContext`NF[0, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178110631*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.074507`5.323742070520248", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "\[Theta]"}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.074507`5.323742070520248, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, $CellContext`\[Theta]}, {0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781131077`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[3, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178115548*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[3, 1 + $CellContext`\[Theta]^2], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178117798*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.085552`5.383775160252239", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "3"}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.085552`5.383775160252239, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 3}, {0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781196213`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[5, 2 + $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178122116*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 2 + $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178124291*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[0, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781521883`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.102545`5.4624594829166115", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "\[Theta]"}], "}"}], ",", "X"}], "}"}]}],
  SequenceForm[
  0.102545`5.4624594829166115, ": ", 
   "inside HandleLogTerm 2a: ", {{1, $CellContext`\[Theta]}, $CellContext`X}],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781572447`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.103927`5.468273384438056", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.103927`5.468273384438056, ": ", "inside HandleLogTerm 2a: cnorm:  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781596527`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.107305`5.4821649523847364", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"1", "+", "X"}]}], "}"}]}],
  SequenceForm[
  0.107305`5.4821649523847364, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{0, -1}, 1 + $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178161372*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.109219`5.489843189349863", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "X"}]}], "}"}]}],
  SequenceForm[
  0.109219`5.489843189349863, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{0, 1}, -1 + $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781630774`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.111001`5.496871884827908", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.111001`5.496871884827908, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{$CellContext`X, -1}, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.667767178164764*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.112811`5.503896442490666", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "X"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.112811`5.503896442490666, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{-$CellContext`X, -1}, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6677440309882174`*^9, 3.66774416485609*^9, 3.667744237514889*^9, 
   3.6677442972614098`*^9, 3.6677446553222313`*^9, {3.667744747295721*^9, 
   3.667744770890143*^9}, 3.6677448462672157`*^9, 3.667764724336865*^9, 
   3.667764844236614*^9, {3.667764932352565*^9, 3.667764947615117*^9}, 
   3.6677649966264067`*^9, 3.667765030941736*^9, {3.667765062078207*^9, 
   3.667765085073094*^9}, {3.667765135721546*^9, 3.667765159581616*^9}, 
   3.6677671781664467`*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.11698200000000014`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"ArcTan", "[", 
        FractionBox[
         RowBox[{"1", "-", "y"}], "x"], "]"}]}]}]}], "]"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.667316630343461*^9, 3.667316676106434*^9, {3.667316719730402*^9, 
   3.667316739784438*^9}, 3.6673167879343348`*^9, 3.66731687903963*^9, 
   3.66733290481987*^9, {3.6673329898318253`*^9, 3.6673330709130096`*^9}, 
   3.667333118630525*^9, 3.667333148751122*^9, 3.667333313675147*^9, {
   3.667333458942046*^9, 3.667333501312297*^9}, 3.667333675070654*^9, 
   3.667333828619561*^9, 3.667334156869923*^9, 3.667334259464014*^9, 
   3.667334462813693*^9, 3.667743987043263*^9, 3.6677440310010347`*^9, 
   3.6677441648779917`*^9, 3.667744237555252*^9, 3.667744297320034*^9, 
   3.667744655449691*^9, {3.66774474741691*^9, 3.667744771128924*^9}, 
   3.667744846390308*^9, 3.667764724476598*^9, 3.6677648443121634`*^9, {
   3.667764932404614*^9, 3.667764947670085*^9}, 3.667764996719492*^9, 
   3.667765031016447*^9, {3.667765062227173*^9, 3.6677650851960907`*^9}, {
   3.667765135841158*^9, 3.6677651597033863`*^9}, 3.667767178168172*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "3"], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["x", "3"]}], ")"}]}]}], "}"}], ",", 
      FractionBox["1", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{
  3.6673166289384317`*^9, {3.667333069407978*^9, 3.6673330701116953`*^9}, {
   3.667333473825678*^9, 3.667333500096284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.005849`4.218626614859295", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"new curve \"\>", "\[InvisibleSpace]", 
   RowBox[{"1", "-", 
    SuperscriptBox["X", "3"], "+", 
    SuperscriptBox["Y", "3"]}], "\[InvisibleSpace]", "\<\" after change \"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      FractionBox["1", "X"]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox["Y", "X"]}]}], "}"}]}],
  SequenceForm[
  0.005849`4.218626614859295, ": ", "new curve ", 
   1 - $CellContext`X^3 + $CellContext`Y^3, 
   " after change ", {$CellContext`x -> $CellContext`X^(-1), $CellContext`y -> \
$CellContext`X^(-1) $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671815546837`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"normal integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y", ",", 
     SuperscriptBox["Y", "2"]}], "}"}]}],
  SequenceForm[
  "normal integral basis: ", {1, $CellContext`Y, $CellContext`Y^2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671816413*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"change of basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm["change of basis: ", {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.66776718164345*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"product: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "3"]}], ",", "0", ",", "0"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "3"]}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "3"]}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "product: ", {{{1, 0, 0}, {0, 1, 0}, {0, 0, 
    1}}, {{0, 1, 0}, {0, 0, 1}, {-1 + $CellContext`X^3, 0, 0}}, {{0, 0, 
     1}, {-1 + $CellContext`X^3, 0, 0}, {0, -1 + $CellContext`X^3, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181645603*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trace: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["trace: ", {3, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181647477*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"orders: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["orders: ", {0, 1, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181649289*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"derivative: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["X", "3"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", 
        SuperscriptBox["X", "2"], "0"},
       {"0", "0", 
        RowBox[{"2", " ", 
         SuperscriptBox["X", "2"]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["derivative: ", (-1 + $CellContext`X^3)^(-1), "*", 
   MatrixForm[{{0, 0, 0}, {0, $CellContext`X^2, 0}, {
     0, 0, 2 $CellContext`X^2}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181651445*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"absolutely irreducible components: \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["absolutely irreducible components: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671816531763`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"genus: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["genus: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671816548634`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"discriminant: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "X"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "X", "+", 
       SuperscriptBox["X", "2"]}], ")"}], "2"]}]}],
  SequenceForm[
  "discriminant: ", (-1 + $CellContext`X)^2 (
     1 + $CellContext`X + $CellContext`X^2)^2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.66776718165665*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"different: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "3"]}], "0", "0"}, {"0", 
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "3"]}], "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm["different: ", 
   Row[{1, "*", 
     MatrixForm[{{-1 + $CellContext`X^3, 0, 0}, {
       0, -1 + $CellContext`X^3, 0}, {0, 0, 1}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181659005*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"square free factors: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          GridBox[{{
             RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["X", "3"]}], "0", "0"}, {"0", "1", "0"}, {
            "0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}], "}"}]}],
  SequenceForm["square free factors: ", {
    Row[{1, "*", 
      MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], 
    Row[{1, "*", 
      MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], 
    Row[{1, "*", 
      MatrixForm[{{-1 + $CellContext`X^3, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}]}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181660801*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bad reduction: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "27"}], ",", 
     RowBox[{"-", "27"}]}], "}"}]}],
  SequenceForm["bad reduction: ", {1, -27, -27}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181663725*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.105006`5.47275910868442", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y", ",", 
     SuperscriptBox["Y", "2"]}], "}"}]}],
  SequenceForm[
  0.105006`5.47275910868442, ": ", "integral basis: ", {
   1, $CellContext`Y, $CellContext`Y^2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.66776718166551*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.105124`5.473246871062486", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "X"}], "+", 
     SuperscriptBox["X", "4"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm[
  0.105124`5.473246871062486, ": ", 
   "integrand: ", (-$CellContext`X + $CellContext`X^4)^(-1), "*", {0, 0, -1}],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181667231*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.105761`5.475870542033422", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "X"}], "+", 
     SuperscriptBox["X", "4"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm[
  0.105761`5.475870542033422, ": ", 
   "integrand: ", (-$CellContext`X + $CellContext`X^4)^(-1), "*", {0, 0, -1}],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671816690207`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.106856`5.4803439064605675", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"respiece: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["X", "3"], " ", "#1"}]}], ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", "1"}], "}"}], "&"}]}],
  SequenceForm[
  0.106856`5.4803439064605675, ": ", 
   "respiece: ", {{# - (4 $CellContext`X^3) #, 0, -1}, 1}& ],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181670806*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.108195`5.485752184741725", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"normres: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["#1", "3"], "-", 
     RowBox[{"64", " ", 
      SuperscriptBox["X", "9"], " ", 
      SuperscriptBox["#1", "3"]}], "+", 
     RowBox[{
      SuperscriptBox["X", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["#1", "3"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"48", " ", 
         SuperscriptBox["#1", "3"]}]}], ")"}]}]}], "&"}]}],
  SequenceForm[
  0.108195`5.485752184741725, ": ", 
   "normres: ", -1 + #^3 - (
    64 $CellContext`X^9) #^3 + $CellContext`X^3 (2 - 
     12 #^3) + $CellContext`X^6 (-1 + 48 #^3)& ],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181672728*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.133202`5.576055739219463", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "1", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"X", "0", "0"}, {"0", "X", "0"}, {"0", "0", "X"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["X", "3"], ",", "1"}], "}"}]}],
  SequenceForm[
  0.133202`5.576055739219463, ": ", "B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{$CellContext`X, 0, 0}, {0, $CellContext`X, 0}, {
       0, 0, $CellContext`X}}]}], " , norm of B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", {$CellContext`X^3, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181702833*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.134797`5.581225220280257", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["z$3421", "3"]}]}],
  SequenceForm[
  0.134797`5.581225220280257, ": ", "residues from ramification index ", 1, 
   ": ", -1 + $CellContext`z$3421^3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671817056713`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.137101`5.58858561599444", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm[
  0.137101`5.58858561599444, ": ", "B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], 
   " , norm of B\[LeftDoubleBracket]", 2, "\[RightDoubleBracket]: ", {1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181707732*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.138186`5.592009039206131", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.138186`5.592009039206131, ": ", "residues from ramification index ", 2, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181710146*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.14074`5.599962540187349", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "3", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "3"]}], "0", "0"}, {"0", "1", "0"}, {
          "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "X"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "X", "+", 
        SuperscriptBox["X", "2"]}], ")"}]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.14074`5.599962540187349, ": ", "B\[LeftDoubleBracket]", 3, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{-1 + $CellContext`X^3, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], 
   " , norm of B\[LeftDoubleBracket]", 3, 
   "\[RightDoubleBracket]: ", {(-1 + $CellContext`X) (
     1 + $CellContext`X + $CellContext`X^2), 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181712038*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.142394`5.605036683486486", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.142394`5.605036683486486, ": ", "residues from ramification index ", 3, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181714525*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.148189`5.622360960859914", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"DATA: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"1a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["1", "2"], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", "2", "}"}], "}"}], ",", "0", ",", 
             RowBox[{"RedInfo", "[", 
              RowBox[{
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", 
               RowBox[{"3", "+", 
                SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", "2"]}], "+", 
                FractionBox["\[Theta]", "2"]}], ",", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", "2"]}], "-", 
                FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"-", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
             RowBox[{"RedInfo", "[", 
              RowBox[{
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"3", "+", 
                  SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}]}], "}"}]}], 
          "]"}]},
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"3", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["\[Theta]", "2"], "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"3", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{"3", "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"3", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "2"]}], "+", 
               FractionBox["\[Theta]", "2"]}], ",", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "2"]}], "-", 
               FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"3", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"3", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[0.148189`5.622360960859914, ": ", "DATA: ", 
   MatrixForm[{
     $CellContext`belem["1a", 
      $CellContext`NF[0, $CellContext`\[Theta]], {
       Rational[1, 2]}][{1, 
       $CellContext`NF[0, $CellContext`\[Theta]], {1}, {{2}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, $CellContext`\[Theta]], 
        $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}, {1, 
       $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
       Rational[-1, 2] + Rational[1, 2] $CellContext`\[Theta], 
        Rational[-1, 2] + 
        Rational[-1, 2] $CellContext`\[Theta]}, {{-1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
        $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}]}], 
     $CellContext`belem["2a", 
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
      Rational[1, 2] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
      3 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
       Rational[-1, 2] + Rational[1, 2] $CellContext`\[Theta], 
        Rational[-1, 2] + Rational[-1, 2] $CellContext`\[Theta]}, {{1}, {-1}},
        0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
        $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
        1}}, {}]}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181716971*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.148828`5.624229639097819", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"1a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["1", "2"], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "2", "}"}], "}"}], ",", "0", ",", 
       RowBox[{"RedInfo", "[", 
        RowBox[{
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", 
         RowBox[{"3", "+", 
          SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], "+", 
          FractionBox["\[Theta]", "2"]}], ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], "-", 
          FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
       RowBox[{"RedInfo", "[", 
        RowBox[{
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", 
           RowBox[{"3", "+", 
            SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.148828`5.624229639097819, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["1a", 
    $CellContext`NF[0, $CellContext`\[Theta]], {
     Rational[1, 2]}][{1, 
     $CellContext`NF[0, $CellContext`\[Theta]], {1}, {{2}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}, {1, 
     $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
     Rational[-1, 2] + Rational[1, 2] $CellContext`\[Theta], Rational[-1, 2] + 
      Rational[-1, 2] $CellContext`\[Theta]}, {{-1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
      $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}]}], 
   " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671817199373`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.210549`5.774898176580616", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{"-", "1"}]}, {"0", "1", "1"}, {"0", "0", 
           SuperscriptBox["X", "3"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.210549`5.774898176580616, ": ", "ideal: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, -1}, {0, 1, 1}, {0, 0, $CellContext`X^3}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181753302*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{"-", "1"}]}, {"0", "1", "1"}, {"0", "0", 
           SuperscriptBox["X", "3"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, -1}, {0, 1, 1}, {0, 0, $CellContext`X^3}}]}], 
   " over ", 
   $CellContext`NF[0, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671817562723`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.212325`5.778546126252772", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "4"}, {"0", "1", "1"}, {"0", "0", 
           SuperscriptBox["X", "3"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.212325`5.778546126252772, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 4}, {0, 1, 1}, {0, 0, $CellContext`X^3}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181758821*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], " over ", 
   $CellContext`NF[5, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181787818*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", "\[Theta]"}], "]"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181790366*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.233386`5.819619794198014", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "6"}, {"0", "1", "1"}, {"0", "0", 
           SuperscriptBox["X", "3"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.233386`5.819619794198014, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 6}, {0, 1, 1}, {0, 0, $CellContext`X^3}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181792239*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], " over ", 
   $CellContext`NF[7, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671818210983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", "\[Theta]"}], "]"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[7, $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181849078*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], " over ", 
   $CellContext`NF[0, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671818512487`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.272857`5.887480093350077", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"3", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["\[Theta]", "2"], "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"3", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"3", "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"3", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "+", 
         FractionBox["\[Theta]", "2"]}], ",", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], "-", 
         FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"3", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"3", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.272857`5.887480093350077, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
    Rational[1, 2] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
    3 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
     Rational[-1, 2] + Rational[1, 2] $CellContext`\[Theta], Rational[-1, 2] + 
      Rational[-1, 2] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
      1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181853854*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671818561583`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.316987`5.95258644516472", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             FractionBox["1", "2"], "+", 
             FractionBox["\[Theta]", "2"]}], 
           RowBox[{
             RowBox[{"-", 
               FractionBox["1", "2"]}], "+", 
             FractionBox["\[Theta]", "2"]}]}, {"0", "X", 
           RowBox[{"X", " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", 
                   FractionBox["1", "2"]}], "+", 
                 FractionBox["\[Theta]", "2"]}], ")"}]}]}, {"0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.316987`5.95258644516472, ": ", "ideal: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{
       1, Rational[1, 2] + Rational[1, 2] $CellContext`\[Theta], 
        Rational[-1, 2] + Rational[1, 2] $CellContext`\[Theta]}, {
       0, $CellContext`X, $CellContext`X (Rational[-1, 2] + 
         Rational[1, 2] $CellContext`\[Theta])}, {0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.66776718188461*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             FractionBox["1", "2"], "+", 
             FractionBox["\[Theta]", "2"]}], 
           RowBox[{
             RowBox[{"-", 
               FractionBox["1", "2"]}], "+", 
             FractionBox["\[Theta]", "2"]}]}, {"0", "X", 
           RowBox[{"X", " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", 
                   FractionBox["1", "2"]}], "+", 
                 FractionBox["\[Theta]", "2"]}], ")"}]}]}, {"0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{
       1, Rational[1, 2] + Rational[1, 2] $CellContext`\[Theta], 
        Rational[-1, 2] + Rational[1, 2] $CellContext`\[Theta]}, {
       0, $CellContext`X, $CellContext`X (Rational[-1, 2] + 
         Rational[1, 2] $CellContext`\[Theta])}, {0, 0, $CellContext`X^2}}]}],
    " over ", 
   $CellContext`NF[0, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671818878317`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.319048`5.9554010200231415", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"3", "+", 
             RowBox[{"3", " ", "\[Theta]"}]}], 
           RowBox[{"2", "+", 
             RowBox[{"3", " ", "\[Theta]"}]}]}, {"0", "X", 
           RowBox[{"X", " ", 
             RowBox[{"(", 
               RowBox[{"2", "+", 
                 RowBox[{"3", " ", "\[Theta]"}]}], ")"}]}]}, {"0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.319048`5.9554010200231415, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{
       1, 3 + 3 $CellContext`\[Theta], 2 + 3 $CellContext`\[Theta]}, {
       0, $CellContext`X, $CellContext`X (2 + 3 $CellContext`\[Theta])}, {
       0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181890779*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.342301`5.985953161385965", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "2"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"3", "+", 
             RowBox[{"3", " ", "\[Theta]"}]}], 
           RowBox[{"2", "+", 
             RowBox[{"3", " ", "\[Theta]"}], "+", 
             RowBox[{"2", " ", 
               SuperscriptBox["X", "3"], " ", "\[Theta]"}]}]}, {"0", 
           SuperscriptBox["X", "2"], 
           RowBox[{
             SuperscriptBox["X", "2"], " ", 
             RowBox[{"(", 
               RowBox[{"2", "+", 
                 RowBox[{"3", " ", "\[Theta]"}]}], ")"}]}]}, {"0", "0", 
           SuperscriptBox["X", "4"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.342301`5.985953161385965, ": ", "inside DivisorOrder: ideal^", 2, ": ", 
   Row[{$CellContext`X^(-2), "*", 
     MatrixForm[{{
       1, 3 + 3 $CellContext`\[Theta], 2 + 
        3 $CellContext`\[Theta] + (
          2 $CellContext`X^3) $CellContext`\[Theta]}, {
       0, $CellContext`X^2, $CellContext`X^2 (2 + 3 $CellContext`\[Theta])}, {
       0, 0, $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671818935947`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.368765`6.0182946883390995", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "3"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"3", "+", 
             RowBox[{"3", " ", "\[Theta]"}]}], 
           RowBox[{"2", "+", 
             RowBox[{"3", " ", "\[Theta]"}], "+", 
             RowBox[{"2", " ", 
               SuperscriptBox["X", "3"], " ", "\[Theta]"}]}]}, {"0", 
           SuperscriptBox["X", "3"], 
           RowBox[{
             SuperscriptBox["X", "3"], " ", 
             RowBox[{"(", 
               RowBox[{"2", "+", 
                 RowBox[{"3", " ", "\[Theta]"}]}], ")"}]}]}, {"0", "0", 
           SuperscriptBox["X", "6"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.368765`6.0182946883390995, ": ", "inside DivisorOrder: ideal^", 3, ": ", 
   Row[{$CellContext`X^(-3), "*", 
     MatrixForm[{{
       1, 3 + 3 $CellContext`\[Theta], 2 + 
        3 $CellContext`\[Theta] + (
          2 $CellContext`X^3) $CellContext`\[Theta]}, {
       0, $CellContext`X^3, $CellContext`X^3 (2 + 3 $CellContext`\[Theta])}, {
       0, 0, $CellContext`X^6}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181922386*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], " over ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181962083*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2], ": ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181964666*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.420723`6.0755412480849875", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "3", "2"}, {"0", "X", 
           RowBox[{"2", " ", "X"}]}, {"0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.420723`6.0755412480849875, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 3, 2}, {0, $CellContext`X, 2 $CellContext`X}, {
       0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671819665737`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.435175`6.090208931486853", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "2"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "3", 
           RowBox[{"2", "+", 
             RowBox[{"4", " ", 
               SuperscriptBox["X", "3"]}]}]}, {"0", 
           SuperscriptBox["X", "2"], 
           RowBox[{"2", " ", 
             SuperscriptBox["X", "2"]}]}, {"0", "0", 
           SuperscriptBox["X", "4"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.435175`6.090208931486853, ": ", "inside DivisorOrder: ideal^", 2, ": ", 
   Row[{$CellContext`X^(-2), "*", 
     MatrixForm[{{1, 3, 2 + 4 $CellContext`X^3}, {
       0, $CellContext`X^2, 2 $CellContext`X^2}, {0, 0, $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767181996419*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.452787`6.107438942795195", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "3"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "3", 
           RowBox[{"2", "+", 
             RowBox[{"4", " ", 
               SuperscriptBox["X", "3"]}]}]}, {"0", 
           SuperscriptBox["X", "3"], 
           RowBox[{"2", " ", 
             SuperscriptBox["X", "3"]}]}, {"0", "0", 
           SuperscriptBox["X", "6"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.452787`6.107438942795195, ": ", "inside DivisorOrder: ideal^", 3, ": ", 
   Row[{$CellContext`X^(-3), "*", 
     MatrixForm[{{1, 3, 2 + 4 $CellContext`X^3}, {
       0, $CellContext`X^3, 2 $CellContext`X^3}, {0, 0, $CellContext`X^6}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.66776718199944*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], " over ", 
   $CellContext`NF[7, 2 + $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182034683*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[7, 2 + $CellContext`\[Theta]], ": ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182037236*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}]}], " over ", 
   $CellContext`NF[0, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.6677671821102552`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.563008`6.202059559450646", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["X", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], "-", 
           FractionBox["\[Theta]", "6"]}], ")"}]}]}], ",", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[Theta]", "2"]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "+", 
        FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
     SuperscriptBox["X", "3"]}], "}"}]}],
  SequenceForm[
  0.563008`6.202059559450646, ": ", 
   "inside HandleLogTerm 2a: ", {{
    1 + $CellContext`X^3 (Rational[-1, 2] + 
       Rational[-1, 6] $CellContext`\[Theta]), Rational[1, 2] + 
     Rational[1, 2] $CellContext`\[Theta], Rational[-1, 2] + 
     Rational[1, 2] $CellContext`\[Theta]}, $CellContext`X^3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182138961*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.566168`6.204490312752968", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", 
   FractionBox["1", "3"]}],
  SequenceForm[
  0.566168`6.204490312752968, ": ", "inside HandleLogTerm 2a: cnorm:  ", 
   Rational[1, 3]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182141399*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.604478`6.2329254928160625", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SuperscriptBox["X", "3"], "2"], ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["X", "3"]}]}], "}"}]}],
  SequenceForm[
  0.604478`6.2329254928160625, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[1, 2] $CellContext`X^3, 1, 1}, -2 + $CellContext`X^3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182169364*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.610004`6.236877676330067", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "3"]}], "2"]}], ",", 
       RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
     SuperscriptBox["X", "3"]}], "}"}]}],
  SequenceForm[
  0.610004`6.236877676330067, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    3 + Rational[-3, 2] $CellContext`X^3, -3, 3}, $CellContext`X^3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182171527*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.616685`6.241608378444971", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["3", "2"]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "3"]}], "2"]}], ",", "6", ",", "3"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"-", "9"}], "+", 
      SuperscriptBox["X", "3"]}]}], "}"}]}],
  SequenceForm[
  0.616685`6.241608378444971, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[-3, 2] + Rational[3, 2] $CellContext`X^3, 6, 
     3}, -9 + $CellContext`X^3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182173539*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.622878`6.2459479853954285", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["3", "16"], ",", 
       FractionBox["3", "8"], ",", 
       FractionBox["3", "4"]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["9", "8"]}], "+", 
      SuperscriptBox["X", "3"]}]}], "}"}]}],
  SequenceForm[
  0.622878`6.2459479853954285, ": ", "inside HandleLogTerm 2a: elem:  ", {{
     Rational[3, 16], 
     Rational[3, 8], 
     Rational[3, 4]}, Rational[-9, 8] + $CellContext`X^3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182175578*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.626186`6.248248347114277", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.626186`6.248248347114277, ": ", "inside HandleLogTerm 2a: elem:  ", {{
     Rational[1, 2], -1, 0}, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182177596*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.631743`6.252085431934038", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox[
         SuperscriptBox["X", "3"], "2"]}], ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["X", "3"]}]}], "}"}]}],
  SequenceForm[
  0.631743`6.252085431934038, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[1, 2] + Rational[-1, 2] $CellContext`X^3, 0, 
     1}, -1 + $CellContext`X^3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667316630238944*^9, 3.667316675988235*^9, {3.667316719607745*^9, 
   3.667316739661661*^9}, 3.667316787811639*^9, 3.667316878910836*^9, 
   3.667332904662684*^9, {3.667332989701003*^9, 3.6673330707485723`*^9}, 
   3.667333118505126*^9, 3.667333148605341*^9, 3.667333313525612*^9, {
   3.667333458804027*^9, 3.6673335007027187`*^9}, 3.667333674447625*^9, 
   3.667333828000333*^9, 3.6673342755501328`*^9, 3.667334474596798*^9, 
   3.6677651664005938`*^9, 3.667767182179529*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6449020000000001`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "3"], "+", 
        SuperscriptBox["y", "3"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{"ArcTan", "[", 
        FractionBox[
         RowBox[{"x", "-", 
          RowBox[{"2", " ", "y"}]}], 
         RowBox[{
          SqrtBox["3"], " ", "x"}]], "]"}], 
       SqrtBox["3"]], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"x", "+", "y"}], "]"}]}]}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.667316630343461*^9, 3.667316676106434*^9, {3.667316719730402*^9, 
   3.667316739784438*^9}, 3.6673167879343348`*^9, 3.66731687903963*^9, 
   3.66733290481987*^9, {3.6673329898318253`*^9, 3.6673330709130096`*^9}, 
   3.667333118630525*^9, 3.667333148751122*^9, 3.667333313675147*^9, {
   3.667333458942046*^9, 3.667333501312297*^9}, 3.667333675070654*^9, 
   3.667333828619561*^9, 3.667334276175394*^9, 3.6673344752186728`*^9, 
   3.6677651670374823`*^9, 3.667767182206563*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "4"], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["x", "4"]}], ")"}]}]}], "}"}], ",", 
      FractionBox["1", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.667334727552541*^9, 3.6673347310172987`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.012344`4.543000906551062", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"new curve \"\>", "\[InvisibleSpace]", 
   RowBox[{"1", "-", 
    SuperscriptBox["X", "4"], "+", 
    SuperscriptBox["Y", "4"]}], "\[InvisibleSpace]", "\<\" after change \"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      FractionBox["1", "X"]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox["Y", "X"]}]}], "}"}]}],
  SequenceForm[
  0.012344`4.543000906551062, ": ", "new curve ", 
   1 - $CellContext`X^4 + $CellContext`Y^4, 
   " after change ", {$CellContext`x -> $CellContext`X^(-1), $CellContext`y -> \
$CellContext`X^(-1) $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185601183*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"normal integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y", ",", 
     SuperscriptBox["Y", "2"], ",", 
     SuperscriptBox["Y", "3"]}], "}"}]}],
  SequenceForm[
  "normal integral basis: ", {
   1, $CellContext`Y, $CellContext`Y^2, $CellContext`Y^3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185837434*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"change of basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm[
  "change of basis: ", {{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 
   1}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.66776718583965*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"product: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "4"]}], ",", "0", ",", "0", ",", "0"}], "}"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "4"]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "4"]}], ",", "0", ",", "0"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "4"]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "4"]}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["X", "4"]}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "product: ", {{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 
    1}}, {{0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 
     1}, {-1 + $CellContext`X^4, 0, 0, 0}}, {{0, 0, 1, 0}, {0, 0, 0, 
     1}, {-1 + $CellContext`X^4, 0, 0, 0}, {
     0, -1 + $CellContext`X^4, 0, 0}}, {{0, 0, 0, 
     1}, {-1 + $CellContext`X^4, 0, 0, 0}, {0, -1 + $CellContext`X^4, 0, 0}, {
     0, 0, -1 + $CellContext`X^4, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185842142*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trace: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["trace: ", {4, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185843857*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"orders: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["orders: ", {0, 1, 2, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185845559*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"derivative: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["X", "4"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", 
        SuperscriptBox["X", "3"], "0", "0"},
       {"0", "0", 
        RowBox[{"2", " ", 
         SuperscriptBox["X", "3"]}], "0"},
       {"0", "0", "0", 
        RowBox[{"3", " ", 
         SuperscriptBox["X", "3"]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["derivative: ", (-1 + $CellContext`X^4)^(-1), "*", 
   MatrixForm[{{0, 0, 0, 0}, {0, $CellContext`X^3, 0, 0}, {
     0, 0, 2 $CellContext`X^3, 0}, {0, 0, 0, 3 $CellContext`X^3}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185847971*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"absolutely irreducible components: \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["absolutely irreducible components: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185849815*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"genus: \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["genus: ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185851591*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"discriminant: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "X"}], ")"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "X"}], ")"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["X", "2"]}], ")"}], "3"]}]}],
  SequenceForm[
  "discriminant: ", ((-1 + $CellContext`X)^3 (1 + $CellContext`X)^3) (
     1 + $CellContext`X^2)^3],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185882262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"different: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "4"]}], "0", "0", "0"}, {"0", 
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "4"]}], "0", "0"}, {"0", "0", 
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "4"]}], "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm["different: ", 
   Row[{1, "*", 
     MatrixForm[{{-1 + $CellContext`X^4, 0, 0, 0}, {
       0, -1 + $CellContext`X^4, 0, 0}, {0, 0, -1 + $CellContext`X^4, 0}, {0, 
       0, 0, 1}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185885269*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"square free factors: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
            "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
            "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
            "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          GridBox[{{
             RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["X", "4"]}], "0", "0", "0"}, {
            "0", "1", "0", "0"}, {"0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}], "}"}]}],
  SequenceForm["square free factors: ", {
    Row[{1, "*", 
      MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
    
    Row[{1, "*", 
      MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
    
    Row[{1, "*", 
      MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
    
    Row[{1, "*", 
      MatrixForm[{{-1 + $CellContext`X^4, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 
        0}, {0, 0, 0, 1}}]}]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671858873043`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bad reduction: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "256"}], ",", 
     RowBox[{"-", "256"}]}], "}"}]}],
  SequenceForm["bad reduction: ", {1, -256, -256}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185890895*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.261886`5.86965727586446", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y", ",", 
     SuperscriptBox["Y", "2"], ",", 
     SuperscriptBox["Y", "3"]}], "}"}]}],
  SequenceForm[
  0.261886`5.86965727586446, ": ", "integral basis: ", {
   1, $CellContext`Y, $CellContext`Y^2, $CellContext`Y^3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185892692*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.262005`5.869854572799265", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "X"}], "+", 
     SuperscriptBox["X", "5"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm[
  0.262005`5.869854572799265, ": ", 
   "integrand: ", (-$CellContext`X + $CellContext`X^5)^(-1), "*", {0, 0, 
   0, -1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671858945007`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.262625`5.8708810589099825", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "X"}], "+", 
     SuperscriptBox["X", "5"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm[
  0.262625`5.8708810589099825, ": ", 
   "integrand: ", (-$CellContext`X + $CellContext`X^5)^(-1), "*", {0, 0, 
   0, -1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671858964043`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.263829`5.872867524841863", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"respiece: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#1", "-", 
         RowBox[{"5", " ", 
          SuperscriptBox["X", "4"], " ", "#1"}]}], ",", "0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", "1"}], "}"}], "&"}]}],
  SequenceForm[
  0.263829`5.872867524841863, ": ", 
   "respiece: ", {{# - (5 $CellContext`X^4) #, 0, 0, -1}, 1}& ],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185898323*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.265489`5.875591525172338", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"normres: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"1", "+", 
     SuperscriptBox["#1", "4"], "+", 
     RowBox[{"625", " ", 
      SuperscriptBox["X", "16"], " ", 
      SuperscriptBox["#1", "4"]}], "+", 
     RowBox[{
      SuperscriptBox["X", "12"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"500", " ", 
         SuperscriptBox["#1", "4"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "-", 
        RowBox[{"20", " ", 
         SuperscriptBox["#1", "4"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "8"], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"150", " ", 
         SuperscriptBox["#1", "4"]}]}], ")"}]}]}], "&"}]}],
  SequenceForm[
  0.265489`5.875591525172338, ": ", "normres: ", 
   1 + #^4 + (625 $CellContext`X^16) #^4 + $CellContext`X^12 (-1 - 
     500 #^4) + $CellContext`X^4 (-3 - 20 #^4) + $CellContext`X^8 (3 + 
     150 #^4)& ],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185900324*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.313827`5.948235298733435", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "1", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"X", "0", "0", "0"}, {"0", "X", "0", "0"}, {
          "0", "0", "X", "0"}, {"0", "0", "0", "X"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["X", "4"], ",", "1"}], "}"}]}],
  SequenceForm[
  0.313827`5.948235298733435, ": ", "B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{$CellContext`X, 0, 0, 0}, {0, $CellContext`X, 0, 0}, {
       0, 0, $CellContext`X, 0}, {0, 0, 0, $CellContext`X}}]}], 
   " , norm of B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", {$CellContext`X^4, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671859024067`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.315532`5.950588403728063", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"1", "+", 
    SuperscriptBox["z$3847", "4"]}]}],
  SequenceForm[
  0.315532`5.950588403728063, ": ", "residues from ramification index ", 1, 
   ": ", 1 + $CellContext`z$3847^4],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185905044*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.318996`5.955330230820175", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm[
  0.318996`5.955330230820175, ": ", "B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " , norm of B\[LeftDoubleBracket]", 2, "\[RightDoubleBracket]: ", {1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185906949*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.320124`5.956863228330018", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.320124`5.956863228330018, ": ", "residues from ramification index ", 2, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185909418*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.323569`5.9615119002129475", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "3", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}],
  SequenceForm[
  0.323569`5.9615119002129475, ": ", "B\[LeftDoubleBracket]", 3, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " , norm of B\[LeftDoubleBracket]", 3, "\[RightDoubleBracket]: ", {1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671859112587`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.324764`5.963112875309377", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.324764`5.963112875309377, ": ", "residues from ramification index ", 3, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185913813*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.328467`5.968036737444102", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "4", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["X", "4"]}], "0", "0", "0"}, {
          "0", "1", "0", "0"}, {"0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "X"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "X"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["X", "2"]}], ")"}]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.328467`5.968036737444102, ": ", "B\[LeftDoubleBracket]", 4, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{-1 + $CellContext`X^4, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 
       0}, {0, 0, 0, 1}}]}], " , norm of B\[LeftDoubleBracket]", 4, 
   "\[RightDoubleBracket]: ", {((-1 + $CellContext`X) (1 + $CellContext`X)) (
     1 + $CellContext`X^2), 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185915851*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.330246`5.970382559560138", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "4", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.330246`5.970382559560138, ": ", "residues from ramification index ", 4, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185918881*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.362493`6.010844617945808", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"DATA: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["\[Theta]", "2"], "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"16", "+", 
               SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["\[Theta]", "2"], ",", 
              RowBox[{"-", 
               FractionBox[
                SuperscriptBox["\[Theta]", "3"], "8"]}], ",", 
              FractionBox[
               SuperscriptBox["\[Theta]", "3"], "8"], ",", 
              RowBox[{"-", 
               FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"16", "+", 
                 SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", 
                  RowBox[{"-", "8"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], 
               "}"}]}], "]"}]}], "}"}], "]"}]},
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"2", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["\[Theta]", "2"], "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"2", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{"2", "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"16", "+", 
               SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["\[Theta]", "2"], ",", 
              RowBox[{"-", 
               FractionBox[
                SuperscriptBox["\[Theta]", "3"], "8"]}], ",", 
              FractionBox[
               SuperscriptBox["\[Theta]", "3"], "8"], ",", 
              RowBox[{"-", 
               FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}], ",", 
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"16", "+", 
                 SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"2", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", "8"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0", ",", 
                  RowBox[{"-", "4"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], 
               "}"}]}], "]"}]}], "}"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[0.362493`6.010844617945808, ": ", "DATA: ", 
   MatrixForm[{
     $CellContext`belem["2a", 
      $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {
      Rational[1, 2] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 
       1}}], -2 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], {
       Rational[1, 2] $CellContext`\[Theta], 
        Rational[-1, 8] $CellContext`\[Theta]^3, 
        Rational[1, 8] $CellContext`\[Theta]^3, 
        Rational[-1, 2] $CellContext`\[Theta]}, {{1}, {1}, {-1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], 
        $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {{1, 0, 0, 0}, {0, 
        0, 0, -8}}, {{0, 1, 0, 4}, {0, 0, 1, 0}}]}], 
     $CellContext`belem["2a", 
      $CellContext`NF[0, 2 + $CellContext`\[Theta]^2], {
      Rational[1, 2] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, 2 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
      2 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], {
       Rational[1, 2] $CellContext`\[Theta], 
        Rational[-1, 8] $CellContext`\[Theta]^3, 
        Rational[1, 8] $CellContext`\[Theta]^3, 
        Rational[-1, 2] $CellContext`\[Theta]}, {{1}, {-1}, {1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], 
        $CellContext`NF[0, 2 + $CellContext`\[Theta]^2], {{1, 0, 0, 0}, {0, 0,
         0, 8}}, {{0, 1, 0, -4}, {0, 0, 1, 0}}]}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.66776718595411*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.363277`6.011782895929883", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["\[Theta]", "2"], "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"16", "+", 
         SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["\[Theta]", "2"], ",", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[Theta]", "3"], "8"]}], ",", 
        FractionBox[
         SuperscriptBox["\[Theta]", "3"], "8"], ",", 
        RowBox[{"-", 
         FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"16", "+", 
           SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", 
            RowBox[{"-", "8"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
       "]"}]}], "}"}], "]"}], "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.363277`6.011782895929883, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {
    Rational[1, 2] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 
     1}}], -2 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], {
     Rational[1, 2] $CellContext`\[Theta], 
      Rational[-1, 8] $CellContext`\[Theta]^3, 
      Rational[1, 8] $CellContext`\[Theta]^3, 
      Rational[-1, 2] $CellContext`\[Theta]}, {{1}, {1}, {-1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], 
      $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {{1, 0, 0, 0}, {0, 0, 
      0, -8}}, {{0, 1, 0, 4}, {0, 0, 1, 0}}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767185957659*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671859600773`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.512306`6.161074435750672", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "\[Theta]"}]}, {"0", "1", "\[Theta]", "1"}, {"0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.512306`6.161074435750672, ": ", "ideal: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, -1, -$CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 1}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671860968323`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{"-", "1"}], 
           RowBox[{"-", "\[Theta]"}]}, {"0", "1", "\[Theta]", "1"}, {"0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, -1, -$CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 1}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}], " over ", 
   $CellContext`NF[0, -2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671861000757`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.51445`6.162888165054479", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "4", 
           RowBox[{"4", " ", "\[Theta]"}]}, {"0", "1", "\[Theta]", "1"}, {
          "0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.51445`6.162888165054479, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 4, 4 $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 1}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671861028767`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.551916`6.193417977905483", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "2"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "4", 
           RowBox[{"4", " ", "\[Theta]"}]}, {"0", "1", "\[Theta]", "1"}, {
          "0", "0", 
           SuperscriptBox["X", "4"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "4"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.551916`6.193417977905483, ": ", "inside DivisorOrder: ideal^", 2, ": ", 
   Row[{$CellContext`X^(-2), "*", 
     MatrixForm[{{1, 0, 4, 4 $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 1}, {0, 0, $CellContext`X^4, 0}, {
       0, 0, 0, $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186141543*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " over ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186192484*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2], ": ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.66776718619526*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.609733`6.23668469406171", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "6", "3"}, {"0", "1", "4", "1"}, {"0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.609733`6.23668469406171, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 6, 3}, {0, 1, 4, 1}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186197241*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.637495`6.256021776357379", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "2"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "6", "3"}, {"0", "1", "4", "1"}, {"0", "0", 
           SuperscriptBox["X", "4"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "4"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.637495`6.256021776357379, ": ", "inside DivisorOrder: ideal^", 2, ": ", 
   Row[{$CellContext`X^(-2), "*", 
     MatrixForm[{{1, 0, 6, 3}, {0, 1, 4, 1}, {0, 0, $CellContext`X^4, 0}, {
       0, 0, 0, $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671862302713`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"3", "+", "\[Theta]"}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " over ", 
   $CellContext`NF[7, 3 + $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.66776718627065*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"3", "+", "\[Theta]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[7, 3 + $CellContext`\[Theta]], ": ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186273299*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " over ", 
   $CellContext`NF[0, -2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186334733*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.750758`6.327044962188967", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "\[Theta]", ",", "1", ",", "0"}], "}"}], ",", 
     SuperscriptBox["X", "2"]}], "}"}]}],
  SequenceForm[
  0.750758`6.327044962188967, ": ", 
   "inside HandleLogTerm 2a: ", {{
    1, $CellContext`\[Theta], 1, 0}, $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186337452*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.755333`6.329683452646775", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.755333`6.329683452646775, ": ", "inside HandleLogTerm 2a: cnorm:  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186339342*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.767155`6.336428113434308", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox[
         SuperscriptBox["X", "2"], "2"]}], ",", "0", ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "}"}], ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.767155`6.336428113434308, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    0, Rational[1, 2] + Rational[1, 2] $CellContext`X^2, 0, 
     Rational[-1, 2]}, 1 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186372087*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.775577`6.341169914942876", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "+", 
        FractionBox[
         SuperscriptBox["X", "2"], "2"]}], ",", "0", ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.775577`6.341169914942876, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    0, Rational[-1, 2] + Rational[1, 2] $CellContext`X^2, 0, 
     Rational[1, 2]}, -1 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186374405*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.790936`6.349686336701177", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["X", "2"], "4"], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "4"]}], "4"]}], ",", 
       RowBox[{
        FractionBox["1", "8"], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}], "8"]}], ",", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["X", "2"], "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "8"]}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["X", "2"]}], "4"], "+", 
      SuperscriptBox["X", "4"]}]}], "}"}]}],
  SequenceForm[
  0.790936`6.349686336701177, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[1, 4] $CellContext`X^2 + Rational[3, 4] $CellContext`X^4, 
     Rational[1, 8] + Rational[3, 8] $CellContext`X^2, 
     Rational[-1, 4] $CellContext`X^2, 
     Rational[-1, 8]}, Rational[1, 4] + 
    Rational[3, 4] $CellContext`X^2 + $CellContext`X^4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186376534*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.805659`6.35769625644891", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["X", "2"], "4"]}], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "4"]}], "4"]}], ",", 
       RowBox[{
        FractionBox["1", "8"], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}], "8"]}], ",", 
       FractionBox[
        SuperscriptBox["X", "2"], "4"], ",", 
       RowBox[{"-", 
        FractionBox["1", "8"]}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["X", "2"]}], "4"], "+", 
      SuperscriptBox["X", "4"]}]}], "}"}]}],
  SequenceForm[
  0.805659`6.35769625644891, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[-1, 4] $CellContext`X^2 + Rational[3, 4] $CellContext`X^4, 
     Rational[1, 8] + Rational[-3, 8] $CellContext`X^2, 
     Rational[1, 4] $CellContext`X^2, 
     Rational[-1, 8]}, Rational[1, 4] + 
    Rational[-3, 4] $CellContext`X^2 + $CellContext`X^4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186409*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.820295`6.365515057870268", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["X", "2"], "4"]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "4"]}], "4"]}], ",", 
       RowBox[{
        FractionBox["1", "8"], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}], "8"]}], ",", 
       FractionBox[
        SuperscriptBox["X", "2"], "4"], ",", 
       RowBox[{"-", 
        FractionBox["1", "8"]}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["X", "2"]}], "4"], "+", 
      SuperscriptBox["X", "4"]}]}], "}"}]}],
  SequenceForm[
  0.820295`6.365515057870268, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[-1, 4] $CellContext`X^2 + Rational[-3, 4] $CellContext`X^4, 
     Rational[1, 8] + Rational[3, 8] $CellContext`X^2, 
     Rational[1, 4] $CellContext`X^2, 
     Rational[-1, 8]}, Rational[1, 4] + 
    Rational[3, 4] $CellContext`X^2 + $CellContext`X^4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186441959*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.835074`6.373269955647453", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["X", "2"], "4"], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "4"]}], "4"]}], ",", 
       RowBox[{
        FractionBox["1", "8"], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}], "8"]}], ",", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["X", "2"], "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "8"]}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["X", "2"]}], "4"], "+", 
      SuperscriptBox["X", "4"]}]}], "}"}]}],
  SequenceForm[
  0.835074`6.373269955647453, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[1, 4] $CellContext`X^2 + Rational[-3, 4] $CellContext`X^4, 
     Rational[1, 8] + Rational[-3, 8] $CellContext`X^2, 
     Rational[-1, 4] $CellContext`X^2, 
     Rational[-1, 8]}, Rational[1, 4] + 
    Rational[-3, 4] $CellContext`X^2 + $CellContext`X^4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.66776718644455*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.843954`6.377863769398173", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"2", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["\[Theta]", "2"], "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"2", "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"16", "+", 
         SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["\[Theta]", "2"], ",", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[Theta]", "3"], "8"]}], ",", 
        FractionBox[
         SuperscriptBox["\[Theta]", "3"], "8"], ",", 
        RowBox[{"-", 
         FractionBox["\[Theta]", "2"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], ",", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"16", "+", 
           SuperscriptBox["\[Theta]", "4"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"2", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "8"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", 
            RowBox[{"-", "4"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
       "]"}]}], "}"}], "]"}], "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.843954`6.377863769398173, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[0, 2 + $CellContext`\[Theta]^2], {
    Rational[1, 2] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, 2 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
    2 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], {
     Rational[1, 2] $CellContext`\[Theta], 
      Rational[-1, 8] $CellContext`\[Theta]^3, 
      Rational[1, 8] $CellContext`\[Theta]^3, 
      Rational[-1, 2] $CellContext`\[Theta]}, {{1}, {-1}, {1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 16 + $CellContext`\[Theta]^4], 
      $CellContext`NF[0, 2 + $CellContext`\[Theta]^2], {{1, 0, 0, 0}, {0, 0, 
      0, 8}}, {{0, 1, 0, -4}, {0, 0, 1, 0}}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186447081*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186449601*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.994788`6.449275531286863", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "1", "\[Theta]"}, {"0", "1", "\[Theta]", 
           RowBox[{"-", "1"}]}, {"0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.994788`6.449275531286863, ": ", "ideal: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 1, $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], -1}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186579342*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "1", "\[Theta]"}, {"0", "1", "\[Theta]", 
           RowBox[{"-", "1"}]}, {"0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 1, $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], -1}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}], " over ", 
   $CellContext`NF[0, 2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186582389*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.997027`6.450251912883095", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "1", "\[Theta]"}, {"0", "1", "\[Theta]", "4"}, {
          "0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.997027`6.450251912883095, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 1, $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 4}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186585122*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.034119`6.466115511044677", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "2"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "1", "\[Theta]"}, {"0", "1", "\[Theta]", "4"}, {
          "0", "0", 
           SuperscriptBox["X", "4"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "4"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  1.034119`6.466115511044677, ": ", "inside DivisorOrder: ideal^", 2, ": ", 
   Row[{$CellContext`X^(-2), "*", 
     MatrixForm[{{1, 0, 1, $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 4}, {0, 0, $CellContext`X^4, 0}, {
       0, 0, 0, $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671866186447`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " over ", 
   $CellContext`NF[5, 2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671866747103`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 2 + $CellContext`\[Theta]^2], ": ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186708125*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.091916`6.4897342233118955", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "1", "\[Theta]"}, {"0", "1", "\[Theta]", "6"}, {
          "0", "0", 
           SuperscriptBox["X", "2"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  1.091916`6.4897342233118955, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 0, 1, $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 6}, {0, 0, $CellContext`X^2, 0}, {
       0, 0, 0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186710415*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.127321`6.503592590712273", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      SuperscriptBox["X", "2"]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "1", "\[Theta]"}, {"0", "1", "\[Theta]", "6"}, {
          "0", "0", 
           SuperscriptBox["X", "4"], "0"}, {"0", "0", "0", 
           SuperscriptBox["X", "4"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  1.127321`6.503592590712273, ": ", "inside DivisorOrder: ideal^", 2, ": ", 
   Row[{$CellContext`X^(-2), "*", 
     MatrixForm[{{1, 0, 1, $CellContext`\[Theta]}, {
       0, 1, $CellContext`\[Theta], 6}, {0, 0, $CellContext`X^4, 0}, {
       0, 0, 0, $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186713277*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " over ", 
   $CellContext`NF[7, 2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.6677671867689667`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[7, 2 + $CellContext`\[Theta]^2], ": ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186771721*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
          "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 0}, {0, 1, 0, 0}, {0, 0, 1, 0}, {0, 0, 0, 1}}]}], 
   " over ", 
   $CellContext`NF[0, 2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186831848*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.24816`6.547815254053262", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "\[Theta]", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     SuperscriptBox["X", "2"]}], "}"}]}],
  SequenceForm[
  1.24816`6.547815254053262, ": ", 
   "inside HandleLogTerm 2a: ", {{
    1, $CellContext`\[Theta], -1, 0}, $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186834569*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.252822`6.549434364642402", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  1.252822`6.549434364642402, ": ", "inside HandleLogTerm 2a: cnorm:  ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186836412*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.276009`6.557398731075907", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "-", 
        FractionBox[
         SuperscriptBox["X", "2"], "2"]}], ",", "0", ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "}"}], ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  1.276009`6.557398731075907, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    0, Rational[-1, 2] + Rational[-1, 2] $CellContext`X^2, 0, 
     Rational[-1, 2]}, 1 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186868527*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.284497`6.560278087785396", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox[
         SuperscriptBox["X", "2"], "2"]}], ",", "0", ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  1.284497`6.560278087785396, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    0, Rational[1, 2] + Rational[-1, 2] $CellContext`X^2, 0, 
     Rational[1, 2]}, -1 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334731840116*^9, 3.667336745978304*^9, 
  3.6677651741018057`*^9, 3.667767186870844*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.294803`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["x", "4"], "+", 
        SuperscriptBox["y", "4"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{"ArcTan", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "y"}], "-", 
          RowBox[{
           SuperscriptBox["x", "2"], " ", "y"}], "-", 
          SuperscriptBox["y", "3"]}], 
         RowBox[{
          SqrtBox["2"], " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]], "]"}], 
       SqrtBox["2"]], "+", 
      FractionBox[
       RowBox[{"ArcTanh", "[", 
        FractionBox[
         RowBox[{"y", "+", 
          RowBox[{
           SuperscriptBox["x", "2"], " ", "y"}], "-", 
          SuperscriptBox["y", "3"]}], 
         RowBox[{
          SqrtBox["2"], " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]], "]"}], 
       SqrtBox["2"]]}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.666323103332411*^9, 3.666367629869351*^9, 3.666367919797537*^9, 
   3.666368487031226*^9, 3.666456781673236*^9, {3.667334725745779*^9, 
   3.667334732154155*^9}, 3.667336747264628*^9, 3.6677651754124823`*^9, 
   3.667767186904677*^9}]
}, Closed]],

Cell[TextData[{
 "When the curve has no rational points, the ordinary ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["tan", 
     RowBox[{"-", "1"}]], "(", 
    RowBox[{"x", "/", "y"}], ")"}], TraditionalForm]]],
 " integration must used if one does not want to introduce an unecessary \
extension."
}], "Text",
 CellChangeTimes->{{3.667338902625256*^9, 3.6673389681682663`*^9}, 
   3.667675812474062*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"3", 
            SuperscriptBox["x", "2"]}]}], ")"}]}]}], "}"}], ",", 
      FractionBox["1", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.667333961615821*^9, 3.66733396466356*^9}, {
  3.6673374916763573`*^9, 3.667337526347252*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.003041`3.9345614136401066", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"new curve \"\>", "\[InvisibleSpace]", 
   RowBox[{"3", "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["X", "2"]}], "+", 
    SuperscriptBox["Y", "2"]}], "\[InvisibleSpace]", "\<\" after change \"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      FractionBox["1", "X"]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox["Y", "X"]}]}], "}"}]}],
  SequenceForm[
  0.003041`3.9345614136401066, ": ", "new curve ", 3 - 
   2 $CellContext`X^2 + $CellContext`Y^2, 
   " after change ", {$CellContext`x -> $CellContext`X^(-1), $CellContext`y -> \
$CellContext`X^(-1) $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190863785*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"normal integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm["normal integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190886753*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"change of basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm["change of basis: ", {{1, 0}, {0, 1}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190888851*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"product: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["X", "2"]}]}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "product: ", {{{1, 0}, {0, 1}}, {{0, 1}, {-3 + 2 $CellContext`X^2, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190890891*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trace: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}],
  SequenceForm["trace: ", {2, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190892724*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"orders: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}],
  SequenceForm["orders: ", {0, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671908945217`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"derivative: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["3", "2"]}], "+", 
     SuperscriptBox["X", "2"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0"},
       {"0", "X"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["derivative: ", (Rational[-3, 2] + $CellContext`X^2)^(-1), "*", 
   MatrixForm[{{0, 0}, {0, $CellContext`X}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190896616*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"absolutely irreducible components: \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["absolutely irreducible components: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671908983593`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"genus: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["genus: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.66776719090005*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"discriminant: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["X", "2"]}]}], ")"}]}]}],
  SequenceForm["discriminant: ", Rational[1, 2] (-3 + 2 $CellContext`X^2)],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190901856*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"different: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", 
               FractionBox["3", "2"]}], "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm["different: ", 
   Row[{1, "*", 
     MatrixForm[{{Rational[-3, 2] + $CellContext`X^2, 0}, {0, 1}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190904241*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"square free factors: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          GridBox[{{
             RowBox[{
               RowBox[{"-", 
                 FractionBox["3", "2"]}], "+", 
               SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}], "}"}]}],
  SequenceForm["square free factors: ", {
    Row[{1, "*", 
      MatrixForm[{{1, 0}, {0, 1}}]}], 
    Row[{1, "*", 
      MatrixForm[{{Rational[-3, 2] + $CellContext`X^2, 0}, {0, 1}}]}]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190906089*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bad reduction: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "8", ",", "6"}], "}"}]}],
  SequenceForm["bad reduction: ", {1, 8, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190908729*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.03681`5.017510810942636", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm[
  0.03681`5.017510810942636, ": ", "integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909105053`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.036914`5.018736101379352", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "X"}], "2"]}], "+", 
     SuperscriptBox["X", "3"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}]}], "}"}]}],
  SequenceForm[
  0.036914`5.018736101379352, ": ", 
   "integrand: ", (Rational[-3, 2] $CellContext`X + $CellContext`X^3)^(-1), 
   "*", {0, 
    Rational[-1, 2]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190912343*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.037536`5.025992983931404", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "X"}], "2"]}], "+", 
     SuperscriptBox["X", "3"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}]}], "}"}]}],
  SequenceForm[
  0.037536`5.025992983931404, ": ", 
   "integrand: ", (Rational[-3, 2] $CellContext`X + $CellContext`X^3)^(-1), 
   "*", {0, 
    Rational[-1, 2]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190914419*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.038649`5.038683255007748", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"respiece: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"3", " ", "#1"}], "2"], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"], " ", "#1"}]}], ",", 
        RowBox[{"-", 
         FractionBox["1", "2"]}]}], "}"}], ",", "1"}], "}"}], "&"}]}],
  SequenceForm[
  0.038649`5.038683255007748, ": ", 
   "respiece: ", {{Rational[3, 2] # - (3 $CellContext`X^2) #, 
     Rational[-1, 2]}, 1}& ],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190916442*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.039695`5.050280799776376", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"normres: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox["3", "4"], "+", 
     FractionBox[
      RowBox[{"9", " ", 
       SuperscriptBox["#1", "2"]}], "4"], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox["X", "4"], " ", 
      SuperscriptBox["#1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["X", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "-", 
        RowBox[{"9", " ", 
         SuperscriptBox["#1", "2"]}]}], ")"}]}]}], "&"}]}],
  SequenceForm[
  0.039695`5.050280799776376, ": ", "normres: ", Rational[3, 4] + 
   Rational[9, 4] #^2 + (9 $CellContext`X^4) #^2 + $CellContext`X^2 (
     Rational[-1, 2] - 9 #^2)& ],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190918413*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.05161`5.1642788525659284", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "1", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"X", "0"}, {"0", "X"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["X", "2"], ",", "1"}], "}"}]}],
  SequenceForm[
  0.05161`5.1642788525659284, ": ", "B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{$CellContext`X, 0}, {0, $CellContext`X}}]}], 
   " , norm of B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", {$CellContext`X^2, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909204197`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.05329`5.178190713736883", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "3"], "+", 
    SuperscriptBox["z$4382", "2"]}]}],
  SequenceForm[
  0.05329`5.178190713736883, ": ", "residues from ramification index ", 1, 
   ": ", Rational[1, 3] + $CellContext`z$4382^2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909228287`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.055083`5.192562578820247", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             RowBox[{"-", 
               FractionBox["3", "2"]}], "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["X", "2"]}]}], ")"}]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.055083`5.192562578820247, ": ", "B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{Rational[-3, 2] + $CellContext`X^2, 0}, {0, 1}}]}], 
   " , norm of B\[LeftDoubleBracket]", 2, "\[RightDoubleBracket]: ", {
   Rational[1, 2] (-3 + 2 $CellContext`X^2), 1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190924787*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.05686`5.206351848850397", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.05686`5.206351848850397, ": ", "residues from ramification index ", 2, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190927383*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.061767`5.242301501825968", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"DATA: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"3", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["\[Theta]", "3"], "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"3", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{"3", "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"3", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["\[Theta]", "3"], ",", 
              RowBox[{"-", 
               FractionBox["\[Theta]", "3"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"3", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"3", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[0.061767`5.242301501825968, ": ", "DATA: ", 
   MatrixForm[{
     $CellContext`belem["2a", 
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
      Rational[1, 3] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
      3 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
       Rational[1, 3] $CellContext`\[Theta], 
        Rational[-1, 3] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
        $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
        1}}, {}]}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190929565*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.062281`5.245900570593653", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"3", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["\[Theta]", "3"], "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"3", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"3", "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"3", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["\[Theta]", "3"], ",", 
        RowBox[{"-", 
         FractionBox["\[Theta]", "3"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"3", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"3", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.062281`5.245900570593653, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
    Rational[1, 3] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
    3 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {
     Rational[1, 3] $CellContext`\[Theta], 
      Rational[-1, 3] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], 
      $CellContext`NF[0, 3 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
      1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190932164*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909344788`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.077176`5.339027259012184", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           FractionBox["\[Theta]", "3"]}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.077176`5.339027259012184, ": ", "ideal: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, Rational[1, 3] $CellContext`\[Theta]}, {
       0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909363194`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           FractionBox["\[Theta]", "3"]}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, Rational[1, 3] $CellContext`\[Theta]}, {
       0, $CellContext`X^2}}]}], " over ", 
   $CellContext`NF[0, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190938859*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.078841`5.348297117623513", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"2", " ", "\[Theta]"}]}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.078841`5.348297117623513, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 2 $CellContext`\[Theta]}, {0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.66776719094133*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909438334`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190946512*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.090556`5.408462224298052", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", "X"],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "4"}, {"0", 
           SuperscriptBox["X", "2"]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.090556`5.408462224298052, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{$CellContext`X^(-1), "*", 
     MatrixForm[{{1, 4}, {0, $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190948415*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[7, 2 + $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190973914*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[7, 2 + $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909765263`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[0, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190978531*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.108459`5.486810589386629", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       FractionBox["\[Theta]", "3"]}], "}"}], ",", "X"}], "}"}]}],
  SequenceForm[
  0.108459`5.486810589386629, ": ", 
   "inside HandleLogTerm 2a: ", {{
    1, Rational[1, 3] $CellContext`\[Theta]}, $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190980876*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.109913`5.492594055294994", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", 
   FractionBox["2", "3"]}],
  SequenceForm[
  0.109913`5.492594055294994, ": ", "inside HandleLogTerm 2a: cnorm:  ", 
   Rational[2, 3]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.66776719098278*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.116377`5.517412151128767", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"implementation note in HandleLogTerm 2a: no norm \
representatives\"\>"}],
  SequenceForm[
  0.116377`5.517412151128767, ": ", 
   "implementation note in HandleLogTerm 2a: no norm representatives"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190984644*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.123923`5.54469691202759", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "3"]}]}], "}"}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.123923`5.54469691202759, ": ", "inside HandleLogTerm 2a: elem:  ", {{0, 
     Rational[-1, 3]}, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190986436*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.126104`5.552273856043483", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["3", "2"]}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.126104`5.552273856043483, ": ", "inside HandleLogTerm 2a: elem:  ", {{0, 
     Rational[1, 2]}, Rational[-3, 2] + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190988266*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.129106`5.56249141939013", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["X", "2"]}], ",", "2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.129106`5.56249141939013, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{-$CellContext`X^2, 
     2}, -6 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190990156*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.132071`5.572352459690199", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["X", "2"], ",", "2"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.132071`5.572352459690199, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{$CellContext`X^2, 
     2}, -6 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.66776719099199*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.135063`5.582081385474061", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["X", "2"], "3"]}], ",", 
       FractionBox["2", "3"]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.135063`5.582081385474061, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{Rational[-1, 3] $CellContext`X^2, 
     Rational[2, 3]}, -2 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.667767190993966*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.138066`5.591631736300761", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SuperscriptBox["X", "2"], "3"], ",", 
       FractionBox["2", "3"]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.138066`5.591631736300761, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{Rational[1, 3] $CellContext`X^2, 
     Rational[2, 3]}, -2 + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.667333966446967*^9, 3.667333987976946*^9}, 
   3.667334077434379*^9, 3.667334125499578*^9, 3.667334249240966*^9, 
   3.667334458256291*^9, {3.6673374951119747`*^9, 3.667337526917592*^9}, 
   3.66765883297215*^9, 3.667765197188311*^9, 3.6677671909960613`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.14197799999999994`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"ArcTan", "[", 
         FractionBox["y", 
          RowBox[{
           SqrtBox["3"], " ", "x"}]], "]"}]}], 
       SqrtBox["3"]]}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6673339665739937`*^9, 3.6673339881067543`*^9}, 
   3.667334077681705*^9, 3.667334125612769*^9, 3.66733424938103*^9, 
   3.667334458370838*^9, {3.6673374952191343`*^9, 3.667337527051076*^9}, 
   3.6676588331581907`*^9, 3.6677651973371696`*^9, 3.66776719099792*^9}]
}, Closed]],

Cell["\<\
Here are some more easy integrals. The last example has a simple pole at a \
branch location, which is handled correctly.\
\>", "Text",
 CellChangeTimes->{{3.667339257134663*^9, 3.667339264529065*^9}, {
  3.667340217002338*^9, 3.66734025008153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", "1"}], ")"}]}]}], "}"}], ",", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["x", "5"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], "2"], "y"}]]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.666041151963825*^9, 3.6660411683877583`*^9}, {
   3.666041199885338*^9, 3.666041200179468*^9}, 3.666104616272602*^9, 
   3.666992114031695*^9, {3.667136209534564*^9, 3.667136230452607*^9}, {
   3.6671363561499233`*^9, 3.667136356604863*^9}, {3.6671364172614937`*^9, 
   3.667136441469233*^9}, {3.667138288615841*^9, 3.667138299950639*^9}, {
   3.667230305774273*^9, 3.6672303132861633`*^9}, {3.667230983311269*^9, 
   3.6672309836547413`*^9}, {3.667236503729176*^9, 3.667236505233924*^9}, {
   3.667236580736939*^9, 3.667236580961974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.007882`4.348181424025562", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"new curve \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "X"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["X", "2"]}], "+", 
    SuperscriptBox["Y", "2"]}], "\[InvisibleSpace]", "\<\" after change \"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"1", "+", 
       FractionBox["1", "X"]}]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox["Y", "X"]}]}], "}"}]}],
  SequenceForm[
  0.007882`4.348181424025562, ": ", "new curve ", -1 - 2 $CellContext`X - 
   2 $CellContext`X^2 + $CellContext`Y^2, 
   " after change ", {$CellContext`x -> 
    1 + $CellContext`X^(-1), $CellContext`y -> $CellContext`X^(-1) \
$CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671984381447`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"normal integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm["normal integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198462537*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"change of basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm["change of basis: ", {{1, 0}, {0, 1}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671984652147`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"product: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "X"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["X", "2"]}]}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "product: ", {{{1, 0}, {0, 
    1}}, {{0, 1}, {1 + 2 $CellContext`X + 2 $CellContext`X^2, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198467495*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trace: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}],
  SequenceForm["trace: ", {2, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.66776719846954*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"orders: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}],
  SequenceForm["orders: ", {0, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198471446*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"derivative: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     FractionBox["1", "2"], "+", "X", "+", 
     SuperscriptBox["X", "2"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0"},
       {"0", 
        RowBox[{
         FractionBox["1", "2"], "+", "X"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
  "derivative: ", (Rational[1, 2] + $CellContext`X + $CellContext`X^2)^(-1), 
   "*", 
   MatrixForm[{{0, 0}, {0, Rational[1, 2] + $CellContext`X}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198473856*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"absolutely irreducible components: \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["absolutely irreducible components: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198475762*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"genus: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["genus: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198477584*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"discriminant: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "X"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["X", "2"]}]}], ")"}]}]}],
  SequenceForm[
  "discriminant: ", 
   Rational[1, 2] (1 + 2 $CellContext`X + 2 $CellContext`X^2)],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198479553*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"different: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             FractionBox["1", "2"], "+", "X", "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm["different: ", 
   Row[{1, "*", 
     MatrixForm[{{Rational[1, 2] + $CellContext`X + $CellContext`X^2, 0}, {0, 
       1}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198482114*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"square free factors: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          GridBox[{{
             RowBox[{
               FractionBox["1", "2"], "+", "X", "+", 
               SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}], "}"}]}],
  SequenceForm["square free factors: ", {
    Row[{1, "*", 
      MatrixForm[{{1, 0}, {0, 1}}]}], 
    Row[{1, "*", 
      MatrixForm[{{Rational[1, 2] + $CellContext`X + $CellContext`X^2, 0}, {0,
         1}}]}]}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.66776719848494*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bad reduction: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "8", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm["bad reduction: ", {1, 8, -1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198486535*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.057672`5.212510006011477", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm[
  0.057672`5.212510006011477, ": ", "integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198488201*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.057792`5.213412717793367", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox[
      RowBox[{"11", " ", "X"}], "8"], "+", 
     FractionBox[
      RowBox[{"27", " ", 
       SuperscriptBox["X", "2"]}], "4"], "+", 
     FractionBox[
      RowBox[{"39", " ", 
       SuperscriptBox["X", "3"]}], "2"], "+", 
     FractionBox[
      RowBox[{"293", " ", 
       SuperscriptBox["X", "4"]}], "8"], "+", 
     FractionBox[
      RowBox[{"371", " ", 
       SuperscriptBox["X", "5"]}], "8"], "+", 
     FractionBox[
      RowBox[{"79", " ", 
       SuperscriptBox["X", "6"]}], "2"], "+", 
     FractionBox[
      RowBox[{"87", " ", 
       SuperscriptBox["X", "7"]}], "4"], "+", 
     RowBox[{"7", " ", 
      SuperscriptBox["X", "8"]}], "+", 
     SuperscriptBox["X", "9"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["X", "6"], "8"]}]}], "}"}]}],
  SequenceForm[
  0.057792`5.213412717793367, ": ", 
   "integrand: ", (Rational[1, 8] + Rational[11, 8] $CellContext`X + 
    Rational[27, 4] $CellContext`X^2 + Rational[39, 2] $CellContext`X^3 + 
    Rational[293, 8] $CellContext`X^4 + Rational[371, 8] $CellContext`X^5 + 
    Rational[79, 2] $CellContext`X^6 + Rational[87, 4] $CellContext`X^7 + 
    7 $CellContext`X^8 + $CellContext`X^9)^(-1), "*", {
   0, Rational[-1, 8] $CellContext`X^6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198490087*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.096135`5.4344265241357235", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     FractionBox["1", "4"], "+", 
     FractionBox[
      RowBox[{"5", " ", "X"}], "4"], "+", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["X", "2"]}], "2"], "+", 
     FractionBox[
      RowBox[{"5", " ", 
       SuperscriptBox["X", "3"]}], "2"], "+", 
     SuperscriptBox["X", "4"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["13", "32"], "-", 
      FractionBox[
       RowBox[{"9", " ", "X"}], "16"]}]}], "}"}]}],
  SequenceForm[
  0.096135`5.4344265241357235, ": ", 
   "integrand: ", (Rational[1, 4] + Rational[5, 4] $CellContext`X + 
    Rational[5, 2] $CellContext`X^2 + 
    Rational[5, 2] $CellContext`X^3 + $CellContext`X^4)^(-1), "*", {
   0, Rational[13, 32] + Rational[-9, 16] $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671985168962`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.097884`5.44225670185076", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"respiece: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", "#1"}], "4"]}], "-", 
         RowBox[{"5", " ", "X", " ", "#1"}], "-", 
         FractionBox[
          RowBox[{"15", " ", 
           SuperscriptBox["X", "2"], " ", "#1"}], "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["X", "3"], " ", "#1"}]}], ",", 
        RowBox[{
         FractionBox["13", "32"], "-", 
         FractionBox[
          RowBox[{"9", " ", "X"}], "16"]}]}], "}"}], ",", "1"}], "}"}], 
    "&"}]}],
  SequenceForm[
  0.097884`5.44225670185076, ": ", 
   "respiece: ", {{
    Rational[-5, 4] # - (
      5 $CellContext`X) # + (Rational[-15, 2] $CellContext`X^2) # - (
      4 $CellContext`X^3) #, Rational[13, 32] + 
     Rational[-9, 16] $CellContext`X}, 1}& ],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671985195227`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.100186`5.452352030919963", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"normres: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["169", "1024"]}], "+", 
     FractionBox[
      RowBox[{"25", " ", 
       SuperscriptBox["#1", "2"]}], "16"], "+", 
     RowBox[{"60", " ", 
      SuperscriptBox["X", "5"], " ", 
      SuperscriptBox["#1", "2"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox["X", "6"], " ", 
      SuperscriptBox["#1", "2"]}], "+", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["65", "512"], "+", 
        FractionBox[
         RowBox[{"25", " ", 
          SuperscriptBox["#1", "2"]}], "2"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["137", "512"], "+", 
        FractionBox[
         RowBox[{"175", " ", 
          SuperscriptBox["#1", "2"]}], "4"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["9", "32"], "+", 
        RowBox[{"85", " ", 
         SuperscriptBox["#1", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["81", "128"]}], "+", 
        FractionBox[
         RowBox[{"385", " ", 
          SuperscriptBox["#1", "2"]}], "4"]}], ")"}]}]}], "&"}]}],
  SequenceForm[
  0.100186`5.452352030919963, ": ", "normres: ", Rational[-169, 1024] + 
   Rational[25, 16] #^2 + (60 $CellContext`X^5) #^2 + (
     16 $CellContext`X^6) #^2 + $CellContext`X (Rational[65, 512] + 
     Rational[25, 2] #^2) + $CellContext`X^2 (Rational[137, 512] + 
     Rational[175, 4] #^2) + $CellContext`X^3 (Rational[9, 32] + 
     85 #^2) + $CellContext`X^4 (Rational[-81, 128] + Rational[385, 4] #^2)& ],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198521842*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.116965`5.519600918653498", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "1", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             FractionBox["1", "2"], "+", 
             FractionBox[
              RowBox[{"3", " ", "X"}], "2"], "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", 
           RowBox[{
             FractionBox["1", "2"], "+", 
             FractionBox[
              RowBox[{"3", " ", "X"}], "2"], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "X"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "X"}]}], ")"}], "2"]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.116965`5.519600918653498, ": ", "B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{
       Rational[1, 2] + Rational[3, 2] $CellContext`X + $CellContext`X^2, 
        0}, {0, Rational[1, 2] + 
        Rational[3, 2] $CellContext`X + $CellContext`X^2}}]}], 
   " , norm of B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", {(
     Rational[1, 4] (1 + $CellContext`X)^2) (1 + 2 $CellContext`X)^2, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671985480413`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.120066`5.530965035845681", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["116281", "512"], "-", 
    FractionBox[
     RowBox[{"1929", " ", 
      SuperscriptBox["z$4617", "2"]}], "64"], "+", 
    SuperscriptBox["z$4617", "4"]}]}],
  SequenceForm[
  0.120066`5.530965035845681, ": ", "residues from ramification index ", 1, 
   ": ", Rational[116281, 512] + 
   Rational[-1929, 64] $CellContext`z$4617^2 + $CellContext`z$4617^4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198551675*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.122334`5.539092169749369", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             FractionBox["1", "2"], "+", "X", "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "X"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["X", "2"]}]}], ")"}]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.122334`5.539092169749369, ": ", "B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{Rational[1, 2] + $CellContext`X + $CellContext`X^2, 0}, {0, 
       1}}]}], " , norm of B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", {
   Rational[1, 2] (1 + 2 $CellContext`X + 2 $CellContext`X^2), 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671985540113`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.124418`5.546428209342484", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.124418`5.546428209342484, ": ", "residues from ramification index ", 2, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198556836*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.129841`5.564956845144784", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"DATA: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"1a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["31", "8"], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
             RowBox[{"{", 
              FractionBox["31", "8"], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
             RowBox[{"RedInfo", "[", 
              RowBox[{
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", 
               FractionBox["31", "8"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}], "}"}], ",", "0", ",", 
             RowBox[{"RedInfo", "[", 
              RowBox[{
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}]},
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox[
              RowBox[{"11", " ", "\[Theta]"}], "4"], "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"11", " ", "\[Theta]"}], "4"], ",", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"11", " ", "\[Theta]"}], "4"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[0.129841`5.564956845144784, ": ", "DATA: ", 
   MatrixForm[{
     $CellContext`belem["1a", 
      $CellContext`NF[0, $CellContext`\[Theta]], {
       Rational[31, 8]}][{1, 
       $CellContext`NF[0, $CellContext`\[Theta]], {
        Rational[31, 8]}, {{1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, $CellContext`\[Theta]], 
        $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}, {1, 
       $CellContext`NF[0, $CellContext`\[Theta]], {
        Rational[-31, 8]}, {{-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, $CellContext`\[Theta]], 
        $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}], 
     $CellContext`belem["2a", 
      $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {
      Rational[11, 4] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 
       1}}], -2 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {
       Rational[11, 4] $CellContext`\[Theta], 
        Rational[-11, 4] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], 
        $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
        1}}, {}]}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198559423*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.130546`5.567308562841135", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"1a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["31", "8"], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"{", 
        FractionBox["31", "8"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
       RowBox[{"RedInfo", "[", 
        RowBox[{
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"-", 
         FractionBox["31", "8"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "}"}], ",", "0", ",", 
       RowBox[{"RedInfo", "[", 
        RowBox[{
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.130546`5.567308562841135, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["1a", 
    $CellContext`NF[0, $CellContext`\[Theta]], {
     Rational[31, 8]}][{1, 
     $CellContext`NF[0, $CellContext`\[Theta]], {
      Rational[31, 8]}, {{1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}, {1, 
     $CellContext`NF[0, $CellContext`\[Theta]], {
      Rational[-31, 8]}, {{-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198562249*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.155093`5.6421371902136555", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"2", "+", "X"}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.155093`5.6421371902136555, ": ", "ideal: ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 2 + $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198587769*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"2", "+", "X"}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 2 + $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}], " over ", 
   $CellContext`NF[0, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671985906487`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.156705`5.646627847257266", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"2", "+", "X"}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.156705`5.646627847257266, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 2 + $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671985932837`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[3, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198595902*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", "\[Theta]"}], "]"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[3, $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198598117*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.17186`5.68671980095243", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"2", "+", "X"}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.17186`5.68671980095243, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 2 + $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198599964*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[5, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671986270103`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", "\[Theta]"}], "]"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198629607*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[0, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198631505*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.20397`5.761111289389744", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox[
        RowBox[{"11", " ", "\[Theta]"}], "4"], "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"11", " ", "\[Theta]"}], "4"], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"11", " ", "\[Theta]"}], "4"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.20397`5.761111289389744, ": ", 
   "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {
    Rational[11, 4] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 
     1}}], -2 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {
     Rational[11, 4] $CellContext`\[Theta], 
      Rational[-11, 4] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], 
      $CellContext`NF[0, -2 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
      1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198634129*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198636375*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.229924`5.813129299795939", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{
        FractionBox["1", "2"], "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"-", "\[Theta]"}]}, {"0", 
           RowBox[{
             FractionBox["1", "4"], "+", "X", "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.229924`5.813129299795939, ": ", "ideal: ", 
   Row[{(Rational[1, 2] + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, -$CellContext`\[Theta]}, {
       0, Rational[1, 4] + $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.66776719866155*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{
        FractionBox["1", "2"], "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"-", "\[Theta]"}]}, {"0", 
           RowBox[{
             FractionBox["1", "4"], "+", "X", "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{(Rational[1, 2] + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, -$CellContext`\[Theta]}, {
       0, Rational[1, 4] + $CellContext`X + $CellContext`X^2}}]}], " over ", 
   $CellContext`NF[0, -2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198664489*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.23164`5.816358549757307", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"2", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"2", " ", "\[Theta]"}]}, {"0", 
           RowBox[{"1", "+", "X", "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.23164`5.816358549757307, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(2 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 2 $CellContext`\[Theta]}, {
       0, 1 + $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198667351*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[3, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198670082*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[3, 1 + $CellContext`\[Theta]^2], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.66776719867244*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.246917`5.844095985218227", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"3", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"4", " ", "\[Theta]"}]}, {"0", 
           RowBox[{"4", "+", "X", "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.246917`5.844095985218227, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(3 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 4 $CellContext`\[Theta]}, {
       0, 4 + $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198674395*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.66776719870017*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"3", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 3 + $CellContext`\[Theta]^2], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198725794*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[0, -2 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671987278852`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.272999`5.887706049711539", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "\[Theta]"}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "2"], "+", "X"}]}], "}"}]}],
  SequenceForm[
  0.272999`5.887706049711539, ": ", 
   "inside HandleLogTerm 2a: ", {{1, -$CellContext`\[Theta]}, 
    Rational[1, 2] + $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198731018*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.274537`5.89014587711983", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "4"}]}],
  SequenceForm[
  0.274537`5.89014587711983, ": ", "inside HandleLogTerm 2a: cnorm:  ", -4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198733712*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.281229`5.900605096083393", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["11", "4"], "+", 
        FractionBox[
         RowBox[{"11", " ", "X"}], "2"]}], ",", 
       FractionBox["11", "4"]}], "}"}], ",", "X"}], "}"}]}],
  SequenceForm[
  0.281229`5.900605096083393, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[11, 4] + Rational[11, 2] $CellContext`X, 
     Rational[11, 4]}, $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198736348*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.285167`5.906644260303027", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["11", "4"], "+", 
        FractionBox[
         RowBox[{"11", " ", "X"}], "2"]}], ",", 
       RowBox[{"-", 
        FractionBox["11", "4"]}]}], "}"}], ",", 
     RowBox[{"1", "+", "X"}]}], "}"}]}],
  SequenceForm[
  0.285167`5.906644260303027, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[11, 4] + Rational[11, 2] $CellContext`X, 
     Rational[-11, 4]}, 1 + $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671987390833`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.289077`5.912558532518955", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["11", "4"]}], "-", 
        FractionBox[
         RowBox[{"11", " ", "X"}], "2"]}], ",", 
       RowBox[{"-", 
        FractionBox["11", "4"]}]}], "}"}], ",", 
     RowBox[{"1", "+", "X"}]}], "}"}]}],
  SequenceForm[
  0.289077`5.912558532518955, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[-11, 4] + Rational[-11, 2] $CellContext`X, 
     Rational[-11, 4]}, 1 + $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.667767198741852*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.29252`5.917700558248182", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["11", "4"]}], "-", 
        FractionBox[
         RowBox[{"11", " ", "X"}], "2"]}], ",", 
       FractionBox["11", "4"]}], "}"}], ",", "X"}], "}"}]}],
  SequenceForm[
  0.29252`5.917700558248182, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[-11, 4] + Rational[-11, 2] $CellContext`X, 
     Rational[11, 4]}, $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.667230335719438*^9, 3.667230408284793*^9, 3.667230983942481*^9, 
   3.667231068925535*^9, 3.667236505671011*^9, 3.667236581437532*^9, 
   3.6672366518516207`*^9, 3.667312672279484*^9, {3.667312750978058*^9, 
   3.667312768285193*^9}, 3.6673139126993217`*^9, 3.667314003991201*^9, 
   3.667314065229368*^9, 3.6673144847927017`*^9, {3.6673154837616587`*^9, 
   3.66731551013573*^9}, {3.6673155529427357`*^9, 3.667315569188189*^9}, {
   3.6673156806738*^9, 3.667315710036462*^9}, 3.667315743281681*^9, 
   3.667315790458955*^9, 3.667315866711841*^9, 3.667315927348199*^9, 
   3.667316022084358*^9, 3.667316078051415*^9, 3.667316408280898*^9, 
   3.6673164422121964`*^9, 3.6673165727521048`*^9, 3.667334489735952*^9, 
   3.667675752947875*^9, 3.667765204265616*^9, 3.6677671987446537`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.29895400000000016`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "6"}], "+", 
          RowBox[{"10", " ", "x"}], "-", 
          RowBox[{"11", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          RowBox[{"37", " ", 
           SuperscriptBox["x", "3"]}], "+", 
          RowBox[{"76", " ", 
           SuperscriptBox["x", "4"]}]}], ")"}], " ", "y"}], 
       RowBox[{"24", " ", 
        SuperscriptBox["x", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}]}]], "+", 
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{"11", " ", 
        RowBox[{"ArcTanh", "[", 
         FractionBox[
          RowBox[{"1", "+", "x", "+", "y"}], 
          SqrtBox["2"]], "]"}]}], 
       SqrtBox["2"]], "+", 
      RowBox[{
       FractionBox["31", "8"], " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "y"}], "x"], "]"}]}]}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6673154843572693`*^9, 3.6673155104480963`*^9}, {
   3.667315553242579*^9, 3.6673155695181932`*^9}, {3.667315681015746*^9, 
   3.667315710320026*^9}, 3.667315743589738*^9, 3.667315790755096*^9, 
   3.667315867027719*^9, 3.667315927693701*^9, 3.667316022369471*^9, 
   3.667316078389791*^9, 3.6673164085782843`*^9, 3.667316442508853*^9, 
   3.6673165730369263`*^9, 3.6673344900347357`*^9, 3.667675753230194*^9, 
   3.66776520456905*^9, 3.667767198747582*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"]}], ")"}]}]}], "}"}], ",", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["x", "3"], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", "2"}], ")"}], "y"}]]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6673348038264723`*^9, 3.667334806904063*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.004707`4.124289191802576", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"new curve \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "X"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["X", "2"]}], "+", 
    SuperscriptBox["Y", "2"]}], "\[InvisibleSpace]", "\<\" after change \"\>",
    "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "\[Rule]", 
      RowBox[{"1", "+", 
       FractionBox["1", "X"]}]}], ",", 
     RowBox[{"y", "\[Rule]", 
      FractionBox["Y", "X"]}]}], "}"}]}],
  SequenceForm[
  0.004707`4.124289191802576, ": ", "new curve ", -1 - 2 $CellContext`X - 
   2 $CellContext`X^2 + $CellContext`Y^2, 
   " after change ", {$CellContext`x -> 
    1 + $CellContext`X^(-1), $CellContext`y -> $CellContext`X^(-1) \
$CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.66776720249242*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"normal integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm["normal integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202517466*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"change of basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm["change of basis: ", {{1, 0}, {0, 1}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025196457`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"product: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "X"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["X", "2"]}]}], ",", "0"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "product: ", {{{1, 0}, {0, 
    1}}, {{0, 1}, {1 + 2 $CellContext`X + 2 $CellContext`X^2, 0}}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202521893*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"trace: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}]}],
  SequenceForm["trace: ", {2, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.66776720252381*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"orders: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}],
  SequenceForm["orders: ", {0, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.66776720252569*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"derivative: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     FractionBox["1", "2"], "+", "X", "+", 
     SuperscriptBox["X", "2"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0"},
       {"0", 
        RowBox[{
         FractionBox["1", "2"], "+", "X"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
  "derivative: ", (Rational[1, 2] + $CellContext`X + $CellContext`X^2)^(-1), 
   "*", 
   MatrixForm[{{0, 0}, {0, Rational[1, 2] + $CellContext`X}}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202527914*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"absolutely irreducible components: \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["absolutely irreducible components: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202529813*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"genus: \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["genus: ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025315933`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"discriminant: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "X"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["X", "2"]}]}], ")"}]}]}],
  SequenceForm[
  "discriminant: ", 
   Rational[1, 2] (1 + 2 $CellContext`X + 2 $CellContext`X^2)],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025334797`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"different: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             FractionBox["1", "2"], "+", "X", "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm["different: ", 
   Row[{1, "*", 
     MatrixForm[{{Rational[1, 2] + $CellContext`X + $CellContext`X^2, 0}, {0, 
       1}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202535948*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"square free factors: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          
          GridBox[{{"1", "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], ",", 
     TemplateBox[{"1","\"*\"",TagBox[
        RowBox[{"(", "\[NoBreak]", 
          GridBox[{{
             RowBox[{
               FractionBox["1", "2"], "+", "X", "+", 
               SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
           GridBoxAlignment -> {
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
           GridBoxSpacings -> {"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]},
      "Row",
      DisplayFunction->(
       RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
      InterpretationFunction->(RowBox[{"Row", "[", 
         RowBox[{"{", 
           RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}], "}"}]}],
  SequenceForm["square free factors: ", {
    Row[{1, "*", 
      MatrixForm[{{1, 0}, {0, 1}}]}], 
    Row[{1, "*", 
      MatrixForm[{{Rational[1, 2] + $CellContext`X + $CellContext`X^2, 0}, {0,
         1}}]}]}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202538745*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bad reduction: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "8", ",", 
     RowBox[{"-", "1"}]}], "}"}]}],
  SequenceForm["bad reduction: ", {1, 8, -1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202540534*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.052276`5.169847342787271", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integral basis: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Y"}], "}"}]}],
  SequenceForm[
  0.052276`5.169847342787271, ": ", "integral basis: ", {1, $CellContext`Y}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025420628`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.052396`5.170843126963758", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     FractionBox["1", "6"], "+", 
     FractionBox[
      RowBox[{"7", " ", "X"}], "6"], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["X", "2"]}], "+", 
     FractionBox[
      RowBox[{"25", " ", 
       SuperscriptBox["X", "3"]}], "3"], "+", 
     FractionBox[
      RowBox[{"67", " ", 
       SuperscriptBox["X", "4"]}], "6"], "+", 
     FractionBox[
      RowBox[{"19", " ", 
       SuperscriptBox["X", "5"]}], "2"], "+", 
     FractionBox[
      RowBox[{"14", " ", 
       SuperscriptBox["X", "6"]}], "3"], "+", 
     SuperscriptBox["X", "7"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["X", "4"], "6"]}]}], "}"}]}],
  SequenceForm[
  0.052396`5.170843126963758, ": ", 
   "integrand: ", (Rational[1, 6] + Rational[7, 6] $CellContext`X + 
    4 $CellContext`X^2 + Rational[25, 3] $CellContext`X^3 + 
    Rational[67, 6] $CellContext`X^4 + Rational[19, 2] $CellContext`X^5 + 
    Rational[14, 3] $CellContext`X^6 + $CellContext`X^7)^(-1), "*", {
   0, Rational[-1, 6] $CellContext`X^4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025439367`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.067934`5.283632180393248", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"integrand: \"\>", "\[InvisibleSpace]", 
   FractionBox["1", 
    RowBox[{
     FractionBox["1", "6"], "+", 
     FractionBox[
      RowBox[{"5", " ", "X"}], "6"], "+", 
     FractionBox[
      RowBox[{"13", " ", 
       SuperscriptBox["X", "2"]}], "6"], "+", 
     FractionBox[
      RowBox[{"19", " ", 
       SuperscriptBox["X", "3"]}], "6"], "+", 
     FractionBox[
      RowBox[{"8", " ", 
       SuperscriptBox["X", "4"]}], "3"], "+", 
     SuperscriptBox["X", "5"]}]], "\[InvisibleSpace]", "\<\"*\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "24"], "+", 
      FractionBox["X", "12"], "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["X", "2"]}], "24"]}]}], "}"}]}],
  SequenceForm[
  0.067934`5.283632180393248, ": ", 
   "integrand: ", (Rational[1, 6] + Rational[5, 6] $CellContext`X + 
    Rational[13, 6] $CellContext`X^2 + Rational[19, 6] $CellContext`X^3 + 
    Rational[8, 3] $CellContext`X^4 + $CellContext`X^5)^(-1), "*", {
   0, Rational[1, 24] + Rational[1, 12] $CellContext`X + 
    Rational[5, 24] $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202546221*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.069863`5.2957922243176645", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"respiece: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"5", " ", "#1"}], "6"]}], "-", 
         FractionBox[
          RowBox[{"13", " ", "X", " ", "#1"}], "3"], "-", 
         FractionBox[
          RowBox[{"19", " ", 
           SuperscriptBox["X", "2"], " ", "#1"}], "2"], "-", 
         FractionBox[
          RowBox[{"32", " ", 
           SuperscriptBox["X", "3"], " ", "#1"}], "3"], "-", 
         RowBox[{"5", " ", 
          SuperscriptBox["X", "4"], " ", "#1"}]}], ",", 
        RowBox[{
         FractionBox["1", "24"], "+", 
         FractionBox["X", "12"], "+", 
         FractionBox[
          RowBox[{"5", " ", 
           SuperscriptBox["X", "2"]}], "24"]}]}], "}"}], ",", "1"}], "}"}], 
    "&"}]}],
  SequenceForm[
  0.069863`5.2957922243176645, ": ", 
   "respiece: ", {{
    Rational[-5, 6] # + (Rational[-13, 3] $CellContext`X) # + (
       Rational[-19, 2] $CellContext`X^2) # + (
       Rational[-32, 3] $CellContext`X^3) # - (5 $CellContext`X^4) #, 
     Rational[1, 24] + Rational[1, 12] $CellContext`X + 
     Rational[5, 24] $CellContext`X^2}, 1}& ],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202548469*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.072802`5.313688303812206", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"normres: \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "576"]}], "+", 
     FractionBox[
      RowBox[{"25", " ", 
       SuperscriptBox["#1", "2"]}], "36"], "+", 
     FractionBox[
      RowBox[{"320", " ", 
       SuperscriptBox["X", "7"], " ", 
       SuperscriptBox["#1", "2"]}], "3"], "+", 
     RowBox[{"25", " ", 
      SuperscriptBox["X", "8"], " ", 
      SuperscriptBox["#1", "2"]}], "+", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "96"]}], "+", 
        FractionBox[
         RowBox[{"65", " ", 
          SuperscriptBox["#1", "2"]}], "9"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "24"]}], "+", 
        FractionBox[
         RowBox[{"623", " ", 
          SuperscriptBox["#1", "2"]}], "18"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["7", "72"]}], "+", 
        FractionBox[
         RowBox[{"901", " ", 
          SuperscriptBox["#1", "2"]}], "9"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["31", "192"]}], "+", 
        FractionBox[
         RowBox[{"6877", " ", 
          SuperscriptBox["#1", "2"]}], "36"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["25", "288"]}], "+", 
        FractionBox[
         RowBox[{"1879", " ", 
          SuperscriptBox["#1", "2"]}], "9"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["X", "5"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["5", "32"]}], "+", 
        RowBox[{"246", " ", 
         SuperscriptBox["#1", "2"]}]}], ")"}]}]}], "&"}]}],
  SequenceForm[
  0.072802`5.313688303812206, ": ", "normres: ", Rational[-1, 576] + 
   Rational[25, 36] #^2 + (Rational[320, 3] $CellContext`X^7) #^2 + (
     25 $CellContext`X^8) #^2 + $CellContext`X (Rational[-1, 96] + 
     Rational[65, 9] #^2) + $CellContext`X^2 (Rational[-1, 24] + 
     Rational[623, 18] #^2) + $CellContext`X^3 (Rational[-7, 72] + 
     Rational[901, 9] #^2) + $CellContext`X^4 (Rational[-31, 192] + 
     Rational[6877, 36] #^2) + $CellContext`X^6 (Rational[-25, 288] + 
     Rational[1879, 9] #^2) + $CellContext`X^5 (Rational[-5, 32] + 246 #^2)& ],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025508347`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.090794`5.409602143195596", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "1", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             FractionBox["1", "3"], "+", "X", "+", 
             FractionBox[
              RowBox[{"5", " ", 
                SuperscriptBox["X", "2"]}], "3"], "+", 
             SuperscriptBox["X", "3"]}], "0"}, {"0", 
           RowBox[{
             FractionBox["1", "3"], "+", "X", "+", 
             FractionBox[
              RowBox[{"5", " ", 
                SuperscriptBox["X", "2"]}], "3"], "+", 
             SuperscriptBox["X", "3"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "9"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "X"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "X"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}]}], ")"}], "2"]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.090794`5.409602143195596, ": ", "B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{
       Rational[1, 3] + $CellContext`X + 
        Rational[5, 3] $CellContext`X^2 + $CellContext`X^3, 0}, {
       0, Rational[1, 3] + $CellContext`X + 
        Rational[5, 3] $CellContext`X^2 + $CellContext`X^3}}]}], 
   " , norm of B\[LeftDoubleBracket]", 1, 
   "\[RightDoubleBracket]: ", {(
     Rational[1, 9] (1 + $CellContext`X)^2) (1 + 2 $CellContext`X + 
      3 $CellContext`X^2)^2, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202579217*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.094586`5.427371853230803", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "256"]}], "-", 
    FractionBox[
     RowBox[{"15", " ", 
      SuperscriptBox["z$4946", "2"]}], "64"], "+", 
    SuperscriptBox["z$4946", "4"]}]}],
  SequenceForm[
  0.094586`5.427371853230803, ": ", "residues from ramification index ", 1, 
   ": ", Rational[-1, 256] + 
   Rational[-15, 64] $CellContext`z$4946^2 + $CellContext`z$4946^4],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025825243`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.09701`5.438361498081511", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"B\[LeftDoubleBracket]\"\>", "\[InvisibleSpace]", 
   "2", "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{
             FractionBox["1", "2"], "+", "X", "+", 
             SuperscriptBox["X", "2"]}], "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" , norm of B\[LeftDoubleBracket]\"\>", 
   "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"\[RightDoubleBracket]: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "X"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["X", "2"]}]}], ")"}]}], ",", "1"}], "}"}]}],
  SequenceForm[
  0.09701`5.438361498081511, ": ", "B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", 
   Row[{1, "*", 
     MatrixForm[{{Rational[1, 2] + $CellContext`X + $CellContext`X^2, 0}, {0, 
       1}}]}], " , norm of B\[LeftDoubleBracket]", 2, 
   "\[RightDoubleBracket]: ", {
   Rational[1, 2] (1 + 2 $CellContext`X + 2 $CellContext`X^2), 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202584667*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.099162`5.447890270972598", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"residues from ramification index \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  0.099162`5.447890270972598, ": ", "residues from ramification index ", 2, 
   ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202587274*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.102832`5.463673276062297", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"DATA: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"1a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["1", "2"], "}"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
             RowBox[{"{", 
              FractionBox["1", "2"], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
             RowBox[{"RedInfo", "[", 
              RowBox[{
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", 
               FractionBox["1", "2"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}], "}"}], ",", "0", ",", 
             RowBox[{"RedInfo", "[", 
              RowBox[{
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"NF", "[", 
                RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}]},
        {
         RowBox[{
          RowBox[{"belem", "[", 
           RowBox[{"\<\"2a\"\>", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             FractionBox["\[Theta]", "8"], "}"}], ",", 
            RowBox[{"-", "\[Theta]"}], ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["\[Theta]", "8"], ",", 
              RowBox[{"-", 
               FractionBox["\[Theta]", "8"]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
            RowBox[{"RedInfo", "[", 
             RowBox[{
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"NF", "[", 
               RowBox[{"0", ",", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[0.102832`5.463673276062297, ": ", "DATA: ", 
   MatrixForm[{
     $CellContext`belem["1a", 
      $CellContext`NF[0, $CellContext`\[Theta]], {
       Rational[1, 2]}][{1, 
       $CellContext`NF[0, $CellContext`\[Theta]], {
        Rational[1, 2]}, {{1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, $CellContext`\[Theta]], 
        $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}, {1, 
       $CellContext`NF[0, $CellContext`\[Theta]], {
        Rational[-1, 2]}, {{-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, $CellContext`\[Theta]], 
        $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}], 
     $CellContext`belem["2a", 
      $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {
      Rational[1, 8] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`RedInfo[
       $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
       $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
      1 + $CellContext`\[Theta]^2][{1, 
       $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {
       Rational[1, 8] $CellContext`\[Theta], 
        Rational[-1, 8] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
       $CellContext`RedInfo[
        $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
        $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
        1}}, {}]}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202589727*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.103505`5.466506323191903", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"1a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["1", "2"], "}"}]}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"{", 
        FractionBox["1", "2"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
       RowBox[{"RedInfo", "[", 
        RowBox[{
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"-", 
         FractionBox["1", "2"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "}"}], ",", "0", ",", 
       RowBox[{"RedInfo", "[", 
        RowBox[{
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.103505`5.466506323191903, ": ", "***** looking at residue basis element ", 
   $CellContext`belem["1a", 
    $CellContext`NF[0, $CellContext`\[Theta]], {
     Rational[1, 2]}][{1, 
     $CellContext`NF[0, $CellContext`\[Theta]], {
      Rational[1, 2]}, {{1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}, {1, 
     $CellContext`NF[0, $CellContext`\[Theta]], {
      Rational[-1, 2]}, {{-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, $CellContext`\[Theta]], 
      $CellContext`NF[0, $CellContext`\[Theta]], {{1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672025925093`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.132183`5.572720597806449", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             RowBox[{"-", "2"}], "-", "X"}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.132183`5.572720597806449, ": ", "ideal: ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, -2 - $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202620376*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             RowBox[{"-", "2"}], "-", "X"}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, -2 - $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}], " over ", 
   $CellContext`NF[0, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202623198*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.133844`5.578143900768668", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}]}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.133844`5.578143900768668, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 1 + 2 $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672026258497`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[3, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202628591*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"3", ",", "\[Theta]"}], "]"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[3, $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202630886*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.148938`5.624550511159658", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"1", "+", "X"}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"3", "+", 
             RowBox[{"4", " ", "X"}]}]}, {"0", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             SuperscriptBox["X", "2"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.148938`5.624550511159658, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(1 + $CellContext`X)^(-1), "*", 
     MatrixForm[{{1, 3 + 4 $CellContext`X}, {
       0, 1 + 2 $CellContext`X + $CellContext`X^2}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.66776720263271*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[5, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202660537*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", "\[Theta]"}], "]"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202663167*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]"}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[0, $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202665078*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.18134`5.710038604889888", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"***** looking at residue basis element \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"belem", "[", 
     RowBox[{"\<\"2a\"\>", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       FractionBox["\[Theta]", "8"], "}"}], ",", 
      RowBox[{"-", "\[Theta]"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Theta]", "2"]}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["\[Theta]", "8"], ",", 
        RowBox[{"-", 
         FractionBox["\[Theta]", "8"]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}]}], "}"}], ",", "0", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Theta]", "2"]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "}"}], "]"}], 
   "\[InvisibleSpace]", "\<\" *****\"\>"}],
  SequenceForm[
  0.18134`5.710038604889888, ": ", 
   "***** looking at residue basis element ", 
   $CellContext`belem["2a", 
    $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {
    Rational[1, 8] $CellContext`\[Theta]}, -$CellContext`\[Theta], 
    $CellContext`NF[0, $CellContext`\[Theta]], 
    $CellContext`RedInfo[
     $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
     $CellContext`NF[0, $CellContext`\[Theta]], {{1, 0}}, {{0, 1}}], 
    1 + $CellContext`\[Theta]^2][{1, 
     $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {
     Rational[1, 8] $CellContext`\[Theta], 
      Rational[-1, 8] $CellContext`\[Theta]}, {{1}, {-1}}, 0, 
     $CellContext`RedInfo[
      $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], 
      $CellContext`NF[0, 1 + $CellContext`\[Theta]^2], {{1, 0}, {0, 
      1}}, {}]}], " *****"],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202667646*^9}],

Cell[BoxData["\<\"inside MakeIdeal 2a:\"\>"], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672026699533`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.218126`5.790252428829535", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"ideal: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{
        FractionBox["1", "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "X"}], "3"], "+", 
        SuperscriptBox["X", "2"]}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             RowBox[{"2", " ", "\[Theta]"}], "+", 
             FractionBox[
              RowBox[{"15", " ", "X", " ", "\[Theta]"}], "2"], "+", 
             RowBox[{"9", " ", 
               SuperscriptBox["X", "2"], " ", "\[Theta]"}], "+", 
             FractionBox[
              RowBox[{"27", " ", 
                SuperscriptBox["X", "3"], " ", "\[Theta]"}], "2"]}]}, {"0", 
           RowBox[{
             FractionBox["1", "9"], "+", 
             FractionBox[
              RowBox[{"4", " ", "X"}], "9"], "+", 
             FractionBox[
              RowBox[{"10", " ", 
                SuperscriptBox["X", "2"]}], "9"], "+", 
             FractionBox[
              RowBox[{"4", " ", 
                SuperscriptBox["X", "3"]}], "3"], "+", 
             SuperscriptBox["X", "4"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[0.218126`5.790252428829535, ": ", "ideal: ", 
   Row[{(Rational[1, 3] + 
      Rational[2, 3] $CellContext`X + $CellContext`X^2)^(-1), "*", 
     MatrixForm[{{
       1, 2 $CellContext`\[Theta] + (
          Rational[15, 2] $CellContext`X) $CellContext`\[Theta] + (
          9 $CellContext`X^2) $CellContext`\[Theta] + (
          Rational[27, 2] $CellContext`X^3) $CellContext`\[Theta]}, {
       0, Rational[1, 9] + Rational[4, 9] $CellContext`X + 
        Rational[10, 9] $CellContext`X^2 + 
        Rational[4, 3] $CellContext`X^3 + $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202698094*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"entering DivisorIsTorsion: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{
        FractionBox["1", "3"], "+", 
        FractionBox[
         RowBox[{"2", " ", "X"}], "3"], "+", 
        SuperscriptBox["X", "2"]}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             RowBox[{"2", " ", "\[Theta]"}], "+", 
             FractionBox[
              RowBox[{"15", " ", "X", " ", "\[Theta]"}], "2"], "+", 
             RowBox[{"9", " ", 
               SuperscriptBox["X", "2"], " ", "\[Theta]"}], "+", 
             FractionBox[
              RowBox[{"27", " ", 
                SuperscriptBox["X", "3"], " ", "\[Theta]"}], "2"]}]}, {"0", 
           RowBox[{
             FractionBox["1", "9"], "+", 
             FractionBox[
              RowBox[{"4", " ", "X"}], "9"], "+", 
             FractionBox[
              RowBox[{"10", " ", 
                SuperscriptBox["X", "2"]}], "9"], "+", 
             FractionBox[
              RowBox[{"4", " ", 
                SuperscriptBox["X", "3"]}], "3"], "+", 
             SuperscriptBox["X", "4"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["entering DivisorIsTorsion: ", 
   Row[{(Rational[1, 3] + 
      Rational[2, 3] $CellContext`X + $CellContext`X^2)^(-1), "*", 
     MatrixForm[{{
       1, 2 $CellContext`\[Theta] + (
          Rational[15, 2] $CellContext`X) $CellContext`\[Theta] + (
          9 $CellContext`X^2) $CellContext`\[Theta] + (
          Rational[27, 2] $CellContext`X^3) $CellContext`\[Theta]}, {
       0, Rational[1, 9] + Rational[4, 9] $CellContext`X + 
        Rational[10, 9] $CellContext`X^2 + 
        Rational[4, 3] $CellContext`X^3 + $CellContext`X^4}}]}], " over ", 
   $CellContext`NF[0, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202701653*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.220334`5.794626512312855", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"2", "+", 
        RowBox[{"4", " ", "X"}], "+", 
        SuperscriptBox["X", "2"]}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"1", "+", 
             RowBox[{"2", " ", 
               SuperscriptBox["X", "2"]}], "+", 
             RowBox[{"3", " ", 
               SuperscriptBox["X", "3"]}]}]}, {"0", 
           RowBox[{"4", "+", "X", "+", 
             RowBox[{"3", " ", 
               SuperscriptBox["X", "3"]}], "+", 
             SuperscriptBox["X", "4"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.220334`5.794626512312855, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(2 + 4 $CellContext`X + $CellContext`X^2)^(-1), "*", 
     MatrixForm[{{1, 1 + 2 $CellContext`X^2 + 3 $CellContext`X^3}, {
       0, 4 + $CellContext`X + 3 $CellContext`X^3 + $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202704844*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[5, 2 + $CellContext`\[Theta]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202733696*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"5", ",", 
     RowBox[{"2", "+", "\[Theta]"}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[5, 2 + $CellContext`\[Theta]], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672027361717`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.24824`5.846416756072085", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside DivisorOrder: ideal^\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{FractionBox["1", 
      RowBox[{"5", "+", 
        RowBox[{"3", " ", "X"}], "+", 
        SuperscriptBox["X", "2"]}]],"\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             RowBox[{"2", " ", "\[Theta]"}], "+", 
             RowBox[{"4", " ", "X", " ", "\[Theta]"}], "+", 
             RowBox[{"2", " ", 
               SuperscriptBox["X", "2"], " ", "\[Theta]"}], "+", 
             RowBox[{"3", " ", 
               SuperscriptBox["X", "3"], " ", "\[Theta]"}]}]}, {"0", 
           RowBox[{"4", "+", 
             RowBox[{"2", " ", "X"}], "+", 
             RowBox[{"5", " ", 
               SuperscriptBox["X", "2"]}], "+", 
             RowBox[{"6", " ", 
               SuperscriptBox["X", "3"]}], "+", 
             SuperscriptBox["X", "4"]}]}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )]}],
  SequenceForm[
  0.24824`5.846416756072085, ": ", "inside DivisorOrder: ideal^", 1, ": ", 
   Row[{(5 + 3 $CellContext`X + $CellContext`X^2)^(-1), "*", 
     MatrixForm[{{
       1, 2 $CellContext`\[Theta] + (
          4 $CellContext`X) $CellContext`\[Theta] + (
          2 $CellContext`X^2) $CellContext`\[Theta] + (
          3 $CellContext`X^3) $CellContext`\[Theta]}, {
       0, 4 + 2 $CellContext`X + 5 $CellContext`X^2 + 
        6 $CellContext`X^3 + $CellContext`X^4}}]}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202738084*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[7, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202766362*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"order after reduction to \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"7", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}], 
   "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["order after reduction to ", 
   $CellContext`NF[7, 1 + $CellContext`\[Theta]^2], ": ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672027947063`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"principal ideal identity check: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0"}, {"0", "1"}}, 
         GridBoxAlignment -> {
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}, 
         GridBoxSpacings -> {"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "Row",
    DisplayFunction->(
     RowBox[{#, "\[InvisibleSpace]", #2, "\[InvisibleSpace]", #3}]& ),
    InterpretationFunction->(RowBox[{"Row", "[", 
       RowBox[{"{", 
         RowBox[{#, ",", #2, ",", #3}], "}"}], "]"}]& )], 
   "\[InvisibleSpace]", "\<\" over \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[Theta]", "2"]}]}], "]"}]}],
  SequenceForm["principal ideal identity check: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0}, {0, 1}}]}], " over ", 
   $CellContext`NF[0, 1 + $CellContext`\[Theta]^2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202796916*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.312337`5.946168428075253", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "X"}], "+", 
        SuperscriptBox["X", "2"]}], ",", 
       RowBox[{"2", " ", "X", " ", "\[Theta]"}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "3"], "+", 
      FractionBox[
       RowBox[{"2", " ", "X"}], "3"], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.312337`5.946168428075253, ": ", 
   "inside HandleLogTerm 2a: ", {{
    1 + 2 $CellContext`X + $CellContext`X^2, (
      2 $CellContext`X) $CellContext`\[Theta]}, Rational[1, 3] + 
    Rational[2, 3] $CellContext`X + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202799415*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.314162`5.948698646547614", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: cnorm:  \"\>", 
   "\[InvisibleSpace]", "9"}],
  SequenceForm[
  0.314162`5.948698646547614, ": ", "inside HandleLogTerm 2a: cnorm:  ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202801359*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.320203`5.956970390027855", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["X", "16"]}]}], "}"}], ",", 
     RowBox[{
      FractionBox["1", "2"], "+", "X", "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.320203`5.956970390027855, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{0, Rational[-1, 16] $CellContext`X}, 
    Rational[1, 2] + $CellContext`X + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202803195*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.322848`5.960543093850176", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", "8"]}], "}"}], ",", "X"}], "}"}]}],
  SequenceForm[
  0.322848`5.960543093850176, ": ", "inside HandleLogTerm 2a: elem:  ", {{0, 
     Rational[1, 8]}, $CellContext`X}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202805097*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.329683`5.9696415469583854", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "8"], "+", 
        FractionBox["X", "4"], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}], "8"]}], ",", 
       RowBox[{"-", 
        FractionBox["X", "4"]}]}], "}"}], ",", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "X"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.329683`5.9696415469583854, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[1, 8] + Rational[1, 4] $CellContext`X + 
     Rational[3, 8] $CellContext`X^2, Rational[-1, 4] $CellContext`X}, 1 + 
    2 $CellContext`X + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.6677672028070602`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.336827`5.978951890697167", "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", "\<\"inside HandleLogTerm 2a: elem:  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "8"]}], "-", 
        FractionBox["X", "4"], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["X", "2"]}], "8"]}], ",", 
       RowBox[{"-", 
        FractionBox["X", "4"]}]}], "}"}], ",", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "X"}], "+", 
      SuperscriptBox["X", "2"]}]}], "}"}]}],
  SequenceForm[
  0.336827`5.978951890697167, ": ", 
   "inside HandleLogTerm 2a: elem:  ", {{
    Rational[-1, 8] + Rational[-1, 4] $CellContext`X + 
     Rational[-3, 8] $CellContext`X^2, Rational[-1, 4] $CellContext`X}, 1 + 
    2 $CellContext`X + $CellContext`X^2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.667334807519573*^9, 3.667765214954193*^9, 
  3.667767202834778*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3469470000000001`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["y", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "2"]}]]}], "+", 
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{"ArcTan", "[", "y", "]"}], "4"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"1", "+", "y"}], "x"], "]"}]}]}]}], "]"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.667334807862129*^9, 3.667765215287891*^9, 
  3.6677672028374453`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{"x", "+", 
           SuperscriptBox["x", "4"]}], ")"}]}]}], "}"}], ",", 
      FractionBox["x", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.665918606885107*^9, 3.66591861481316*^9}, {
   3.6660409170276012`*^9, 3.666040917171584*^9}, {3.6660412950335083`*^9, 
   3.666041295267556*^9}, 3.6661046163226147`*^9, 3.667138106078718*^9, {
   3.6672310790708847`*^9, 3.6672310792065697`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.25696100000000044`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "x"}], "-", 
        SuperscriptBox["x", "4"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["x", "3"]}], "+", 
           RowBox[{"2", " ", "x", " ", "y"}]}], ")"}]}], "]"}]}]}]}], "]"}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.6663683583608723`*^9, 3.666456715179779*^9, 3.667138107410681*^9, {
   3.66723107738291*^9, 3.667231079946516*^9}, 3.66776523105202*^9, 
   3.667767207058861*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{"x", "+", 
           SuperscriptBox["x", "2"]}], ")"}]}]}], "}"}], ",", 
      FractionBox[
       RowBox[{"1", "+", "x", "+", "y"}], 
       RowBox[{"x", "+", 
        SuperscriptBox["x", "2"]}]]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.667339233605311*^9, 3.667339242494134*^9}, {
  3.685227962040937*^9, 3.685228021925664*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.12198199999999915`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "x"}], "-", 
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Log", "[", 
        RowBox[{"x", "+", "y"}], "]"}]}]}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.667339245244011*^9, 3.667765251528288*^9, 3.6677672124280024`*^9, {
   3.685227964028748*^9, 3.6852280225078278`*^9}}]
}, Open  ]],

Cell[TextData[{
 "Here are some examples that reply on torsion points in the Jacobians of \
hyperelliptic curves. In order to prove that the last one cannot be done, it \
is shown that the divisor has order ",
 Cell[BoxData[
  FormBox["24", TraditionalForm]]],
 " when reduced to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalF]", "11"], TraditionalForm]]],
 " and order ",
 Cell[BoxData[
  FormBox["39", TraditionalForm]]],
 " when reduced to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalF]", "13"], TraditionalForm]]],
 ". The second to last integral uses a torsion point of order ",
 Cell[BoxData[
  FormBox["29", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.667339282122671*^9, 3.667339349376449*^9}, {
  3.667339635537328*^9, 3.667339733476248*^9}, {3.667340270418541*^9, 
  3.667340270626525*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "4"], "+", 
           RowBox[{"4", 
            SuperscriptBox["x", "3"]}], "-", 
           RowBox[{"6", 
            SuperscriptBox["x", "2"]}], "+", 
           RowBox[{"4", "x"}], "+", "1"}], ")"}]}]}], "}"}], ",", 
      FractionBox["x", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.666965680630835*^9, 3.666965683303565*^9}, {
  3.6669698262782593`*^9, 3.666969826471648*^9}, {3.666983444425754*^9, 
  3.6669834447693777`*^9}, {3.667658386691033*^9, 3.667658386865747*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4989239999999988`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "-", 
        RowBox[{"4", " ", "x"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["x", "3"]}], "-", 
        SuperscriptBox["x", "4"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"43", "-", 
         RowBox[{"33", " ", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{"44", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"45", " ", 
          SuperscriptBox["x", "4"]}], "+", 
         RowBox[{"12", " ", 
          SuperscriptBox["x", "5"]}], "+", 
         SuperscriptBox["x", "6"], "-", 
         RowBox[{"11", " ", "y"}], "+", 
         RowBox[{"22", " ", "x", " ", "y"}], "+", 
         RowBox[{"30", " ", 
          SuperscriptBox["x", "2"], " ", "y"}], "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["x", "3"], " ", "y"}], "+", 
         RowBox[{
          SuperscriptBox["x", "4"], " ", "y"}]}], "]"}]}]}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.666992076764473*^9, 3.666992556810594*^9, 3.6671364727350903`*^9, 
   3.667658391818006*^9, {3.667658511353009*^9, 3.667658535100616*^9}, 
   3.6677652566708593`*^9, 3.6677672164154654`*^9, 3.683904121457111*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"AlgFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "71"}], "-", 
           RowBox[{"96", " ", "x"}], "+", 
           RowBox[{"10", " ", 
            SuperscriptBox["x", "2"]}], "+", 
           SuperscriptBox["x", "4"]}], ")"}]}]}], "}"}], ",", 
      FractionBox["x", "y"]}], "]"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.665152826719925*^9, 3.5794806738699665`*^9}, {
   3.665323828591131*^9, 3.665323844797743*^9}, 3.6661046163373423`*^9, 
   3.666992460896728*^9, {3.667658558827949*^9, 3.667658558995826*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5929099999999998`", ",", 
   RowBox[{"AlgFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{"71", "+", 
        RowBox[{"96", " ", "x"}], "-", 
        RowBox[{"10", " ", 
         SuperscriptBox["x", "2"]}], "-", 
        SuperscriptBox["x", "4"], "+", 
        SuperscriptBox["y", "2"]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"AlgIntegral", "[", "0", "]"}], "+", 
      RowBox[{
       FractionBox["1", "8"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"10001", "+", 
         RowBox[{"3124", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"1408", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"54", " ", 
          SuperscriptBox["x", "4"]}], "-", 
         RowBox[{"128", " ", 
          SuperscriptBox["x", "5"]}], "+", 
         RowBox[{"20", " ", 
          SuperscriptBox["x", "6"]}], "+", 
         SuperscriptBox["x", "8"], "+", 
         RowBox[{"781", " ", "y"}], "-", 
         RowBox[{"528", " ", "x", " ", "y"}], "+", 
         RowBox[{"27", " ", 
          SuperscriptBox["x", "2"], " ", "y"}], "-", 
         RowBox[{"80", " ", 
          SuperscriptBox["x", "3"], " ", "y"}], "+", 
         RowBox[{"15", " ", 
          SuperscriptBox["x", "4"], " ", "y"}], "+", 
         RowBox[{
          SuperscriptBox["x", "6"], " ", "y"}]}], "]"}]}]}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.666368409051544*^9, 3.6669924645066442`*^9, 
  3.6669925809675198`*^9, 3.6676585601505213`*^9, 3.667765262414625*^9, 
  3.6677672207540894`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["examples", "Title",
 CellChangeTimes->{{3.686181155169971*^9, 3.671192328421301*^9}, {
  3.6711924177825584`*^9, 3.671192417923214*^9}, {3.6711925608782597`*^9, 
  3.671192561534519*^9}}],

Cell["Integrals that can be done by hand.", "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, 
   3.6711486542892933`*^9, {3.671149063057547*^9, 3.671149078113076*^9}, {
   3.6711491246133995`*^9, 3.6711491294415894`*^9}, {3.671190977507208*^9, 
   3.6711909916167707`*^9}, 3.671191655221868*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], ")"}]}]}], "}"}], "}"}], ",", 
    FractionBox["1", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6930623928235903`*^9, 3.693062407557365*^9}, {
  3.693155774016474*^9, 3.693155817511451*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.226966`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{"1", "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"1", "+", "x", "+", 
          RowBox[{"y", " ", "#1"}]}], 
         RowBox[{"1", "+", "x"}]], "]"}], " ", "#1"}]}], "]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.693062411790956*^9, 3.693062522455694*^9, 3.693062624865478*^9, 
   3.6930627216515627`*^9, 3.693062906148879*^9, 3.693087805032666*^9, 
   3.693155576983686*^9, 3.693155639788394*^9, 3.693155679521194*^9, 
   3.69315573876877*^9, {3.693155778737934*^9, 3.693155821719674*^9}, 
   3.695571260984417*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    FractionBox[
     RowBox[{"12", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x", "-", 
        SuperscriptBox["x", "3"], "+", 
        SuperscriptBox["x", "4"]}], ")"}]}], 
     RowBox[{"1", "-", 
      RowBox[{"9", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["x", "3"]}], "-", 
      RowBox[{"9", " ", 
       SuperscriptBox["x", "4"]}], "+", 
      SuperscriptBox["x", "6"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6930128795171556`*^9, 3.693012880268281*^9}, 
   3.693057607838523*^9, {3.693163298212701*^9, 3.693163311878755*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0989850000000001`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"3", " ", "#1"}], "+", 
       SuperscriptBox["#1", "3"]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         SuperscriptBox["x", "2"], "-", 
         RowBox[{"2", " ", "x", " ", "#1"}]}], "]"}], " ", "#1"}]}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.693012886546789*^9, 3.693057615019093*^9, 3.6930586885142736`*^9, 
   3.693073638911068*^9, 3.693087741480048*^9, 3.693156217323749*^9, {
   3.693163303840919*^9, 3.6931633153919773`*^9}, 3.69316360872232*^9, 
   3.6955712821468887`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", "1"}], ")"}]}]}], "}"}], "}"}], ",", 
    
    FractionBox["144", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "+", "2"}], ")"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", "2"}], ")"}], "2"], 
      SuperscriptBox["x", "3"], "y"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{
  3.693012300051317*^9, {3.693071123238233*^9, 3.693071125109736*^9}, {
   3.693073684309431*^9, 3.693073686036282*^9}, {3.693073737859332*^9, 
   3.6930737405651503`*^9}, {3.6930741206086073`*^9, 3.693074122309124*^9}, {
   3.693074165901741*^9, 3.693074192837805*^9}, {3.693150417002522*^9, 
   3.693150449339518*^9}, {3.693150654588923*^9, 3.6931506562353992`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5869109999999997`", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "6"}], "+", 
        RowBox[{"6", " ", "x"}], "-", 
        SuperscriptBox["x", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "3"]}]}], ")"}], " ", "y"}], 
     RowBox[{
      SuperscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox["x", "2"]}], ")"}]}]], "+", 
    RowBox[{"Int", "[", "0", "]"}], "-", 
    RowBox[{
     FractionBox["45", "4"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", "y"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["45", "4"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", "y"}], "]"}]}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "20"]}], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}], "+", 
         RowBox[{"10", " ", "y", " ", "#1"}]}], "]"}], " ", "#1"}]}], "]"}], 
    "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1185921", "64"], "+", 
       FractionBox[
        RowBox[{"511", " ", 
         SuperscriptBox["#1", "2"]}], "4"], "+", 
       SuperscriptBox["#1", "4"]}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["1", "680"], " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"511", "+", 
            RowBox[{"8", " ", 
             SuperscriptBox["#1", "2"]}]}], ")"}]}], "+", 
         FractionBox[
          RowBox[{"y", " ", "#1", " ", 
           RowBox[{"(", 
            RowBox[{"2111", "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["#1", "2"]}]}], ")"}]}], "21780"]}], "]"}], " ", 
       "#1"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.69307489843544*^9, 3.693074983819202*^9, 
  3.6931504019891167`*^9, 3.6931504324700403`*^9, 3.693150465776052*^9, 
  3.693150565628882*^9, 3.693150661522397*^9, 3.695576294288587*^9, 
  3.695577107547421*^9}]
}, Open  ]],

Cell["Integral on a singular cubic.", "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, 
   3.6711486542892933`*^9, {3.671149063057547*^9, 3.671149078113076*^9}, {
   3.6711491246133995`*^9, 3.6711491294415894`*^9}, {3.671190977507208*^9, 
   3.6711909916167707`*^9}, {3.67119158923663*^9, 3.671191593158554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "3"], "-", 
        RowBox[{
         SuperscriptBox["x", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]}]}], "}"}], "}"}], ",", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", "x"}], "+", "4", "-", "y"}], ")"}], "y"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6711914764684515`*^9, 3.6711914977812376`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8098770000000002`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "-", 
    RowBox[{
     FractionBox["3", "4"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"2", " ", "y"}], "x"]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["3", "4"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"2", " ", "y"}], "x"]}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6930617010794353`*^9, 3.693150734947548*^9, 
  3.695576573174773*^9, 3.695576976210244*^9, 3.695585292121159*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "3"], "-", 
        RowBox[{
         SuperscriptBox["x", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "+", "x"}], ")"}]}]}]}], "}"}], "}"}], ",", 
    FractionBox["1", 
     RowBox[{"y", "-", 
      RowBox[{"2", "x"}], "-", "2"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.693070842982997*^9, 3.693070846037615*^9}, {
  3.693071466055698*^9, 3.693071497967391*^9}, {3.693071564608289*^9, 
  3.693071565195207*^9}, {3.6930716255924664`*^9, 3.693071626619816*^9}, {
  3.693073417367797*^9, 3.693073490705882*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0268439999999988`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "-", 
      FractionBox["y", "x"]}], "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "7"], "-", 
       FractionBox[
        RowBox[{"5", " ", "#1"}], "7"], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"x", "+", 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"7", " ", "#1"}]}], ")"}]}]}], "x"], "]"}], " ", 
       "#1"}]}], "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["9", "14"], "+", 
       FractionBox[
        RowBox[{"12", " ", "#1"}], "7"], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"x", "+", 
          RowBox[{
           FractionBox["2", "3"], " ", "y", " ", 
           RowBox[{"(", 
            RowBox[{"6", "+", 
             RowBox[{"7", " ", "#1"}]}], ")"}]}]}], "x"], "]"}], " ", 
       "#1"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6955769375292387`*^9, 3.695585298996667*^9}]
}, Open  ]],

Cell[TextData[{
 "The integral ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "3"], "+", "1"}], ")"}], 
      RowBox[{"2", "/", "3"}]], 
     RowBox[{"\[DifferentialD]", "x"}]}]}], TraditionalForm]]],
 " is evaluated in this example."
}], "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, 
   3.6711486542892933`*^9, {3.671149063057547*^9, 3.671149078113076*^9}, {
   3.6711491246133995`*^9, 3.6711491294415894`*^9}, 3.693012139415216*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "3"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "3"], "+", "1"}], ")"}]}]}], "}"}], "}"}], ",", 
    
    SuperscriptBox["y", "2"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.686181194682899*^9, 3.686181208492766*^9}, {
  3.686181572358556*^9, 3.686181572541888*^9}, {3.686181606126462*^9, 
  3.686181608262232*^9}, {3.686181994526689*^9, 3.686181995318611*^9}, {
  3.686604932222554*^9, 3.6866049415108137`*^9}, {3.686605078175796*^9, 
  3.6866050825803423`*^9}, {3.686655708401094*^9, 3.6866557084812307`*^9}, {
  3.68665574533751*^9, 3.6866557543540916`*^9}, {3.68665582102652*^9, 
  3.686655850954278*^9}, {3.6866656779763737`*^9, 3.671148955981745*^9}, {
  3.6711490851600466`*^9, 3.671149088175682*^9}, {3.6711496048836236`*^9, 
  3.6711496066961775`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.3866379999999996`", ",", 
   RowBox[{
    FractionBox[
     RowBox[{"x", " ", 
      SuperscriptBox["y", "2"]}], "3"], "+", 
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       RowBox[{"x", " ", "y"}], "+", 
       SuperscriptBox["y", "2"]}], "]"}]}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "3"], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["3", "2"], " ", 
          SuperscriptBox["x", "2"], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "#1"}], ")"}]}], "-", 
         RowBox[{"3", " ", "x", " ", 
          SuperscriptBox["y", "2"], " ", "#1"}], "+", 
         RowBox[{
          FractionBox["3", "2"], " ", 
          SuperscriptBox["x", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "#1"}], ")"}]}]}], "]"}], " ", "#1"}]}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.68618128295909*^9, 3.686181333112917*^9, {3.686181435018722*^9, 
   3.68618145012504*^9}, 3.6861815560921793`*^9, 3.686181590121763*^9, 
   3.686181626529297*^9, 3.686181833467312*^9, {3.686181984875401*^9, 
   3.6861820037184057`*^9}, 3.686604944038838*^9, 3.686605052376491*^9, 
   3.686605085157251*^9, 3.686605153617847*^9, 3.686605246207274*^9, 
   3.68660539518852*^9, 3.6866064320156593`*^9, 3.686606493880539*^9, {
   3.686606545971879*^9, 3.686606571547471*^9}, 3.686606744679027*^9, 
   3.686607024728067*^9, 3.686607056371649*^9, 3.6866070931654387`*^9, 
   3.6866071247896976`*^9, 3.686607189439345*^9, {3.6866073173528852`*^9, 
   3.6866073361609173`*^9}, {3.686608224042799*^9, 3.686608237228745*^9}, 
   3.686608400286723*^9, 3.686609190079835*^9, 3.686609247370398*^9, 
   3.686609304605064*^9, 3.6866093576278667`*^9, 3.686609406119359*^9, 
   3.686609477703328*^9, 3.686609561132461*^9, 3.6866095945921907`*^9, 
   3.686609624686811*^9, 3.686609700957027*^9, 3.686609734614251*^9, 
   3.686609771755517*^9, 3.686609820025009*^9, 3.686654170284984*^9, 
   3.6866542452088327`*^9, 3.686654389308565*^9, 3.686654459879513*^9, 
   3.686654533447732*^9, 3.686654652340502*^9, 3.686654713787427*^9, 
   3.6866548599114943`*^9, 3.686654969236499*^9, 3.686655124395667*^9, 
   3.6866557133044777`*^9, 3.686655758589905*^9, {3.6866558268146963`*^9, 
   3.686655853913945*^9}, 3.686665687442226*^9, {3.6866657295449257`*^9, 
   3.671148914978837*^9}, {3.6711489490000553`*^9, 3.6711489736443157`*^9}, 
   3.671149106188985*^9, 3.671149630945997*^9, 3.6711977481519732`*^9, 
   3.693012137925736*^9, 3.693156043060686*^9, 3.695585310324709*^9}]
}, Open  ]],

Cell[TextData[{
 "The integral ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    FractionBox[
     RowBox[{"\[DifferentialD]", "x"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "3"], "-", 
        SuperscriptBox["x", "4"]}], ")"}], 
      RowBox[{"1", "/", "4"}]]]}], TraditionalForm]]],
 "is evaluated in this example."
}], "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, 
   3.6711486542892933`*^9, {3.671149063057547*^9, 3.671149078113076*^9}, {
   3.6711491246133995`*^9, 3.6711491294415894`*^9}, {3.671197819715457*^9, 
   3.671197828090596*^9}, {3.671200536141555*^9, 3.6712005420017447`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "4"], "-", 
        RowBox[{
         SuperscriptBox["x", "3"], 
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}]}]}]}], "}"}], "}"}], ",", 
    FractionBox["1", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6711977868087955`*^9, 3.671197800418351*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.4717759999999984`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{"1", "+", 
       SuperscriptBox["#1", "4"]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "x", "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["y", "3"], " ", 
            SuperscriptBox["#1", "3"]}], 
           SuperscriptBox["x", "2"]]}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}]], "]"}], " ", "#1"}]}], "]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.671197865951005*^9, 3.693012177481881*^9, 
  3.693156068724972*^9, 3.6931561798163557`*^9, 3.695572971409645*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "4"], "+", "1"}], ")"}]}]}], "}"}], "}"}], ",", 
    
    FractionBox["y", 
     RowBox[{
      SuperscriptBox["x", "4"], "-", "1"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.695572978652926*^9, 3.695572991385394*^9}, {
  3.695573021754408*^9, 3.69557302187072*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0328429999999997`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"y", "-", 
          RowBox[{"4", " ", "x", " ", "#1"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["x", "2"]}]], "]"}], " ", "#1"}]}], "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "8"], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"y", "+", 
          RowBox[{"4", " ", "x", " ", "#1"}]}], 
         RowBox[{"1", "+", 
          SuperscriptBox["x", "2"]}]], "]"}], " ", "#1"}]}], "]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.695572997460999*^9, 3.695573023277603*^9}, 
   3.695576031891173*^9}]
}, Open  ]],

Cell[TextData[{
 "The integral ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{"\[DifferentialD]", "x"}]}], TraditionalForm]]],
 " is evaluated in this example."
}], "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, 
   3.6711486542892933`*^9, {3.692983231906678*^9, 3.6929832410455847`*^9}, {
   3.693166246416697*^9, 3.6931662476918573`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "4"], "+", 
        RowBox[{
         SuperscriptBox["x", "3"], "y"}], "-", 
        SuperscriptBox["x", "2"]}]}], "}"}], "}"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"54", 
       SuperscriptBox["x", "7"]}], "+", 
      RowBox[{"27", 
       SuperscriptBox["x", "4"], 
       SuperscriptBox["y", "3"]}], "-", 
      RowBox[{"27", 
       SuperscriptBox["x", "5"], "y"}], "+", 
      RowBox[{"36", 
       SuperscriptBox["x", "3"], 
       SuperscriptBox["y", "2"]}], "+", 
      RowBox[{"108", 
       SuperscriptBox["x", "4"]}], "+", 
      RowBox[{"144", "x", " ", 
       SuperscriptBox["y", "3"]}], "+", 
      RowBox[{"48", 
       SuperscriptBox["x", "2"], "y"}], "+", 
      RowBox[{"192", 
       SuperscriptBox["y", "2"]}], "+", 
      RowBox[{"320", "x"}]}], 
     RowBox[{
      SuperscriptBox["x", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"27", 
         SuperscriptBox["x", "6"]}], "+", "256"}], ")"}]}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6931636568041763`*^9, 3.6931636569403343`*^9}, {
   3.6931636882207317`*^9, 3.6931636884024467`*^9}, {3.693164011566113*^9, 
   3.6931640118132687`*^9}, 3.693164072925221*^9, {3.693165053758772*^9, 
   3.693165056790462*^9}, {3.693165350776657*^9, 3.6931653529990673`*^9}, {
   3.693165599554138*^9, 3.693165599823655*^9}, 3.693165667896702*^9, {
   3.693165801769299*^9, 3.693165807259346*^9}, {3.693165847713702*^9, 
   3.6931658495196953`*^9}, {3.693165894185075*^9, 3.69316598067282*^9}, {
   3.693166123313569*^9, 3.6931661271255293`*^9}, {3.69316624979646*^9, 
   3.693166296782251*^9}, {3.6931663337114897`*^9, 3.69316636222714*^9}, {
   3.693167800597308*^9, 3.693167890642549*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.163671000000022`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["x", "2"]}], "+", "y", "-", 
      FractionBox[
       SuperscriptBox["y", "3"], "x"]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.693061742597487*^9, 3.693156271872571*^9, 3.693163669587964*^9, 
   3.693163716792675*^9, 3.693163970033619*^9, 3.693164035029119*^9, 
   3.693164096866641*^9, 3.693164586999936*^9, 3.693165088835765*^9, 
   3.693165293380254*^9, 3.693165379474566*^9, 3.693165571153924*^9, 
   3.693165635754139*^9, 3.693165704127933*^9, 3.693165822427176*^9, {
   3.69316588387294*^9, 3.693165954535349*^9}, 3.693166002620552*^9, 
   3.693166134206916*^9, 3.693166373322315*^9, 3.6931670478132353`*^9, 
   3.6931679204540567`*^9, 3.69316839906936*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "3"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "6"], "+", "1"}], ")"}]}]}], "}"}], "}"}], ",", 
    
    FractionBox["x", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6931717459732027`*^9, 3.693171776221161*^9}, {
  3.693171848557304*^9, 3.6931718808384857`*^9}, {3.693172066479096*^9, 
  3.693172069188232*^9}, {3.6931721223993893`*^9, 3.693172130495097*^9}, {
  3.693225305511353*^9, 3.693225306062067*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.2246609999999998`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       SuperscriptBox["x", "4"], "+", 
       RowBox[{
        SuperscriptBox["x", "2"], " ", "y"}], "+", 
       SuperscriptBox["y", "2"]}], "]"}]}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["3", "4"], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "12"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["x", "4"], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["3", "2"]}], "+", "#1"}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"], " ", 
          SuperscriptBox["y", "2"], " ", "#1"}], "+", 
         RowBox[{
          SuperscriptBox["x", "6"], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["3", "2"], "+", "#1"}], ")"}]}]}], "]"}], " ", 
       "#1"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6931717827522373`*^9, 3.693171856507125*^9, {3.693171975155792*^9, 
   3.693171986298183*^9}, {3.693172114003153*^9, 3.693172143320343*^9}, 
   3.693225313394136*^9}]
}, Open  ]],

Cell[TextData[{
 "The integral ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"tan", "(", 
      RowBox[{
       RowBox[{"1", "/", "4"}], " ", 
       RowBox[{
        SuperscriptBox["tan", 
         RowBox[{"-", "1"}]], "(", "x", ")"}]}], ")"}], 
     RowBox[{"\[DifferentialD]", "x"}]}]}], TraditionalForm]]],
 " is evaluated in this example."
}], "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, 
   3.6711486542892933`*^9, {3.692983231906678*^9, 3.6929832410455847`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"Numerator", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"TrigExpand", "[", 
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{"4", 
              RowBox[{"ArcTan", "[", "y", "]"}]}], "]"}], "-", "x"}], "]"}], 
          "]"}], "]"}], "]"}]}], "}"}], "}"}], ",", "y", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6931636568041763`*^9, 3.6931636569403343`*^9}, {
   3.6931636882207317`*^9, 3.6931636884024467`*^9}, {3.693164011566113*^9, 
   3.6931640118132687`*^9}, 3.693164072925221*^9, {3.693165053758772*^9, 
   3.693165056790462*^9}, {3.693165350776657*^9, 3.6931653529990673`*^9}, {
   3.693165599554138*^9, 3.693165599823655*^9}, 3.693165667896702*^9, {
   3.693165801769299*^9, 3.693165807259346*^9}, {3.693165847713702*^9, 
   3.6931658495196953`*^9}, {3.693165894185075*^9, 3.69316598067282*^9}, {
   3.693166123313569*^9, 3.6931661271255293`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.23566100000005`", ",", 
   RowBox[{
    RowBox[{"x", " ", "y"}], "+", 
    RowBox[{"Int", "[", "0", "]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"504", "+", 
        RowBox[{"41", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"833", " ", "x", " ", "y"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "588"}], "-", 
           RowBox[{"7", " ", 
            SuperscriptBox["x", "2"]}]}], ")"}], " ", 
         SuperscriptBox["y", "2"]}], "-", 
        RowBox[{"147", " ", "x", " ", 
         SuperscriptBox["y", "3"]}]}], 
       RowBox[{"504", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "63"}], "+", 
          SuperscriptBox["x", "2"]}], ")"}]}]], "]"}]}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "-", 
       RowBox[{"2", " ", "#1"}], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"126", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["x", "2"], " ", "#1"}], "+", 
          RowBox[{"119", " ", "x", " ", "y", " ", "#1"}], "-", 
          RowBox[{"21", " ", "x", " ", 
           SuperscriptBox["y", "3"], " ", "#1"}], "+", 
          RowBox[{
           SuperscriptBox["y", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "84"}], " ", "#1"}], "-", 
             RowBox[{
              SuperscriptBox["x", "2"], " ", "#1"}]}], ")"}]}]}], 
         RowBox[{"126", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "63"}], "+", 
            SuperscriptBox["x", "2"]}], ")"}]}]], "]"}], " ", "#1"}]}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.693061742597487*^9, 3.693156271872571*^9, 3.693163669587964*^9, 
   3.693163716792675*^9, 3.693163970033619*^9, 3.693164035029119*^9, 
   3.693164096866641*^9, 3.693164586999936*^9, 3.693165088835765*^9, 
   3.693165293380254*^9, 3.693165379474566*^9, 3.693165571153924*^9, 
   3.693165635754139*^9, 3.693165704127933*^9, 3.693165822427176*^9, {
   3.69316588387294*^9, 3.693165954535349*^9}, 3.693166002620552*^9, 
   3.693166134206916*^9}]
}, Open  ]],

Cell["\<\
This integral on the Klein quartic is reduced to an integral of the first \
kind.\
\>", "Text",
 CellChangeTimes->{{3.693166196174115*^9, 3.6931662168496723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "3"], "+", 
        RowBox[{"y", " ", 
         SuperscriptBox["x", "3"]}], "+", "x"}]}], "}"}], "}"}], ",", 
    FractionBox["1", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.576173367515027*^9, 3.576173371617834*^9}, {
  3.676496168149043*^9, 3.6711355822577705`*^9}, {3.6711375568851447`*^9, 
  3.671137558244545*^9}, {3.693166480008524*^9, 3.693166482392312*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7338889999999907`", ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["x", "3"]}], "-", 
       SuperscriptBox["y", "2"]}], ")"}]}], "+", 
    RowBox[{"Int", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "42"}], " ", 
        SuperscriptBox["x", "3"]}], "-", 
       RowBox[{"14", " ", 
        SuperscriptBox["x", "5"], " ", "y"}], "-", 
       RowBox[{"63", " ", 
        SuperscriptBox["y", "2"]}]}], 
      RowBox[{
       RowBox[{"81", " ", "x"}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["x", "8"]}]}]], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.676496447327058*^9, 3.6764966659823513`*^9, 3.6764967847411942`*^9, 
   3.676496854096095*^9, {3.6764970503276825`*^9, 3.6711355895390882`*^9}, 
   3.671135891533653*^9, 3.6711360844576645`*^9, 3.6711362459648075`*^9, 
   3.6711365375591393`*^9, 3.6711366574547324`*^9, 3.671136843079872*^9, 
   3.6711369555720177`*^9, 3.671137191968112*^9, 3.67113731945438*^9, 
   3.671137510685458*^9, 3.671137565799161*^9, 3.6711377621247168`*^9, 
   3.6711378438476586`*^9, 3.6711379523818336`*^9, 3.671138236642165*^9, 
   3.671146660794278*^9, 3.6711467269486837`*^9, 3.671146810866346*^9, 
   3.6711469180324993`*^9, 3.6930622871126833`*^9}]
}, Open  ]],

Cell["These hyperelliptic integrals are logarithms.", "Text",
 CellChangeTimes->{{3.6711488696396985`*^9, 3.67114887754615*^9}, {
  3.6711921597933245`*^9, 3.6711921702777963`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "16"}], " ", "x"}], "+", 
          RowBox[{"33", " ", 
           SuperscriptBox["x", "2"]}], "-", 
          RowBox[{"12", " ", 
           SuperscriptBox["x", "3"]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["x", "4"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["x", "5"]}], "+", 
          SuperscriptBox["x", "6"]}], ")"}]}]}], "}"}], "}"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      RowBox[{"18", " ", "x"}], "+", 
      RowBox[{"29", " ", 
       SuperscriptBox["x", "2"]}]}], "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.667054937436734*^9, 3.667054986660514*^9}, {
  3.66705524521871*^9, 3.6670552605577*^9}, {3.667055300246599*^9, 
  3.667055313621965*^9}, {3.667055572742947*^9, 3.6670555739487743`*^9}, {
  3.667055694799124*^9, 3.667055702334509*^9}, {3.667136491601321*^9, 
  3.667136496225876*^9}, {3.667334558302906*^9, 3.667334558462263*^9}, {
  3.6764770496768026`*^9, 3.676477060536244*^9}, {3.6764772188263607`*^9, 
  3.6764772278577423`*^9}, {3.676477258297369*^9, 3.67112257149059*^9}, {
  3.671192128777254*^9, 3.671192129480389*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.5714570000000005`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"Log", "[", 
     RowBox[{
      FractionBox["1", "524288"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "134217728"}], "+", 
        RowBox[{"150994944", " ", "x"}], "-", 
        RowBox[{"528482304", " ", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"279969792", " ", 
         SuperscriptBox["x", "3"]}], "+", 
        RowBox[{"638582784", " ", 
         SuperscriptBox["x", "4"]}], "+", 
        RowBox[{"916848640", " ", 
         SuperscriptBox["x", "5"]}], "+", 
        RowBox[{"2374631424", " ", 
         SuperscriptBox["x", "6"]}], "+", 
        RowBox[{"4834279424", " ", 
         SuperscriptBox["x", "7"]}], "+", 
        RowBox[{"6614046720", " ", 
         SuperscriptBox["x", "8"]}], "+", 
        RowBox[{"7944578304", " ", 
         SuperscriptBox["x", "9"]}], "+", 
        RowBox[{"8991685504", " ", 
         SuperscriptBox["x", "10"]}], "+", 
        RowBox[{"9056612528", " ", 
         SuperscriptBox["x", "11"]}], "+", 
        RowBox[{"8106250392", " ", 
         SuperscriptBox["x", "12"]}], "+", 
        RowBox[{"6677210721", " ", 
         SuperscriptBox["x", "13"]}], "+", 
        RowBox[{"5097069328", " ", 
         SuperscriptBox["x", "14"]}], "+", 
        RowBox[{"3548250712", " ", 
         SuperscriptBox["x", "15"]}], "+", 
        RowBox[{"2238714832", " ", 
         SuperscriptBox["x", "16"]}], "+", 
        RowBox[{"1288213884", " ", 
         SuperscriptBox["x", "17"]}], "+", 
        RowBox[{"675607056", " ", 
         SuperscriptBox["x", "18"]}], "+", 
        RowBox[{"317208072", " ", 
         SuperscriptBox["x", "19"]}], "+", 
        RowBox[{"129708992", " ", 
         SuperscriptBox["x", "20"]}], "+", 
        RowBox[{"45004902", " ", 
         SuperscriptBox["x", "21"]}], "+", 
        RowBox[{"12979632", " ", 
         SuperscriptBox["x", "22"]}], "+", 
        RowBox[{"3058536", " ", 
         SuperscriptBox["x", "23"]}], "+", 
        RowBox[{"578480", " ", 
         SuperscriptBox["x", "24"]}], "+", 
        RowBox[{"85820", " ", 
         SuperscriptBox["x", "25"]}], "+", 
        RowBox[{"9648", " ", 
         SuperscriptBox["x", "26"]}], "+", 
        RowBox[{"776", " ", 
         SuperscriptBox["x", "27"]}], "+", 
        RowBox[{"40", " ", 
         SuperscriptBox["x", "28"]}], "+", 
        SuperscriptBox["x", "29"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "50331648"}], "+", 
           RowBox[{"50331648", " ", "x"}], "+", 
           RowBox[{"95420416", " ", 
            SuperscriptBox["x", "2"]}], "+", 
           RowBox[{"207618048", " ", 
            SuperscriptBox["x", "3"]}], "+", 
           RowBox[{"640024576", " ", 
            SuperscriptBox["x", "4"]}], "+", 
           RowBox[{"1097859072", " ", 
            SuperscriptBox["x", "5"]}], "+", 
           RowBox[{"1494073344", " ", 
            SuperscriptBox["x", "6"]}], "+", 
           RowBox[{"1939619840", " ", 
            SuperscriptBox["x", "7"]}], "+", 
           RowBox[{"2246693120", " ", 
            SuperscriptBox["x", "8"]}], "+", 
           RowBox[{"2257532160", " ", 
            SuperscriptBox["x", "9"]}], "+", 
           RowBox[{"2055647184", " ", 
            SuperscriptBox["x", "10"]}], "+", 
           RowBox[{"1731692416", " ", 
            SuperscriptBox["x", "11"]}], "+", 
           RowBox[{"1326830817", " ", 
            SuperscriptBox["x", "12"]}], "+", 
           RowBox[{"914354726", " ", 
            SuperscriptBox["x", "13"]}], "+", 
           RowBox[{"570906027", " ", 
            SuperscriptBox["x", "14"]}], "+", 
           RowBox[{"324386076", " ", 
            SuperscriptBox["x", "15"]}], "+", 
           RowBox[{"165196041", " ", 
            SuperscriptBox["x", "16"]}], "+", 
           RowBox[{"73265978", " ", 
            SuperscriptBox["x", "17"]}], "+", 
           RowBox[{"27506475", " ", 
            SuperscriptBox["x", "18"]}], "+", 
           RowBox[{"8550024", " ", 
            SuperscriptBox["x", "19"]}], "+", 
           RowBox[{"2161755", " ", 
            SuperscriptBox["x", "20"]}], "+", 
           RowBox[{"436794", " ", 
            SuperscriptBox["x", "21"]}], "+", 
           RowBox[{"68953", " ", 
            SuperscriptBox["x", "22"]}], "+", 
           RowBox[{"8220", " ", 
            SuperscriptBox["x", "23"]}], "+", 
           RowBox[{"699", " ", 
            SuperscriptBox["x", "24"]}], "+", 
           RowBox[{"38", " ", 
            SuperscriptBox["x", "25"]}], "+", 
           SuperscriptBox["x", "26"]}], ")"}], " ", "y"}]}], ")"}]}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5761773008123355`*^9, 3.67647733673818*^9, 3.6764961941659756`*^9, 
   3.6764963597592506`*^9, 3.676497241627765*^9, 3.676498896711985*^9, 
   3.676498943540617*^9, 3.67650078681201*^9, 3.6765009233494673`*^9, 
   3.6765010006733155`*^9, 3.676501134733142*^9, 3.6765011823430243`*^9, 
   3.6765012614381924`*^9, {3.6765016318812413`*^9, 3.6711225606779437`*^9}, 
   3.671122593319006*^9, 3.6711353625920725`*^9, 3.6711355046708937`*^9, 
   3.671138316865918*^9, 3.671146964822687*^9, 3.6929792900431747`*^9, 
   3.693062268087625*^9, 3.697193222706133*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "6"], "-", 
          RowBox[{"8", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "+", "1"}], ")"}], "3"]}]}], ")"}]}]}], "}"}], 
     "}"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"2", 
       SuperscriptBox["x", "2"]}], "+", "x"}], "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.667054937436734*^9, 3.667054986660514*^9}, {
  3.66705524521871*^9, 3.6670552605577*^9}, {3.667055300246599*^9, 
  3.667055313621965*^9}, {3.667055572742947*^9, 3.6670555739487743`*^9}, {
  3.667055694799124*^9, 3.667055702334509*^9}, {3.667136491601321*^9, 
  3.667136496225876*^9}, {3.667334558302906*^9, 3.667334558462263*^9}, {
  3.6764770496768026`*^9, 3.676477060536244*^9}, {3.6764772188263607`*^9, 
  3.6764772278577423`*^9}, {3.676477258297369*^9, 3.67112257149059*^9}, {
  3.6711491792389565`*^9, 3.671149202330559*^9}, {3.671149281407853*^9, 
  3.6711492815797596`*^9}, {3.6711493128616805`*^9, 3.671149313064808*^9}, {
  3.6711493446115503`*^9, 3.671149349705312*^9}, {3.671149383314886*^9, 
  3.6711493836117373`*^9}, {3.671192143871235*^9, 3.67119215048067*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6107550000000002`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"-", "184"}], "+", 
       RowBox[{"120", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"40", " ", 
        SuperscriptBox["x", "3"]}], "+", 
       RowBox[{"36", " ", 
        SuperscriptBox["x", "4"]}], "+", 
       RowBox[{"144", " ", 
        SuperscriptBox["x", "5"]}], "-", 
       RowBox[{"204", " ", 
        SuperscriptBox["x", "6"]}], "+", 
       RowBox[{"144", " ", 
        SuperscriptBox["x", "7"]}], "-", 
       RowBox[{"108", " ", 
        SuperscriptBox["x", "8"]}], "+", 
       RowBox[{"52", " ", 
        SuperscriptBox["x", "9"]}], "-", 
       RowBox[{"18", " ", 
        SuperscriptBox["x", "10"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["x", "11"]}], "-", 
       SuperscriptBox["x", "12"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"40", "-", 
          RowBox[{"60", " ", "x"}], "+", 
          RowBox[{"144", " ", 
           SuperscriptBox["x", "2"]}], "-", 
          RowBox[{"168", " ", 
           SuperscriptBox["x", "3"]}], "+", 
          RowBox[{"132", " ", 
           SuperscriptBox["x", "4"]}], "-", 
          RowBox[{"96", " ", 
           SuperscriptBox["x", "5"]}], "+", 
          RowBox[{"48", " ", 
           SuperscriptBox["x", "6"]}], "-", 
          RowBox[{"18", " ", 
           SuperscriptBox["x", "7"]}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["x", "8"]}], "-", 
          SuperscriptBox["x", "9"]}], ")"}], " ", "y"}]}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.671149219440163*^9, 3.6711492981580486`*^9, 
  3.671149328805421*^9, 3.671149364647328*^9, 3.6711493992622104`*^9, 
  3.6930622250491123`*^9, 3.697193260303591*^9}]
}, Open  ]],

Cell["This hyperelliptic integral is not elementary.", "Text",
 CellChangeTimes->{{3.6711488696396985`*^9, 3.67114887754615*^9}, {
  3.6711491741920156`*^9, 3.671149174848276*^9}, {3.6711494411815667`*^9, 
  3.671149444494112*^9}, {3.6711494930938377`*^9, 3.671149495734483*^9}, {
  3.697193283596312*^9, 3.697193285059774*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "6"], "-", 
          RowBox[{"6", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "+", "1"}], ")"}], "3"]}]}], ")"}]}]}], "}"}], 
     "}"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"2", 
       SuperscriptBox["x", "2"]}], "+", "x"}], "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.667054937436734*^9, 3.667054986660514*^9}, {
  3.66705524521871*^9, 3.6670552605577*^9}, {3.667055300246599*^9, 
  3.667055313621965*^9}, {3.667055572742947*^9, 3.6670555739487743`*^9}, {
  3.667055694799124*^9, 3.667055702334509*^9}, {3.667136491601321*^9, 
  3.667136496225876*^9}, {3.667334558302906*^9, 3.667334558462263*^9}, {
  3.6764770496768026`*^9, 3.676477060536244*^9}, {3.6764772188263607`*^9, 
  3.6764772278577423`*^9}, {3.676477258297369*^9, 3.67112257149059*^9}, {
  3.6711491792389565`*^9, 3.671149202330559*^9}, {3.671149281407853*^9, 
  3.6711492815797596`*^9}, {3.6711493128616805`*^9, 3.671149313064808*^9}, {
  3.6711493446115503`*^9, 3.671149349705312*^9}, {3.671149383314886*^9, 
  3.6711493836117373`*^9}, {3.6711494479159746`*^9, 3.6711494491347466`*^9}, {
  3.671191996977987*^9, 3.6711920029624386`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.839415999999998`", ",", 
   RowBox[{"Int", "[", 
    FractionBox[
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "x"}]}], ")"}], " ", "y"}], 
     RowBox[{
      RowBox[{"-", "6"}], "-", 
      RowBox[{"18", " ", "x"}], "-", 
      RowBox[{"18", " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["x", "3"]}], "+", 
      SuperscriptBox["x", "6"]}]], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.671149219440163*^9, 3.6711492981580486`*^9, 
  3.671149328805421*^9, 3.671149364647328*^9, 3.6711493992622104`*^9, 
  3.671149481889327*^9, 3.693062192055295*^9, 3.6971932902666483`*^9}]
}, Open  ]],

Cell["These elliptic integrals are also logarithms.", "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
   3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
   3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, {
   3.6711486542892933`*^9, 3.671148687962438*^9}, {3.6711487955149574`*^9, 
   3.671148839641962*^9}, {3.6711919184769297`*^9, 3.6711919247895164`*^9}, 
   3.6711920085875134`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "+", "1"}], ")"}], "4"], "-", 
          RowBox[{"12", 
           SuperscriptBox["x", "2"]}]}], ")"}]}]}], "}"}], "}"}], ",", 
    FractionBox["x", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.5761012637982893`*^9, 3.5761012694066105`*^9}, {
   3.5761013166223106`*^9, 3.576101319198458*^9}, 3.576101372117485*^9, {
   3.5761015269723425`*^9, 3.5761015270763483`*^9}, {3.5761107119556932`*^9, 
   3.576110734538985*^9}, {3.5761114236463995`*^9, 3.576111425262492*^9}, {
   3.576111474638316*^9, 3.5761114792145777`*^9}, {3.5761120631549773`*^9, 
   3.57611206792225*^9}, {3.576112532198805*^9, 3.5761125323668146`*^9}, {
   3.5761126079341373`*^9, 3.5761126207978725`*^9}, {3.676501808216955*^9, 
   3.671131968813715*^9}, {3.6711487583539157`*^9, 3.6711487584945145`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3917890000000028`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox["1", "125"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "16"}], " ", 
          RowBox[{"(", 
           RowBox[{"43", "-", 
            RowBox[{"33", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            RowBox[{"44", " ", 
             SuperscriptBox["x", "3"]}], "+", 
            RowBox[{"45", " ", 
             SuperscriptBox["x", "4"]}], "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["x", "5"]}], "+", 
            SuperscriptBox["x", "6"]}], ")"}]}], "-", 
         RowBox[{"16", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "11"}], "+", 
            RowBox[{"22", " ", "x"}], "+", 
            RowBox[{"30", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            RowBox[{"10", " ", 
             SuperscriptBox["x", "3"]}], "+", 
            SuperscriptBox["x", "4"]}], ")"}], " ", "y"}]}], ")"}]}], 
      "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5761012707746887`*^9, 3.5761013251838007`*^9, {3.576101365823125*^9, 
   3.576101373852584*^9}, 3.576101528716442*^9, 3.576101590035949*^9, 
   3.576101661415032*^9, 3.5761017351342487`*^9, 3.576101840557278*^9, 
   3.5761106880143237`*^9, {3.5761107202851696`*^9, 3.5761107366171036`*^9}, {
   3.576110793836376*^9, 3.5761108224740143`*^9}, 3.576110864688429*^9, 
   3.576110933692376*^9, 3.5761110097787275`*^9, 3.576111428115655*^9, 
   3.576111482175747*^9, 3.5761120236717196`*^9, 3.576112071614461*^9, 
   3.576112333970467*^9, 3.5761124444937887`*^9, {3.5761125171579447`*^9, 
   3.5761125342919245`*^9}, 3.5761126251541224`*^9, 3.676475363217002*^9, 
   3.676475648462905*^9, {3.67650182434212*^9, 3.671131804095472*^9}, 
   3.6711319335774593`*^9, 3.6711319760638123`*^9, 3.6711342161331472`*^9, 
   3.6711342586805935`*^9, 3.6711353179913235`*^9, 3.6711487784022827`*^9, 
   3.693062165307382*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "71"}], "-", 
          RowBox[{"96", " ", "x"}], "+", 
          RowBox[{"10", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          SuperscriptBox["x", "4"]}], ")"}]}]}], "}"}], "}"}], ",", 
    FractionBox["x", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.671191929461425*^9, 3.6711919452897882`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.499771999999993`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "8"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox["1", "171875"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"64", " ", 
          RowBox[{"(", 
           RowBox[{"10001", "+", 
            RowBox[{"3124", " ", 
             SuperscriptBox["x", "2"]}], "-", 
            RowBox[{"1408", " ", 
             SuperscriptBox["x", "3"]}], "+", 
            RowBox[{"54", " ", 
             SuperscriptBox["x", "4"]}], "-", 
            RowBox[{"128", " ", 
             SuperscriptBox["x", "5"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox["x", "6"]}], "+", 
            SuperscriptBox["x", "8"]}], ")"}]}], "+", 
         RowBox[{"64", " ", 
          RowBox[{"(", 
           RowBox[{"781", "-", 
            RowBox[{"528", " ", "x"}], "+", 
            RowBox[{"27", " ", 
             SuperscriptBox["x", "2"]}], "-", 
            RowBox[{"80", " ", 
             SuperscriptBox["x", "3"]}], "+", 
            RowBox[{"15", " ", 
             SuperscriptBox["x", "4"]}], "+", 
            SuperscriptBox["x", "6"]}], ")"}], " ", "y"}]}], ")"}]}], 
      "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.671191964633748*^9, 3.6930621286557302`*^9}]
}, Open  ]],

Cell["\<\
Here an elliptic integral is split up into an algebraic portion, logarithmic \
portion, an integral of the second kind, and an integral of the first kind.\
\>", "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
  3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711484011328173`*^9, 
  3.671148461302458*^9}, {3.6711485975063562`*^9, 3.6711485977094564`*^9}, {
  3.6711486542892933`*^9, 3.671148687962438*^9}, {3.6711487955149574`*^9, 
  3.6711488254853325`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{"x", "+", "5"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"x", "-", "4"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"x", "-", "3"}], ")"}]}]}]}], "}"}], "}"}], ",", "y", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6878897542139893`*^9, 3.687889767063067*^9}, {
  3.687889797817731*^9, 3.576097281658762*^9}, {3.576097452937559*^9, 
  3.576097455273692*^9}, {3.5761008392092423`*^9, 3.5761008394732575`*^9}, {
  3.576101002896367*^9, 3.5761010036314087`*^9}, {3.5761076725688505`*^9, 
  3.5761076901688566`*^9}, {3.5761098128342667`*^9, 3.5761098424179583`*^9}, {
  3.67650177806036*^9, 3.6711176108326344`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9348580000000055`", ",", 
   RowBox[{
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "x"}]}], ")"}], " ", "y"}], "+", 
    RowBox[{"Int", "[", 
     FractionBox[
      RowBox[{"35", " ", "y"}], 
      RowBox[{
       RowBox[{"60", " ", "x"}], "-", 
       RowBox[{"23", " ", 
        SuperscriptBox["x", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "3"]}], "+", 
       SuperscriptBox["x", "4"]}]], "]"}], "-", 
    RowBox[{
     FractionBox["49", "3"], " ", 
     RowBox[{"Int2ndKind", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "y"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"60", "-", 
          RowBox[{"23", " ", "x"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["x", "2"]}], "+", 
          SuperscriptBox["x", "3"]}], ")"}]}]], "]"}]}], "+", 
    RowBox[{"6", " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox["1", "18"], " ", 
       RowBox[{"(", 
        RowBox[{"18", "+", 
         RowBox[{"15", " ", "x"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["x", "3"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "-", "x"}], ")"}], " ", "y"}]}], ")"}]}], 
      "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.687893357409957*^9, {3.687893427696826*^9, 3.6878934375218077`*^9}, 
   3.687893474610305*^9, 3.687893522477079*^9, 3.6878935796388206`*^9, 
   3.6878943141025248`*^9, 3.687894501872031*^9, 3.687894556363926*^9, 
   3.687894713551433*^9, {3.687894827189802*^9, 3.6878948826385183`*^9}, 
   3.6878950720792017`*^9, 3.687895110184297*^9, 3.687895217883567*^9, 
   3.6878952711023417`*^9, 3.6878953146537523`*^9, 3.687895357349255*^9, 
   3.687896002290167*^9, 3.687896093120916*^9, {3.6878962388842077`*^9, 
   3.5760973024249496`*^9}, 3.576097336281886*^9, {3.5760974476292553`*^9, 
   3.5760974832352915`*^9}, {3.5760975329341345`*^9, 3.576097578036714*^9}, 
   3.576097756975949*^9, 3.576097795660161*^9, 3.576097829181079*^9, 
   3.5760979548522663`*^9, 3.576098019164945*^9, {3.576098079796413*^9, 
   3.576098103579773*^9}, 3.576098134377535*^9, 3.5760982356113253`*^9, {
   3.5760983882990584`*^9, 3.576098418141765*^9}, 3.5760984700897365`*^9, 
   3.5760985059747887`*^9, 3.576098624993596*^9, 3.576098715482772*^9, 
   3.5760987988145385`*^9, 3.57609898801136*^9, 3.5760990507339478`*^9, 
   3.576099087615057*^9, 3.576099137375903*^9, {3.576099243410968*^9, 
   3.5760992713995686`*^9}, 3.5760993194223156`*^9, 3.5760993691421595`*^9, 
   3.576099427271484*^9, 3.5760995372367735`*^9, 3.576099760710556*^9, 
   3.576099922838829*^9, 3.576099987596533*^9, 3.576100029799947*^9, 
   3.5761000701552553`*^9, 3.576100288454741*^9, 3.5761003566086392`*^9, 
   3.5761004175511246`*^9, 3.576100526528358*^9, 3.5761006056428833`*^9, 
   3.5761007531213183`*^9, 3.576100794676695*^9, {3.5761008286876407`*^9, 
   3.5761008412763605`*^9}, 3.576101005802533*^9, {3.5761020642070704`*^9, 
   3.576102116464059*^9}, 3.576102207370259*^9, 3.576110199157363*^9, 
   3.5761102428108597`*^9, 3.576110282736143*^9, 3.5761103737913513`*^9, 
   3.5761104098324127`*^9, 3.5761105173795643`*^9, 3.5761113778927827`*^9, 
   3.5761118649996433`*^9, 3.57611200200548*^9, 3.57616863794552*^9, 
   3.576168912896003*^9, 3.576169034077016*^9, {3.5761703291600904`*^9, 
   3.5761703455089192`*^9}, {3.5761703871765924`*^9, 3.576170407503428*^9}, 
   3.6764758239643965`*^9, 3.6765017258090496`*^9, {3.676501785388569*^9, 
   3.6711175118157*^9}, 3.671117621739029*^9, 3.6711177785698767`*^9, 
   3.6711178438676267`*^9, 3.671122331291727*^9, 3.6711461786310787`*^9, 
   3.671147122584853*^9, 3.6711471754331746`*^9, 3.6711475532340083`*^9, 
   3.693062104060114*^9}]
}, Open  ]],

Cell["\<\
Here are some subtle examples. In each second case, the larger function field \
can be used to give a simpler answer.\
\>", "Text",
 CellChangeTimes->{{3.6711477998561707`*^9, 3.671147809184476*^9}, {
  3.6711480249509106`*^9, 3.671148076674348*^9}, {3.6711495593892403`*^9, 
  3.671149564466626*^9}, {3.6711927481314526`*^9, 3.671192749631504*^9}, {
  3.6711928991333027`*^9, 3.671192901789592*^9}, {3.671200359871763*^9, 
  3.671200379106397*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Integral]", 
   RowBox[{
    SqrtBox[
     FractionBox["x", 
      RowBox[{
       SuperscriptBox["x", "3"], "+", "1"}]]], 
    RowBox[{"\[DifferentialD]", "x"}], "        ", "and", "        ", 
    RowBox[{"\[Integral]", 
     RowBox[{
      FractionBox[
       SqrtBox["x"], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "3"], "+", "1"}]]], 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
  TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.6712005197663345`*^9, 3.671200519875738*^9}, {
  3.6712005650449095`*^9, 3.6712005997797194`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "3"], "+", "1"}], ")"}], 
         SuperscriptBox["y", "2"]}], "-", "x"}]}], "}"}], "}"}], ",", "y", 
    ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.671138386587115*^9, 3.671138404956016*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7548850000000016`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "3"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "3"]}], "+", 
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["x", "3"]}], ")"}], " ", "y"}]}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.671138416987376*^9, 3.671138629118351*^9, 
  3.671144908586337*^9, 3.6711458914616117`*^9, 3.6711459841183596`*^9, 
  3.6711476379940834`*^9, 3.693061848220441*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "3"], "+", "1"}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{
         SuperscriptBox["z", "2"], "-", "x"}]}], "}"}]}], "}"}], ",", 
    FractionBox["z", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.57611268789371*^9, 3.5761126985093174`*^9}, {
  3.576113040739892*^9, 3.576113079482108*^9}, {3.5761704231502557`*^9, 
  3.5761704364258785`*^9}, {3.576171774549429*^9, 3.5761717746898293`*^9}, {
  3.576178040596835*^9, 3.5761780410648355`*^9}, {3.576178438729534*^9, 
  3.5761784689155874`*^9}, {3.57617872088723*^9, 3.576178745426073*^9}, {
  3.5761788071241813`*^9, 3.576178808091383*^9}, {3.5761788478558526`*^9, 
  3.5761788505858574`*^9}, {3.576263894164625*^9, 3.576263919031069*^9}, {
  3.6711449541141443`*^9, 3.671144954176597*^9}, {3.6711458384536505`*^9, 
  3.671145848750643*^9}, {3.6711461192214713`*^9, 3.671146120908946*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.504618999999998`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["2", "3"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"y", "+", 
       RowBox[{"x", " ", "z"}]}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5761780776512995`*^9, {3.576178733757252*^9, 3.5761787542244883`*^9}, 
   3.5761788172173986`*^9, 3.5761788561550674`*^9, {3.576263912822258*^9, 
   3.576263932088292*^9}, 3.671144946332741*^9, 3.6711449931341534`*^9, 
   3.6711456844048257`*^9, 3.6711457669426055`*^9, 3.671146010654208*^9, 
   3.671146141196495*^9, 3.693061871700609*^9}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Integral]", 
   RowBox[{
    FractionBox[
     RowBox[{"\[DifferentialD]", "x"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "-", 
        SuperscriptBox["x", "3"]}], ")"}], 
      RowBox[{"1", "/", "3"}]]], "        ", "and", "        ", 
    RowBox[{"\[Integral]", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "x"}], 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["x", 
         RowBox[{"2", "/", "3"}]], "(", 
        RowBox[{"1", "-", "x"}], ")"}], 
       RowBox[{"1", "/", "3"}]]]}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.6712005197663345`*^9, 3.671200519875738*^9}, {
  3.6712005650449095`*^9, 3.6712006380146074`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "3"], "-", 
        RowBox[{
         SuperscriptBox["x", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}]}]}]}], "}"}], "}"}], ",", 
    FractionBox["1", "y"], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.671200107191906*^9, 3.671200116692006*^9}, {
  3.693072278304512*^9, 3.6930722847131042`*^9}, {3.693072337691433*^9, 
  3.693072340887891*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8628690000000461`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "x"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "y"}], "-", 
         SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{"1", "+", "#1", "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "x"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["x", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["y", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "#1"}], ")"}]}], "+", 
           RowBox[{"y", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "#1"}], "+", 
              RowBox[{"x", " ", "#1"}]}], ")"}]}]}], ")"}]}], "]"}], " ", 
       "#1"}]}], "]"}]}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.6712001508017807`*^9, 3.69306189349168*^9, 3.693062998457621*^9, 
   3.693071964087982*^9, 3.693072185995515*^9, {3.693072265909396*^9, 
   3.693072290902824*^9}, {3.693072337693849*^9, 3.693072347518299*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{
         SuperscriptBox["y", "3"], "-", "x"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{
         SuperscriptBox["z", "3"], "-", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x"}], ")"}]}]}], "}"}]}], "}"}], ",", 
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["y", "2"], " ", "z"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.67119950806555*^9, 3.671199533003385*^9}, {
  3.671199713163147*^9, 3.6711997136006823`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"47.763738999999994`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{
     FractionBox["3", "2"], " ", 
     RowBox[{"Log", "[", 
      RowBox[{"y", "+", "z"}], "]"}]}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       FractionBox["27", "4"], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         FractionBox["1", "6"], " ", 
         RowBox[{"(", 
          RowBox[{"6", "+", 
           RowBox[{
            SuperscriptBox["y", "2"], " ", "z", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "9"}], "-", 
              RowBox[{"2", " ", "#1"}]}], ")"}]}], "-", 
           RowBox[{"4", " ", "y", " ", 
            SuperscriptBox["z", "2"], " ", "#1"}], "+", 
           RowBox[{"x", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "9"}], "+", 
              RowBox[{"2", " ", "#1"}]}], ")"}]}]}], ")"}]}], "]"}], " ", 
       "#1"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.671199694772274*^9, 3.6712000648905697`*^9, 
  3.693062023264773*^9}]
}, Open  ]],

Cell[TextData[{
 "Here is an example where the ",
 Cell[BoxData[
  FormBox["\[DoubleStruckCapitalQ]", TraditionalForm]]],
 "-linear dependence of the residues must be taken into account."
}], "Text",
 CellChangeTimes->{{3.6711517271298466`*^9, 3.671151760318345*^9}, 
   3.701347277035233*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "3"], "+", "1"}], ")"}]}]}], "}"}], "}"}], ",", 
    
    FractionBox[
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", 
         SuperscriptBox["x", "3"]}], "-", 
        RowBox[{"10", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"4", "x"}], "+", "2"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "x"}], "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "3"], "-", 
        RowBox[{"2", 
         SuperscriptBox["x", "2"]}], "+", "1"}], ")"}], "y"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6711501813844533`*^9, 3.671150227496592*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.2438100000000034`", ",", 
   RowBox[{
    RowBox[{"Int", "[", "0", "]"}], "+", 
    RowBox[{"RootPlus", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], "+", 
       SuperscriptBox["#1", "2"]}], ",", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"17", "-", 
             RowBox[{"20", " ", "x"}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["x", "2"]}], "+", 
             RowBox[{"9", " ", 
              SuperscriptBox["x", "3"]}], "-", 
             RowBox[{"12", " ", 
              SuperscriptBox["x", "4"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["x", "5"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "y", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "6"}], " ", "#1"}], "+", 
             RowBox[{"7", " ", "x", " ", "#1"}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["x", "2"], " ", "#1"}]}], ")"}]}]}], 
         RowBox[{"17", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "x"}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            SuperscriptBox["x", "3"]}], ")"}]}]], "]"}], " ", "#1"}]}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6711502887627845`*^9, 3.6711976424154663`*^9, 
  3.6930130023349*^9, 3.693061821291176*^9, 3.693156455069858*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["code", "Title",
 CellChangeTimes->{{3.685223046649054*^9, 3.6711923396089497`*^9}}],

Cell[CellGroupData[{

Cell["misc", "Section",
 CellChangeTimes->{{3.666103906054731*^9, 3.6661039100641203`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetTime", "[", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"abstime", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TimePrint", "[", "p___", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Pause", "[", "0.1", "]"}], ";"}], "*)"}], 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Sequence", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AbsoluteTime", "[", "]"}], "-", "abstime"}], ",", 
        "\"\<: \>\""}], "]"}], ",", "p"}], "]"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"assert", "[", 
    RowBox[{"a_", ",", "mes_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"TrueQ", "[", "a", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Print", "[", "mes", "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$Pre", "=", 
   RowBox[{
    RowBox[{"MemoryConstrained", "[", 
     RowBox[{"#", ",", "1000000"}], "]"}], "&"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6660371589380217`*^9, 3.666037207679686*^9}, {
   3.6661039252079363`*^9, 3.666103967038663*^9}, {3.686176657293991*^9, 
   3.686176729787421*^9}, {3.6861812614914637`*^9, 3.6861812777551537`*^9}, {
   3.686181422894067*^9, 3.686181426021585*^9}, {3.686411711501244*^9, 
   3.686411719739005*^9}, 3.687893242319457*^9, {3.693168385344282*^9, 
   3.6931683872688093`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["number fields", "Section",
 CellChangeTimes->{{3.66420892024028*^9, 3.579327658354533*^9}, {
  3.5811972809067497`*^9, 3.5811972825915527`*^9}}],

Cell["\<\
a field can be one of the following:
Null: just use plain root objects for elements
NF[0,f(\[Theta]),\[Theta],embed,{}]: finite extension of Q with embeddings \
list embed
NF[0,f(\[Theta]),\[Theta],embed,{a,b,c}]: finite extension of Q(a,b,c) with \
embeddings list embed
NF[p,f(\[Theta]),\[Theta]]: characteristic p with min poly f\
\>", "Text",
 CellChangeTimes->{{3.701509231894403*^9, 3.701509281341066*^9}, {
  3.70150931653323*^9, 3.7015094517813463`*^9}, {3.7015095352852287`*^9, 
  3.70150954069351*^9}, {3.701510117710137*^9, 3.701510156966069*^9}, {
  3.7015101945498734`*^9, 3.7015102072539186`*^9}, {3.701777725884602*^9, 
  3.7017777304366426`*^9}}],

Cell[CellGroupData[{

Cell["basics", "Subsection",
 CellChangeTimes->{{3.581197662062219*^9, 3.581197664729824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NumRecp", "[", 
    RowBox[{"a_", ",", "Null"}], "]"}], ":=", 
   RowBox[{"RootReduce", "[", 
    RowBox[{"1", "/", "a"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumRecp", "[", 
    RowBox[{"a_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"NumCollect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "&"}], "[", 
      RowBox[{"PolynomialExtendedGCD", "[", 
       RowBox[{"a", ",", 
        RowBox[{"nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"Modulus", "\[Rule]", 
         RowBox[{
         "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "]"}], "]"}], ",", "nf"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumCollect", "[", 
    RowBox[{"a_", ",", "Null"}], "]"}], ":=", 
   RowBox[{"RootReduce", "[", "a", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumCollect", "[", 
    RowBox[{"a_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"PolynomialRemainder", "[", 
      RowBox[{"a", ",", 
       RowBox[{"nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"Modulus", "\[Rule]", 
        RowBox[{
        "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
      "]"}], ",", 
     RowBox[{"nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", "Together"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumCard", "[", "nf_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===",
       "0"}], ",", "\[Infinity]", ",", 
     RowBox[{
      RowBox[{"nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "^", 
      RowBox[{"Exponent", "[", 
       RowBox[{
        RowBox[{"nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumFieldEmbedding", "[", 
    RowBox[{"ex_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"ex", "/.", 
     RowBox[{"nf", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
    ")"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.5811943525177813`*^9, 3.58119441548787*^9}, {
  3.5811948072134185`*^9, 3.5811948875535307`*^9}, {3.581199739932803*^9, 
  3.5811997412432055`*^9}, {3.666963722459198*^9, 3.666963769112756*^9}, {
  3.666964021850522*^9, 3.666964035115843*^9}, {3.667229392582357*^9, 
  3.6672293969297123`*^9}, {3.689548282813586*^9, 3.68954830304193*^9}, {
  3.689549251873446*^9, 3.673908367542104*^9}, {3.6766518772830334`*^9, 
  3.676651877829914*^9}, {3.6766519886135025`*^9, 3.6766520274576664`*^9}, {
  3.6766520688175697`*^9, 3.676652076427035*^9}, {3.676652411275275*^9, 
  3.671110713745491*^9}, {3.701508054436981*^9, 3.7015080618928013`*^9}, {
  3.7015090815501966`*^9, 3.70150909568575*^9}, {3.701509543270441*^9, 
  3.701509546212784*^9}, {3.701510191790691*^9, 3.701510215758346*^9}, {
  3.70151084878372*^9, 3.70151089699932*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["matrices", "Subsection",
 CellChangeTimes->{{3.581197655681808*^9, 3.581197659862615*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "produce", " ", "a", " ", "matrix", " ", "X", " ", "such", " ", "that", 
     " ", 
     RowBox[{"MM", ".", 
      RowBox[{"Transpose", "[", "X", "]"}]}]}], "=", "0"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NumNullSpace", "[", 
      RowBox[{"MM_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "=", "MM"}], ",", "m", ",", "n", ",", "j", ",", 
         RowBox[{"r", "=", "0"}], ",", "c", ",", "d", ",", "x", ",", 
         RowBox[{"res", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "M", "]"}]}], ";", "\n", "\t", 
        RowBox[{"c", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", "m"}], "]"}]}], ";", 
        RowBox[{"d", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"Do", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"j", "\[LessEqual]", "m"}], "&&", 
              RowBox[{"Not", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}], "=!=", 
                 "0"}], "&&", 
                RowBox[{
                 RowBox[{
                 "c", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                 "===", "0"}]}], "]"}]}], ",", 
             RowBox[{"j", "++"}]}], "]"}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", ">", "m"}], ",", 
             RowBox[{
              RowBox[{"r", "++"}], ";", 
              RowBox[{
               RowBox[{
               "d", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
               "=", "0"}]}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"x", "=", 
               RowBox[{"NumRecp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"M", "\[LeftDoubleBracket]", 
                   RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
                 "nf"}], "]"}]}], ";", 
              RowBox[{
               RowBox[{"M", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{"-", "1"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "s"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"NumCollect", "[", 
                  RowBox[{
                   RowBox[{"x", "*", 
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "s"}], "\[RightDoubleBracket]"}]}], ",",
                    "nf"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"s", ",", 
                  RowBox[{"k", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
              "\n", "\t\t\t", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "=!=", "j"}], ",", "\n", "\t\t\t\t", 
                  RowBox[{
                   RowBox[{"x", "=", 
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "=", 
                    "0"}], ";", "\n", "\t\t\t\t", 
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "s"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NumCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "s"}], "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"x", "*", 
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "s"}], "\[RightDoubleBracket]"}]}]}], 
                    ",", "nf"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"k", "+", "1"}], ",", "n"}], "}"}]}], "]"}], 
                   ";"}]}], "\n", "\t\t\t", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ";", "\n",
               "\t\t\t", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "=", "k"}], ";", 
              RowBox[{
               RowBox[{
               "d", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
               "=", "j"}], ";"}]}], "\n", "\t\t", "]"}], ";"}], "\n", "\t", 
          ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "d", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], "===",
              "0"}], ",", "\n", "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"res", ",", 
              RowBox[{"Table", "[", "\n", "\t\t\t", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "d", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ">", "0"}], ",", 
                  RowBox[{"M", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{
                    "d", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "k"}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"i", "===", "k"}], ",", "1", ",", "True", ",", 
                  "0"}], "]"}], "\n", "\t\t", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}],
            "\n", "\t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t",
         "res"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"adj", "[", "m_", "]"}], " ", ":=", " ", "\n", "    ", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", " ", 
        RowBox[{"Minors", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "m", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", "m", "]"}], " ", "-", " ", "1"}]}], "]"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1"}], "}"}]}], "]"}], " ", "*", " ", "\n", 
      "      ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"i", " ", "+", " ", "j"}], ")"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Length", "[", "m", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"Length", "[", "m", "]"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumMatrixInverse", "[", 
      RowBox[{"M_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NumCollect", "[", 
         RowBox[{"#", ",", "nf"}], "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{"adj", "[", "M", "]"}], "*", 
        RowBox[{"NumRecp", "[", 
         RowBox[{
          RowBox[{"NumCollect", "[", 
           RowBox[{
            RowBox[{"Det", "[", "M", "]"}], ",", "nf"}], "]"}], ",", "nf"}], 
         "]"}]}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n"}]}]], "Code",
 CellChangeTimes->{{3.5811976692070312`*^9, 3.581197681827454*^9}, 
   3.5812151628042507`*^9, {3.5812152072114058`*^9, 3.581215262714673*^9}, {
   3.581215303901801*^9, 3.5812154736586637`*^9}, {3.5812155061849203`*^9, 
   3.581215554275106*^9}, {3.581215597003258*^9, 3.5812157907329197`*^9}, {
   3.581215826861113*^9, 3.5812158386731815`*^9}, {3.581215881411336*^9, 
   3.581215900411363*^9}, {3.5812159568076315`*^9, 3.5812159800726633`*^9}, {
   3.581216020499861*^9, 3.581216022736865*^9}, {3.581216053368909*^9, 
   3.5812160712639346`*^9}, {3.5812162385262394`*^9, 
   3.5812162946344137`*^9}, {3.581216523052165*^9, 3.5812165426681943`*^9}, {
   3.581216595385271*^9, 3.581216610279293*^9}, {3.687604353686288*^9, 
   3.687604362365028*^9}, {3.687605743747699*^9, 3.6876057504589787`*^9}, {
   3.6876057870007143`*^9, 3.6876058238874283`*^9}, {3.687606021734311*^9, 
   3.68760602270717*^9}, {3.687607509350792*^9, 3.6765922222323284`*^9}, {
   3.693082082031877*^9, 3.693082082345502*^9}, {3.69308216025548*^9, 
   3.6930822504267387`*^9}, {3.6930827042874117`*^9, 3.69308272438934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"reduced", " ", "row", " ", "echlon", " ", "form"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"NumHermitianReduce", "[", 
     RowBox[{
      RowBox[{"m_", "?", "ArrayQ"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", "=", "m"}], ",", "ncols", ",", "nrows", ",", "min", ",", 
        "pv", ",", "new", ",", "q", ",", 
        RowBox[{"r", "=", "1"}]}], "}"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<called NumHermitianReduce: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "nf"}], "}"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nrows", ",", "ncols"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"r", ">", "nrows"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"find", " ", "pivot", " ", "at", " ", "row"}], " ", 
             "\[GreaterEqual]", " ", "r"}], ",", " ", 
            RowBox[{"if", " ", "there", " ", "is", " ", "no", " ", "pivot"}], 
            ",", " ", 
            RowBox[{
            "then", " ", "this", " ", "column", " ", "is", " ", "done"}]}], 
           " ", "*)"}], "\n", "\t\t", 
          RowBox[{"pv", "=", "0"}], ";", "\n", "\t\t", 
          RowBox[{"Do", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"M", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=!=", 
               "0"}], ",", 
              RowBox[{"pv", "=", "i"}]}], "]"}], "\n", "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "r", ",", "nrows"}], "}"}]}], "]"}], ";", "\n",
           "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"pv", "===", "0"}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "we", " ", "have", " ", "a", " ", "pivot", " ", "for", " ", "row", 
            " ", "r", " ", "and", " ", "column", " ", "j"}], " ", "*)"}], 
          "\n", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "move", " ", "the", " ", "pivot", " ", "to", " ", "row", " ", 
            "r"}], " ", "*)"}], "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"r", "=!=", "pv"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "M", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "M", "\[LeftDoubleBracket]", "pv", "\[RightDoubleBracket]"}]}],
               "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "M", "\[LeftDoubleBracket]", "pv", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "M", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}]}], 
              "}"}]}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{"make", " ", "it", " ", "monic"}], " ", "*)"}], "\n", 
          "\t\t", 
          RowBox[{
           RowBox[{
           "M", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NumCollect", "[", 
               RowBox[{"#", ",", "nf"}], "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{
              "M", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{"NumRecp", "[", 
               RowBox[{
                RowBox[{"M", "\[LeftDoubleBracket]", 
                 RowBox[{"r", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                "nf"}], "]"}]}]}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "reduce", " ", "the", " ", "entries", " ", "above", " ", "and", 
            " ", "below", " ", "the", " ", "pivot"}], " ", "*)"}], "\n", 
          "\t\t", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "=!=", "r"}], ",", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"q", "=", 
                RowBox[{"NumCollect", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                   RowBox[{"NumRecp", "[", 
                    RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "nf"}], "]"}]}], ",", "nf"}], "]"}]}], ";", "\n", 
               "\t\t\t", 
               RowBox[{
                RowBox[{
                "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"NumCollect", "[", 
                    RowBox[{"#", ",", "nf"}], "]"}], "&"}], ",", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}]}], "]"}]}], 
               ";"}]}], "\n", "\t\t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "nrows"}], "}"}]}], "]"}], ";", "\n",
           "\t\t", 
          RowBox[{"r", "++"}], ";"}], "\n", "\t\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<M: \>\"", ",", 
             RowBox[{"MatrixForm", "[", "M", "]"}]}], "]"}], ";", 
           RowBox[{"Pause", "[", "0.5", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "ncols"}], "}"}]}], "]"}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<NumHermitianReduce returning: \>\"", ",", "M"}], "]"}],
          ";"}], "*)"}], "\n", "\t", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Code",
 CellChangeTimes->{{3.702661261251664*^9, 3.7026613156295013`*^9}, {
  3.7026614185739307`*^9, 3.70266145877402*^9}, {3.702661504509845*^9, 
  3.702661553477756*^9}, {3.702661592062333*^9, 3.702661860765564*^9}, {
  3.702662040365981*^9, 3.70266207275047*^9}, {3.702662297894556*^9, 
  3.702662303205551*^9}, {3.7026634544342947`*^9, 3.702663455441759*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["reductions", "Subsection",
 CellChangeTimes->{{3.580343269045357*^9, 3.5803432713697615`*^9}, {
   3.666961492438476*^9, 3.666961493661289*^9}, 3.666961858485971*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumReduce", "[", 
    RowBox[{
     RowBox[{"NF", "[", 
      RowBox[{
      "p1_", ",", "m\[Theta]1_", ",", "\[Theta]1_", ",", "emb_", ",", 
       "tlist_"}], "]"}], ",", "p2_"}], "]"}], ":=", 
   RowBox[{"(", "\n", 
    RowBox[{
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"p1", "===", "0"}], ",", "\"\<char p1 bad in NumReduce\>\""}], 
      "]"}], ";", "\n", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"PrimeQ", "[", "p2", "]"}], ",", 
       "\"\<char p2 bad in NumReduce\>\""}], "]"}], ";", "\n", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"tlist", "===", 
        RowBox[{"{", "}"}]}], ",", "\"\<trans degree bad in NumReduce\>\""}], 
      "]"}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"Denominator", "[", 
            RowBox[{"CoefficientList", "[", 
             RowBox[{"m\[Theta]1", ",", "\[Theta]1"}], "]"}], "]"}], ",", 
           "p2"}], "]"}]}], "===", "0"}], ",", "$Failed", ",", "\n", "\t", 
       RowBox[{"NF", "[", 
        RowBox[{"p2", ",", 
         RowBox[{
          RowBox[{"FactorList", "[", 
           RowBox[{"m\[Theta]1", ",", 
            RowBox[{"Modulus", "\[Rule]", "p2"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         "\[Theta]1"}], "]"}]}], "\n", "]"}]}], ")"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.6669618845943127`*^9, 3.6669618910570393`*^9}, {
   3.6669619757297277`*^9, 3.666962082732975*^9}, {3.666967938188809*^9, 
   3.666967952531478*^9}, 3.666968000036336*^9, {3.667229844224443*^9, 
   3.667229844599696*^9}, {3.667230222352377*^9, 3.667230222504373*^9}, {
   3.6711176889437046`*^9, 3.671117690178093*^9}, {3.6930094474780903`*^9, 
   3.6930094771934433`*^9}, {3.693010014847918*^9, 3.693010132549334*^9}, {
   3.701782627066749*^9, 3.701782732474759*^9}, {3.701784663908491*^9, 
   3.701784685428548*^9}, 3.7017847761322737`*^9, {3.701784875622403*^9, 
   3.701784876003274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumExtReduce", "[", 
   RowBox[{"X_", ",", "nf\[Phi]_", ",", "nf\[Theta]_", ",", "ext_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Theta]", ",", "\[Theta]d", ",", "\[Phi]", ",", "\[Phi]d", ",", "M"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]", "=", 
      RowBox[{
      "nf\[Theta]", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{
      "nf\[Phi]", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]d", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{
        RowBox[{
        "nf\[Theta]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "\[Theta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]d", "=", 
      RowBox[{"Exponent", "[", 
       RowBox[{
        RowBox[{
        "nf\[Phi]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "\[Phi]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{"CoefficientList", "[", 
        RowBox[{
         RowBox[{"NumCollect", "[", 
          RowBox[{"X", ",", "nf\[Phi]"}], "]"}], ",", "\[Phi]", ",", 
         "\[Phi]d"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"M", ",", 
         RowBox[{"CoefficientList", "[", 
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "===", "0"}], ",", "1", ",", 
               RowBox[{
                RowBox[{"ext", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "^", 
                "i"}]}], "]"}], ",", "nf\[Phi]"}], "]"}], ",", "\[Phi]", ",", 
           "\[Phi]d"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"\[Theta]d", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"NullSpace", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "M", "]"}], ",", 
         RowBox[{"ZeroTest", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"PossibleZeroQ", "[", 
             RowBox[{"Simplify", "[", "#", "]"}], "]"}], "&"}], ")"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "M", "]"}], "\[LessEqual]", "1"}], ",", 
       "\"\<Length[M] in NumExtReduce\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "M", "]"}], "===", "0"}], ",", "$Failed", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=!=", "0"}], 
          ",", "\"\<M\[LeftDoubleBracket]1,1\[RightDoubleBracket]=0 in \
NumExtReduce\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"NumCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"M", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"2", ";;", 
                RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], ".", 
             RowBox[{"\[Theta]", "^", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"\[Theta]d", "-", "1"}]}], "]"}]}]}]}], "/", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
          "nf\[Theta]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.702632195660774*^9, 3.702632212603938*^9}, {
  3.7026326529725857`*^9, 3.7026326786849003`*^9}, {3.7026328416209507`*^9, 
  3.702632990989373*^9}, {3.702633156317581*^9, 3.702633170237352*^9}, {
  3.7026332057097692`*^9, 3.70263333811832*^9}, {3.7026333942476597`*^9, 
  3.702633678095276*^9}, {3.702634465367826*^9, 3.702634497351934*^9}, {
  3.702637932476511*^9, 3.702637938619999*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NFReduce", "[", 
     RowBox[{"X_", ",", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "mx_", ",", "cex_"}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "my_", ",", "cey_"}], "]"}], ",", "rmat_", ",", 
        "nmat_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xd", ",", "yd", ",", "XL"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"assert", "[", 
        RowBox[{"False", ",", "\"\<obsolete fxn NFReduce\>\""}], "]"}], ";", 
       "\n", "\t", 
       RowBox[{"xd", "=", 
        RowBox[{"Exponent", "[", 
         RowBox[{"mx", ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"yd", "=", 
        RowBox[{"Exponent", "[", 
         RowBox[{"my", ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"XL", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{"X", ",", "\[Theta]"}], "]"}], ",", "xd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "XL", "]"}], "===", 
         RowBox[{"{", "xd", "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\t", 
       
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "rmat", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"yd", ",", "xd"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"xd", "===", "yd"}], "||", 
         RowBox[{
          RowBox[{"Dimensions", "[", "nmat", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xd", "-", "yd"}], ",", "xd"}], "}"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"yd", "<", "xd"}], "&&", 
          RowBox[{"Not", "[", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"nmat", ".", "XL"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", "..."}], "}"}]}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<internal error in NFReduce: \>\"", ",", "X", ",", 
            "\"\< : \>\"", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "mx"}], "]"}], ",", 
            "\"\< is not in number field \>\"", ",", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", "my"}], "]"}]}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rmat", ".", "XL"}], ")"}], ".", 
        RowBox[{"\[Theta]", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"yd", "-", "1"}]}], "]"}]}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeRedInfo", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M", ",", "xd", ",", "yd", ",", "mx", ",", "my"}], "}"}], ",", 
     "\n", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{"False", ",", "\"\<obsolete fxn MakeRedInfo\>\""}], "]"}], ";",
       "\n", "\t", 
      RowBox[{"mx", "=", 
       RowBox[{"MinimalPolynomial", "[", 
        RowBox[{"x", ",", "\[Theta]"}], "]"}]}], ";", 
      RowBox[{"xd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"mx", ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"my", "=", 
       RowBox[{"MinimalPolynomial", "[", 
        RowBox[{"y", ",", "\[Theta]"}], "]"}]}], ";", 
      RowBox[{"yd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"my", ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"M", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToNumberField", "[", 
             RowBox[{
              RowBox[{"y", "^", "i"}], ",", "x"}], "]"}], 
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"yd", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"xd", "-", "1"}]}], "]"}], ",", "1"}], "]"}]}], "]"}]}], 
      ";", "\n", "\t", 
      RowBox[{"M", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "[", "M", "]"}], ",", 
           RowBox[{"IdentityMatrix", "[", "xd", "]"}]}], "}"}], "}"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"RowReduce", "[", "M", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"-", "xd"}], ";;", 
          RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"RedInfo", "[", 
       RowBox[{
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "mx", ",", "x"}], "]"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "my", ",", "y"}], "]"}], ",", 
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "yd"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"M", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"yd", "+", "1"}], ";;", "xd"}], "\[RightDoubleBracket]"}]}],
        "]"}]}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6672312878986187`*^9, 3.667231291785109*^9}, {
   3.6766529615339966`*^9, 3.6766529986906195`*^9}, {3.7017827582838984`*^9, 
   3.701782777221912*^9}, 3.7017828171484413`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PowerfreePart", "[", 
    RowBox[{"n_", ",", "mod_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sign", "[", "n", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"Times", "@@", 
      RowBox[{"Power", "@@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", "mod"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"FactorInteger", "[", 
          RowBox[{"Abs", "[", "n", "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.6672492187153587`*^9, 3.667249221164111*^9}, {
   3.667311485446859*^9, 3.667311489886829*^9}, 3.6673330923379383`*^9, 
   3.701782836482501*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"given", " ", "X", " ", "in", " ", "K", "\n", "\t", "return", " ", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "l2"}], "}"}], "\n", "\t", "where", " ", "every", 
     " ", "solution", " ", "to", " ", 
     SubscriptBox["Norm", 
      RowBox[{"L", "/", "K"}]], 
     RowBox[{"(", "Y", ")"}]}], "=", 
    RowBox[{
    "X", " ", "can", " ", "be", " ", "obtaine", " ", "as", "\n", "\t", "a", 
     " ", "element", " ", "of", " ", "l1", " ", "times", " ", "products", " ",
      "of", " ", "powers", " ", "of", " ", "elements", " ", "of", " ", 
     "l2"}]}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{"NumNormReps", "[", 
    RowBox[{"X_", ",", "L_", ",", "K_", ",", "LKMP_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]i", ",", 
       RowBox[{"xK", "=", "X"}], ",", "xKQnorm", ",", 
       RowBox[{"reps", "=", 
        RowBox[{"{", "}"}]}], ",", "reps1", ",", "unityroots", ",", "units", 
       ",", "yL", ",", "yLKnorm", ",", "LKmp", ",", "\[Phi]", ",", "n", ",", 
       "m", ",", "num", ",", "rest"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"LKmp", "=", 
       RowBox[{"LKMP", "/.", 
        RowBox[{"#", "\[Rule]", "\[Phi]"}]}]}], ";", "\n", "\t", 
      RowBox[{"n", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"LKmp", ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"xKQnorm", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PadRight", "[", 
            RowBox[{
             RowBox[{"CoefficientList", "[", 
              RowBox[{
               RowBox[{"NumCollect", "[", 
                RowBox[{
                 RowBox[{"xK", "*", "#"}], ",", "K"}], "]"}], ",", 
               "\[Theta]"}], "]"}], ",", 
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{
               "K", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", "\[Theta]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"\[Theta]", "^", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{
                RowBox[{
                "K", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", "\[Theta]"}], "]"}], "-", "1"}]}], "]"}]}]}], "]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"\[Theta]i", "=", 
       RowBox[{"Root", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
            "L", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"\[Theta]", "\[Rule]", "#"}]}], "]"}], "&"}], ",", "1"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"m", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{"L", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"num", "=", 
       RowBox[{"PowerfreePart", "[", 
        RowBox[{"xKQnorm", ",", "m"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"rest", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xKQnorm", "/", "num"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "m"}], ")"}]}]}], ";", "\n", "\t", 
      RowBox[{"reps1", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AlgebraicNumberPolynomial", "[", 
           RowBox[{
            RowBox[{"rest", "*", "#"}], ",", "\[Theta]"}], "]"}], "&"}], ",", 
         
         RowBox[{"NumberFieldNormRepresentatives", "[", 
          RowBox[{"\[Theta]i", ",", "num"}], "]"}]}], "]"}]}], ";", "\n", 
      "\n", "\t", 
      RowBox[{"unityroots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AlgebraicNumberPolynomial", "[", 
           RowBox[{"#", ",", "\[Theta]"}], "]"}], "&"}], ",", 
         RowBox[{"NumberFieldRootsOfUnity", "[", "\[Theta]i", "]"}]}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"units", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AlgebraicNumberPolynomial", "[", 
           RowBox[{"#", ",", "\[Theta]"}], "]"}], "&"}], ",", 
         RowBox[{"NumberFieldFundamentalUnits", "[", "\[Theta]i", "]"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"(*", "\n", "\t", 
       RowBox[{
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "\n", "\t\t", 
            RowBox[{
             RowBox[{"yL", "=", "#"}], ";", "\n", "\t\t", 
             RowBox[{"yLKnorm", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"PadRight", "[", 
                  RowBox[{
                   RowBox[{"CoefficientList", "[", 
                    RowBox[{
                    RowBox[{"PolynomialRemainder", "[", 
                    RowBox[{
                    RowBox[{"yL", "*", "#"}], ",", "LKmp", ",", "\[Theta]"}], 
                    "]"}], ",", "\[Theta]"}], "]"}], ",", "n"}], "]"}], "&"}],
                 ",", 
                RowBox[{"\[Theta]", "^", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}]}]}], "]"}]}], ";", "\n", 
             "\t\t", 
             RowBox[{"yLKnorm", "=", 
              RowBox[{"NumCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Det", "[", "yLKnorm", "]"}], "/.", 
                 RowBox[{"\[Phi]", "\[Rule]", "\[Theta]"}]}], ",", "K"}], 
               "]"}]}], ";", "\n", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NumCollect", "[", 
                 RowBox[{
                  RowBox[{"yLKnorm", "-", "xK"}], ",", "K"}], "]"}], "===", 
                "0"}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"reps", ",", "yL"}], "]"}]}], "]"}], ";"}], "\n", 
            "\t", ")"}], "&"}], ",", "reps1"}], "]"}], ";"}], "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<exiting NumNormReps: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"reps1", ",", "unityroots", ",", "units"}], "}"}]}], "]"}],
         ";"}], "*)"}], "\n", "\n", "\t", 
      RowBox[{"reps", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Outer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{"#1", "*", "#2"}], ",", "L"}], "]"}], "&"}], ",", 
          "reps1", ",", "unityroots"}], "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"reps", ",", "units"}], "}"}]}]}], "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.667237909851329*^9, 3.667237915265711*^9}, {
   3.667238050681752*^9, 3.667238065845944*^9}, {3.667238430701605*^9, 
   3.667238575596506*^9}, 3.6672386111076593`*^9, {3.667238765743615*^9, 
   3.667238830254795*^9}, {3.667240987556305*^9, 3.667240994126141*^9}, {
   3.6672410304872503`*^9, 3.667241030665011*^9}, {3.66724109703148*^9, 
   3.667241104399864*^9}, {3.6672411370783997`*^9, 3.6672412163682756`*^9}, {
   3.6672413368487186`*^9, 3.667241341448655*^9}, {3.66724206127315*^9, 
   3.667242139758026*^9}, {3.667242214541254*^9, 3.667242219477467*^9}, {
   3.667242268124404*^9, 3.6672423360516233`*^9}, {3.6672424838787413`*^9, 
   3.6672425444708776`*^9}, {3.667242591564295*^9, 3.6672426649396477`*^9}, {
   3.667242697457511*^9, 3.667242706401469*^9}, {3.667242786180381*^9, 
   3.667242810711113*^9}, {3.6672428483200283`*^9, 3.667242970769136*^9}, 
   3.667243039486438*^9, {3.667243088624854*^9, 3.667243091162158*^9}, {
   3.6672431924710627`*^9, 3.6672433406413927`*^9}, {3.667243422052968*^9, 
   3.667243453333054*^9}, {3.667243907284012*^9, 3.667243929511067*^9}, {
   3.66724720961578*^9, 3.6672472370111437`*^9}, {3.667247305595806*^9, 
   3.6672473219612627`*^9}, {3.667247406742364*^9, 3.66724742927665*^9}, {
   3.66724746899209*^9, 3.667247591428935*^9}, {3.667247818397805*^9, 
   3.667247850205208*^9}, {3.667247986972911*^9, 3.667248056106894*^9}, {
   3.667248091953404*^9, 3.667248124315976*^9}, {3.667248172636179*^9, 
   3.667248193668878*^9}, {3.667248247917117*^9, 3.667248260758051*^9}, {
   3.667248349350358*^9, 3.6672483927521143`*^9}, {3.667248478337653*^9, 
   3.667248478410502*^9}, {3.667248524711816*^9, 3.667248534550913*^9}, {
   3.667248623993738*^9, 3.667248705869341*^9}, {3.667248797746286*^9, 
   3.6672488217578783`*^9}, {3.667249215630906*^9, 3.667249297752152*^9}, {
   3.667249332246784*^9, 3.6672493568777313`*^9}, {3.667249471996709*^9, 
   3.667249474375971*^9}, {3.667313970106566*^9, 3.667313992528357*^9}, {
   3.667314025515551*^9, 3.667314088210017*^9}, {3.6673141496598473`*^9, 
   3.6673141813000727`*^9}, {3.667314314233199*^9, 3.667314318605404*^9}, {
   3.667315466921159*^9, 3.667315472147541*^9}, {3.667315502190875*^9, 
   3.667315504617992*^9}, 3.667315564345797*^9, {3.667316284360922*^9, 
   3.6673163137388678`*^9}, {3.667334354909274*^9, 3.6673344275435867`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["extensions", "Subsection",
 CellChangeTimes->{{3.5811976497537975`*^9, 3.5811976531546035`*^9}, {
  3.666960033806106*^9, 3.666960037907991*^9}, {3.6711962106426334`*^9, 
  3.671196212923914*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "an", " ", "extension", " ", "of", " ", "nf", " ", "to", 
    " ", "nf1", 
    RowBox[{"(", 
     RowBox[{"in", " ", "\[Phi]"}], ")"}], " ", "so", " ", "that", " ", 
    "poly", 
    RowBox[{"(", "x", ")"}], " ", "has", " ", "a", " ", "root", " ", "in", 
    " ", "nf1"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NumExtendRoot", "[", 
      RowBox[{"poly_", ",", "x_", ",", "nf_", ",", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "f", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{
          RowBox[{"PolyFactor", "[", 
           RowBox[{"poly", ",", "x", ",", "nf"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"NumExtendRootIrr", "[", 
         RowBox[{"f", ",", "x", ",", "nf", ",", "\[Phi]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "poly", " ", "should", " ", "be", " ", "irreducible", " ", "over", " ", 
     "nf"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumExtendRootIrr", "[", 
      RowBox[{"poly_", ",", "x_", ",", "nf_", ",", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "norm", ",", 
         RowBox[{"f", "=", "poly"}], ",", "nf1", ",", "alpha"}], "}"}], ",", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"PolyFactor", "[", 
             RowBox[{"poly", ",", "x", ",", "nf"}], "]"}], "]"}], "===", 
           "1"}], ",", "\"\<reducible poly in NumExtendRootIrr\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"s", "=", "0"}], ";", 
        RowBox[{"While", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"norm", "=", 
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{"Resultant", "[", 
               RowBox[{
                RowBox[{"f", "/.", 
                 RowBox[{"{", 
                  RowBox[{"x", "\[Rule]", 
                   RowBox[{"x", "+", 
                    RowBox[{"s", "*", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{"Resultant", "[", 
               RowBox[{"norm", ",", 
                RowBox[{"PolyD", "[", 
                 RowBox[{"norm", ",", "x", ",", "nf"}], "]"}], ",", "x"}], 
               "]"}], ",", "nf"}], "]"}], "===", "0"}]}], ",", 
          RowBox[{"s", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"s", ">", "0"}], ",", 
             RowBox[{"-", "s"}], ",", 
             RowBox[{"1", "-", "s"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";", 
        "\n", "\t", 
        RowBox[{"nf1", "=", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", 
           RowBox[{"norm", "/.", 
            RowBox[{"x", "\[Rule]", "\[Phi]"}]}], ",", "\[Phi]", ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"alpha", "=", 
         RowBox[{"PolyGCD", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"f", "/.", 
              RowBox[{"{", 
               RowBox[{"x", "\[Rule]", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"s", "*", 
                  RowBox[{
                  "nf", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", "nf"}], "]"}], ",", 
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           "nf1"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"alpha", ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "]"}], "===", "1"}], ",", 
          "\"\<alpha has bad degree in NumExtendRoot\>\""}], "]"}], ";", "\n",
         "\t", 
        RowBox[{"alpha", "=", 
         RowBox[{"NumCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Coefficient", "[", 
              RowBox[{"alpha", ",", 
               RowBox[{
               "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}], "*", 
            RowBox[{"NumRecp", "[", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{"alpha", ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", "1"}], "]"}], ",", "nf1"}], "]"}]}], ",", "nf1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"return", " ", "nf1"}], ",", " ", 
          RowBox[{"a", " ", "root", " ", "of", " ", "poly"}], ",", " ", 
          RowBox[{"and", " ", "some", " ", "extension", " ", "data"}]}], " ", 
         "*)"}], "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"nf1", ",", 
          RowBox[{"NumCollect", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "+", 
             RowBox[{"s", "*", "alpha"}]}], ",", "nf1"}], "]"}], ",", 
          RowBox[{"NFExt", "[", 
           RowBox[{
            RowBox[{
            "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "\[Rule]", "alpha"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "poly", " ", "should", " ", "be", " ", "irreducible", " ", "over", " ", 
     "nf"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NumExtendRootIrrExt", "[", 
      RowBox[{"poly_", ",", "x_", ",", "nf_", ",", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "norm", ",", 
         RowBox[{"f", "=", "poly"}], ",", "nf1", ",", "alpha"}], "}"}], ",", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"PolyFactor", "[", 
             RowBox[{"poly", ",", "x", ",", "nf"}], "]"}], "]"}], "===", 
           "1"}], ",", "\"\<reducible poly in NumExtendRootIrrExt\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"s", "=", "0"}], ";", 
        RowBox[{"While", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"norm", "=", 
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{"Resultant", "[", 
               RowBox[{
                RowBox[{"f", "/.", 
                 RowBox[{"{", 
                  RowBox[{"x", "\[Rule]", 
                   RowBox[{"x", "+", 
                    RowBox[{"s", "*", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{"Resultant", "[", 
               RowBox[{"norm", ",", 
                RowBox[{"PolyD", "[", 
                 RowBox[{"norm", ",", "x", ",", "nf"}], "]"}], ",", "x"}], 
               "]"}], ",", "nf"}], "]"}], "===", "0"}]}], ",", 
          RowBox[{"s", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"s", ">", "0"}], ",", 
             RowBox[{"-", "s"}], ",", 
             RowBox[{"1", "-", "s"}]}], "]"}]}]}], "\n", "\t\t", "]"}], ";", 
        "\n", "\t", 
        RowBox[{"nf1", "=", 
         RowBox[{"NF", "[", 
          RowBox[{"0", ",", 
           RowBox[{"norm", "/.", 
            RowBox[{"x", "\[Rule]", "\[Phi]"}]}], ",", "\[Phi]", ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"alpha", "=", 
         RowBox[{"PolyGCD", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"f", "/.", 
              RowBox[{"{", 
               RowBox[{"x", "\[Rule]", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"s", "*", 
                  RowBox[{
                  "nf", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", "nf"}], "]"}], ",", 
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           "nf1"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"alpha", ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "]"}], "===", "1"}], ",", 
          "\"\<alpha has bad degree in NumExtendRoot\>\""}], "]"}], ";", "\n",
         "\t", 
        RowBox[{"alpha", "=", 
         RowBox[{"NumCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Coefficient", "[", 
              RowBox[{"alpha", ",", 
               RowBox[{
               "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", "0"}], "]"}]}], "*", 
            RowBox[{"NumRecp", "[", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{"alpha", ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", "1"}], "]"}], ",", "nf1"}], "]"}]}], ",", "nf1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"return", " ", "nf1"}], ",", " ", 
          RowBox[{"a", " ", "root", " ", "of", " ", "poly"}], ",", " ", 
          RowBox[{"and", " ", "some", " ", "extension", " ", "data"}]}], " ", 
         "*)"}], "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"nf1", ",", 
          RowBox[{"NumCollect", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "+", 
             RowBox[{"s", "*", "alpha"}]}], ",", "nf1"}], "]"}], ",", 
          RowBox[{"NFExt", "[", 
           RowBox[{
            RowBox[{
            "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "\[Rule]", "alpha"}], "]"}], ",", 
          RowBox[{"x", "-", 
           RowBox[{"s", "*", 
            RowBox[{
            "nf", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}]}]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.701510280395548*^9, 3.701510507934602*^9}, 
   3.70151247354473*^9, {3.7015126149077883`*^9, 3.701512627513266*^9}, {
   3.7015129187935753`*^9, 3.7015130250180063`*^9}, {3.701513216217682*^9, 
   3.701513296866335*^9}, {3.70151347065024*^9, 3.7015134864503727`*^9}, {
   3.701513673618984*^9, 3.70151367417899*^9}, {3.7015138616488457`*^9, 
   3.701513862176683*^9}, {3.701513985778473*^9, 3.70151405659263*^9}, {
   3.701514322127537*^9, 3.701514379520327*^9}, {3.701514443722649*^9, 
   3.701514510362143*^9}, {3.701514555706704*^9, 3.701514769661996*^9}, {
   3.7015150936190643`*^9, 3.701515093978351*^9}, {3.70151526243892*^9, 
   3.701515270631768*^9}, {3.70151530489443*^9, 3.701515316669928*^9}, {
   3.701515348302455*^9, 3.7015153496067343`*^9}, {3.7015154678720293`*^9, 
   3.7015154959216833`*^9}, {3.701515539944416*^9, 3.701515545185582*^9}, {
   3.701515714595934*^9, 3.701515721604372*^9}, {3.701515816421842*^9, 
   3.701515816741589*^9}, {3.7015159529436693`*^9, 3.701515964479467*^9}, {
   3.701516004902631*^9, 3.701516025615447*^9}, {3.701517397444086*^9, 
   3.70151745529394*^9}, {3.701518543729123*^9, 3.701518547545526*^9}, {
   3.701519417896536*^9, 3.701519427688457*^9}, {3.701519550408269*^9, 
   3.701519624731661*^9}, {3.701522147951324*^9, 3.701522158111907*^9}, {
   3.701522532423526*^9, 3.701522548854561*^9}, {3.702667449945632*^9, 
   3.7026674608017673`*^9}, {3.702667491250456*^9, 3.702667509629402*^9}, {
   3.7026682699033537`*^9, 3.7026683475878*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ddupp", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "n_Integer"}], "}"}], "]"}], ":=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"x", ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "an", " ", "extension", " ", "of", " ", "nf", " ", "to", 
    " ", "nf1", 
    RowBox[{"(", 
     RowBox[{"in", " ", "\[Phi]"}], ")"}], " ", "so", " ", "that", " ", 
    "poly", 
    RowBox[{"(", "x", ")"}], " ", "factors", " ", "completely", " ", "in", 
    " ", "nf1"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumExtendSplit", "[", 
     RowBox[{"poly_", ",", "x_", ",", "nf_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "oldnf", ",", "newnf", ",", "nf1", ",", "ext", ",", "fl", ",", "flh", 
        ",", "tryAgain", ",", "\[Psi]", ",", "newext", ",", "root"}], "}"}], 
      ",", "\n", "\t", 
      RowBox[{
       RowBox[{"fl", "=", 
        RowBox[{"{", 
         RowBox[{"poly", "/.", 
          RowBox[{
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[Rule]", "\[Phi]"}]}], "}"}]}], ";", "\n", "\t", 
       RowBox[{"nf1", "=", 
        RowBox[{"nf", "/.", 
         RowBox[{
          RowBox[{
          "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[Rule]", "\[Phi]"}]}]}], ";", "\n", "\t", 
       RowBox[{"ext", "=", 
        RowBox[{"NFExt", "[", 
         RowBox[{
          RowBox[{
          "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[Rule]", "\[Phi]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Label", "[", "tryAgain", "]"}], ";", "\n", "\t", 
       RowBox[{"fl", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ddupp", "/@", 
              RowBox[{"PolyFactor", "[", 
               RowBox[{"#", ",", "x", ",", "nf1"}], "]"}]}], ")"}], "&"}], 
           ",", "fl"}], "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"fl", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"fl", ",", 
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"#", ",", "x"}], "]"}], "&"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"flh", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"fl", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"#", ",", "x"}], "]"}], ">", "1"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flh", "=!=", 
          RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"newnf", ",", "root", ",", "newext"}], "}"}], "=", 
           RowBox[{"NumExtendRootIrr", "[", 
            RowBox[{
             RowBox[{
             "flh", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "x", ",", "nf1", ",", "\[Psi]"}], "]"}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"fl", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyCollect", "[", 
                 RowBox[{
                  RowBox[{"#", "/.", 
                   RowBox[{
                   "newext", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", "newnf"}], 
                 "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ")"}], 
              "&"}], ",", "fl"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"nf1", "=", 
           RowBox[{"newnf", "/.", 
            RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}]}]}], ";", "\n", "\t\t", 
          RowBox[{
           RowBox[{"ext", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ext", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
                RowBox[{
                "newext", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ",", "nf1"}],
             "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"Goto", "[", "tryAgain", "]"}]}]}], "\n", "\t", "]"}], ";", 
       "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"nf1", ",", "\n", "\t", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Coefficient", "[", 
                 RowBox[{"#", ",", "x", ",", "0"}], "]"}]}], "*", 
               RowBox[{"NumRecp", "[", 
                RowBox[{
                 RowBox[{"Coefficient", "[", 
                  RowBox[{"#", ",", "x", ",", "1"}], "]"}], ",", "nf1"}], 
                "]"}]}], ",", "nf1"}], "]"}], "&"}], ",", "fl"}], "]"}], ",", 
         "\n", "\t", "ext"}], "\n", "\t", "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "an", " ", "extension", " ", "of", " ", "nf", " ", "to", 
    " ", "nf1", 
    RowBox[{"(", 
     RowBox[{"in", " ", "\[Phi]"}], ")"}], " ", "so", " ", "that", " ", 
    "poly", 
    RowBox[{"(", "x", ")"}], " ", "factors", " ", "completely", " ", "in", 
    " ", "nf1"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumExtendSplitList", "[", 
    RowBox[{"polyl_List", ",", "x_", ",", "nf_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldnf", ",", "newnf", ",", "nf1", ",", "ext", ",", "fl", ",", "flh", 
       ",", "tryAgain", ",", "\[Psi]", ",", "newext", ",", "root"}], "}"}], 
     ",", "\n", "\t", 
     RowBox[{
      RowBox[{"fl", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", "/.", 
            RowBox[{
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[Rule]", "\[Phi]"}]}], "}"}], "&"}], ",", "polyl"}], "]"}]}], 
      ";", "\n", "\t", 
      RowBox[{"nf1", "=", 
       RowBox[{"nf", "/.", 
        RowBox[{
         RowBox[{"nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          "\[Rule]", "\[Phi]"}]}]}], ";", "\n", "\t", 
      RowBox[{"ext", "=", 
       RowBox[{"NFExt", "[", 
        RowBox[{
         RowBox[{"nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          "\[Rule]", "\[Phi]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Label", "[", "tryAgain", "]"}], ";", "\n", "\t", 
      RowBox[{"fl", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ddupp", "/@", 
            RowBox[{"PolyFactor", "[", 
             RowBox[{"#", ",", "x", ",", "nf1"}], "]"}]}], ")"}], "&"}], ",", 
         "fl", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"fl", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Flatten", ",", "fl"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"flh", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "fl", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "x"}], "]"}], ">", "1"}], "&"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"#", ",", "x"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flh", "=!=", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"newnf", ",", "root", ",", "newext"}], "}"}], "=", 
          RowBox[{"NumExtendRootIrr", "[", 
           RowBox[{
            RowBox[{
            "flh", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", "x", ",", "nf1", ",", "\[Psi]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"fl", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{"#", "/.", 
                  RowBox[{
                  "newext", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "x", ",", "newnf"}], 
                "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ")"}], 
             "&"}], ",", "fl", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"nf1", "=", 
          RowBox[{"newnf", "/.", 
           RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}]}]}], ";", "\n", "\t\t", 
         RowBox[{
          RowBox[{"ext", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"NumCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ext", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
               RowBox[{
               "newext", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ",", "nf1"}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Goto", "[", "tryAgain", "]"}]}]}], "\n", "\t", "]"}], ";", 
      "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"nf1", ",", "\n", "\t", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Coefficient", "[", 
                RowBox[{"#", ",", "x", ",", "0"}], "]"}]}], "*", 
              RowBox[{"NumRecp", "[", 
               RowBox[{
                RowBox[{"Coefficient", "[", 
                 RowBox[{"#", ",", "x", ",", "1"}], "]"}], ",", "nf1"}], 
               "]"}]}], ",", "nf1"}], "]"}], "&"}], ",", "fl", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", "\n", "\t", "ext"}], "\n", 
       "\t", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJwdzE0ow3EAxvFZykqozUYNY1IjLzNzYWmWouRtLg42WjRxMNLIHHDawVuL
/gfL2zI7eMma7OBlLZOaNIyUt9TStBxWykY2/+d3ePpcnr55mkFlL5PBYAjp
Qfs5s5S9GKq1LlASyOI7tem04fczouVBu8Kl9d9NENkW2yZ054tscDv4vgfN
ixoHTO0THcNm+xcxHkxyw0dV1xNc55iDUPbpisIeEycG+9o20ni0QmMCF/YL
dDxodEmz4HT3UB4MjghKIbtETfQnX0ngxdZwJRyOxGXQ+loth2tGqh1Ori4M
wB7BsgGGmdQc/DPN7sOIVHRI+vNNx1DaoTiBo7s6L/Qpx4gd1/p7GBBOEHOU
46YM2iOej+g2xCl4xYhtwaJCa1km7XnUJIb3iQqWnNbxnZMC9TPFHFhTF8og
Vjzzofn6MxtORW8LoC07XAVVByIFrE3REFN/P+phpye5Af68PrbAgNjeCk89
rB1IpeXayf+73An3fiUeqH578ELWkv4SNscMN/ClMcEP/wEoTQv5
  "]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NumExtendSplit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "^", "2"}], "+", "a"}], ",", "x", ",", "k", ",", "\[Phi]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.701519489087184*^9, 3.701519533358399*^9}, {
   3.701519700603675*^9, 3.701519753948513*^9}, {3.701519816402483*^9, 
   3.7015198650549717`*^9}, 3.701520064266502*^9, {3.701705484333362*^9, 
   3.701705485093508*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"a", "+", 
      SuperscriptBox["\[Phi]", "2"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"-", "\[Phi]"}]}], "}"}], ",", 
   RowBox[{"NFExt", "[", 
    RowBox[{"\[Theta]", "\[Rule]", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7015195358736897`*^9, 3.701519597288348*^9, 3.701519632608417*^9, {
   3.701519702413015*^9, 3.701519731681036*^9}, {3.701519806207108*^9, 
   3.70151983596647*^9}, 3.701519878152329*^9, 3.7015199373604116`*^9, {
   3.70151997106925*^9, 3.701520017632373*^9}, {3.7015200554363203`*^9, 
   3.70152006473849*^9}, 3.701521780835835*^9, 3.701522073364307*^9, 
   3.7015221613802834`*^9, 3.701522448182609*^9, 3.70152255370128*^9, 
   3.701522826025235*^9, 3.701705485486871*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumExtendSplit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "3"}], "+", 
     RowBox[{"a", " ", "x"}], "+", "b"}], ",", "x", ",", "k", ",", "\[Phi]"}],
    "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{
  3.701520213177265*^9, {3.701521195651883*^9, 3.701521203200294*^9}, {
   3.701522200489575*^9, 3.701522204998436*^9}, {3.701522692455254*^9, 
   3.701522695899952*^9}, {3.701523617171608*^9, 3.701523620761736*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`\[Phi], $CellContext`\[Phi], {}, {$CellContext`a, \
$CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7015202136751738`*^9, 3.701521204558372*^9, 3.701521234720209*^9, 
   3.7015217847750797`*^9, 3.701521867940742*^9, {3.701522050521577*^9, 
   3.701522076789465*^9}, 3.701522166068581*^9, {3.701522205645238*^9, 
   3.7015222246863823`*^9}, {3.701522319848587*^9, 3.701522347991729*^9}, {
   3.701522450240583*^9, 3.701522472031124*^9}, {3.701522555735601*^9, 
   3.701522583028296*^9}, 3.701522696408505*^9, 3.701522828954035*^9, 
   3.701523622536446*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"b", "+", 
      RowBox[{"a", " ", "\[Phi]"}], "+", 
      SuperscriptBox["\[Phi]", "3"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`b + $CellContext`a $CellContext`\[Phi] + $CellContext`\
\[Phi]^3, $CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7015202136751738`*^9, 3.701521204558372*^9, 3.701521234720209*^9, 
   3.7015217847750797`*^9, 3.701521867940742*^9, {3.701522050521577*^9, 
   3.701522076789465*^9}, 3.701522166068581*^9, {3.701522205645238*^9, 
   3.7015222246863823`*^9}, {3.701522319848587*^9, 3.701522347991729*^9}, {
   3.701522450240583*^9, 3.701522472031124*^9}, {3.701522555735601*^9, 
   3.701522583028296*^9}, 3.701522696408505*^9, 3.701522828954035*^9, 
   3.7015236225382843`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["a", "3"]}], "+", 
      RowBox[{"27", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["\[Phi]", "2"]}], "+", 
      RowBox[{"6", " ", "a", " ", 
       SuperscriptBox["\[Phi]", "4"]}], "+", 
      SuperscriptBox["\[Phi]", "6"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, 4 $CellContext`a^3 + 
    27 $CellContext`b^2 + (9 $CellContext`a^2) $CellContext`\[Phi]^2 + (
      6 $CellContext`a) $CellContext`\[Phi]^4 + $CellContext`\[Phi]^6, \
$CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7015202136751738`*^9, 3.701521204558372*^9, 3.701521234720209*^9, 
   3.7015217847750797`*^9, 3.701521867940742*^9, {3.701522050521577*^9, 
   3.701522076789465*^9}, 3.701522166068581*^9, {3.701522205645238*^9, 
   3.7015222246863823`*^9}, {3.701522319848587*^9, 3.701522347991729*^9}, {
   3.701522450240583*^9, 3.701522472031124*^9}, {3.701522555735601*^9, 
   3.701522583028296*^9}, 3.701522696408505*^9, 3.701522828954035*^9, 
   3.70152362263168*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.658737`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["a", "3"]}], "+", 
        RowBox[{"27", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["\[Phi]", "2"]}], "+", 
        RowBox[{"6", " ", "a", " ", 
         SuperscriptBox["\[Phi]", "4"]}], "+", 
        SuperscriptBox["\[Phi]", "6"]}], ",", "\[Phi]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"]}], 
         RowBox[{"9", " ", "b"}]], "+", 
        FractionBox["\[Phi]", "2"], "+", 
        FractionBox[
         RowBox[{"5", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "2"]}], 
         RowBox[{"18", " ", "b"}]], "+", 
        FractionBox[
         SuperscriptBox["\[Phi]", "4"], 
         RowBox[{"18", " ", "b"}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"]}], 
         RowBox[{"9", " ", "b"}]], "-", 
        FractionBox["\[Phi]", "2"], "+", 
        FractionBox[
         RowBox[{"5", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "2"]}], 
         RowBox[{"18", " ", "b"}]], "+", 
        FractionBox[
         SuperscriptBox["\[Phi]", "4"], 
         RowBox[{"18", " ", "b"}]]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"4", " ", 
           SuperscriptBox["a", "2"]}], 
          RowBox[{"9", " ", "b"}]]}], "-", 
        FractionBox[
         RowBox[{"5", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "2"]}], 
         RowBox[{"9", " ", "b"}]], "-", 
        FractionBox[
         SuperscriptBox["\[Phi]", "4"], 
         RowBox[{"9", " ", "b"}]]}]}], "}"}], ",", 
     RowBox[{"NFExt", "[", 
      RowBox[{"\[Theta]", "\[Rule]", "0"}], "]"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.701522591545227*^9, 3.7015227047360487`*^9, 
  3.70152283727386*^9, 3.701523631059564*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumExtendSplit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "3"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"9", "+", 
        RowBox[{"3", " ", 
         RowBox[{"a", "^", "2"}]}]}], ")"}], " ", "x"}], "+", 
     RowBox[{"6", " ", "a"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"a", "^", "3"}]}]}], ",", "x", ",", "k", ",", "\[Phi]"}], "]"}],
   "//", "Timing"}]}], "Input",
 CellChangeTimes->{
  3.701520213177265*^9, {3.701521195651883*^9, 3.701521203200294*^9}, {
   3.701522200489575*^9, 3.701522204998436*^9}, {3.701522692455254*^9, 
   3.701522695899952*^9}, {3.701523617171608*^9, 3.701523620761736*^9}, {
   3.701524017849202*^9, 3.701524083376683*^9}, {3.701524192043234*^9, 
   3.701524192187883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`\[Phi], $CellContext`\[Phi], {}, {$CellContext`a}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.701524084601028*^9, 3.701524195592152*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"6", " ", "a"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "3"]}], "-", 
      RowBox[{"9", " ", "\[Phi]"}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["a", "2"], " ", "\[Phi]"}], "+", 
      SuperscriptBox["\[Phi]", "3"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, 6 $CellContext`a + 2 $CellContext`a^3 - 
    9 $CellContext`\[Phi] - (
     3 $CellContext`a^2) $CellContext`\[Phi] + $CellContext`\[Phi]^3, \
$CellContext`\[Phi], {}, {$CellContext`a}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.701524084601028*^9, 3.701524195596776*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.195199`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"6", " ", "a"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "3"]}], "-", 
        RowBox[{"9", " ", "\[Phi]"}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["a", "2"], " ", "\[Phi]"}], "+", 
        SuperscriptBox["\[Phi]", "3"]}], ",", "\[Phi]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "a", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{
        RowBox[{"-", "3"}], "-", 
        SuperscriptBox["a", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", "\[Phi]"}], "+", 
        FractionBox[
         SuperscriptBox["\[Phi]", "2"], "2"]}], ",", 
       RowBox[{"3", "+", 
        SuperscriptBox["a", "2"], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "a"}], ")"}], " ", "\[Phi]"}], "-", 
        FractionBox[
         SuperscriptBox["\[Phi]", "2"], "2"]}]}], "}"}], ",", 
     RowBox[{"NFExt", "[", 
      RowBox[{"\[Theta]", "\[Rule]", "0"}], "]"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.701524084745113*^9, 3.701524195715232*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumExtendSplit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "4"}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"x", "^", "2"}]}], "+", "b"}], ",", "x", ",", "k", ",", 
    "\[Phi]"}], "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.7015241096324368`*^9, 3.7015241097849007`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`\[Phi], $CellContext`\[Phi], {}, {$CellContext`a, \
$CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.701524110235682*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"b", "+", 
      RowBox[{"a", " ", 
       SuperscriptBox["\[Phi]", "2"]}], "+", 
      SuperscriptBox["\[Phi]", "4"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`b + $CellContext`a $CellContext`\[Phi]^2 + $CellContext`\
\[Phi]^4, $CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.701524110237651*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"16", " ", 
       SuperscriptBox["a", "4"]}], "-", 
      RowBox[{"200", " ", 
       SuperscriptBox["a", "2"], " ", "b"}], "+", 
      RowBox[{"625", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"40", " ", 
       SuperscriptBox["a", "3"], " ", 
       SuperscriptBox["\[Phi]", "2"]}], "-", 
      RowBox[{"70", " ", "a", " ", "b", " ", 
       SuperscriptBox["\[Phi]", "2"]}], "+", 
      RowBox[{"33", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["\[Phi]", "4"]}], "-", 
      RowBox[{"14", " ", "b", " ", 
       SuperscriptBox["\[Phi]", "4"]}], "+", 
      RowBox[{"10", " ", "a", " ", 
       SuperscriptBox["\[Phi]", "6"]}], "+", 
      SuperscriptBox["\[Phi]", "8"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, 16 $CellContext`a^4 - (200 $CellContext`a^2) $CellContext`b + 
    625 $CellContext`b^2 + (40 $CellContext`a^3) $CellContext`\[Phi]^2 - ((
      70 $CellContext`a) $CellContext`b) $CellContext`\[Phi]^2 + (
      33 $CellContext`a^2) $CellContext`\[Phi]^4 - (
     14 $CellContext`b) $CellContext`\[Phi]^4 + (
      10 $CellContext`a) $CellContext`\[Phi]^6 + $CellContext`\[Phi]^8, \
$CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.701524110470202*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.325432`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"16", " ", 
         SuperscriptBox["a", "4"]}], "-", 
        RowBox[{"200", " ", 
         SuperscriptBox["a", "2"], " ", "b"}], "+", 
        RowBox[{"625", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"40", " ", 
         SuperscriptBox["a", "3"], " ", 
         SuperscriptBox["\[Phi]", "2"]}], "-", 
        RowBox[{"70", " ", "a", " ", "b", " ", 
         SuperscriptBox["\[Phi]", "2"]}], "+", 
        RowBox[{"33", " ", 
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["\[Phi]", "4"]}], "-", 
        RowBox[{"14", " ", "b", " ", 
         SuperscriptBox["\[Phi]", "4"]}], "+", 
        RowBox[{"10", " ", "a", " ", 
         SuperscriptBox["\[Phi]", "6"]}], "+", 
        SuperscriptBox["\[Phi]", "8"]}], ",", "\[Phi]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "308"}], " ", 
             SuperscriptBox["a", "4"]}], "+", 
            RowBox[{"3945", " ", 
             SuperscriptBox["a", "2"], " ", "b"}], "-", 
            RowBox[{"4750", " ", 
             SuperscriptBox["b", "2"]}]}], ")"}], " ", "\[Phi]"}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "69"}], " ", 
             SuperscriptBox["a", "3"]}], "+", 
            RowBox[{"1777", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "3"]}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"25", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "5"]}], 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"7", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "7"]}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "92"}], " ", 
             SuperscriptBox["a", "4"]}], "+", 
            RowBox[{"195", " ", 
             SuperscriptBox["a", "2"], " ", "b"}], "+", 
            RowBox[{"10250", " ", 
             SuperscriptBox["b", "2"]}]}], ")"}], " ", "\[Phi]"}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "69"}], " ", 
             SuperscriptBox["a", "3"]}], "+", 
            RowBox[{"1777", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "3"]}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"25", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "5"]}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{"7", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "7"]}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"92", " ", 
             SuperscriptBox["a", "4"]}], "-", 
            RowBox[{"195", " ", 
             SuperscriptBox["a", "2"], " ", "b"}], "-", 
            RowBox[{"10250", " ", 
             SuperscriptBox["b", "2"]}]}], ")"}], " ", "\[Phi]"}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"69", " ", 
             SuperscriptBox["a", "3"]}], "-", 
            RowBox[{"1777", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "3"]}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"25", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "5"]}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"7", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "7"]}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"308", " ", 
             SuperscriptBox["a", "4"]}], "-", 
            RowBox[{"3945", " ", 
             SuperscriptBox["a", "2"], " ", "b"}], "+", 
            RowBox[{"4750", " ", 
             SuperscriptBox["b", "2"]}]}], ")"}], " ", "\[Phi]"}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"69", " ", 
             SuperscriptBox["a", "3"]}], "-", 
            RowBox[{"1777", " ", "a", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "3"]}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"5", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             SuperscriptBox["a", "2"]}], "+", 
            RowBox[{"25", " ", "b"}]}], ")"}], " ", 
          SuperscriptBox["\[Phi]", "5"]}], 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]], "-", 
        FractionBox[
         RowBox[{"7", " ", "a", " ", 
          SuperscriptBox["\[Phi]", "7"]}], 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"9", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"100", " ", "b"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["a", "2"]}], "-", 
            RowBox[{"25", " ", "b"}]}], ")"}]}]]}]}], "}"}], ",", 
     RowBox[{"NFExt", "[", 
      RowBox[{"\[Theta]", "\[Rule]", "0"}], "]"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.7015241115718327`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumExtendSplit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "4"}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"x", "^", "2"}]}], "+", 
     RowBox[{"b", "^", "2"}]}], ",", "x", ",", "k", ",", "\[Phi]"}], "]"}], "//",
   "Timing"}]}], "Input",
 CellChangeTimes->{
  3.701520213177265*^9, {3.701521195651883*^9, 3.701521203200294*^9}, {
   3.701522200489575*^9, 3.701522204998436*^9}, {3.701522692455254*^9, 
   3.701522695899952*^9}, {3.7015228643598537`*^9, 3.7015228667037153`*^9}, {
   3.7015229734650106`*^9, 3.701522973656496*^9}, {3.7015237763976517`*^9, 
   3.701523780594331*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`\[Phi], $CellContext`\[Phi], {}, {$CellContext`a, \
$CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7015202136751738`*^9, 3.701521204558372*^9, 3.701521234720209*^9, 
   3.7015217847750797`*^9, 3.701521867940742*^9, {3.701522050521577*^9, 
   3.701522076789465*^9}, 3.701522166068581*^9, {3.701522205645238*^9, 
   3.7015222246863823`*^9}, {3.701522319848587*^9, 3.701522347991729*^9}, {
   3.701522450240583*^9, 3.701522472031124*^9}, {3.701522555735601*^9, 
   3.701522583028296*^9}, 3.701522696408505*^9, 3.701522828954035*^9, 
   3.701522867902076*^9, 3.7015229741805763`*^9, 3.701523781472163*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], "+", 
      RowBox[{"a", " ", 
       SuperscriptBox["\[Phi]", "2"]}], "+", 
      SuperscriptBox["\[Phi]", "4"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`b^2 + $CellContext`a $CellContext`\[Phi]^2 + $CellContext`\
\[Phi]^4, $CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7015202136751738`*^9, 3.701521204558372*^9, 3.701521234720209*^9, 
   3.7015217847750797`*^9, 3.701521867940742*^9, {3.701522050521577*^9, 
   3.701522076789465*^9}, 3.701522166068581*^9, {3.701522205645238*^9, 
   3.7015222246863823`*^9}, {3.701522319848587*^9, 3.701522347991729*^9}, {
   3.701522450240583*^9, 3.701522472031124*^9}, {3.701522555735601*^9, 
   3.701522583028296*^9}, 3.701522696408505*^9, 3.701522828954035*^9, 
   3.701522867902076*^9, 3.7015229741805763`*^9, 3.701523781474142*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.308709`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        SuperscriptBox["b", "2"], "+", 
        RowBox[{"a", " ", 
         SuperscriptBox["\[Phi]", "2"]}], "+", 
        SuperscriptBox["\[Phi]", "4"]}], ",", "\[Phi]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"-", "\[Phi]"}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"a", " ", "\[Phi]"}], "b"], "+", 
        FractionBox[
         SuperscriptBox["\[Phi]", "3"], "b"]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"a", " ", "\[Phi]"}], "b"]}], "-", 
        FractionBox[
         SuperscriptBox["\[Phi]", "3"], "b"]}]}], "}"}], ",", 
     RowBox[{"NFExt", "[", 
      RowBox[{"\[Theta]", "\[Rule]", "0"}], "]"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.701522591545227*^9, 3.7015227047360487`*^9, 
  3.70152283727386*^9, 3.701522869159953*^9, 3.701522974425047*^9, 
  3.701523781747864*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumExtendSplit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "6"}], "+", 
     RowBox[{"a", " ", 
      RowBox[{"x", "^", "3"}]}], "+", "b"}], ",", "x", ",", "k", ",", 
    "\[Phi]"}], "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.701524677320715*^9, 3.701524694768943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`\[Phi], $CellContext`\[Phi], {}, {$CellContext`a, \
$CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.701524681397393*^9, 3.701524695168601*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"b", "+", 
      RowBox[{"a", " ", 
       SuperscriptBox["\[Phi]", "3"]}], "+", 
      SuperscriptBox["\[Phi]", "6"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`b + $CellContext`a $CellContext`\[Phi]^3 + $CellContext`\
\[Phi]^6, $CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.701524681397393*^9, 3.701524695170459*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"729", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"27", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["\[Phi]", "6"]}], "-", 
      RowBox[{"54", " ", "b", " ", 
       SuperscriptBox["\[Phi]", "6"]}], "+", 
      SuperscriptBox["\[Phi]", "12"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, 729 $CellContext`b^2 + (27 $CellContext`a^2) $CellContext`\[Phi]^6 - (
     54 $CellContext`b) $CellContext`\[Phi]^6 + $CellContext`\[Phi]^12, \
$CellContext`\[Phi], {}, {$CellContext`a, $CellContext`b}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.701524681397393*^9, 3.701524741388051*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7015246920098753`*^9, 3.701524850492648*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumExtendSplit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "5"}], "+", 
     RowBox[{
      RowBox[{"5", "/", "4"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "^", "2"}], "+", "1"}], ")"}], "^", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "+", "a", "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "-", "a", "-", "1"}], ")"}], " ", "x"}], "+", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "^", "2"}], "+", "1"}], ")"}], "^", "3"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], "+", "a", "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "a"}], "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"a", "+", "2"}], ")"}]}]}], ",", "x", ",", "k", ",", 
    "\[Phi]"}], "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.701524677320715*^9, 3.701524694768943*^9}, {
  3.701525209288621*^9, 3.701525301289938*^9}, {3.7015254877730217`*^9, 
  3.701525532423999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, $CellContext`\[Phi], $CellContext`\[Phi], {}, {$CellContext`a}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.701525302288971*^9, {3.701525494165346*^9, 3.701525525828656*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nf1: \"\>", "\[InvisibleSpace]", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"4", "-", 
        RowBox[{"10", " ", "a"}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["a", "2"]}], "-", 
        RowBox[{"20", " ", 
         SuperscriptBox["a", "3"]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["a", "4"]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["a", "6"]}], "+", 
        RowBox[{"20", " ", 
         SuperscriptBox["a", "7"]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["a", "8"]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["a", "9"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["a", "10"]}], "+", 
        RowBox[{"5", " ", "\[Phi]"}], "-", 
        RowBox[{"5", " ", 
         SuperscriptBox["a", "2"], " ", "\[Phi]"}], "-", 
        RowBox[{"20", " ", 
         SuperscriptBox["a", "4"], " ", "\[Phi]"}], "-", 
        RowBox[{"5", " ", 
         SuperscriptBox["a", "6"], " ", "\[Phi]"}], "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["a", "8"], " ", "\[Phi]"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[Phi]", "5"]}]}], ")"}]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "a", "}"}]}], "]"}]}],
  SequenceForm["nf1: ", 
   $CellContext`NF[
   0, Rational[1, 4] (4 - 10 $CellContext`a + 10 $CellContext`a^2 - 
     20 $CellContext`a^3 + 10 $CellContext`a^4 + 10 $CellContext`a^6 + 
     20 $CellContext`a^7 + 10 $CellContext`a^8 + 10 $CellContext`a^9 + 
     4 $CellContext`a^10 + 
     5 $CellContext`\[Phi] - (5 $CellContext`a^2) $CellContext`\[Phi] - (
      20 $CellContext`a^4) $CellContext`\[Phi] - (
      5 $CellContext`a^6) $CellContext`\[Phi] + (
       5 $CellContext`a^8) $CellContext`\[Phi] + 
     4 $CellContext`\[Phi]^5), $CellContext`\[Phi], {}, {$CellContext`a}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.701525302288971*^9, {3.701525494165346*^9, 3.701525525858548*^9}}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.701525357803688*^9, {3.701525494489183*^9, 3.701525529585165*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumQBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"-", "\[Phi]"}]}], "}"}], ",", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"2", "+", 
      SuperscriptBox["\[Phi]", "2"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701706564799333*^9, 3.701706576855061*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\[Phi]", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.701706577655488*^9, {3.701706686711061*^9, 3.701706710242989*^9}, 
   3.7017780263332872`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumQBasis", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["\[Phi]", "2"], "+", 
      FractionBox[
       SuperscriptBox["\[Phi]", "4"], "36"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Phi]", "2"]}], "+", 
      FractionBox[
       SuperscriptBox["\[Phi]", "4"], "36"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Phi]", "4"], "18"]}]}], "}"}], ",", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", 
     RowBox[{"108", "+", 
      SuperscriptBox["\[Phi]", "6"]}], ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701705827110462*^9, 3.701705835973938*^9}, {
   3.701705880048188*^9, 3.701705884519717*^9}, 3.7017065681605797`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["\[Phi]", "2"], "+", 
      FractionBox[
       SuperscriptBox["\[Phi]", "4"], "36"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[Phi]", "2"]}], "+", 
      FractionBox[
       SuperscriptBox["\[Phi]", "4"], "36"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.701705836854105*^9, 3.7017058860764914`*^9}, {
  3.7017067119828568`*^9, 3.701706749234314*^9}, {3.701777997581778*^9, 
  3.7017780194028063`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["basis", "Subsection",
 CellChangeTimes->{{3.7017055136502123`*^9, 3.701705516277299*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumQBasis", "[", 
   RowBox[{"roots_", ",", "nf_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rbasis", ",", "bigrmat", ",", "done", ",", "bigrbasis", ",", "rmat", 
      ",", "x", ",", "rel", ",", "d", ",", "mp", ",", "shift", ",", "r", ",", 
      "cand", ",", "\n", "auto", ",", 
      RowBox[{"ggroup", "=", 
       RowBox[{"{", "}"}]}], ",", "newroots", ",", "lcm", ",", "\n", "a", ",",
       "b", ",", "c", ",", "br", ",", "\[Theta]k10", ",", "nfk1", ",", 
      "\[Theta]k21", ",", "mp2", ",", "mat", ",", "rnf"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "roots", "]"}], ">", "0"}], ",", 
       "\"\<roots in NumQBasis\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"rnf", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"nf", ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{
         "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
       "]"}]}], ";", "\t", "\n", "\t", 
     RowBox[{"rbasis", "=", 
      RowBox[{"{", 
       RowBox[{
       "roots", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "}"}]}], ";", "\n", "\t", 
     RowBox[{"rmat", "=", 
      RowBox[{"{", 
       RowBox[{"{", "1", "}"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"cand", "=", 
         RowBox[{
         "roots", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"rel", "=", 
         RowBox[{"PolyNumRowNullSpace", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"rbasis", ",", "cand"}], "]"}], "/.", 
              RowBox[{
               RowBox[{
               "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Rule]", "x"}]}], "}"}], "]"}], ",", "x", ",", "rnf"}], 
          "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rel", "]"}], "===", "0"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"rbasis", ",", "cand"}], "]"}], ";", "\n", "\t\t\t", 
           RowBox[{"rmat", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PadRight", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Length", "[", "rbasis", "]"}]}], "]"}], "&"}], ",", 
              "rmat"}], "]"}]}], ";"}]}], "\n", "\t\t", "]"}], ";", "\n", 
        "\t\t", 
        RowBox[{"rel", "=", 
         RowBox[{"PolyNumRowNullSpace", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"rbasis", ",", 
                RowBox[{
                "roots", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}], "/.", 
              RowBox[{
               RowBox[{
               "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[Rule]", "x"}]}], "}"}], "]"}], ",", "x", ",", "rnf"}], 
          "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rel", "]"}], "===", "1"}], ",", 
          "\"\<problem in NumQBasis\>\""}], "]"}], ";", "\n", "\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rmat", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Most", "[", 
             RowBox[{
             "rel", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], "/", 
           RowBox[{"Last", "[", 
            RowBox[{
            "rel", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"lcm", "=", "1"}], ";", "\n", "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"lcm", "=", 
            RowBox[{"LCM", "[", 
             RowBox[{"lcm", ",", 
              RowBox[{"Denominator", "[", 
               RowBox[{"rmat", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], "]"}]}], 
             "]"}]}], ";"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "rmat", "]"}]}], "}"}]}], "]"}], ";", "\n",
         "\t\t", 
        RowBox[{
         RowBox[{"rmat", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"rmat", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
          "lcm"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "rbasis", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "/", "lcm"}]}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "rbasis", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"{", 
      RowBox[{"rmat", ",", "rbasis"}], "}"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.701704552740046*^9, 3.701704571509479*^9}, {
   3.701704798454028*^9, 3.701704838661305*^9}, {3.7017051878701468`*^9, 
   3.701705226974125*^9}, 3.701705261647567*^9, {3.701705450118688*^9, 
   3.701705462678349*^9}, {3.701705548670643*^9, 3.701705643182222*^9}, {
   3.701705790343504*^9, 3.701705791879491*^9}, {3.701705850102806*^9, 
   3.7017058635182123`*^9}, {3.701706471623402*^9, 3.701706506703424*^9}, {
   3.701706537111919*^9, 3.701706543903326*^9}, {3.701706589399293*^9, 
   3.701706745375895*^9}, {3.701778015464983*^9, 3.701778015865292*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["old extneswions", "Subsection",
 CellChangeTimes->{{3.701513037476919*^9, 3.7015130427454643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumFieldExtend", "[", 
   RowBox[{"elems_", ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "m\[Theta]_", ",", "ce_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"newnf", "=", 
       RowBox[{"NF", "[", 
        RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}]}], "}"}], ",", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<entering NumFieldExtend \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"elems", ",", 
          RowBox[{"NF", "[", 
           RowBox[{"0", ",", "m\[Theta]", ",", "ce"}], "]"}]}], "}"}]}], 
       "]"}], ";"}], "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"ToNumberField", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"elems", ",", "ce"}], "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"l", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "#", "]"}], "===", "AlgebraicNumber"}], 
            "\n", "\t\t", ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"newnf", "===", 
                RowBox[{"NF", "[", 
                 RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], ",", "\n",
                "\t\t\t\t", 
               RowBox[{"newnf", "=", 
                RowBox[{"NF", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"MinimalPolynomial", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}], ",", 
                  
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{"assert", "[", 
                RowBox[{
                 RowBox[{"newnf", "===", 
                  RowBox[{"NF", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}], ",", 
                    
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 "\"\<number field mismatch in NumFieldExtend\>\""}], "]"}]}],
               "\n", "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
             RowBox[{"AlgebraicNumberPolynomial", "[", 
              RowBox[{"#", ",", "\[Theta]"}], "]"}]}], "\n", "\t\t", ",", 
            "\n", "\t\t\t", "#"}], "\t", "\n", "\t\t", "]"}], "\n", "\t", 
          ")"}], "&"}], ",", "l"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"elems", "\[Rule]", 
         RowBox[{"Most", "[", "l", "]"}]}], "]"}], ",", 
       RowBox[{"Last", "[", "l", "]"}], ",", "newnf"}], "}"}]}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.6711939908723335`*^9, 3.6711939909661093`*^9}, {
  3.693086876329855*^9, 3.693086877370593*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SplittingField", "[", 
     RowBox[{"f_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", ",", "newnf", ",", "new\[Theta]", ",", "newrmp"}], 
       "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"roots", ",", "new\[Theta]", ",", "newnf"}], "}"}], "=", 
        RowBox[{"NumFieldExtend", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"RootReduce", "[", 
            RowBox[{"x", "/.", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"f", "/.", 
                  RowBox[{"\[Theta]", "\[Rule]", 
                   RowBox[{
                   "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "\[Equal]", "0"}], 
               ",", "x", ",", 
               RowBox[{"Cubics", "\[Rule]", "False"}], ",", 
               RowBox[{"Quartics", "\[Rule]", "False"}]}], "]"}]}], "]"}], 
           "]"}], ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"newrmp", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"PolyFactor", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "newnf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"\[Theta]", "\[Rule]", "x"}]}], ",", "x", ",", "nf"}], 
          "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"newrmp", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"newrmp", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "\[Rule]", "\[Theta]"}], ",", 
                  RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}]}], "}"}]}], 
               ")"}], ",", "newnf"}], "]"}], "===", "0"}], "&"}]}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"newrmp", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"newrmp", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"#1", ",", "x"}], "]"}], "===", 
              RowBox[{"Exponent", "[", 
               RowBox[{"#2", ",", "x"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"ByteCount", "[", "#1", "]"}], "<", 
              RowBox[{"ByteCount", "[", "#2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"#1", ",", "x"}], "]"}], "<", 
              RowBox[{"Exponent", "[", 
               RowBox[{"#2", ",", "x"}], "]"}]}]}], "]"}], "&"}]}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"roots", ",", "new\[Theta]", ",", "newnf", ",", 
         RowBox[{
          RowBox[{"First", "[", "newrmp", "]"}], "/.", 
          RowBox[{"x", "\[Rule]", "#"}]}]}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SplittingField", "[", 
     RowBox[{"f_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", ",", "newnf", ",", "new\[Theta]", ",", 
        RowBox[{"ggroup", "=", 
         RowBox[{"{", "}"}]}], ",", "auto"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"roots", ",", "new\[Theta]", ",", "newnf"}], "}"}], "=", 
        RowBox[{"NumFieldExtend", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"x", "/.", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"f", "/.", 
                 RowBox[{"\[Theta]", "\[Rule]", 
                  RowBox[{
                  "nf", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], ")"}], "\[Equal]", "0"}], 
              ",", "x", ",", 
              RowBox[{"Cubics", "\[Rule]", "False"}], ",", 
              RowBox[{"Quartics", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",",
           "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", "x"}], "]"}], "===", "1"}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"auto", "=", 
               RowBox[{"NumCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "x", ",", "0"}], "]"}]}], 
                  "/", 
                  RowBox[{"Coefficient", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "x", ",", "1"}], "]"}]}], 
                 ",", "newnf"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RootReduce", "[", 
                  RowBox[{
                   RowBox[{
                   "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"new\[Theta]", "/.", 
                    RowBox[{"\[Theta]", "\[Rule]", "auto"}]}], ")"}], "/.", 
                    RowBox[{"\[Theta]", "\[Rule]", 
                    RowBox[{
                    "newnf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], ")"}]}], "]"}], "===", 
                 "0"}], ",", "\n", "\t\t\t\t", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"ggroup", ",", "auto"}], "]"}]}], "\n", "\t\t\t", 
               "]"}]}]}], "\n", "\t\t", "]"}], "\n", "\t", ")"}], "&"}], ",", 
         
         RowBox[{"PolyFactor", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "newnf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"\[Theta]", "\[Rule]", "x"}]}], ",", "x", ",", "newnf"}], 
          "]"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"roots", ",", "ggroup", ",", "new\[Theta]", ",", "newnf"}], 
        "}"}]}]}], "\n", "]"}]}], "*)"}]}]}], "Code",
 CellChangeTimes->{{3.6766574419761305`*^9, 3.6766574897117915`*^9}, {
   3.6766575896191564`*^9, 3.676657592619218*^9}, {3.676657625994602*^9, 
   3.6766576522917767`*^9}, {3.6766580309357433`*^9, 3.676658084436327*^9}, {
   3.676658125077445*^9, 3.676658168218508*^9}, {3.676658300814517*^9, 
   3.6766583910350103`*^9}, {3.6766584697702656`*^9, 
   3.6766584747234964`*^9}, {3.676658557896323*^9, 3.6766585591463094`*^9}, {
   3.676658634132286*^9, 3.676658638335429*^9}, {3.676658684460985*^9, 
   3.6766587122112494`*^9}, {3.6766587624782143`*^9, 3.67665879458796*^9}, {
   3.6766589574186287`*^9, 3.676659014841161*^9}, {3.6766596078066792`*^9, 
   3.6766596097911334`*^9}, {3.676659644666533*^9, 3.6766596449321623`*^9}, {
   3.6766596942452245`*^9, 3.676659694432728*^9}, {3.6766598606682243`*^9, 
   3.67665986580888*^9}, {3.676665536893854*^9, 3.676665551284636*^9}, {
   3.6766656039571257`*^9, 3.6766656576306543`*^9}, {3.6766657122718835`*^9, 
   3.6766658178824887`*^9}, {3.676665854508937*^9, 3.6711118951905503`*^9}, {
   3.671112221883859*^9, 3.671112275493952*^9}, {3.671112353308183*^9, 
   3.671112446934412*^9}, {3.671112481684882*^9, 3.6711125775844784`*^9}, {
   3.671112623647596*^9, 3.6711126539136276`*^9}, {3.671112685180321*^9, 
   3.671112698305499*^9}, {3.6711170155727153`*^9, 3.6711170306822453`*^9}, {
   3.671135452753479*^9, 3.6711354615295196`*^9}, {3.671192976155102*^9, 
   3.6711930035929923`*^9}, {3.6711933664594126`*^9, 
   3.6711934354447174`*^9}, {3.6711934914715195`*^9, 3.671193495784973*^9}, {
   3.6711935846298904`*^9, 3.671193585786152*^9}, {3.6711936232097626`*^9, 
   3.6711936235066123`*^9}, {3.6711936906644716`*^9, 3.67119379624404*^9}, {
   3.671193865917556*^9, 3.6711938925741367`*^9}, {3.671193922699522*^9, 
   3.6711939333872128`*^9}, {3.6711941182965946`*^9, 3.6711941991258335`*^9}, 
   3.671194248580328*^9, {3.671194326315834*^9, 3.6711944199271765`*^9}, {
   3.671196411067906*^9, 3.6711964150522814`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumMinPoly", "[", 
     RowBox[{
     "e_", ",", "x_", ",", "bignf_", ",", "smallnf_", ",", "change_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mp", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"mp", "=", 
        RowBox[{"MinimalPolynomial", "[", 
         RowBox[{
          RowBox[{"NumFieldEmbedding", "[", 
           RowBox[{"e", ",", "bignf"}], "]"}], ",", "x"}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"mp", "=", 
        RowBox[{"First", "/@", 
         RowBox[{"PolyFactor", "[", 
          RowBox[{"mp", ",", "x", ",", "smallnf"}], "]"}]}]}], ";", "\n", 
       "\t", 
       RowBox[{"mp", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"mp", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"x", "\[Rule]", "e"}], ",", 
                  RowBox[{"\[Theta]", "\[Rule]", "change"}]}], "}"}]}], ")"}],
               ",", "bignf"}], "]"}], "===", "0"}], "&"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "mp", "]"}], "===", "1"}], ",", 
         "\"\<problem in NumMinPoly\>\""}], "]"}], ";", "\n", "\t", 
       RowBox[{"PolyMakeMonic", "[", 
        RowBox[{
         RowBox[{"mp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", "x", ",", "smallnf"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "rewrite", " ", "e", " ", "which", " ", "is", " ", "in", " ", "bignf", " ",
     "to", " ", "an", " ", "element", " ", "of", " ", "small", " ", "nf"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NumRewrite", "[", 
    RowBox[{"e_", ",", "bignf_", ",", "smallnf_", ",", "change_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bd", ",", "sd", ",", "mat"}], "}"}], ",", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<calling NumRewrite\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "bignf", ",", "smallnf", ",", "change"}], "}"}]}],
         "]"}], ";"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"bd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{
         "bignf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
          "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"sd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{
         "smallnf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"mat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "===", "0"}], ",", "1", ",", 
                 RowBox[{"change", "^", "i"}]}], "]"}], ",", "bignf"}], "]"}],
              ",", "\[Theta]"}], "]"}], ",", "bd"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"sd", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"mat", ",", 
        RowBox[{"PadRight", "[", 
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{"e", ",", "bignf"}], "]"}], ",", "\[Theta]"}], "]"}], 
          ",", "bd"}], "]"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"mat", "=", 
       RowBox[{"NullSpace", "[", 
        RowBox[{"Transpose", "[", "mat", "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "mat", "]"}], "===", "1"}], ",", 
        "\"\<problem in NumRewrite\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{"mat", "=", 
       RowBox[{
       "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
      "\n", "\t", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "mat", "]"}], "=!=", "0"}], ",", 
        "\"\<problem in NumRewrite\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Most", "[", "mat", "]"}]}], "/", 
         RowBox[{"Last", "[", "mat", "]"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"\[Theta]", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"sd", "-", "1"}]}], "]"}]}], ")"}]}]}]}], "\n", "]"}]}], 
  ";"}], "\n"}], "Code",
 CellChangeTimes->{{3.692998142568345*^9, 3.692998289122581*^9}, {
   3.692998344666314*^9, 3.692998367531322*^9}, {3.6929985128465137`*^9, 
   3.692998601989259*^9}, {3.692998662091546*^9, 3.692998671373713*^9}, {
   3.693001306900236*^9, 3.693001369507986*^9}, 3.693001476775243*^9, {
   3.693001553734295*^9, 3.69300176816534*^9}, {3.693001805516225*^9, 
   3.6930019387659693`*^9}, {3.693003871571588*^9, 3.693003895522112*^9}, {
   3.693003931358597*^9, 3.693003951913604*^9}, {3.693004013699854*^9, 
   3.693004054758312*^9}, {3.693004094487316*^9, 3.69300411427792*^9}, {
   3.693004178738385*^9, 3.693004181297035*^9}, {3.693004235609646*^9, 
   3.6930042440564737`*^9}, 3.69300435183807*^9, {3.69307380293703*^9, 
   3.69307382900104*^9}, {3.693085614003417*^9, 3.693085614906088*^9}, {
   3.693086729413081*^9, 3.6930867310368023`*^9}, {3.693086809415015*^9, 
   3.693086817216198*^9}, {3.693086881670217*^9, 3.693086882840105*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QBasisForQSpan", "[", 
     RowBox[{"roots_", ",", "bignf_", ",", "smallnf_", ",", "change_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rbasis", ",", "bigrmat", ",", "done", ",", "bigrbasis", ",", "rmat", 
        ",", "x", ",", "rel", ",", "d", ",", "mp", ",", "shift", ",", "r", 
        ",", "cand", ",", "\n", "auto", ",", 
        RowBox[{"ggroup", "=", 
         RowBox[{"{", "}"}]}], ",", "newroots", ",", "newrmat", ",", 
        "newrbasis", ",", "bigmp", ",", "bigred", ",", "\n", "a", ",", "b", 
        ",", "c", ",", "br", ",", "\[Theta]k10", ",", "nfk1", ",", 
        "\[Theta]k21", ",", "mp2", ",", "mat"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "roots", "]"}], "===", "0"}], ",", 
         RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"rbasis", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{
             "smallnf", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}], "===", 
           "1"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "bignf"}], "]"}], "&"}], ",", 
            RowBox[{"change", "^", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{
                  RowBox[{
                  "smallnf", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}], "-", 
                "1"}]}], "]"}]}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rmat", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"mp", "=", 
           RowBox[{
            RowBox[{"NumMinPoly", "[", 
             RowBox[{
              RowBox[{
              "roots", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", "x", ",", "bignf", ",", "smallnf", ",", "change"}], "]"}],
             "/.", 
            RowBox[{"\[Theta]", "\[Rule]", "change"}]}]}], ";", "\n", "\t\t", 
          
          RowBox[{"d", "=", 
           RowBox[{"Exponent", "[", 
            RowBox[{"mp", ",", "x"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"cand", "=", 
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "roots", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               "+", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"d", "===", "1"}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"Coefficient", "[", 
                  RowBox[{"mp", ",", "x", ",", 
                   RowBox[{"d", "-", "1"}]}], "]"}], "/", "d"}]}], "]"}]}], 
             ",", "bignf"}], "]"}]}], ";", "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<cand: \>\"", ",", "cand", ",", "\"\<   \>\"", ",", 
              RowBox[{"RootReduce", "[", 
               RowBox[{"NumFieldEmbedding", "[", 
                RowBox[{"cand", ",", "bignf"}], "]"}], "]"}]}], "]"}], ";"}], 
           "*)"}], "\n", "\n", "\t\t", 
          RowBox[{"rel", "=", 
           RowBox[{"PolyNumRowNullSpace", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{"rbasis", ",", "cand"}], "]"}], "/.", 
                RowBox[{"\[Theta]", "\[Rule]", "x"}]}], "}"}], "]"}], ",", 
             "x", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}]}], ";",
           "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "rel", "]"}], "===", "0"}], ",", "\n", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"rbasis", ",", "cand"}], "]"}], ";", "\n", "\t\t\t", 
             RowBox[{"rmat", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"PadRight", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Length", "[", "rbasis", "]"}]}], "]"}], "&"}], 
                ",", "rmat"}], "]"}]}], ";"}]}], "\n", "\t\t", "]"}], ";", 
          "\n", "\t\t", 
          RowBox[{"rel", "=", 
           RowBox[{"PolyNumRowNullSpace", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Append", "[", 
                 RowBox[{"rbasis", ",", 
                  RowBox[{
                  "roots", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}], "/.", 
                RowBox[{"\[Theta]", "\[Rule]", "x"}]}], "}"}], "]"}], ",", 
             "x", ",", 
             RowBox[{"NF", "[", 
              RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}]}], ";",
           "\n", "\t\t", 
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "rel", "]"}], "===", "1"}], ",", 
            "\"\<problem in NewQBasisForQSpan\>\""}], "]"}], ";", "\n", 
          "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rmat", ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Most", "[", 
               RowBox[{
               "rel", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}], "/", 
             RowBox[{"Last", "[", 
              RowBox[{
              "rel", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}]}]}], "]"}], ";"}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", "\n",
        "\t", 
       RowBox[{"{", 
        RowBox[{"rmat", ",", "rbasis"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"NewQBasisForQSpan", "[", 
   RowBox[{"roots_", ",", "bignf_", ",", "smallnf_", ",", "change_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rbasis", ",", "bigrmat", ",", "done", ",", "bigrbasis", ",", "rmat", 
      ",", "x", ",", "rel", ",", "d", ",", "mp", ",", "shift", ",", "r", ",", 
      "cand", ",", "\n", "auto", ",", 
      RowBox[{"ggroup", "=", 
       RowBox[{"{", "}"}]}], ",", "newroots", ",", "newrmat", ",", 
      "newrbasis", ",", "bigmp", ",", "bigred", ",", "\n", "a", ",", "b", ",",
       "c", ",", "br", ",", "\[Theta]k10", ",", "nfk1", ",", "\[Theta]k21", 
      ",", "mp2", ",", "mat"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "roots", "]"}], "===", "0"}], ",", 
       RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"rbasis", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{
           RowBox[{
           "smallnf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           ",", "\[Theta]"}], "]"}], "===", "1"}], ",", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{"#", ",", "bignf"}], "]"}], "&"}], ",", 
          RowBox[{"change", "^", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{
                RowBox[{
                "smallnf", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}], "-", 
              "1"}]}], "]"}]}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"rmat", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"mp", "=", 
         RowBox[{
          RowBox[{"NumMinPoly", "[", 
           RowBox[{
            RowBox[{
            "roots", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", "x", ",", "bignf", ",", "smallnf", ",", "change"}], "]"}], "/.", 
          RowBox[{"\[Theta]", "\[Rule]", "change"}]}]}], ";", "\n", "\t\t", 
        RowBox[{"d", "=", 
         RowBox[{"Exponent", "[", 
          RowBox[{"mp", ",", "x"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"cand", "=", 
         RowBox[{"NumCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "roots", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"d", "===", "1"}], ",", "0", ",", 
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{"mp", ",", "x", ",", 
                 RowBox[{"d", "-", "1"}]}], "]"}], "/", "d"}]}], "]"}]}], ",",
            "bignf"}], "]"}]}], ";", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<cand: \>\"", ",", "cand", ",", "\"\<   \>\"", ",", 
            RowBox[{"RootReduce", "[", 
             RowBox[{"NumFieldEmbedding", "[", 
              RowBox[{"cand", ",", "bignf"}], "]"}], "]"}]}], "]"}], ";"}], 
         "*)"}], "\n", "\n", "\t\t", 
        RowBox[{"rel", "=", 
         RowBox[{"PolyNumRowNullSpace", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"rbasis", ",", "cand"}], "]"}], "/.", 
              RowBox[{"\[Theta]", "\[Rule]", "x"}]}], "}"}], "]"}], ",", "x", 
           ",", 
           RowBox[{"NF", "[", 
            RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rel", "]"}], "===", "0"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"rbasis", ",", "cand"}], "]"}], ";", "\n", "\t\t\t", 
           RowBox[{"rmat", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PadRight", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Length", "[", "rbasis", "]"}]}], "]"}], "&"}], ",", 
              "rmat"}], "]"}]}], ";"}]}], "\n", "\t\t", "]"}], ";", "\n", 
        "\t\t", 
        RowBox[{"rel", "=", 
         RowBox[{"PolyNumRowNullSpace", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"rbasis", ",", 
                RowBox[{
                "roots", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}], "/.", 
              RowBox[{"\[Theta]", "\[Rule]", "x"}]}], "}"}], "]"}], ",", "x", 
           ",", 
           RowBox[{"NF", "[", 
            RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rel", "]"}], "===", "1"}], ",", 
          "\"\<problem in NewQBasisForQSpan\>\""}], "]"}], ";", "\n", "\t\t", 
        
        RowBox[{"AppendTo", "[", 
         RowBox[{"rmat", ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Most", "[", 
             RowBox[{
             "rel", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], "/", 
           RowBox[{"Last", "[", 
            RowBox[{
            "rel", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     RowBox[{"(*", "\n", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<roots: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "roots", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<rmat: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "rmat", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<rbasis: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "rbasis", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<zero check: \>\"", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{"#", ",", "bignf"}], "]"}], "&"}], ",", 
           RowBox[{"roots", "-", 
            RowBox[{"rmat", ".", "rbasis"}]}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ";"}], "\n", "*)"}], 
     "\n", "\n", "\t", 
     RowBox[{"rmat", "=", 
      RowBox[{"Transpose", "[", "rmat", "]"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "rmat", "]"}], "\[GreaterEqual]", "i"}], "&&", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{
             "rmat", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ".."}], "}"}]}], "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"rmat", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"rmat", ",", "i"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"rbasis", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"rbasis", ",", "i"}], "]"}]}], ";"}]}], "\t\t", "\n", 
         "\t\t", "]"}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "rmat", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"rmat", "=", 
      RowBox[{"Transpose", "[", "rmat", "]"}]}], ";", "\n", 
     RowBox[{"(*", "\n", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<roots: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "roots", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<rmat: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "rmat", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<rbasis: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "rbasis", "]"}]}], "]"}], ";"}], "\n", 
      "*)"}], "\n", "\n", "\t", 
     RowBox[{"Scan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "x"}], "]"}], "===", "1"}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"auto", "=", 
             RowBox[{"NumCollect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Coefficient", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "x", ",", "0"}], "]"}]}], 
                "/", 
                RowBox[{"Coefficient", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "x", ",", "1"}], "]"}]}], ",", "bignf"}], "]"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"NumCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"change", "/.", 
                    RowBox[{"\[Theta]", "\[Rule]", "auto"}]}], ")"}], "-", 
                  "change"}], ",", "bignf"}], "]"}], "===", "0"}], ",", "\n", 
              "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"ggroup", ",", "auto"}], "]"}]}], "\n", "\t\t\t", 
             "]"}]}]}], "\n", "\t\t", "]"}], "\n", "\t", ")"}], "&"}], ",", 
       RowBox[{"PolyFactor", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "bignf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"\[Theta]", "\[Rule]", "x"}]}], ",", "x", ",", "bignf"}], 
        "]"}]}], "]"}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<group: \>\"", ",", "ggroup"}], "]"}], ";"}], "*)"}], 
     "\n", "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "average", " ", "over", " ", "elements", " ", "of", " ", "the", " ", 
       "galois", " ", "group"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"bigrmat", "=", 
      RowBox[{"Sequence", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"bigrbasis", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"newroots", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{"#", ",", "bignf"}], "]"}], "&"}], ",", 
           RowBox[{"roots", "/.", 
            RowBox[{"\[Theta]", "\[Rule]", 
             RowBox[{
             "ggroup", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"newrmat", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{"#", ",", "bignf"}], "]"}], "&"}], ",", 
           RowBox[{"rmat", "/.", 
            RowBox[{"\[Theta]", "\[Rule]", 
             RowBox[{
             "ggroup", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"newrbasis", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NumCollect", "[", 
             RowBox[{"#", ",", "bignf"}], "]"}], "&"}], ",", 
           RowBox[{"rbasis", "/.", 
            RowBox[{"\[Theta]", "\[Rule]", 
             RowBox[{
             "ggroup", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<newroots: \>\"", ",", "newroots"}], "]"}], ";", "\n", 
          
          RowBox[{"Print", "[", 
           RowBox[{"\"\<newrmat: \>\"", ",", "newrmat"}], "]"}], ";", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<newrbasis: \>\"", ",", "newrbasis"}], "]"}], ";"}], 
         "*)"}], "\n", "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Do", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"assert", "[", 
               RowBox[{
                RowBox[{"k", "\[LessEqual]", 
                 RowBox[{"Length", "[", "roots", "]"}]}], ",", 
                "\"\<permutation problem in NewQBasisForQSpan\>\""}], "]"}], 
              ";", "\n", "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "roots", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "===", 
                 RowBox[{
                 "newroots", "\[LeftDoubleBracket]", "k", 
                  "\[RightDoubleBracket]"}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "newroots", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "newroots", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "newroots", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "newroots", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], ";", "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "newrmat", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "newrmat", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "newrmat", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "newrmat", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], ";", "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{"Break", "[", "]"}], ";"}]}], "\n", "\t\t\t\t", 
               "]"}]}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "j", ",", 
               RowBox[{
                RowBox[{"Length", "[", "roots", "]"}], "+", "1"}]}], "}"}]}], 
            "]"}], ";"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", "\t\t", 
        RowBox[{"bigrmat", "=", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"bigrmat", ",", "newrmat"}], "}"}], "}"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"bigrbasis", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"bigrbasis", ",", "newrbasis"}], "]"}]}], ";"}], "\n", "\t",
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ggroup", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"bigrmat", "=", 
      RowBox[{"bigrmat", "/", 
       RowBox[{"Length", "[", "ggroup", "]"}]}]}], ";", "\n", 
     RowBox[{"(*", "\n", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<bigrmat: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "bigrmat", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<bigrbasis: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "bigrbasis", "]"}]}], "]"}], ";", "\n", 
       RowBox[{
       "Print", "[", "\"\<*******deleteing duplicates now **************\>\"",
         "]"}], ";"}], "\n", "*)"}], "\n", "\t", 
     RowBox[{"bigrmat", "=", 
      RowBox[{"Transpose", "[", "bigrmat", "]"}]}], ";", "\n", "\t", 
     RowBox[{"done", "=", "False"}], ";", "\n", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"Not", "[", "done", "]"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"done", "=", "True"}], ";", "\n", "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "bigrbasis", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "===", 
             RowBox[{
             "bigrbasis", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
              "bigrmat", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{
               RowBox[{
               "bigrmat", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "+", 
               RowBox[{
               "bigrmat", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t\t\t\t", 
             RowBox[{"bigrmat", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"bigrmat", ",", "j"}], "]"}]}], ";", "\n", "\t\t\t\t", 
             
             RowBox[{"bigrbasis", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"bigrbasis", ",", "j"}], "]"}]}], ";", "\n", 
             "\t\t\t\t", 
             RowBox[{"done", "=", "False"}], ";", 
             RowBox[{"Break", "[", "]"}], ";"}]}], "\n", "\t\t\t", "]"}], 
          "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "bigrbasis", "]"}], "-", "1"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"Length", "[", "bigrbasis", "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"bigrmat", "=", 
      RowBox[{"Transpose", "[", "bigrmat", "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", "\n", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<bigrmat: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "bigrmat", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<bigrbasis: \>\"", ",", 
         RowBox[{"MatrixForm", "[", "bigrbasis", "]"}]}], "]"}], ";"}], "\n", 
      "*)"}], "\n", "\n", "\t", 
     RowBox[{"bigmp", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"be", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"mp", "=", 
            RowBox[{"NumMinPoly", "[", 
             RowBox[{
             "be", ",", "x", ",", "bignf", ",", "smallnf", ",", "change"}], 
             "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"br", ",", "\[Theta]k10", ",", "nfk1"}], "}"}], "=", 
            RowBox[{"NumFieldExtend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"RootReduce", "[", 
                RowBox[{"NumFieldEmbedding", "[", 
                 RowBox[{"be", ",", "bignf"}], "]"}], "]"}], "}"}], ",", 
              "smallnf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"br", "=", 
            RowBox[{"br", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
           
           RowBox[{"(*", "\n", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<br: \>\"", ",", "br"}], "]"}], ";", "\n", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<\[Theta]k10: \>\"", ",", "\[Theta]k10"}], "]"}], 
             ";", "\n", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<nfk1: \>\"", ",", "nfk1"}], "]"}], ";"}], "\n", 
            "*)"}], "\n", "\t\t\t\t", 
           RowBox[{"mp2", "=", 
            RowBox[{"MinimalPolynomial", "[", 
             RowBox[{
              RowBox[{
              "nfk1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              ",", "x"}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"\[Theta]k21", "=", 
            RowBox[{"First", "/@", 
             RowBox[{"PolyFactor", "[", 
              RowBox[{
               RowBox[{"MinimalPolynomial", "[", 
                RowBox[{
                 RowBox[{
                 "nfk1", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}], ",", "x"}], "]"}], ",", "x", ",",
                "bignf"}], "]"}]}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"\[Theta]k21", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"\[Theta]k21", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"#", ",", "x"}], "]"}], "===", "1"}], "&"}]}], 
             "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Theta]k21", "]"}], ">", "0"}], ",", 
             "\"\<problem with \[Theta]k21\>\""}], "]"}], ";", "\n", 
           "\t\t\t\t", 
           RowBox[{"\[Theta]k21", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"NumCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "x", ",", "0"}], "]"}]}], "*", 
                  RowBox[{"NumRecp", "[", 
                   RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "x", ",", "1"}], "]"}], ",", "bignf"}], 
                   "]"}]}], ",", "bignf"}], "]"}], "&"}], ",", 
              "\[Theta]k21"}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"\[Theta]k21", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"\[Theta]k21", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"RootReduce", "[", 
                 RowBox[{
                  RowBox[{
                  "nfk1", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"NumFieldEmbedding", "[", 
                   RowBox[{"#", ",", "bignf"}], "]"}]}], "]"}], "===", "0"}], 
               "&"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Theta]k21", "]"}], "===", "1"}], ",", 
             "\"\<problem 2 with \[Theta]2 to \[Theta]1\>\""}], "]"}], ";", 
           "\n", "\t\t\t\t", 
           RowBox[{"\[Theta]k21", "=", 
            RowBox[{
            "\[Theta]k21", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"\[Theta]k10", ",", "\[Theta]"}], "]"}], ">", "0"}], 
             ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"a", "=", 
               RowBox[{"First", "/@", 
                RowBox[{"PolyFactor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[Theta]k10", "/.", 
                    RowBox[{"\[Theta]", "\[Rule]", "x"}]}], ")"}], "-", 
                   "change"}], ",", "x", ",", "bignf"}], "]"}]}]}], ";", "\n",
               "\t\t\t\t\t", 
              RowBox[{"a", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"a", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "x"}], "]"}], "===", "1"}], "&"}]}], 
                "]"}]}], ";", "\n", "\t\t\t\t\t", 
              RowBox[{"assert", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "a", "]"}], ">", "0"}], ",", 
                "\"\<problem with \[Theta]2 to \[Theta]1\>\""}], "]"}], ";", 
              "\n", "\t\t\t\t\t", 
              RowBox[{"a", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NumCollect", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "x", ",", "0"}], "]"}]}], "*", 
                    RowBox[{"NumRecp", "[", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "x", ",", "1"}], "]"}], ",", "bignf"}], 
                    "]"}]}], ",", "bignf"}], "]"}], "&"}], ",", "a"}], 
                "]"}]}], ";", "\n", "\t\t\t\t\t", 
              RowBox[{"a", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"a", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RootReduce", "[", 
                    RowBox[{
                    RowBox[{
                    "nfk1", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"NumFieldEmbedding", "[", 
                    RowBox[{"#", ",", "bignf"}], "]"}]}], "]"}], "===", "0"}],
                   "&"}]}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
              RowBox[{"assert", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "a", "]"}], "===", "1"}], ",", 
                "\"\<problem 2 with \[Theta]2 to \[Theta]1\>\""}], "]"}], ";",
               "\n", "\t\t\t\t\t", 
              RowBox[{"assert", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "===", "\[Theta]k21"}], ",", 
                "\"\<a\[LeftDoubleBracket]1\[RightDoubleBracket]===\[Theta]\
k21\>\""}], "]"}], ";"}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
           RowBox[{"d", "=", 
            RowBox[{"Exponent", "[", 
             RowBox[{"mp", ",", "x"}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{"d", "===", 
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{
                 "nfk1", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}], "/", 
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{
                 "smallnf", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "\[Theta]"}], "]"}]}]}], 
             ",", "\"\<d===Exponent[nfk1\[LeftDoubleBracket]2\
\[RightDoubleBracket],\[Theta]]/Exponent[smallnf\[LeftDoubleBracket]2\
\[RightDoubleBracket],\[Theta]]\>\""}], "]"}], ";", "\n", "\t\t\t\t", 
           RowBox[{"mp2", "=", 
            RowBox[{"NumMinPoly", "[", 
             RowBox[{
             "\[Theta]", ",", "x", ",", "nfk1", ",", "smallnf", ",", 
              "\[Theta]k10"}], "]"}]}], ";", "\n", "\t\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{"d", "===", 
              RowBox[{"Exponent", "[", 
               RowBox[{"mp2", ",", "x"}], "]"}]}], ",", 
             "\"\<d===Exponent[mp2,x]\>\""}], "]"}], ";", "\n", "\t\t\t\t", 
           RowBox[{"mat", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PadRight", "[", 
               RowBox[{
                RowBox[{"CoefficientList", "[", 
                 RowBox[{
                  RowBox[{"PolyRemainder", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"br", "/.", 
                    RowBox[{"{", 
                    RowBox[{"\[Theta]", "\[Rule]", "x"}], "}"}]}], ")"}], "^",
                     "i"}], ",", "mp2", ",", "x", ",", "smallnf"}], "]"}], 
                  ",", "x"}], "]"}], ",", "d"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
           "\t\t\t\t", 
           RowBox[{"mat", "=", 
            RowBox[{"NumMatrixInverse", "[", 
             RowBox[{"mat", ",", "smallnf"}], "]"}]}], ";", "\n", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"NumMinPoly", "[", 
               RowBox[{
               "be", ",", "x", ",", "bignf", ",", "smallnf", ",", "change"}], 
               "]"}], "/.", 
              RowBox[{"x", "\[Rule]", "#"}]}], ",", "nfk1", ",", 
             "\[Theta]k10", ",", "\[Theta]k21", ",", "\n", "\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"d", "===", "1"}], ",", "\n", "\t\t", 
               RowBox[{"NumCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Coefficient", "[", 
                    RowBox[{"mp2", ",", "x", ",", "0"}], "]"}]}], "*", 
                  RowBox[{"NumRecp", "[", 
                   RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"mp2", ",", "x", ",", "1"}], "]"}], ",", 
                    "smallnf"}], "]"}]}], ",", "smallnf"}], "]"}], ",", "\n", 
               "\t\t", 
               RowBox[{
                RowBox[{
                "mat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 ".", 
                RowBox[{"#", "^", 
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"d", "-", "1"}]}], "]"}]}]}]}], "\n", "\t", 
              "]"}]}], "\n", "}"}]}]}], "\n", "\t\t", "]"}], ",", 
        "bigrbasis"}], "]"}]}], ";", "\n", 
     RowBox[{"(*", "\n", 
      RowBox[{
      "bigmp", " ", "consists", " ", "of", " ", "rows", " ", "like", "\n", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "minpoly", " ", "for", " ", "basis", " ", "element", " ", "#"}], ",",
          " ", "k1", ",", "\[Theta]k10", ",", "\[Theta]k21", ",", 
         RowBox[{
         "\[Theta]1", " ", "in", " ", "terms", " ", "of", " ", "#", " ", 
          "and", " ", "\[Theta]0"}]}], "}"}]}], "\n", "\n", "*)"}], "\n", 
     "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<bigrmat: \>\"", ",", 
       RowBox[{"MatrixForm", "[", "bigrmat", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<bigrbasis: \>\"", ",", 
       RowBox[{"MatrixForm", "[", "bigrbasis", "]"}]}], "]"}], ";", "\n", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<minpolys: \>\"", ",", 
       RowBox[{"MatrixForm", "[", "bigmp", "]"}]}], "]"}], ";", "\n", "\n", 
     "\t", 
     RowBox[{"{", 
      RowBox[{"bigrmat", ",", "bigrbasis", ",", "bigmp"}], "}"}]}]}], "\n", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.671118082387926*^9, 3.6711181769048433`*^9}, {
   3.6711191916262293`*^9, 3.6711191991419835`*^9}, {3.6711216251385565`*^9, 
   3.671121654842767*^9}, {3.671121733328215*^9, 3.671121733546968*^9}, {
   3.67112542663694*^9, 3.671125458684932*^9}, {3.671125510594942*^9, 
   3.6711255650460324`*^9}, {3.6711424046199884`*^9, 
   3.6711424074325433`*^9}, {3.671142491597786*^9, 3.6711426336331806`*^9}, {
   3.6711426958919497`*^9, 3.6711427078680353`*^9}, {3.6711427728296657`*^9, 
   3.6711428622494383`*^9}, {3.6711429007163963`*^9, 3.671142901013256*^9}, {
   3.671142932207456*^9, 3.6711429590214033`*^9}, {3.6711430968167806`*^9, 
   3.6711431347370014`*^9}, {3.6711431958460913`*^9, 
   3.6711432044868307`*^9}, {3.6711432433832855`*^9, 
   3.6711432778033867`*^9}, {3.6711433312000885`*^9, 
   3.6711433324813786`*^9}, {3.6711433632875547`*^9, 
   3.6711433971661606`*^9}, {3.6711434596416883`*^9, 
   3.6711434689224777`*^9}, {3.6711436202683954`*^9, 3.671143642918263*^9}, {
   3.67114368375599*^9, 3.671143698131154*^9}, {3.671143798431278*^9, 
   3.6711438439435835`*^9}, {3.6711438771335163`*^9, 
   3.6711438886494255`*^9}, {3.671143922227585*^9, 3.6711439931912737`*^9}, {
   3.671144029575365*^9, 3.6711440311066356`*^9}, {3.6711440688044224`*^9, 
   3.671144073055583*^9}, {3.671144106962586*^9, 3.671144109743842*^9}, {
   3.6711443189196777`*^9, 3.67114435694494*^9}, {3.6711443936314325`*^9, 
   3.6711444372522807`*^9}, {3.6711476778239493`*^9, 
   3.6711476873709216`*^9}, {3.6929927821445227`*^9, 3.692992783861816*^9}, {
   3.6929929896580563`*^9, 3.692992990190358*^9}, {3.692993022590485*^9, 
   3.6929930370483913`*^9}, {3.692993266405939*^9, 3.692993285544723*^9}, {
   3.692993317635228*^9, 3.692993381954946*^9}, {3.692993514120034*^9, 
   3.692993532247225*^9}, {3.6929936248184357`*^9, 3.6929936263998013`*^9}, {
   3.692993670174559*^9, 3.6929936749555483`*^9}, {3.692993736926797*^9, 
   3.6929937462122393`*^9}, {3.692993866558681*^9, 3.692993931216642*^9}, {
   3.692994052969676*^9, 3.692994145762577*^9}, {3.692994198871591*^9, 
   3.69299419894209*^9}, {3.692994231353072*^9, 3.692994236111401*^9}, {
   3.692994270833538*^9, 3.692994353673678*^9}, {3.6929944098635883`*^9, 
   3.692994449560913*^9}, {3.6929945143430758`*^9, 3.692994551519864*^9}, {
   3.692994615712111*^9, 3.6929946158480597`*^9}, {3.6929946626011257`*^9, 
   3.692994742024743*^9}, {3.692994772822028*^9, 3.6929948010166492`*^9}, {
   3.692995252303487*^9, 3.692995334238634*^9}, {3.692995421083687*^9, 
   3.69299543873099*^9}, {3.6929957558605556`*^9, 3.6929957829260263`*^9}, {
   3.6929958171632843`*^9, 3.692995829049749*^9}, {3.6929958623397923`*^9, 
   3.692995909883493*^9}, {3.692995949354781*^9, 3.692995950002153*^9}, {
   3.692995988369205*^9, 3.6929960470031023`*^9}, {3.69299610403204*^9, 
   3.692996127691077*^9}, {3.692996165388915*^9, 3.692996168610406*^9}, {
   3.692996212143119*^9, 3.692996316527934*^9}, {3.6929963862854967`*^9, 
   3.692996438490247*^9}, {3.692996528029798*^9, 3.692996559472693*^9}, {
   3.6929966320942707`*^9, 3.692996663044341*^9}, {3.692996929275672*^9, 
   3.692996981178293*^9}, {3.6929970442809353`*^9, 3.69299711178854*^9}, {
   3.692997177601654*^9, 3.6929972510117893`*^9}, {3.6929973421108637`*^9, 
   3.6929974949775333`*^9}, {3.692997531173468*^9, 3.692997636000671*^9}, {
   3.692998076900972*^9, 3.6929980841323347`*^9}, {3.69299895011489*^9, 
   3.692999042065469*^9}, {3.692999144389872*^9, 3.692999201404024*^9}, {
   3.692999238398851*^9, 3.692999314160597*^9}, {3.692999370818193*^9, 
   3.6929994420360117`*^9}, {3.692999574644878*^9, 3.692999601927969*^9}, {
   3.692999666944447*^9, 3.6929997131507263`*^9}, {3.692999859785246*^9, 
   3.692999905054104*^9}, {3.693000044274027*^9, 3.693000175636013*^9}, {
   3.693000432215445*^9, 3.6930005228167343`*^9}, {3.693000569136426*^9, 
   3.6930005995356617`*^9}, {3.6930010554246807`*^9, 3.693001097355163*^9}, {
   3.693001164865047*^9, 3.693001181312676*^9}, {3.693001215292807*^9, 
   3.6930012156429577`*^9}, {3.6930019954400043`*^9, 3.693002154393383*^9}, 
   3.693002260499281*^9, {3.693002606641614*^9, 3.6930026559795847`*^9}, {
   3.693007842850809*^9, 3.693007859278213*^9}, {3.693009582192292*^9, 
   3.693009589849683*^9}, {3.693009714351083*^9, 3.693009730418219*^9}, {
   3.6930105332863903`*^9, 3.6930105750257893`*^9}, {3.693074744610921*^9, 
   3.693074754908408*^9}, {3.693074797419847*^9, 3.69307482201311*^9}, {
   3.693074972114098*^9, 3.693074973370585*^9}, {3.693077564590247*^9, 
   3.693077564746687*^9}, {3.693077668610025*^9, 3.6930776997057457`*^9}, {
   3.6930779610293016`*^9, 3.693078013854479*^9}, {3.6930789506489773`*^9, 
   3.693078958014596*^9}, {3.6930790964946404`*^9, 3.693079135245757*^9}, {
   3.693079194904241*^9, 3.6930792853687277`*^9}, {3.693079321749164*^9, 
   3.693079493872025*^9}, {3.693079525118457*^9, 3.693079527050907*^9}, {
   3.6930796353447523`*^9, 3.6930799322514467`*^9}, 3.693079995125923*^9, {
   3.693080037806594*^9, 3.693080067322301*^9}, {3.693081125837551*^9, 
   3.693081139785584*^9}, {3.693081186300412*^9, 3.693081293703047*^9}, 
   3.693081329332539*^9, {3.6930813685273647`*^9, 3.693081527593309*^9}, {
   3.693081561344576*^9, 3.693081593354054*^9}, {3.693081639158552*^9, 
   3.693081647022234*^9}, {3.693081798068172*^9, 3.693081932130488*^9}, {
   3.693082008496921*^9, 3.6930820120369997`*^9}, {3.693082278254654*^9, 
   3.6930824008160677`*^9}, {3.693082482677986*^9, 3.6930826080801973`*^9}, 
   3.693082856846073*^9, {3.693082891038076*^9, 3.693082919026443*^9}, {
   3.6930829685201797`*^9, 3.6930829818159313`*^9}, {3.6930830512859707`*^9, 
   3.693083093846322*^9}, {3.693083289426162*^9, 3.693083339673184*^9}, {
   3.693083404988866*^9, 3.693083509769602*^9}, {3.693083597679016*^9, 
   3.693083665226419*^9}, {3.6930837643339443`*^9, 3.693083779002157*^9}, {
   3.693083833095565*^9, 3.6930838339533863`*^9}, {3.693083896154043*^9, 
   3.69308392772364*^9}, {3.69308397798281*^9, 3.693083992844349*^9}, {
   3.6930840471361113`*^9, 3.6930840645820427`*^9}, {3.6930841411040487`*^9, 
   3.693084160626247*^9}, {3.693084222531952*^9, 3.693084250284363*^9}, {
   3.693084281253377*^9, 3.6930842893467493`*^9}, {3.6930843290318003`*^9, 
   3.6930843601487207`*^9}, {3.693084402416293*^9, 3.69308440466432*^9}, {
   3.693085706891562*^9, 3.69308571928239*^9}, {3.693086002131509*^9, 
   3.693086054410334*^9}, {3.6930862715080557`*^9, 3.6930862752476807`*^9}, {
   3.693086311567379*^9, 3.6930864714797373`*^9}, {3.693086504170611*^9, 
   3.693086569506193*^9}, {3.693086689615089*^9, 3.693086701186493*^9}, 
   3.6930868958330107`*^9, {3.693087481639558*^9, 3.6930874906171627`*^9}, {
   3.693087597574333*^9, 3.693087670038155*^9}, {3.693164499971542*^9, 
   3.693164506259718*^9}, {3.693164545970998*^9, 3.693164552847249*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["old", "Subsection",
 CellChangeTimes->{{3.676658515598936*^9, 3.676658517802062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"one", " ", "case", " ", 
    RowBox[{"handled", ":", "\n", "\t", 
     RowBox[{"-", 
      RowBox[{
      "qbasis", " ", "full", " ", "of", " ", "square", " ", "roots"}]}]}]}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NiceFactorList", "[", 
      RowBox[{"f_", ",", "x_", ",", "ext_"}], "]"}], ":=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"First", "/@", 
        RowBox[{"FactorList", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Extension", "\[Rule]", "ext"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "x"}], "]"}], ">", "0"}], "&"}]}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "ff", " ", "is", " ", "square", " ", "free", " ", "and", " ", "all", " ", 
     "roots", " ", "are", " ", "nonzero"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"QBasisForRootSpan", "[", 
      RowBox[{"ffl_List", ",", "x_", ",", "nf_", ",", "nfe_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "bas", ",", "newrow", ",", "a", ",", "b", ",", "c", ",", "rlist", ",",
          "mat", ",", "i", ",", "d", ",", "find", ",", 
         RowBox[{"res", "=", 
          RowBox[{"0", "[", "]"}]}], ",", "\n", "l", ",", "elem", ",", "e", 
         ",", "rl", ",", "\[Delta]", ",", "\[Gamma]", ",", "\[Beta]", ",", 
         "fl", ",", "z", ",", "p", ",", "q", ",", "p1", ",", "p2", ",", "p3", 
         ",", "R", ",", "R1", ",", "R2", ",", "R3", ",", "R4", ",", "r", ",", 
         "E0", ",", "E3", ",", "E1", ",", "E2"}], "}"}], ",", "\n", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nf", "=!=", 
           RowBox[{"NF", "[", 
            RowBox[{"0", ",", "\[Theta]", ",", "0"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<implementation incomplete in QBasisForRootSpan\>\"", "]"}], 
           ";", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nfe", "=!=", "0"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<implementation incomplete in QBasisForRootSpan\>\"", "]"}], 
           ";", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "]"}], ";", "\n", "\n", "\n", 
        RowBox[{"Do", "[", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Scan", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"fac", ",", "\n", "\t\t", 
               RowBox[{"Which", "[", "\n", "\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"fac", ",", "x"}], "]"}], "<", "1"}], ",", "Null", 
                 "\n", "\n", "\t\t", ",", 
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"fac", ",", "x"}], "]"}], "===", "1"}], ",", "\n", 
                 "\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"b", ",", "a"}], "}"}], "=", 
                   RowBox[{"CoefficientList", "[", 
                    RowBox[{"fac", ",", "x"}], "]"}]}], ";", "\n", "\t\t\t", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"res", ",", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<1a\>\"", ",", "nf", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t", "nf", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "b"}], "/", "a"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "b"}], "/", "a"}], "}"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"nfe", ",", "nfe"}], "]"}]}], "\n", "\t\t\t\t", 
                    "}"}], "]"}]}], "\n", "\t\t\t", "]"}], ";"}], "\n", "\n", 
                 "\t\t", ",", 
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"fac", ",", "x"}], "]"}], "===", "2"}], ",", "\n", 
                 "\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
                   RowBox[{"CoefficientList", "[", 
                    RowBox[{"fac", ",", "x"}], "]"}]}], ";", "\n", "\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"c", ",", "b", ",", "a"}], "}"}], "=", 
                   RowBox[{
                    RowBox[{"Sign", "[", "a", "]"}], "*", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "b", ",", "a"}], "}"}]}]}], ";", "\n", 
                  "\t\t\t", 
                  RowBox[{"d", "=", 
                   RowBox[{"SquarefreePart", "[", 
                    RowBox[{
                    RowBox[{"b", "^", "2"}], "-", 
                    RowBox[{"4", "*", "a", "*", "c"}]}], "]"}]}], ";", "\n", 
                  "\t\t\t", 
                  RowBox[{"e", "=", 
                   RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "^", "2"}], "-", 
                    RowBox[{"4", "*", "a", "*", "c"}]}], ")"}], "/", "d"}], 
                    "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}]}], ";", "\n", "\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"b", "=!=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<1a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", "\[Theta]"}], "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "d"}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}], "+", 
                    RowBox[{"e", "*", "\[Theta]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}], "-", 
                    RowBox[{"e", "*", "\[Theta]"}]}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}], "}"}]}], "}"}], ",", 
                    "\n", "\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "d", "]"}], ",", "0"}], "]"}]}], 
                    "\n", "\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t", "]"}]}],
                    "]"}], ";", "\n", "\t\t\t", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"res", ",", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<2a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "d"}], ",", 
                    RowBox[{"Sqrt", "[", "d", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]", "}"}], ",", 
                    RowBox[{"-", "\[Theta]"}], ",", "nf", ",", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "d", "]"}], ",", "0"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "d"}]}], "]"}], "[", 
                    
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "d"}]}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}], "+", 
                    RowBox[{"e", "*", "\[Theta]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "a"}], ")"}]}], "-", 
                    RowBox[{"e", "*", "\[Theta]"}]}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "e", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "e"}], "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "d", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "d", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t", "]"}], ";"}], 
                 "\n", "\t\t", "\n", "\t\t", ",", 
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"fac", ",", "x"}], "]"}], "===", "4"}], ",", "\n", 
                 "\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"e", ",", "d", ",", "c", ",", "b", ",", "a"}], 
                    "}"}], "=", 
                   RowBox[{"CoefficientList", "[", 
                    RowBox[{"fac", ",", "x"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", "\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Delta]", ",", "\[Gamma]", ",", "\[Beta]"}], 
                    "}"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], "*", 
                    RowBox[{"b", "^", "4"}]}], "+", 
                    RowBox[{"16", "*", "a", "*", 
                    RowBox[{"b", "^", "2"}], "*", "c"}], "-", 
                    RowBox[{"64", "*", 
                    RowBox[{"a", "^", "2"}], "*", "b", "*", "d"}], "+", 
                    RowBox[{"256", "*", 
                    RowBox[{"a", "^", "3"}], "*", "e"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"256", "*", 
                    RowBox[{"a", "^", "4"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"b", "^", "3"}], "-", 
                    RowBox[{"4", "*", "a", "*", "b", "*", "c"}], "+", 
                    RowBox[{"8", "*", 
                    RowBox[{"a", "^", "2"}], "*", "d"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"8", "*", 
                    RowBox[{"a", "^", "3"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], "*", 
                    RowBox[{"b", "^", "2"}]}], "+", 
                    RowBox[{"8", "*", "a", "*", "c"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"8", "*", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}]}], "}"}]}], ";", "\n", 
                  "\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "===", "0"}], ",", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"fl", "=", 
                    RowBox[{"First", "/@", 
                    RowBox[{"PolyFactor", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"z", "^", "2"}], "+", 
                    RowBox[{"z", "*", 
                    RowBox[{"\[Beta]", "/", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", "^", "2"}], "-", 
                    RowBox[{"4", "*", "\[Delta]"}]}], ")"}], "/", "16"}]}], 
                    ",", "z", ",", "nf"}], "]"}]}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "fl", "]"}], "<", "2"}], ",", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<implmentation incomplete in QuarticSolve: not all \
cubic roots are rational\>\"", "]"}], ";", 
                    RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{"r", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "z", ",", "0"}], "]"}]}], "/", 
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "z", ",", "1"}], "]"}]}], "&"}], ",", 
                    "fl"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p1", ",", "p2"}], "}"}], "=", 
                    RowBox[{"SquarefreePart", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{"R", "=", 
                    RowBox[{"RootReduce", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p1", "]"}], "+", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "]"}]}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{"R1", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"R2", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"R3", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"R4", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"E0", ",", "E1", ",", "E2"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], ",", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}], "/", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Sqrt", "[", "p1", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "}"}]}]}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b", "=!=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<1a\>\"", ",", "nf", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "E0", "}"}], ",", 
                    RowBox[{"{", "E0", "}"}], ",", 
                    RowBox[{"{", "E0", "}"}], ",", 
                    RowBox[{"{", "E0", "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "d", "]"}], ",", "0"}], "]"}]}], 
                    "\n", "\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t\t", 
                    "]"}]}], "]"}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<2a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p1"}], ",", 
                    RowBox[{"Sqrt", "[", "p1", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]", "}"}], ",", 
                    RowBox[{"-", "\[Theta]"}], ",", "nf", ",", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p1", "]"}], ",", "0"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p1"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"+", "E1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"+", "E1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E1"}], "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"Sqrt", "[", "p1", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
                    ";", "\n", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<2a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p2"}], ",", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]", "}"}], ",", 
                    RowBox[{"-", "\[Theta]"}], ",", "nf", ",", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p2", "]"}], ",", "0"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p2"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"+", "E2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"+", "E2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E2"}], "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
                    ";"}], "\n", "\t\t\t", ",", "\[IndentingNewLine]", 
                    "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"fl", "=", 
                    RowBox[{"First", "/@", 
                    RowBox[{"PolyFactor", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"z", "^", "3"}], "+", 
                    RowBox[{
                    RowBox[{"z", "^", "2"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", "^", "2"}], "-", 
                    RowBox[{"4", "*", "\[Delta]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", "*", "\[Gamma]"}], ")"}]}]}], "-", 
                    RowBox[{"z", "*", 
                    RowBox[{"\[Beta]", "/", "2"}]}], "+", 
                    RowBox[{"\[Gamma]", "/", "8"}]}], ",", "z", ",", "nf"}], 
                    "]"}]}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "fl", "]"}], "<", "3"}], ",", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", 
                    "\"\<implmentation incomplete in QuarticSolve: not all \
cubic roots are rational\>\"", "]"}], ";", 
                    RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\t\t\t\t", 
                    RowBox[{"r", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "z", ",", "0"}], "]"}]}], "/", 
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"#", ",", "z", ",", "1"}], "]"}]}], "&"}], ",", 
                    "fl"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p3", ",", "p1", ",", "p2"}], "}"}], "=", 
                    RowBox[{"SquarefreePart", "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "q"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], 
                    ";", "\n", "\t\t\t\t", 
                    RowBox[{"R", "=", 
                    RowBox[{"RootReduce", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p", "]"}], "+", 
                    RowBox[{"Sqrt", "[", "q", "]"}]}], "]"}]}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{"R1", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"R2", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"R3", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{"R4", "=", 
                    RowBox[{"AlgebraicNumberPolynomial", "[", 
                    RowBox[{
                    RowBox[{"ToNumberField", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ",", "R"}], "]"}], 
                    ",", "\[Theta]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"E0", ",", "E3", ",", "E1", ",", "E2"}], "}"}], 
                    "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"4", "*", "a"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "]"}]}], "*", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], "/", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Sqrt", "[", "p3", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "p1", "]"}], ",", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "}"}]}]}], ";", "\n", 
                    "\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b", "=!=", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<1a\>\"", ",", "nf", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "E0", "}"}], ",", 
                    RowBox[{"{", "E0", "}"}], ",", 
                    RowBox[{"{", "E0", "}"}], ",", 
                    RowBox[{"{", "E0", "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"R", ",", "0"}], "]"}]}], "\n", "\t\t\t\t\t", 
                    "}"}], "]"}]}], "\n", "\t\t\t\t", "]"}]}], "]"}], ";", 
                    "\n", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<2a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p3"}], ",", 
                    RowBox[{"Sqrt", "[", "p3", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]", "}"}], ",", 
                    RowBox[{"-", "\[Theta]"}], ",", "nf", ",", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p3", "]"}], ",", "nfe"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p3"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"+", "E3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"+", "E3"}], "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"Sqrt", "[", "p3", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
                    ";", "\n", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<2a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p1"}], ",", 
                    RowBox[{"Sqrt", "[", "p1", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]", "}"}], ",", 
                    RowBox[{"-", "\[Theta]"}], ",", "nf", ",", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p1", "]"}], ",", "nfe"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p1"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"+", "E1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"+", "E1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E1"}], "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"Sqrt", "[", "p1", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
                    ";", "\n", "\t\t\t\t", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"res", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"belem", "[", 
                    RowBox[{"\"\<2a\>\"", ",", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p2"}], ",", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]", "}"}], ",", 
                    RowBox[{"-", "\[Theta]"}], ",", "nf", ",", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", "p2", "]"}], ",", "nfe"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"\[Theta]", "^", "2"}], "-", "p2"}]}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"NF", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"MinimalPolynomial", "[", 
                    RowBox[{"R", ",", "\[Theta]"}], "]"}], ",", "R"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"R1", ",", "R2", ",", "R3", ",", "R4"}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"+", "E2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"+", "E2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "E2"}], "}"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t", "0", ",", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"MakeRedInfo", "[", 
                    RowBox[{"R", ",", 
                    RowBox[{"Sqrt", "[", "p2", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t", "}"}], "]"}]}], "\n", "\t\t\t\t", "]"}], 
                    ";"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\n", "\t\t", ",",
                  "True", ",", "\n", "\t\t\t", 
                 RowBox[{
                  RowBox[{
                  "Print", "[", 
                   "\"\<implementation incomplete in QBasisForRootSpan: \
factors of certain degree\>\"", "]"}], ";", 
                  RowBox[{"Abort", "[", "]"}], ";"}]}], "\n", "\t\t", "]"}]}],
               "\n", "\t", "]"}], ",", 
             RowBox[{"NiceFactorList", "[", 
              RowBox[{
               RowBox[{
               "ffl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               ",", "x", ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "]"}], ";"}], "\n", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ffl", "]"}]}], "}"}]}], "]"}], ";", "\n", 
        "\n", "\t", 
        RowBox[{"res", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"res", ",", 
           RowBox[{
            RowBox[{"OrderedQ", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#1", "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{"Head", "[", "#2", "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}]}], 
              "}"}], "]"}], "&"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"res", "=", 
         RowBox[{"res", "//.", 
          RowBox[{
           RowBox[{"0", "[", 
            RowBox[{"X___", ",", 
             RowBox[{"B_", "[", "B1___", "]"}], ",", 
             RowBox[{"B_", "[", "B2___", "]"}], ",", "Y___"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"0", "[", 
            RowBox[{"X", ",", 
             RowBox[{"B", "[", 
              RowBox[{"B1", ",", "B2"}], "]"}], ",", "Y"}], "]"}]}]}]}], ";", 
        "\n", "\t", 
        RowBox[{"res", "=", 
         RowBox[{"res", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "[", "X___", "]"}], "\[RuleDelayed]", 
            RowBox[{"List", "[", "X", "]"}]}], "}"}]}]}], ";", "\n", "\n", 
        RowBox[{"Do", "[", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"l", "=", 
            RowBox[{"List", "@@", 
             RowBox[{"res", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "All", ",", "4"}], 
              "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t", 
           RowBox[{"l", "=", 
            RowBox[{"Flatten", "[", "l", "]"}]}], ";", "\n", "\t", 
           RowBox[{"a", "=", 
            RowBox[{"LCM", "@@", 
             RowBox[{"Denominator", "/@", "l"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"a", "=", 
            RowBox[{
             RowBox[{"GCD", "@@", 
              RowBox[{"(", 
               RowBox[{"a", "*", "l"}], ")"}]}], "/", "a"}]}], ";", "\n", 
           "\t", 
           RowBox[{
            RowBox[{"res", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "All", ",", "4"}], "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"List", "@@", 
               RowBox[{"res", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "All", ",", "4"}], 
                "\[RightDoubleBracket]"}]}], ")"}], "/", "a"}]}], ";", "\n", 
           "\t", 
           RowBox[{
            RowBox[{"res", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "0", ",", "3"}], "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{
             RowBox[{"res", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "0", ",", "3"}], "\[RightDoubleBracket]"}], 
             "*", "a"}]}], ";"}], "\n", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "res", "]"}]}], "}"}]}], "]"}], ";", "\n", 
        "\t", "\n", "\t", "res"}]}], "\n", "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SquarefreePart", "[", "n_", "]"}], ":=", 
     RowBox[{"Times", "@@", 
      RowBox[{"Power", "@@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", " ", "2"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"FactorInteger", "[", "n", "]"}]}], ")"}]}]}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.6644759320042653`*^9, 3.6644759537605095`*^9}, {
   3.6644760148080015`*^9, 3.6644760496009912`*^9}, {3.6644761097914343`*^9, 
   3.6644761303116074`*^9}, {3.664476196655402*^9, 3.6644762156474886`*^9}, {
   3.664476245775212*^9, 3.664476248327358*^9}, {3.664478351824671*^9, 
   3.6644784294081087`*^9}, {3.664478478511917*^9, 3.664478504663413*^9}, {
   3.664478728774231*^9, 3.664478729990301*^9}, {3.6644791320912995`*^9, 
   3.6644791353794875`*^9}, {3.6644808409430404`*^9, 
   3.6644808410870485`*^9}, {3.664480875102994*^9, 3.6644809221506853`*^9}, {
   3.66448099863906*^9, 3.6644809989580784`*^9}, {3.6644810395584*^9, 
   3.6644810439096494`*^9}, {3.6644811037420716`*^9, 
   3.6644812021737013`*^9}, {3.6644812751328745`*^9, 
   3.6644812760049243`*^9}, {3.6644813189813824`*^9, 3.664481326019785*^9}, {
   3.6644813721404233`*^9, 3.6644813997880044`*^9}, {3.6644814943394127`*^9, 
   3.664481494515423*^9}, {3.6644819578249226`*^9, 3.664481958335952*^9}, {
   3.6644820113999867`*^9, 3.6644820155602245`*^9}, {3.6644820622388945`*^9, 
   3.664482062933934*^9}, {3.664482380101075*^9, 3.6644824500930786`*^9}, {
   3.664482484005018*^9, 3.6644824845170474`*^9}, {3.6644825543800435`*^9, 
   3.664482606460022*^9}, {3.6644826592920437`*^9, 3.664482670324675*^9}, {
   3.6644827601788144`*^9, 3.6644828141389008`*^9}, {3.664724472953751*^9, 
   3.664724476861251*^9}, {3.664724510865671*^9, 3.664724515876317*^9}, {
   3.664741492746481*^9, 3.6647415247068357`*^9}, {3.664742910326806*^9, 
   3.664742979008511*^9}, {3.664743318343878*^9, 3.664743381327436*^9}, {
   3.664743432102056*^9, 3.664743449545295*^9}, {3.664743550076717*^9, 
   3.664743593402068*^9}, {3.664743661386386*^9, 3.664743680701687*^9}, 
   3.664746388686441*^9, {3.6647467720397243`*^9, 3.66474678667052*^9}, {
   3.664747092117042*^9, 3.664747106424955*^9}, {3.6647471758397627`*^9, 
   3.664747389428594*^9}, {3.664747472488809*^9, 3.6647474725688133`*^9}, {
   3.664747924849071*^9, 3.664747974010929*^9}, {3.664748013986106*^9, 
   3.664748050516685*^9}, {3.6647481712180367`*^9, 3.6647482059699087`*^9}, {
   3.664748309301468*^9, 3.6647483265699577`*^9}, {3.664757547290022*^9, 
   3.664757550813559*^9}, {3.664757583788769*^9, 3.664757685139943*^9}, {
   3.664758575203981*^9, 3.6647585761588793`*^9}, {3.664759029434737*^9, 
   3.664759034653246*^9}, {3.664759206829809*^9, 3.6647592593947477`*^9}, {
   3.6647593399793777`*^9, 3.664759377434791*^9}, {3.66475953484035*^9, 
   3.664759535749744*^9}, {3.664759665129283*^9, 3.664759665434696*^9}, {
   3.6647603735199966`*^9, 3.6647603951383963`*^9}, 3.6647604787602453`*^9, {
   3.66476052505484*^9, 3.6647605432331953`*^9}, 3.664826245399378*^9, 
   3.664826311240542*^9, {3.664826341518168*^9, 3.664826357393857*^9}, {
   3.664826399580872*^9, 3.664826491882473*^9}, {3.664826545781671*^9, 
   3.664826554930604*^9}, {3.6648266799149427`*^9, 3.664826686373047*^9}, {
   3.664826813243928*^9, 3.664826813593203*^9}, {3.664829411033814*^9, 
   3.66482944540131*^9}, {3.664829535115404*^9, 3.664829550590979*^9}, {
   3.664829613551222*^9, 3.6648296577216167`*^9}, {3.664829688714821*^9, 
   3.6648298679957027`*^9}, {3.66482989868143*^9, 3.664829920071154*^9}, {
   3.6648299719080477`*^9, 3.664830034892357*^9}, {3.664830088509379*^9, 
   3.664830312851899*^9}, {3.6648303741818857`*^9, 3.664830374393251*^9}, {
   3.6648310052735023`*^9, 3.579123324524414*^9}, {3.579125851666453*^9, 
   3.579125852664854*^9}, {3.5791259266713843`*^9, 3.5791259278725863`*^9}, {
   3.5791260309263678`*^9, 3.5791260318779693`*^9}, {3.5791260644352264`*^9, 
   3.579126067524032*^9}, {3.579126240559536*^9, 3.579126247439148*^9}, {
   3.579126451050706*^9, 3.5791265050580006`*^9}, {3.57912672679679*^9, 
   3.579126780336084*^9}, {3.579127075831803*^9, 3.5791270831482153`*^9}, {
   3.5791273555246944`*^9, 3.5791274069891844`*^9}, {3.5791274579388742`*^9, 
   3.5791274935537367`*^9}, {3.5791275487154336`*^9, 3.579127616435152*^9}, {
   3.5791276976644955`*^9, 3.579127766398216*^9}, {3.5791278291727257`*^9, 
   3.5791278841316223`*^9}, {3.579127947545734*^9, 3.579127953582945*^9}, {
   3.57912799094501*^9, 3.5791280263414726`*^9}, {3.5791281845413504`*^9, 
   3.579128187208955*^9}, {3.5791282513094673`*^9, 3.57912832097919*^9}, {
   3.5791288552645283`*^9, 3.5791288952161984`*^9}, {3.579128984760356*^9, 
   3.579129008940398*^9}, {3.5791290683453026`*^9, 3.5791291411350307`*^9}, {
   3.5791291783878956`*^9, 3.5791292301643867`*^9}, {3.5791292670584517`*^9, 
   3.5791292691644554`*^9}, {3.579129313515333*^9, 3.579129324326152*^9}, {
   3.57912943115514*^9, 3.57912944829957*^9}, {3.5791296127706585`*^9, 
   3.579129649571123*^9}, {3.579129694358802*^9, 3.5791297238272543`*^9}, {
   3.579129953880858*^9, 3.579130008387354*^9}, {3.579130052535431*^9, 
   3.5791300608502455`*^9}, {3.5791301855412645`*^9, 
   3.5791302695942125`*^9}, {3.5791302998738656`*^9, 
   3.5791303161758947`*^9}, {3.5791304351261034`*^9, 3.579130446248923*^9}, {
   3.5791305870391703`*^9, 3.579130629783245*^9}, {3.5791306619661016`*^9, 
   3.579130733086626*^9}, {3.5791309339681797`*^9, 3.5791309482110043`*^9}, {
   3.579130987835074*^9, 3.57913116193138*^9}, {3.579131694531915*^9, 
   3.57913174858601*^9}, {3.579131809878518*^9, 3.579131830283354*^9}, {
   3.579131892761463*^9, 3.5791319993876505`*^9}, {3.5791320892282085`*^9, 
   3.57913210718384*^9}, {3.579132163562339*^9, 3.5791322008932047`*^9}, {
   3.57913223795887*^9, 3.5791323778911157`*^9}, {3.57913242026079*^9, 
   3.5791325037365365`*^9}, {3.5791325612850375`*^9, 3.579132601267908*^9}, {
   3.5791327666893983`*^9, 3.5791327764706154`*^9}, {3.5791330922931705`*^9, 
   3.579133108033598*^9}, {3.5791331698097067`*^9, 3.579133351347225*^9}, {
   3.5791437254265976`*^9, 3.5791437261597986`*^9}, {3.579143775783486*^9, 
   3.5791438495872154`*^9}, {3.5791439003757076`*^9, 3.579143979910819*^9}, {
   3.579144067175941*^9, 3.579144115831009*^9}, {3.579144168366083*^9, 
   3.5791441847511053`*^9}, {3.579144250381198*^9, 3.5791442633912153`*^9}, {
   3.5791442966712627`*^9, 3.5791443211562967`*^9}, {3.579144356431346*^9, 
   3.579144693041817*^9}, {3.579144797971964*^9, 3.579144922182138*^9}, {
   3.579144975277212*^9, 3.5791450118822637`*^9}, {3.5791450583073287`*^9, 
   3.5791450655873384`*^9}, {3.579145096552382*^9, 3.579145114747408*^9}, {
   3.579145405767815*^9, 3.579145596153082*^9}, {3.5791457017982297`*^9, 
   3.579145789503352*^9}, {3.579145893508498*^9, 3.5791458975735035`*^9}, {
   3.579146005858655*^9, 3.579146008598659*^9}, {3.579146289321085*^9, 
   3.579146289516085*^9}, {3.664894285229849*^9, 3.6648943109745903`*^9}, {
   3.664894920996541*^9, 3.664894971856526*^9}, {3.6648950325172377`*^9, 
   3.6648951033808517`*^9}, {3.6648952049468107`*^9, 3.664895217270713*^9}, {
   3.664895271000504*^9, 3.664895305360372*^9}, {3.6648953410500097`*^9, 
   3.66489541134144*^9}, {3.664895446993123*^9, 3.6648954689818*^9}, {
   3.664896051271329*^9, 3.6648960542226152`*^9}, {3.664896235797059*^9, 
   3.664896243164782*^9}, {3.664896306468161*^9, 3.664896324379512*^9}, {
   3.6648964032651863`*^9, 3.664896406306028*^9}, {3.6648964823988237`*^9, 
   3.6648964977542953`*^9}, {3.664896698944581*^9, 3.6648967087611313`*^9}, {
   3.66489676206387*^9, 3.664896935678934*^9}, {3.664897972191684*^9, 
   3.6648979957630873`*^9}, {3.6648980605492773`*^9, 
   3.5792154080207057`*^9}, {3.579220926795599*^9, 3.5792209634556637`*^9}, {
   3.579221046494609*^9, 3.579221071532653*^9}, {3.579221118161135*^9, 
   3.579221123246744*^9}, 3.5792211668176203`*^9, {3.5792212003732796`*^9, 
   3.5792213940164194`*^9}, {3.5792214364016943`*^9, 3.579221458850134*^9}, {
   3.5792218070583453`*^9, 3.5792219972382793`*^9}, {3.579222039389553*^9, 
   3.579222316009239*^9}, {3.5792223611557183`*^9, 3.5792224491554728`*^9}, {
   3.5792230237980824`*^9, 3.579223024047683*^9}, {3.5792242833598948`*^9, 
   3.579224304825532*^9}, {3.579224355775222*^9, 3.579224419782134*^9}, {
   3.5792244739142294`*^9, 3.5792245299027276`*^9}, {3.5792246174812813`*^9, 
   3.5792246595233555`*^9}, {3.5792246941398163`*^9, 
   3.5792248192832355`*^9}, {3.5792249016513805`*^9, 3.579224932867035*^9}, {
   3.579224965127892*^9, 3.5792249664694943`*^9}, {3.579225075529286*^9, 
   3.5792251220797677`*^9}, {3.579225163934641*^9, 3.5792252249775486`*^9}, {
   3.5792252825884495`*^9, 3.5792252826820498`*^9}, {3.579225332056136*^9, 
   3.5792253369857454`*^9}, {3.579225430539109*^9, 3.5792254426135306`*^9}, {
   3.5792256698123293`*^9, 3.579225704725191*^9}, {3.5792258952015257`*^9, 
   3.579225906558346*^9}, {3.5792260601422596`*^9, 3.5792261086523275`*^9}, {
   3.5792261510554276`*^9, 3.5792261561104345`*^9}, {3.579228367341565*^9, 
   3.579228367541565*^9}, {3.5792283999516106`*^9, 3.579228420661639*^9}, 
   3.579228471636711*^9, {3.579228676746998*^9, 3.5792286972920265`*^9}, {
   3.5792287451620936`*^9, 3.5792287584771123`*^9}, {3.579228794502163*^9, 
   3.579228794917163*^9}, {3.579228855714281*^9, 3.5792288805543165`*^9}, {
   3.5792289492694125`*^9, 3.579229180249736*^9}, {3.579229332674949*^9, 
   3.5792294250321116`*^9}, {3.5792294826371922`*^9, 
   3.5792295158472385`*^9}, {3.5792295750173216`*^9, 
   3.5792295752973223`*^9}, {3.579229636092407*^9, 3.579229703727502*^9}, {
   3.579229964826947*^9, 3.5792300045220027`*^9}, {3.579230056652076*^9, 
   3.5792301199921646`*^9}, {3.579327738788275*^9, 3.5793277684751267`*^9}, {
   3.579327799987182*^9, 3.5793278844457307`*^9}, {3.665350401450571*^9, 
   3.665350406076075*^9}, {3.665350441332262*^9, 3.665350441508461*^9}, {
   3.665607077644024*^9, 3.66560715622291*^9}, {3.665700246206308*^9, 
   3.665700251652686*^9}, {3.665705905216517*^9, 3.665706017656313*^9}, {
   3.665706098316037*^9, 3.6657060985102987`*^9}, {3.665706140933741*^9, 
   3.665706155790635*^9}, {3.665706204022431*^9, 3.665706204889414*^9}, {
   3.665789607462049*^9, 3.665789614015007*^9}, {3.665877868668976*^9, 
   3.5803479007220526`*^9}, {3.666124457916226*^9, 3.6661244623402433`*^9}, {
   3.666124594786222*^9, 3.666124601316761*^9}, {3.666191667417156*^9, 
   3.6661917418414164`*^9}, {3.6661918650134892`*^9, 
   3.6661918706604357`*^9}, {3.666191910610243*^9, 3.666191940857286*^9}, {
   3.666191977952421*^9, 3.66619198890313*^9}, {3.6661922185404253`*^9, 
   3.666192317190398*^9}, {3.6661923499801273`*^9, 3.6661924175718937`*^9}, 
   3.6661925026660757`*^9, {3.6661925537849817`*^9, 3.6661925557192945`*^9}, {
   3.6661925891173964`*^9, 3.6661925992413416`*^9}, {3.666192683914342*^9, 
   3.6661927168444643`*^9}, {3.666192848705347*^9, 3.6661928497037024`*^9}, {
   3.6661929470745335`*^9, 3.666192983935679*^9}, {3.666193040373946*^9, 
   3.666193103738303*^9}, 3.6661932490925803`*^9, {3.6661934598859215`*^9, 
   3.6661934905385456`*^9}, {3.666193525699368*^9, 3.6661935714833136`*^9}, {
   3.6661937201758413`*^9, 3.6661937486289644`*^9}, {3.666193825564712*^9, 
   3.6661938693987446`*^9}, {3.6661940100420337`*^9, 3.666194034033757*^9}, {
   3.6661948027204633`*^9, 3.6661948377408915`*^9}, {3.666211137749679*^9, 
   3.66621114759832*^9}, {3.666211876736182*^9, 3.666211877220387*^9}, {
   3.666211912442564*^9, 3.666211956436781*^9}, {3.66621211080799*^9, 
   3.666212114171628*^9}, {3.666212214762259*^9, 3.666212245300922*^9}, {
   3.666212293639448*^9, 3.666212294839868*^9}, {3.6662124313107357`*^9, 
   3.666212590009632*^9}, {3.666212639243514*^9, 3.666212706834593*^9}, {
   3.666212791056348*^9, 3.6662129546721487`*^9}, {3.6662130186417837`*^9, 
   3.666213043914748*^9}, {3.666213446859415*^9, 3.666213481964057*^9}, {
   3.6662136601023903`*^9, 3.6662137110807753`*^9}, {3.666213741905787*^9, 
   3.666213785304441*^9}, {3.66621388494519*^9, 3.666213904757245*^9}, {
   3.666213938589006*^9, 3.666213985022497*^9}, {3.666214024269328*^9, 
   3.666214068508563*^9}, {3.666214228161292*^9, 3.666214234930539*^9}, 
   3.666214426811308*^9, {3.666214632674904*^9, 3.666214639349633*^9}, {
   3.666214691950334*^9, 3.6662147149283*^9}, {3.6662147646622467`*^9, 
   3.666214764735361*^9}, {3.666214812052433*^9, 3.6662148127096357`*^9}, {
   3.666214858727417*^9, 3.666214929943541*^9}, {3.6662150084147453`*^9, 
   3.66621507143849*^9}, {3.666215193956031*^9, 3.666215333644137*^9}, {
   3.666215377448716*^9, 3.666215408651701*^9}, {3.666215536353215*^9, 
   3.666215631997981*^9}, {3.666215662533778*^9, 3.666215702115691*^9}, {
   3.666215761809545*^9, 3.666215772287559*^9}, {3.6662177549725533`*^9, 
   3.666217920432428*^9}, {3.666217951776647*^9, 3.666217964407177*^9}, {
   3.666218014448983*^9, 3.666218017047645*^9}, {3.666218706700074*^9, 
   3.666218736914299*^9}, {3.666218790443577*^9, 3.666218822272501*^9}, {
   3.666218882341161*^9, 3.666218882404052*^9}, {3.666219004220662*^9, 
   3.666219056101716*^9}, {3.666219133727611*^9, 3.666219297217701*^9}, {
   3.666219335235166*^9, 3.6662193598349447`*^9}, {3.666219399434628*^9, 
   3.6662194065442867`*^9}, {3.666219445954859*^9, 3.666219457874508*^9}, {
   3.6662195377605133`*^9, 3.666219562834317*^9}, {3.6662196578920527`*^9, 
   3.666219662176846*^9}, {3.66622016265709*^9, 3.666220167352199*^9}, {
   3.6662202837928267`*^9, 3.666220285125444*^9}, {3.666220373060083*^9, 
   3.666220393965542*^9}, {3.6662205368762827`*^9, 3.666220593853277*^9}, {
   3.666220654631804*^9, 3.666220663456925*^9}, {3.6662932949676027`*^9, 
   3.6662933057822227`*^9}, {3.666293389735065*^9, 3.666293394618886*^9}, 
   3.6662936543607273`*^9, {3.666293697034473*^9, 3.66629371871237*^9}, {
   3.6662938379387217`*^9, 3.666293875162538*^9}, {3.666293908824861*^9, 
   3.666293910762314*^9}, {3.666293987611499*^9, 3.666293987761333*^9}, {
   3.666294061478321*^9, 3.666294128670356*^9}, {3.666294203181485*^9, 
   3.6662942126008244`*^9}, {3.666294352952381*^9, 3.6662945444089537`*^9}, {
   3.666294578290512*^9, 3.6662945880786943`*^9}, {3.6662946250121393`*^9, 
   3.666294641469926*^9}, {3.6662946966704817`*^9, 3.6662947646709003`*^9}, {
   3.6662948175382032`*^9, 3.666294828553837*^9}, {3.666294886200137*^9, 
   3.666294894600636*^9}, {3.666294987582514*^9, 3.6662949978717613`*^9}, {
   3.666295088240293*^9, 3.6662950901303062`*^9}, {3.6662966542854357`*^9, 
   3.666296733263506*^9}, 3.666296781487101*^9, {3.666296814332735*^9, 
   3.666296827734234*^9}, {3.66629686468904*^9, 3.66629687019979*^9}, {
   3.666296902387995*^9, 3.6662970165025663`*^9}, {3.6662970511307898`*^9, 
   3.6662971000036907`*^9}, {3.6662971487186604`*^9, 3.6662972234577*^9}, {
   3.666297439866685*^9, 3.666297449135215*^9}, {3.666297521114641*^9, 
   3.666297531684441*^9}, {3.666305411766433*^9, 3.6663054238161488`*^9}, {
   3.666305672347797*^9, 3.6663056738097477`*^9}, {3.6663059726913548`*^9, 
   3.666305981112624*^9}, {3.666306027476304*^9, 3.666306103996718*^9}, 
   3.666306519487845*^9, {3.6663066605188837`*^9, 3.666306674601673*^9}, {
   3.666307151017412*^9, 3.666307151346032*^9}, {3.6663071861462317`*^9, 
   3.666307235997669*^9}, {3.666307276032167*^9, 3.666307293539269*^9}, {
   3.666307336854917*^9, 3.6663073387019367`*^9}, {3.6663075071222563`*^9, 
   3.6663075164334707`*^9}, {3.666307718935527*^9, 3.666307803247161*^9}, {
   3.6663078535200567`*^9, 3.666307867718259*^9}, {3.666307958608994*^9, 
   3.666307975905114*^9}, {3.666308006254937*^9, 3.666308016156705*^9}, {
   3.666308213528022*^9, 3.6663082414972153`*^9}, {3.6663084213202887`*^9, 
   3.666308467089592*^9}, {3.6663085138375072`*^9, 3.666308520841847*^9}, 
   3.666308761691813*^9, {3.6663097738377323`*^9, 3.6663097920847883`*^9}, {
   3.6663099037444468`*^9, 3.666309996880961*^9}, {3.6663101460425043`*^9, 
   3.666310180819436*^9}, {3.666310274164509*^9, 3.66631029892249*^9}, {
   3.6663103494234333`*^9, 3.6663103577728243`*^9}, {3.666310449930799*^9, 
   3.6663105211369677`*^9}, {3.666310579673864*^9, 3.666310611524003*^9}, 
   3.666310649201462*^9, {3.6663107088150387`*^9, 3.66631073090979*^9}, {
   3.666311001700205*^9, 3.6663110057749557`*^9}, {3.6663168753689013`*^9, 
   3.6663169272114964`*^9}, {3.666317461756186*^9, 3.666317463507821*^9}, {
   3.666317596387313*^9, 3.6663175996088877`*^9}, {3.6663176508838367`*^9, 
   3.666317678489585*^9}, {3.6663184021237698`*^9, 3.666318409657752*^9}, {
   3.66631986967549*^9, 3.6663198852576857`*^9}, 3.6663199286888237`*^9, {
   3.666319990965139*^9, 3.666320070828614*^9}, {3.666325332773497*^9, 
   3.6663253385413723`*^9}, {3.66634607283328*^9, 3.666346138824765*^9}, {
   3.666346190557866*^9, 3.6663461910942173`*^9}, {3.666346253869322*^9, 
   3.666346291530634*^9}, {3.66634635649054*^9, 3.666346418908277*^9}, {
   3.666346481223846*^9, 3.666346507225999*^9}, {3.666346607706039*^9, 
   3.666346645187051*^9}, {3.66634668283792*^9, 3.666346717379919*^9}, {
   3.666346764607139*^9, 3.666346854187549*^9}, {3.666346997204624*^9, 
   3.666347038540422*^9}, 3.6663471102397137`*^9, {3.666347543314406*^9, 
   3.666347555032111*^9}, {3.6663476303208*^9, 3.666347644424904*^9}, {
   3.66636385533652*^9, 3.6663639572810287`*^9}, {3.666364029616702*^9, 
   3.66636403055512*^9}, {3.666364257666479*^9, 3.666364259390751*^9}, {
   3.666364354945706*^9, 3.666364357907135*^9}, {3.6663644465270853`*^9, 
   3.666364488357546*^9}, {3.666364668516067*^9, 3.6663646766564617`*^9}, {
   3.66636471051867*^9, 3.6663647106960897`*^9}, {3.666364771838593*^9, 
   3.666364779608357*^9}, {3.6663649808926888`*^9, 3.666365007860201*^9}, {
   3.6663650812831078`*^9, 3.66636509330916*^9}, {3.66636518054321*^9, 
   3.6663654056356707`*^9}, {3.66636548983561*^9, 3.6663654938056307`*^9}, {
   3.666365662885044*^9, 3.666365665375491*^9}, {3.666365792441094*^9, 
   3.6663658181592703`*^9}, {3.666365894880678*^9, 3.6663658956500883`*^9}, {
   3.666366653908996*^9, 3.666366657662067*^9}, {3.6663667077493*^9, 
   3.666366727825706*^9}, {3.666366860880774*^9, 3.666366882451614*^9}, {
   3.666366965061287*^9, 3.66636696636298*^9}, {3.666367007264278*^9, 
   3.6663670334020147`*^9}, {3.6663671497449903`*^9, 3.666367230334416*^9}, {
   3.666367360809762*^9, 3.6663674204223433`*^9}, {3.666367488810491*^9, 
   3.6663674893882637`*^9}, {3.666367861193625*^9, 3.666367878771305*^9}, {
   3.666967204850111*^9, 3.666967244723003*^9}, {3.666967305278922*^9, 
   3.666967308377522*^9}, {3.666967343780566*^9, 3.6669674515646257`*^9}, {
   3.66696748744637*^9, 3.666967528358477*^9}, {3.666984042651222*^9, 
   3.66698406442752*^9}, {3.666984299834771*^9, 3.666984369964406*^9}, {
   3.666984485150942*^9, 3.6669845643280277`*^9}, {3.6669846557238007`*^9, 
   3.666984675504241*^9}, {3.6669847187880497`*^9, 3.666984760141321*^9}, {
   3.6669848906132603`*^9, 3.66698489462815*^9}, {3.666984931077347*^9, 
   3.666985054611614*^9}, {3.6669850874791813`*^9, 3.666985095701462*^9}, {
   3.666985131339004*^9, 3.6669851501938467`*^9}, {3.6669851897275352`*^9, 
   3.6669853076292152`*^9}, {3.666985415219544*^9, 3.666985495378461*^9}, {
   3.6669855349970837`*^9, 3.666985569997245*^9}, {3.6669856748720407`*^9, 
   3.666985796770256*^9}, {3.666985831307337*^9, 3.6669858315418367`*^9}, {
   3.6669859826221724`*^9, 3.666986166285849*^9}, {3.666986205422823*^9, 
   3.666986295980246*^9}, {3.666988171769958*^9, 3.6669881794896107`*^9}, {
   3.666988233624123*^9, 3.6669883842202272`*^9}, {3.667229425284898*^9, 
   3.667229458939725*^9}, {3.667229505933073*^9, 3.66722950782203*^9}, {
   3.667229543919611*^9, 3.667229584648491*^9}, {3.6672296228353777`*^9, 
   3.667229651744589*^9}, {3.66723035972956*^9, 3.667230388500518*^9}, {
   3.667230961925597*^9, 3.6672309623124323`*^9}, {3.6672310026409683`*^9, 
   3.667231005758225*^9}, {3.66723127355859*^9, 3.6672312743749313`*^9}, {
   3.6673115889932137`*^9, 3.667311612513649*^9}, {3.6673116722519283`*^9, 
   3.667311682531521*^9}, {3.667311871392226*^9, 3.667311912962517*^9}, {
   3.667311999828106*^9, 3.6673120251160173`*^9}, 3.667312128079815*^9, 
   3.667312161129842*^9, {3.667312200714879*^9, 3.667312222081624*^9}, {
   3.667312293565119*^9, 3.667312330800058*^9}, {3.667312365254664*^9, 
   3.667312420829155*^9}, {3.667312612949252*^9, 3.667312620053361*^9}, {
   3.667334701395246*^9, 3.667334702630561*^9}, {3.667335023418161*^9, 
   3.6673350534013033`*^9}, {3.667335091689886*^9, 3.667335094858527*^9}, {
   3.667335180548201*^9, 3.667335240795291*^9}, {3.667335278494976*^9, 
   3.667335285473888*^9}, {3.667336955181944*^9, 3.667337003244598*^9}, {
   3.6673370588550863`*^9, 3.6673370612380743`*^9}, {3.667673469856557*^9, 
   3.667673493666663*^9}, {3.676653068973818*^9, 3.6766530876615334`*^9}, {
   3.676653137568351*^9, 3.676653140240257*^9}, {3.676653194272126*^9, 
   3.676653265054721*^9}, {3.676653317164694*^9, 3.676653379462264*^9}, {
   3.6766534355730057`*^9, 3.6766534648389664`*^9}, {3.6766535398866997`*^9, 
   3.676653541792972*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["polynomials over number fields", "Section",
 CellChangeTimes->{{3.5791359147437277`*^9, 3.5791359284249516`*^9}, {
  3.5811972956955757`*^9, 3.5811972989247813`*^9}}],

Cell[CellGroupData[{

Cell["basics", "Subsection",
 CellChangeTimes->{{3.5811973092363997`*^9, 3.5811973128712063`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PolyCollect", "[", 
    RowBox[{"a_", ",", "x_", ",", "Null"}], "]"}], ":=", 
   RowBox[{"Collect", "[", 
    RowBox[{"a", ",", "x", ",", "RootReduce"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyCollect", "[", 
     RowBox[{"a_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Collect", "[", 
     RowBox[{"a", ",", "x", ",", 
      RowBox[{
       RowBox[{"NumCollect", "[", 
        RowBox[{"#", ",", "nf"}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyRecpLC", "[", 
     RowBox[{"a_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"NumRecp", "[", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"a", ",", "x", ",", 
        RowBox[{"Exponent", "[", 
         RowBox[{"a", ",", "x"}], "]"}]}], "]"}], ",", "nf"}], "]"}]}], ";"}],
   "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyLC", "[", 
     RowBox[{"a_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"a", ",", "x", ",", 
      RowBox[{"Exponent", "[", 
       RowBox[{"a", ",", "x"}], "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyMakeMonic", "[", 
     RowBox[{"a_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"PolyCollect", "[", 
     RowBox[{
      RowBox[{"a", "*", 
       RowBox[{"PolyRecpLC", "[", 
        RowBox[{"a", ",", "x", ",", "nf"}], "]"}]}], ",", "x", ",", "nf"}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyNormalizeFraction", "[", 
     RowBox[{"A_", ",", "x_", ",", "nf_", ",", "level_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"num", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "x", ",", "nf"}], "]"}]}], ",", 
        RowBox[{"den", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
           "A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "x", ",", "nf"}], "]"}]}], ",", "gcd"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"gcd", "=", "den"}], ";", 
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gcd", "=", 
            RowBox[{"PolyGCD", "[", 
             RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
          "&"}], ",", "num", ",", "level"}], "]"}], ";", "\n", "\t", 
       RowBox[{"gcd", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"gcd", "*", 
           RowBox[{"PolyLC", "[", 
            RowBox[{"den", ",", "x"}], "]"}]}], ",", "x", ",", "nf"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"num", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", "gcd", ",", "x", ",", "nf"}], "]"}], "&"}], ",",
           "num", ",", "level"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"den", "=", 
        RowBox[{"PolyDivide", "[", 
         RowBox[{"den", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"{", 
        RowBox[{"num", ",", "den"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyNormalizeVector", "[", 
     RowBox[{"V_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "gcd", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"gcd", "=", "0"}], ";", 
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gcd", "=", 
            RowBox[{"PolyGCD", "[", 
             RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
          "&"}], ",", "V"}], "]"}], ";", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"gcd", "===", "0"}], ",", "V", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "gcd", ",", "x", ",", "nf"}], "]"}], "&"}], 
           ",", "V"}], "]"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n"}], "Code",
 CellChangeTimes->{{3.666960062551455*^9, 3.666960065750154*^9}, 
   3.6669609071590776`*^9, {3.6672297730266867`*^9, 3.6672297734102182`*^9}, {
   3.686416987673769*^9, 3.686417073546274*^9}, {3.686417191488557*^9, 
   3.574185149192479*^9}, {3.574185904828537*^9, 3.574185912508548*^9}, {
   3.689548249193898*^9, 3.5761767816746235`*^9}, {3.5761768273515043`*^9, 
   3.5761768408767276`*^9}, {3.676653559558802*^9, 3.6711368116080055`*^9}, {
   3.6711369246413045`*^9, 3.6711369310734034`*^9}, 3.6711370422681723`*^9, {
   3.671137145229678*^9, 3.6711371531672826`*^9}, {3.7015083317497673`*^9, 
   3.701508358293416*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyQuotientRemainder", "[", 
     RowBox[{"a_", ",", "b_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"q", "=", "0"}], ",", 
        RowBox[{"r", "=", "a"}], ",", "c", ",", "d"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"PolyRecpLC", "[", 
         RowBox[{"b", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"r", ",", "x"}], "]"}], "\[GreaterEqual]", 
          RowBox[{"Exponent", "[", 
           RowBox[{"b", ",", "x"}], "]"}]}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{
            RowBox[{"x", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{"r", ",", "x"}], "]"}], "-", 
               RowBox[{"Exponent", "[", 
                RowBox[{"b", ",", "x"}], "]"}]}], ")"}]}], "*", 
            RowBox[{"NumCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{"r", ",", "x", ",", 
                 RowBox[{"Exponent", "[", 
                  RowBox[{"r", ",", "x"}], "]"}]}], "]"}], "*", "c"}], ",", 
              "nf"}], "]"}]}]}], ";", "\n", "\t\t", 
          RowBox[{"q", "=", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"q", "+", "d"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
          "\n", "\t\t", 
          RowBox[{"r", "=", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"r", "-", 
              RowBox[{"b", "*", "d"}]}], ",", "x", ",", "nf"}], "]"}]}], 
          ";"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"q", ",", "r"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyQuotient", "[", 
     RowBox[{"a_", ",", "b_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"PolyQuotientRemainder", "[", 
      RowBox[{"a", ",", "b", ",", "x", ",", "nf"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyRemainder", "[", 
     RowBox[{"a_", ",", "b_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"PolyQuotientRemainder", "[", 
      RowBox[{"a", ",", "b", ",", "x", ",", "nf"}], "]"}], 
     "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyDivide", "[", 
    RowBox[{"a_", ",", "b_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "r"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"q", ",", "r"}], "}"}], "=", 
       RowBox[{"PolyQuotientRemainder", "[", 
        RowBox[{"a", ",", "b", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"r", "=!=", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<problem in PolyDivide: {a,b}= \>\"", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", "\"\< r= \>\"", ",", "r"}], 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\t", "q"}]}], 
    "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.666960938273035*^9, 3.666960940752164*^9}, {
  3.7014766881341877`*^9, 3.701476742613803*^9}, {3.701507969517756*^9, 
  3.7015079852461987`*^9}, {3.7015081920468082`*^9, 3.701508205310731*^9}, {
  3.701508255910891*^9, 3.7015082816708813`*^9}, {3.701508937063272*^9, 
  3.701508944702908*^9}, {3.701508977742386*^9, 3.701508978654045*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyGCD", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", "p1"}], ",", 
        RowBox[{"b", "=", "p2"}], ",", "res"}], "}"}], ",", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<PolyGCD: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "x", ",", "nf"}], "}"}]}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"res", "=", 
        RowBox[{"Catch", "[", "\n", "\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"a", ",", "x"}], "]"}], "\[GreaterEqual]", "0"}], ",", 
            "\n", "\t\t", 
            RowBox[{"a", "=", 
             RowBox[{"PolyMakeMonic", "[", 
              RowBox[{"a", ",", "x", ",", "nf"}], "]"}]}], ",", "\n", "\t\t", 
            
            RowBox[{"Throw", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"b", ",", "x"}], "]"}], "<", "0"}], ",", "0", ",", 
               RowBox[{"PolyMakeMonic", "[", 
                RowBox[{"b", ",", "x", ",", "nf"}], "]"}]}], "]"}], "]"}]}], 
           "\n", "\t", "]"}], ";", "\n", "\t", 
          RowBox[{"Do", "[", "\n", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"b", ",", "x"}], "]"}], "<", "0"}], ",", 
               RowBox[{"Throw", "[", "a", "]"}], ",", 
               RowBox[{"b", "=", 
                RowBox[{"PolyMakeMonic", "[", 
                 RowBox[{"b", ",", "x", ",", "nf"}], "]"}]}]}], "]"}], ";", 
             "\n", "\t\t", 
             RowBox[{"a", "=", 
              RowBox[{"PolyRemainder", "[", 
               RowBox[{"a", ",", "b", ",", "x", ",", "nf"}], "]"}]}], ";", 
             "\n", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"a", ",", "x"}], "]"}], "<", "0"}], ",", 
               RowBox[{"Throw", "[", "b", "]"}], ",", 
               RowBox[{"a", "=", 
                RowBox[{"PolyMakeMonic", "[", 
                 RowBox[{"a", ",", "x", ",", "nf"}], "]"}]}]}], "]"}], ";", 
             "\n", "\t\t", 
             RowBox[{"b", "=", 
              RowBox[{"PolyRemainder", "[", 
               RowBox[{"b", ",", "a", ",", "x", ",", "nf"}], "]"}]}], ";"}], 
            "\n", "\t", ",", 
            RowBox[{"{", 
             RowBox[{"1", "+", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"a", ",", "x"}], "]"}], ",", 
                RowBox[{"Exponent", "[", 
                 RowBox[{"b", ",", "x"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
          ";"}], "\n", "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<PolyGCD returning: \>\"", ",", "res"}], "]"}], ";"}], 
        "*)"}], "\n", "res"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyLCM", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", "=", 
        RowBox[{"PolyDivide", "[", 
         RowBox[{"p2", ",", 
          RowBox[{"PolyGCD", "[", 
           RowBox[{"p1", ",", "p2", ",", "x", ",", "nf"}], "]"}], ",", "x", 
          ",", "nf"}], "]"}]}], "}"}], ",", "\n", "\t", 
      RowBox[{"PolyMakeMonic", "[", 
       RowBox[{
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"p1", "*", "q"}], ",", "x", ",", "nf"}], "]"}], ",", "x", 
        ",", "nf"}], "]"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyExtendedGCD", "[", 
    RowBox[{"a_", ",", "b_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c", ",", "c1", ",", "c2", ",", "d", ",", "d1", ",", "d2", ",", "q", 
       ",", "r", ",", "r1", ",", "r2"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"c", "=", "a"}], ";", 
      RowBox[{"d", "=", "b"}], ";", "\n", "\t", 
      RowBox[{"c1", "=", "1"}], ";", 
      RowBox[{"d1", "=", "0"}], ";", 
      RowBox[{"c2", "=", "0"}], ";", 
      RowBox[{"d2", "=", "1"}], ";", "\n", "\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"d", "=!=", "0"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q", ",", "r"}], "}"}], "=", 
          RowBox[{"PolyQuotientRemainder", "[", 
           RowBox[{"c", ",", "d", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"r1", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"c1", "-", 
             RowBox[{"q", "*", "d1"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
         
         RowBox[{"r2", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"c2", "-", 
             RowBox[{"q", "*", "d2"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"c", "=", "d"}], ";", 
         RowBox[{"c1", "=", "d1"}], ";", 
         RowBox[{"c2", "=", "d2"}], ";", "\n", "\t\t", 
         RowBox[{"d", "=", "r"}], ";", 
         RowBox[{"d1", "=", "r1"}], ";", 
         RowBox[{"d2", "=", "r2"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", 
      "\t", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "c2"}], "}"}]}], "}"}], "*", 
         RowBox[{"PolyRecpLC", "[", 
          RowBox[{"c", ",", "x", ",", "nf"}], "]"}]}], ",", "x", ",", "nf"}], 
       "]"}]}]}], "\n", "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.66696007997064*^9, 3.666960083209958*^9}, {
  3.6669609363517303`*^9, 3.666960936980896*^9}, {3.7014765751502943`*^9, 
  3.701476580572983*^9}, {3.701476637326507*^9, 3.701476645486421*^9}, {
  3.701508179406739*^9, 3.7015081802699213`*^9}, {3.7015089851041927`*^9, 
  3.701508985918833*^9}, {3.7015095757204237`*^9, 3.7015096193294077`*^9}, {
  3.701514871823079*^9, 3.70151489188762*^9}, {3.701519897400902*^9, 
  3.701519906521618*^9}, {3.701522002579309*^9, 3.701522065820648*^9}, {
  3.7015221837283487`*^9, 3.701522188432968*^9}}],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.6765533818056316`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "return", " ", "p1", " ", "with", " ", "its", " ", "factors", " ", "in", 
    " ", "common", " ", "with", " ", "p2", " ", "removed"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PolyRemoveCommonFactors", "[", 
      RowBox[{"p1_", ",", "p2_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"PolyMakeMonic", "[", 
           RowBox[{"p1", ",", "x", ",", "nf"}], "]"}]}], ",", "gcd"}], "}"}], 
       ",", "\n", "\t", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"gcd", "=", 
              RowBox[{"PolyGCD", "[", 
               RowBox[{"res", ",", "p2", ",", "x", ",", "nf"}], "]"}]}], ",", 
             "x"}], "]"}], ">", "0"}], ",", 
          RowBox[{"res", "=", 
           RowBox[{"PolyDivide", "[", 
            RowBox[{"res", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}]}], 
         "]"}], ";", "\n", "\t", "res"}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "return", " ", "the", " ", "factors", " ", "of", " ", "p1", " ", "that", 
     " ", "are", " ", "in", " ", "common", " ", "with", " ", "p2"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PolyGetCommonFactors", "[", 
      RowBox[{"p1_", ",", "p2_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"res", "=", "p1"}], ",", "gcd", ",", 
         RowBox[{"com", "=", "1"}]}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"gcd", "=", 
              RowBox[{"PolyGCD", "[", 
               RowBox[{"res", ",", "p2", ",", "x", ",", "nf"}], "]"}]}], ",", 
             "x"}], "]"}], ">", "0"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"com", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"com", "*", "gcd"}], ",", "x", ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"res", "=", 
            RowBox[{"PolyDivide", "[", 
             RowBox[{"res", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}]}]}], 
         "\n", "\t", "]"}], ";", "\n", "\t", "com"}]}], "\n", "]"}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.5811914631067038`*^9, 3.5811914632667036`*^9}, {
   3.5811915702818537`*^9, 3.581191622626927*^9}, {3.581191784152153*^9, 
   3.581191801247177*^9}, {3.5811920284874954`*^9, 3.581192031422499*^9}, {
   3.5811921495326643`*^9, 3.581192195557729*^9}, {3.581192264384858*^9, 
   3.5811923297099495`*^9}, 3.581192377705017*^9, {3.581192409950062*^9, 
   3.5811924345900965`*^9}, {3.5811925111752043`*^9, 3.581192571745289*^9}, {
   3.5811926142153482`*^9, 3.581192631080372*^9}, {3.581192664815419*^9, 
   3.5811929190957747`*^9}, {3.581192964035838*^9, 3.5811930035308933`*^9}, {
   3.5811932508762393`*^9, 3.581193291836297*^9}, {3.5811933461213727`*^9, 
   3.5811933775864167`*^9}, {3.5811934124914656`*^9, 3.581193459336531*^9}, {
   3.581193493251579*^9, 3.581193569831686*^9}, {3.5811936479467955`*^9, 
   3.5811936606918135`*^9}, {3.581193946277213*^9, 3.5811939787222586`*^9}, {
   3.5811940127673063`*^9, 3.5811941349074774`*^9}, {3.5811941659875207`*^9, 
   3.5811941988275666`*^9}, {3.5811942856726885`*^9, 3.581194293472699*^9}, {
   3.581194446297913*^9, 3.5811944694429455`*^9}, {3.581194605608136*^9, 
   3.581194778343378*^9}, {3.5811949155335703`*^9, 3.5811949496886177`*^9}, {
   3.581196025681745*^9, 3.581196128158325*^9}, {3.581196199902851*^9, 
   3.5811962001368513`*^9}, {3.5811962394801207`*^9, 3.58119630175543*^9}, {
   3.5811963368398914`*^9, 3.581196671476079*^9}, {3.5811967113497496`*^9, 
   3.5811967481814137`*^9}, {3.5811967852158794`*^9, 3.581196932480138*^9}, {
   3.581197154686928*^9, 3.5811972205034437`*^9}, {3.581197331450838*^9, 
   3.5811973565824823`*^9}, {3.5811974277030077`*^9, 3.581197437016224*^9}, {
   3.5811974925055213`*^9, 3.581197565061249*^9}, {3.5811977356943483`*^9, 
   3.58119773650555*^9}, {3.5811984058403254`*^9, 3.5811984119867363`*^9}, {
   3.5811989691433864`*^9, 3.5811991537987127`*^9}, {3.5811993119382253`*^9, 
   3.581199348286931*^9}, {3.5811993795517144`*^9, 3.5811993796765146`*^9}, {
   3.5811994633889904`*^9, 3.5811994716454053`*^9}, {3.581199519569993*^9, 
   3.5811996402678275`*^9}, {3.581199674529488*^9, 3.581199747565217*^9}, {
   3.581199844188187*^9, 3.5811998447497883`*^9}, {3.5811999107449045`*^9, 
   3.581199919168919*^9}, {3.5811999761472197`*^9, 3.5812000367301264`*^9}, {
   3.5812000786826005`*^9, 3.5812000828166075`*^9}, {3.5812041383764906`*^9, 
   3.5812041742283535`*^9}, {3.5812185694661417`*^9, 3.581218581701159*^9}, {
   3.581219417819372*^9, 3.581219565034586*^9}, {3.6669600613958673`*^9, 
   3.6669600787619762`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["reductions", "Subsection",
 CellChangeTimes->{{3.6672313147091722`*^9, 3.667231318460099*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyReduce", "[", 
     RowBox[{"f_", ",", "var_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "res", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{"PrimeQ", "[", 
          RowBox[{
          "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}],
          ",", "\"\<bad nf char in PolyReduce\>\""}], "]"}], ";", "\n", 
       RowBox[{"Catch", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"PolyCollect", "[", "\n", "\t\t", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{"f", ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{
                 "nf", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{"If", "[", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"Denominator", "[", "#", "]"}], ",", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], "===", "0"}], ",", 
                 RowBox[{"Throw", "[", "$Failed", "]"}], ",", "\n", 
                 "\t\t\t\t", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Numerator", "[", "#", "]"}], "*", 
                    RowBox[{"PowerMod", "[", 
                    RowBox[{
                    RowBox[{"Denominator", "[", "#", "]"}], ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                   RowBox[{
                   "nf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "\n", "\t\t\t", 
                "]"}], "&"}]}], "]"}], ",", "\n", "\t", "var", ",", "nf"}], 
           "]"}]}], ";", "\n", "\t", 
         RowBox[{"Throw", "[", "res", "]"}], ";"}], "\n", "]"}]}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyCollectExt", "[", 
    RowBox[{"e_", ",", "x_", ",", "bignf_", ",", "smallnf_", ",", "rrmp_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "rmp"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"rmp", "=", 
       RowBox[{"rrmp", "/.", 
        RowBox[{"#", "\[Rule]", "t"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"e", "/.", 
          RowBox[{"#", "\[Rule]", "t"}]}], ",", "x", ",", 
         RowBox[{
          RowBox[{"(", "\n", "\t", 
           RowBox[{"PolyRemainder", "[", 
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "bignf"}], "]"}], ",", "rmp", ",", "t", ",", 
             "smallnf"}], "]"}], "\n", ")"}], "&"}]}], "]"}], "/.", 
       RowBox[{"t", "\[Rule]", "#"}]}]}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.666961497157703*^9, 3.6669615306924467`*^9}, {
   3.666961561293159*^9, 3.666961563455862*^9}, {3.666961604524541*^9, 
   3.666961694132224*^9}, {3.6669617464045687`*^9, 3.6669617770734463`*^9}, {
   3.6669620267832527`*^9, 3.666962027230689*^9}, {3.66696211161799*^9, 
   3.666962111816786*^9}, {3.666962220822668*^9, 3.666962269825637*^9}, {
   3.66696246175417*^9, 3.666962615995026*^9}, 3.666968058456154*^9, {
   3.666968112884931*^9, 3.666968119046933*^9}, {3.667229848912262*^9, 
   3.66722987332001*^9}, {3.673905512234426*^9, 3.6739055295940003`*^9}, {
   3.673905594220479*^9, 3.6739056669869075`*^9}, {3.673911640872615*^9, 
   3.6739116421226006`*^9}, {3.6766536402791824`*^9, 
   3.6711951656890297`*^9}, {3.671195448910433*^9, 3.6711954530823736`*^9}, {
   3.6711955775382338`*^9, 3.671195579850713*^9}, {3.671195740900347*^9, 
   3.671195847184091*^9}, {3.6711958980588455`*^9, 3.671195898230775*^9}, {
   3.671196357207073*^9, 3.671196358738371*^9}, {3.693085049383739*^9, 
   3.693085066976842*^9}, {3.701782885443493*^9, 3.70178288994757*^9}, {
   3.701782929674192*^9, 3.7017829540349293`*^9}, {3.70178344747523*^9, 
   3.701783448056735*^9}, {3.701784728132453*^9, 3.701784742156355*^9}, {
   3.701784880779848*^9, 3.701784881075472*^9}, 3.70263374055054*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolyCollectNumExtReduce", "[", 
    RowBox[{
    "f_", ",", "var_", ",", "nf\[Phi]_", ",", "nf\[Psi]_", ",", "ext_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\n", 
     RowBox[{"Catch", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"res", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{"f", ",", "var", ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NumExtReduce", "[", 
               RowBox[{"#", ",", "nf\[Phi]", ",", "nf\[Psi]", ",", "ext"}], 
               "]"}], "===", "$Failed"}], ",", 
             RowBox[{"Throw", "[", "$Failed", "]"}], ",", "\n", "\t\t\t", 
             RowBox[{"NumExtReduce", "[", 
              RowBox[{"#", ",", "nf\[Phi]", ",", "nf\[Psi]", ",", "ext"}], 
              "]"}]}], "\n", "\t\t", "]"}], "\n", "\t\t", "&"}]}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"Throw", "[", "res", "]"}], ";"}], "\n", "]"}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.702633743877853*^9, 3.702633752189749*^9}, {
  3.702633798366108*^9, 3.7026340201912603`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["factoring", "Subsection",
 CellChangeTimes->{{3.5811977082539005`*^9, 3.5811977124191074`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyD", "[", 
     RowBox[{"p_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"PolyCollect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"p", ",", "x"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyMakeSquareFree", "[", 
     RowBox[{"p_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
           "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<implementation incomplete in PolyMakeSquareFree: \
characteristic of \>\"", ",", "nf", ",", "\"\< is not 0\>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"PolyDivide", "[", 
        RowBox[{"p", ",", 
         RowBox[{"PolyGCD", "[", 
          RowBox[{"p", ",", 
           RowBox[{"PolyD", "[", 
            RowBox[{"p", ",", "x", ",", "nf"}], "]"}], ",", "x", ",", "nf"}], 
          "]"}], ",", "x", ",", "nf"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyIsSquareFree", "[", 
     RowBox[{"p_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
           "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<implementation incomplete in PolyMakeSquareFree: \
characteristic of \>\"", ",", "nf", ",", "\"\< is not 0\>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{
           RowBox[{"PolyGCD", "[", 
            RowBox[{"p", ",", 
             RowBox[{"PolyD", "[", 
              RowBox[{"p", ",", "x", ",", "nf"}], "]"}], ",", "x", ",", 
             "nf"}], "]"}], ",", "x"}], "]"}], "===", "0"}], ")"}]}]}], "\n", 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "the", " ", "pth", " ", "root", " ", "of", " ", "a", " ", 
    "poly", " ", "over", " ", "F_p"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyRoot", "[", 
     RowBox[{"a_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", 
        RowBox[{"p", "=", 
         RowBox[{
         "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"Assert", "[", 
        RowBox[{"PrimeQ", "[", "p", "]"}], "]"}], ";", "\n", "\t", 
       RowBox[{"l", "=", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"a", "/.", 
           RowBox[{"{", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"x", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "p"}], ")"}]}]}], "}"}]}], ",", "x"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"l", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "nf"}], "]"}], "&"}], ",", 
            RowBox[{"l", "^", "p"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "]"}], "-", "1"}], "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"l", ".", 
        RowBox[{"x", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Length", "[", "l", "]"}], "-", "1"}]}], "]"}]}]}]}]}], 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PolyFactorSquareFree", "[", 
     RowBox[{"p1_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{"p1", ",", "x"}], "]"}]}], ",", "i", ",", "b", ",", "c", 
        ",", "w", ",", "y", ",", "z", ",", "g", ",", "res"}], "}"}], ",", 
      "\n", "\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "===", "Null"}], "||", 
          RowBox[{
           RowBox[{
           "nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===",
            "0"}]}], "\n", "\t", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"char", " ", "0", " ", "case"}], " ", "*)"}], "\n", "\t\t", 
         
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
          RowBox[{"b", "=", 
           RowBox[{"PolyD", "[", 
            RowBox[{"a", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"c", "=", 
           RowBox[{"PolyGCD", "[", 
            RowBox[{"a", ",", "b", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"If", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"c", ",", "x"}], "]"}], "===", "0"}], ",", 
            RowBox[{"res", "=", 
             RowBox[{"{", 
              RowBox[{"PolyMakeMonic", "[", 
               RowBox[{"a", ",", "x", ",", "nf"}], "]"}], "}"}]}], ",", "\n", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"w", "=", 
              RowBox[{"PolyDivide", "[", 
               RowBox[{"a", ",", "c", ",", "x", ",", "nf"}], "]"}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"y", "=", 
              RowBox[{"PolyDivide", "[", 
               RowBox[{"b", ",", "c", ",", "x", ",", "nf"}], "]"}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"z", "=", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"y", "-", 
                 RowBox[{"D", "[", 
                  RowBox[{"w", ",", "x"}], "]"}]}], ",", "x", ",", "nf"}], 
               "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"z", "=!=", "0"}], ",", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{"g", "=", 
                 RowBox[{"PolyGCD", "[", 
                  RowBox[{"w", ",", "z", ",", "x", ",", "nf"}], "]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"PolyMakeMonic", "[", 
                   RowBox[{"g", ",", "x", ",", "nf"}], "]"}]}], "]"}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"w", "=", 
                 RowBox[{"PolyDivide", "[", 
                  RowBox[{"w", ",", "g", ",", "x", ",", "nf"}], "]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"y", "=", 
                 RowBox[{"PolyDivide", "[", 
                  RowBox[{"z", ",", "g", ",", "x", ",", "nf"}], "]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"z", "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{"y", "-", 
                    RowBox[{"D", "[", 
                    RowBox[{"w", ",", "x"}], "]"}]}], ",", "x", ",", "nf"}], 
                  "]"}]}], ";"}]}], "\n", "\t\t\t", "]"}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"res", ",", 
               RowBox[{"PolyMakeMonic", "[", 
                RowBox[{"w", ",", "x", ",", "nf"}], "]"}]}], "]"}], ";"}]}], 
           "\n", "\t\t", "]"}]}], "\n", "\t", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"char", " ", "p", " ", "case"}], " ", "*)"}], "\n", "\t\t", 
         
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"Exponent", "[", 
               RowBox[{"p1", ",", "x"}], "]"}], "}"}]}], "]"}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"i", "=", "1"}], ";", "\n", "\t\t", 
          RowBox[{"b", "=", 
           RowBox[{"PolyD", "[", 
            RowBox[{"a", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"b", "=!=", "0"}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"PolyGCD", "[", 
               RowBox[{"a", ",", "b", ",", "x", ",", "nf"}], "]"}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"w", "=", 
              RowBox[{"PolyDivide", "[", 
               RowBox[{"a", ",", "c", ",", "x", ",", "nf"}], "]"}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"w", ",", "x"}], "]"}], ">", "0"}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{
                RowBox[{"y", "=", 
                 RowBox[{"PolyGCD", "[", 
                  RowBox[{"w", ",", "c", ",", "x", ",", "nf"}], "]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"z", "=", 
                 RowBox[{"PolyDivide", "[", 
                  RowBox[{"w", ",", "y", ",", "x", ",", "nf"}], "]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "res", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "res", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "*", "z"}], ",", "x", ",", 
                   "nf"}], "]"}]}], ";", 
                RowBox[{"i", "++"}], ";", "\n", "\t\t\t\t", 
                RowBox[{"w", "=", "y"}], ";", 
                RowBox[{"c", "=", 
                 RowBox[{"PolyDivide", "[", 
                  RowBox[{"c", ",", "y", ",", "x", ",", "nf"}], "]"}]}], 
                ";"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"c", ",", "x"}], "]"}], ">", "0"}], ",", "\n", 
               "\t\t\t\t", 
               RowBox[{
                RowBox[{"c", "=", 
                 RowBox[{"PolyFactorSquareFree", "[", 
                  RowBox[{
                   RowBox[{"PolyRoot", "[", 
                    RowBox[{"c", ",", "x", ",", "nf"}], "]"}], ",", "x", ",", 
                   "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"res", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "*", "j"}], 
                    "\[RightDoubleBracket]"}], "=", 
                   RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"res", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "*", "j"}], 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "c", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf"}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "c", "]"}]}], "}"}]}], "]"}], 
                ";"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", ",", "\n", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"a", "=", 
              RowBox[{"PolyFactorSquareFree", "[", 
               RowBox[{
                RowBox[{"PolyRoot", "[", 
                 RowBox[{"a", ",", "x", ",", "nf"}], "]"}], ",", "x", ",", 
                "nf"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"res", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                  "nf", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "*", "j"}], 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"PolyCollect", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"res", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "*", "j"}], 
                    "\[RightDoubleBracket]"}], "*", 
                   RowBox[{
                   "a", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf"}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";"}]}],
            "\n", "\t\t", "]"}], ";", "\n", "\t\t", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{"Last", "[", "res", "]"}], ",", "x"}], "]"}], "===", 
             "0"}], ",", 
            RowBox[{"res", "=", 
             RowBox[{"Most", "[", "res", "]"}]}]}], "]"}], ";"}]}], "\n", 
        "\t", "]"}], ";", "\n", "\t", "res"}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyFactor", "[", 
    RowBox[{"p1_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{"p1", ",", "x"}], "]"}]}], ",", 
       RowBox[{"i", "=", "0"}], ",", "b", ",", "c", ",", "w", ",", "y", ",", 
       "z", ",", "g", ",", "res", ",", "l", ",", "norm", ",", "s", ",", "p", 
       ",", "m\[Theta]"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"nf", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ";", 
      RowBox[{"m\[Theta]", "=", 
       RowBox[{"nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
       ";", "\n", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", "===", "0"}], "\n", "\t", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"char", " ", "0", " ", "case"}], " ", "*)"}], "\n", "\t\t", 
        RowBox[{
         RowBox[{"l", "=", 
          RowBox[{"PolyFactorSquareFree", "[", 
           RowBox[{"p1", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"res", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"f", ",", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"i", "++"}], ";", "\n", "\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"f", ",", "x"}], "]"}], "===", "0"}], ",", 
                 RowBox[{"{", "}"}], ",", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"s", "=", "0"}], ";", 
                  RowBox[{"While", "[", "\n", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"norm", "=", 
                    RowBox[{"NumCollect", "[", 
                    RowBox[{
                    RowBox[{"Resultant", "[", 
                    RowBox[{
                    RowBox[{"f", "/.", 
                    RowBox[{"{", 
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"x", "+", 
                    RowBox[{"s", "*", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", 
                    "m\[Theta]", ",", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "nf"}], "]"}]}], 
                    ";", "\n", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"NumCollect", "[", 
                    RowBox[{
                    RowBox[{"Resultant", "[", 
                    RowBox[{"norm", ",", 
                    RowBox[{"PolyD", "[", 
                    RowBox[{"norm", ",", "x", ",", "nf"}], "]"}], ",", "x"}], 
                    "]"}], ",", "nf"}], "]"}], "===", "0"}]}], ",", 
                    RowBox[{"s", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s", ">", "0"}], ",", 
                    RowBox[{"-", "s"}], ",", 
                    RowBox[{"1", "-", "s"}]}], "]"}]}]}], "]"}], ";", "\n", 
                  "\t\t\t\t", 
                  RowBox[{"b", "=", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"First", "/@", 
                    RowBox[{"FactorList", "[", "norm", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "x"}], "]"}], ">", "0"}], "&"}]}], 
                    "]"}]}], ";", "\n", "\t\t\t\t", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PolyGCD", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{"f", "/.", 
                    RowBox[{"{", 
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"x", "+", 
                    RowBox[{"s", "*", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", "x", ",", 
                    "nf"}], "]"}], ",", "x", ",", "nf"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"x", "-", 
                    RowBox[{"s", "*", 
                    RowBox[{
                    "nf", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}]}], "}"}]}], ",", "x", ",", 
                    "nf"}], "]"}], ",", "i"}], "}"}], "&"}], ",", "b"}], 
                   "]"}]}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}], 
            ",", "l"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"res", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"res", ",", "1"}], "]"}]}], ";"}], "\n", "\t", ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"char", " ", "p", " ", "case"}], " ", "*)"}], "\n", "\t\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<implementation incomplete in PolyFactor: characteristic of \
\>\"", ",", "nf", ",", "\"\< is not 0\>\""}], "]"}], ";", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", 
      "\t", "res"}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.581197737644352*^9, 3.5811979838595843`*^9}, {
   3.5811980356204753`*^9, 3.581198118940222*^9}, {3.5811981550698853`*^9, 
   3.5811981854275384`*^9}, {3.581203117361744*^9, 3.5812031538552084`*^9}, {
   3.5812035201877794`*^9, 3.5812035540282393`*^9}, {3.5812035889384804`*^9, 
   3.581203614866726*^9}, {3.5812036692750235`*^9, 3.5812036693998237`*^9}, {
   3.5812037007578783`*^9, 3.581203700820279*^9}, {3.5812037550987744`*^9, 
   3.5812037579067793`*^9}, {3.5812037903266363`*^9, 
   3.5812039219122686`*^9}, {3.581203962339134*^9, 3.5812041268324704`*^9}, 
   3.5812041961961927`*^9, {3.581204236934352*^9, 3.5812043467730284`*^9}, {
   3.5812044779548073`*^9, 3.5812044949764376`*^9}, {3.5812045486933317`*^9, 
   3.5812045798349867`*^9}, {3.58120466466426*^9, 3.581204680905888*^9}, {
   3.5812047126705437`*^9, 3.581204903905655*^9}, {3.581208652041793*^9, 
   3.5812087258889017`*^9}, {3.581208769046966*^9, 3.5812088194640408`*^9}, {
   3.5812088495821767`*^9, 3.5812089495865097`*^9}, {3.5812090510467043`*^9, 
   3.5812091504468503`*^9}, {3.5812092568720083`*^9, 3.581209261247014*^9}, {
   3.5812094044892745`*^9, 3.5812094257623053`*^9}, {3.5812133538420095`*^9, 
   3.581213430000121*^9}, {3.581213488484207*^9, 3.581213543374288*^9}, {
   3.581213614676136*^9, 3.5812139681893044`*^9}, {3.5812140011734467`*^9, 
   3.581214052925614*^9}, {3.581214141638219*^9, 3.581214256165481*^9}, {
   3.581214294324537*^9, 3.5812143183175726`*^9}, {3.58121435074962*^9, 
   3.581214357319629*^9}, {3.581214404565699*^9, 3.5812144700177946`*^9}, {
   3.5812146550787272`*^9, 3.5812146559037285`*^9}, {3.666960134549732*^9, 
   3.6669601404593763`*^9}, {3.667166889662449*^9, 3.667166905633233*^9}, {
   3.667166995960932*^9, 3.667167011250647*^9}, {3.667229670387793*^9, 
   3.667229743560261*^9}, {3.667659125143952*^9, 3.667659145616479*^9}, {
   3.667659244969779*^9, 3.667659252970318*^9}, {3.667659313576612*^9, 
   3.667659363728201*^9}, {3.667659549487499*^9, 3.6676595529146137`*^9}, {
   3.6676596255308027`*^9, 3.667659625951231*^9}, {3.690129529785771*^9, 
   3.6766537749682245`*^9}, {3.6766538373915043`*^9, 
   3.6766539315644803`*^9}, {3.7014764085031033`*^9, 3.70147642528736*^9}, {
   3.701476470609502*^9, 3.7014764808152103`*^9}, {3.701476544555272*^9, 
   3.701476547314005*^9}, {3.701509646337017*^9, 3.701509667852709*^9}, {
   3.701509701905202*^9, 3.70150972072327*^9}, {3.7015097743536797`*^9, 
   3.701509780273736*^9}, {3.701509920353344*^9, 3.7015099601931257`*^9}, {
   3.701510809187162*^9, 3.701510813338978*^9}, {3.701511016805767*^9, 
   3.701511020050655*^9}, {3.701511105801256*^9, 3.701511141068521*^9}, {
   3.7015112642744207`*^9, 3.701511298605256*^9}, {3.701513339756777*^9, 
   3.701513341532647*^9}, {3.701513379765698*^9, 3.701513393812914*^9}, {
   3.701513429604828*^9, 3.701513435392543*^9}, {3.701514833835223*^9, 
   3.701514838868846*^9}, {3.701514924417132*^9, 3.701514931237082*^9}, {
   3.701514981083666*^9, 3.701514981493038*^9}, {3.701519923947311*^9, 
   3.701519926197723*^9}, {3.7015218480765657`*^9, 3.701521857573001*^9}, {
   3.701521933414899*^9, 3.701521963198471*^9}, {3.701522257386077*^9, 
   3.7015223106968193`*^9}, {3.701522428125534*^9, 3.701522436821549*^9}, 
   3.702771514924511*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["row operations", "Subsection",
 CellChangeTimes->{{3.581197359562088*^9, 3.581197363727295*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "m", " ", "upper", " ", "triangluar", " ", "by", " ", 
    "invertible", " ", "row", " ", "operations", " ", "in", " ", 
    RowBox[{"k", "[", "x", "]"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PolyHermitianReduceSingular", "[", 
      RowBox[{
       RowBox[{"m_", "?", "ArrayQ"}], ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "=", "m"}], ",", "ncols", ",", "nrows", ",", "min", ",",
          "pv", ",", "new", ",", "q", ",", 
         RowBox[{"r", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nrows", ",", "ncols"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"Do", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"r", ">", "nrows"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"find", " ", "pivot", " ", "at", " ", "row"}], " ", 
              "\[GreaterEqual]", " ", "r"}], ",", " ", 
             RowBox[{"if", " ", "there", " ", "is", " ", "no", " ", "pivot"}],
              ",", " ", 
             RowBox[{
             "then", " ", "this", " ", "column", " ", "is", " ", "done"}]}], 
            " ", "*)"}], "\n", "\t\t", 
           RowBox[{"pv", "=", "0"}], ";", 
           RowBox[{"min", "=", "\[Infinity]"}], ";", "\n", "\t\t", 
           RowBox[{"Do", "[", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"new", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"Exponent", "[", 
                 RowBox[{
                  RowBox[{"M", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  "x"}], "]"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"new", "<", "min"}], ",", 
                RowBox[{
                 RowBox[{"pv", "=", "i"}], ";", 
                 RowBox[{"min", "=", "new"}]}]}], "]"}]}], "\n", "\t\t", ",", 
             
             RowBox[{"{", 
              RowBox[{"i", ",", "r", ",", "nrows"}], "}"}]}], "]"}], ";", 
           "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pv", "===", "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "we", " ", "have", " ", "a", " ", "pivot", " ", "for", " ", "row",
              " ", "r", " ", "and", " ", "column", " ", "j"}], " ", "*)"}], 
           "\n", "\t\t", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"pv", "=!=", "0"}], ",", "\n", "\t\t\t", 
             RowBox[{"(*", " ", 
              RowBox[{
              "move", " ", "the", " ", "pivot", " ", "to", " ", "row", " ", 
               "r"}], " ", "*)"}], "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"r", "=!=", "pv"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}], ";", "\n", 
              "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{"make", " ", "it", " ", "monic"}], " ", "*)"}], "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{
               "M", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
               "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "M", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}],
                   "*", 
                  RowBox[{"PolyRecpLC", "[", 
                   RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x", ",", "nf"}], "]"}]}], ",", "x", ",", "nf"}], "]"}]}],
               ";", "\n", "\t\t\t", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "reduce", " ", "the", " ", "entries", " ", "below", " ", 
                 "the", " ", "pivot"}], ",", " ", 
                RowBox[{
                "if", " ", "any", " ", "are", " ", "non", " ", "zero"}], ",", 
                " ", 
                RowBox[{
                "we", " ", "will", " ", "get", " ", "a", " ", "new", " ", 
                 "pivot"}]}], " ", "*)"}], "\n", "\t\t\t", 
              RowBox[{"pv", "=", "0"}], ";", 
              RowBox[{"min", "=", "\[Infinity]"}], ";", "\n", "\t\t\t", 
              RowBox[{"Do", "[", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "=", 
                  RowBox[{"PolyQuotient", "[", 
                   RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"q", "=!=", "0"}], ",", 
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                    "nf"}], "]"}]}]}], "]"}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"new", "=", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"Exponent", "[", 
                    RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x"}], "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"new", "<", "min"}], ",", 
                   RowBox[{
                    RowBox[{"pv", "=", "i"}], ";", 
                    RowBox[{"min", "=", "new"}]}]}], "]"}], ";"}], "\n", 
                "\t\t\t", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"r", "+", "1"}], ",", "nrows"}], "}"}]}], "]"}], 
              ";"}]}], "\n", "\t\t", "]"}], ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
            "reduce", " ", "the", " ", "entries", " ", "above", " ", "the", 
             " ", "pivot"}], " ", "*)"}], "\n", "\t\t", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"PolyQuotient", "[", 
                RowBox[{
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                 "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"q", "=!=", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                   "nf"}], "]"}]}]}], "]"}], ";"}], "\n", "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"r", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t\t", 
           RowBox[{"r", "++"}], ";"}], "\n", "\t\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<M: \>\"", ",", 
              RowBox[{"MatrixForm", "[", "M", "]"}]}], "]"}], ";", 
            RowBox[{"Pause", "[", "0.5", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\t", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "ncols"}], "}"}]}], "]"}], ";", "\n", 
        "\t", "M"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "make", " ", "m", " ", "upper", " ", "triangluar", " ", "by", " ", 
     "invertible", " ", "row", " ", "operations", " ", "in", " ", 
     RowBox[{"k", "[", "x", "]"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PolyHermitianReduce", "[", 
      RowBox[{
       RowBox[{"m_", "?", "ArrayQ"}], ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "=", "m"}], ",", "ncols", ",", "nrows", ",", "min", ",",
          "pv", ",", "new", ",", "q"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nrows", ",", "ncols"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"Do", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"new", "=", 
               RowBox[{"Abs", "[", 
                RowBox[{"Exponent", "[", 
                 RowBox[{
                  RowBox[{"M", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  "x"}], "]"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "===", "j"}], "||", 
                 RowBox[{"new", "<", "min"}]}], ",", 
                RowBox[{
                 RowBox[{"pv", "=", "i"}], ";", 
                 RowBox[{"min", "=", "new"}]}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", "nrows"}], "}"}]}], "]"}], ";", 
           "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"min", "===", "\[Infinity]"}], ",", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\<HermitianReduce: matrix bad\>\"", "]"}], ";", 
              RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\t\t", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"pv", "=!=", "0"}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "=!=", "pv"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}], ";", "\n", 
              "\t\t\t", 
              RowBox[{
               RowBox[{
               "M", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "M", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
                   "*", 
                  RowBox[{"PolyRecpLC", "[", 
                   RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x", ",", "nf"}], "]"}]}], ",", "x", ",", "nf"}], "]"}]}],
               ";", "\n", "\t\t\t", 
              RowBox[{"pv", "=", "0"}], ";", 
              RowBox[{"min", "=", "\[Infinity]"}], ";", "\n", "\t\t\t", 
              RowBox[{"Do", "[", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"q", "=", 
                  RowBox[{"PolyQuotient", "[", 
                   RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"q", "=!=", "0"}], ",", 
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                    "nf"}], "]"}]}]}], "]"}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"new", "=", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"Exponent", "[", 
                    RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x"}], "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"new", "<", "min"}], ",", 
                   RowBox[{
                    RowBox[{"pv", "=", "i"}], ";", 
                    RowBox[{"min", "=", "new"}]}]}], "]"}], ";"}], "\n", 
                "\t\t\t", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"j", "+", "1"}], ",", "nrows"}], "}"}]}], "]"}], 
              ";"}]}], "\n", "\t\t", "]"}], ";", "\n", "\t\t", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"PolyQuotient", "[", 
                RowBox[{
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                 "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"q", "=!=", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                   "nf"}], "]"}]}]}], "]"}], ";"}], "\n", "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<M: \>\"", ",", 
              RowBox[{"MatrixForm", "[", "M", "]"}]}], "]"}], ";", 
            RowBox[{"Pause", "[", "0.5", "]"}], ";"}], "*)"}], "\n", "\t", 
          ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "ncols"}], "}"}]}], "]"}], ";", "\n", 
        "\t", "M"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "full", " ", "row", " ", "reduction", " ", "of", " ", "non", " ", 
     "singular", " ", "matrix"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PolyGaussJordanReduce", "[", 
      RowBox[{"AA_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "=", "AA"}], ",", "n", ",", "m", ",", 
         RowBox[{"d", "=", "1"}]}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "m"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "<", "n"}], "===", "\[Infinity]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<error in GaussJordanReduce: matrix size bad\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"Do", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "===", 
              "0"}], ",", "\n", "\t\t\t", 
             RowBox[{"Catch", "[", 
              RowBox[{
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], "=!=",
                     "0"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
                    RowBox[{"Throw", "[", "Null", "]"}]}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
               RowBox[{
               "Print", "[", 
                "\"\<error in GaussJordanReduce: matrix singular\>\"", "]"}], 
               ";", 
               RowBox[{"Abort", "[", "]"}], ";"}], "]"}]}], "\n", "\t\t", 
            "]"}], ";", "\n", "\t\t", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "===", "i"}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", "\t\t\t", 
              
              RowBox[{
               RowBox[{
               "A", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolyDivide", "[", 
                   RowBox[{"#", ",", "d", ",", "x", ",", "nf"}], "]"}], "&"}],
                  ",", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], 
                  "]"}]}], "]"}]}], ";"}], "\n", "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
           "\t", 
           RowBox[{"d", "=", 
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}], ";"}], 
          "\n", "\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"A", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{"A", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
               "x", ",", "nf"}], "]"}], "=!=", "0"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<GaussJordanReduce: internal error bad diagonal \>\"", ",", 
               
               RowBox[{"MatrixForm", "[", "AA", "]"}]}], "]"}], ";", 
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t",
         "A"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "full", " ", "row", " ", "reduction", " ", "of", " ", "non", " ", 
     "singular", " ", "matrix", " ", "modulo", " ", "an", " ", "irreduciple", 
     " ", "polynomial", " ", "p"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PolyGaussJordanReduceMod", "[", 
      RowBox[{"AA_", ",", "x_", ",", "p_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "=", "AA"}], ",", "n", ",", "m", ",", 
         RowBox[{"d", "=", "1"}], ",", "gcd", ",", "a", ",", "b"}], "}"}], 
       ",", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "m"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\n", "\t", 
        RowBox[{"A", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolynomialRemainder", "[", 
             RowBox[{"#", ",", "p", ",", "x"}], "]"}], "&"}], ",", "A", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "<", "n"}], "===", "\[Infinity]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<error in PolyGaussJordanReduceMod: matrix size bad\>\"", 
            "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"Do", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "===", 
              "0"}], ",", "\n", "\t\t\t", 
             RowBox[{"Catch", "[", 
              RowBox[{
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], "=!=",
                     "0"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
                    RowBox[{"Throw", "[", "Null", "]"}]}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
               RowBox[{
               "Print", "[", 
                "\"\<error in PolyGaussJordanReduceMod: matrix singular\>\"", 
                "]"}], ";", 
               RowBox[{"Abort", "[", "]"}], ";"}], "]"}]}], "\n", "\t\t", 
            "]"}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"gcd", ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "=", 
            RowBox[{"PolyExtendedGCD", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", "p", 
              ",", "x", ",", "nf"}], "]"}]}], ";", 
           RowBox[{"Assert", "[", 
            RowBox[{"gcd", "===", "1"}], "]"}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
            
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyRemainder", "[", 
                RowBox[{"#", ",", "p", ",", "x", ",", "nf"}], "]"}], "&"}], 
              ",", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "*", "a"}], ",", "x", ",", "nf"}], "]"}]}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "===", "i"}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", "\t\t\t", 
              
              RowBox[{
               RowBox[{
               "A", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolyRemainder", "[", 
                   RowBox[{"#", ",", "p", ",", "x", ",", "nf"}], "]"}], "&"}],
                  ",", 
                 RowBox[{"Collect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "A", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", "x"}], "]"}]}], 
                "]"}]}], ";"}], "\n", "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}], "\n", 
          "\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t",
         "A"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"return", " ", "numerator", " ", "and", " ", "denominator"}], 
     ",", " ", 
     RowBox[{"denominator", " ", "is", " ", "monic"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PolyMatrixInverse", "[", 
      RowBox[{"AA_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "=", "AA"}], ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "AA", "]"}]}], ",", "d"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "A", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"A", "=", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"A", ",", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "}"}], "}"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"A", "=", 
         RowBox[{"PolyGaussJordanReduce", "[", 
          RowBox[{"A", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"d", "=", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"A", "=", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ";;", 
            RowBox[{"n", "+", "n"}]}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"A", ",", "d"}], "}"}], "*", 
           RowBox[{"PolyRecpLC", "[", 
            RowBox[{"d", ",", "x", ",", "nf"}], "]"}]}], ",", "x", ",", 
          "nf"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "produce", " ", "a", " ", "constant", " ", "matrix", " ", "X", " ", 
      "such", " ", "that", " ", 
      RowBox[{"X", ".", "A"}]}], "=", "0"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"PolyNumRowNullSpace", "[", 
     RowBox[{"AA_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"A", "=", "AA"}], ",", "len", ",", "n", ",", "m", ","}], 
       "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "A", "]"}]}], ";", "\n", "\t", 
       RowBox[{"len", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"CoefficientList", "[", 
                  RowBox[{"#", ",", "x"}], "]"}], "]"}], "&"}], ",", 
               RowBox[{"A", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "i"}], "\[RightDoubleBracket]"}]}], "]"}],
              "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"A", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], ",", "x"}],
              "]"}], ",", 
            RowBox[{
            "len", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "m"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"NumNullSpace", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}], ",", "nf"}], 
        "]"}]}]}], "\n", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.5811973757705164`*^9, 3.581197396643353*^9}, {
   3.581197449511846*^9, 3.5811974543946543`*^9}, {3.5811975870260873`*^9, 
   3.581197640346981*^9}, {3.5811982661888804`*^9, 3.581198384827089*^9}, 
   3.581199647833841*^9, {3.581209325262158*^9, 3.581209350742196*^9}, {
   3.5812166861394033`*^9, 3.5812168678596683`*^9}, {3.581216969355815*^9, 
   3.58121704672993*^9}, {3.581217091112994*^9, 3.581217091682995*^9}, {
   3.666969038208756*^9, 3.6669690526205397`*^9}, {3.666969268176364*^9, 
   3.666969269029331*^9}, {3.686163085456429*^9, 3.686163091439456*^9}, {
   3.6861631865947933`*^9, 3.6861631877727823`*^9}, {3.6861633130174007`*^9, 
   3.686163314960335*^9}, {3.686163443909697*^9, 3.686163445485299*^9}, {
   3.6861641183274508`*^9, 3.686164132338778*^9}, {3.686164308530455*^9, 
   3.6861643095981503`*^9}, {3.687606805158539*^9, 3.687606835389254*^9}, {
   3.687607480973898*^9, 3.687607495597724*^9}, {3.687607556396637*^9, 
   3.687607603139194*^9}, {3.68760770403965*^9, 3.6876077106978207`*^9}, 
   3.687607901004566*^9, {3.687607952674507*^9, 3.687608055453084*^9}, {
   3.687608104979787*^9, 3.6876081238538103`*^9}, {3.687608214644589*^9, 
   3.687608215409004*^9}, {3.687608264775928*^9, 3.687608322374322*^9}, {
   3.6876084056856194`*^9, 3.687608421579227*^9}, {3.687608668987479*^9, 
   3.6876087792074966`*^9}, {3.6876088427982903`*^9, 3.687608895035976*^9}, {
   3.6876089305187597`*^9, 3.6876089511249743`*^9}, {3.6876090262622023`*^9, 
   3.687609039994412*^9}, {3.687609088055561*^9, 3.687609148871605*^9}, {
   3.687609499993113*^9, 3.687609500307907*^9}, {3.687609728428384*^9, 
   3.6876097890860577`*^9}, {3.687609959764518*^9, 3.687609960297224*^9}, {
   3.689548722393631*^9, 3.689548729462304*^9}, {3.689548763023567*^9, 
   3.689548776471409*^9}, {3.6895488147344313`*^9, 3.6895489155198927`*^9}, {
   3.689548962403927*^9, 3.689549025957498*^9}, {3.689549058916995*^9, 
   3.6895491298986588`*^9}, {3.689549168810153*^9, 3.689549186296933*^9}, {
   3.689549313262322*^9, 3.5749550002283106`*^9}, {3.5749555299511466`*^9, 
   3.574955533781152*^9}, {3.574956246544851*^9, 3.5749563101389446`*^9}, {
   3.574956591646575*^9, 3.5749566587186728`*^9}, {3.5749566969847307`*^9, 
   3.57495672510977*^9}, {3.574956786021859*^9, 3.5749570068181825`*^9}, {
   3.5749577208432283`*^9, 3.5749577469682646`*^9}, {3.5749578011683445`*^9, 
   3.5749579453155537`*^9}, {3.574958024523671*^9, 3.574958024603671*^9}, {
   3.574958078942751*^9, 3.5749581137548018`*^9}, {3.5749581532138586`*^9, 
   3.5749581793318977`*^9}, {3.5749582170219526`*^9, 
   3.5749582416769867`*^9}, {3.574958275580037*^9, 3.574958277222041*^9}, {
   3.574958308922087*^9, 3.574958309652088*^9}, {3.574958361749163*^9, 
   3.574958363339165*^9}, {3.676496621200614*^9, 3.6764966453258924`*^9}, {
   3.6764967848349457`*^9, 3.671124091468688*^9}, 3.67112419036917*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["algebraic curves", "Section",
 CellChangeTimes->{{3.66420892024028*^9, 3.664208922331251*^9}, {
  3.664725338423921*^9, 3.579383045995612*^9}, {3.666041437449319*^9, 
  3.6660414391128063`*^9}}],

Cell[CellGroupData[{

Cell["function algebra", "Subsection",
 CellChangeTimes->{{3.6888449929322653`*^9, 3.688844997978244*^9}}],

Cell[BoxData[
 RowBox[{"f1", "=", 
  RowBox[{"ToFunctionAlgebra", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["y", "2"], "-", "x"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "+", "1"}], ")"}], 
          SuperscriptBox["y", "3"]}], "-", "x"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.690553179879986*^9, 3.6905531918633013`*^9}, {
   3.690553994649954*^9, 3.6905540072808313`*^9}, {3.690554438387053*^9, 
   3.690554440531187*^9}, {3.690554505971496*^9, 3.6905545113226757`*^9}, {
   3.690556233396825*^9, 3.6905562380443573`*^9}, {3.6905562732486362`*^9, 
   3.69055627799476*^9}, {3.690556488997396*^9, 3.690556498660219*^9}, {
   3.690556959846033*^9, 3.6905569727628193`*^9}, 3.690557625869936*^9, {
   3.690558089894508*^9, 3.690558110230501*^9}, {3.690558184999365*^9, 
   3.690558209143312*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y1", ",", 
       RowBox[{
        SuperscriptBox["y1", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "3"], "+", "x"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y2", ",", 
       RowBox[{
        SuperscriptBox["y2", "2"], "-", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "4"], "+", "1"}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"FunctionAlgebraCompositum", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.574189227128188*^9, 3.574189266563244*^9}, {
   3.5741893608183756`*^9, 3.5741893642783804`*^9}, {3.5741897907439775`*^9, 
   3.5741898027889943`*^9}, {3.574189846214055*^9, 3.574189888244114*^9}, {
   3.574192297954395*^9, 3.574192312156417*^9}, 3.5741958847054076`*^9, {
   3.5741962353509293`*^9, 3.5741962354959297`*^9}, {3.574196270590982*^9, 
   3.5741962746559877`*^9}, {3.5741971653884315`*^9, 3.574197181538454*^9}, {
   3.5741972135075064`*^9, 3.5741972144425077`*^9}, {3.5741972547855706`*^9, 
   3.5741972974736347`*^9}, {3.5741975827580795`*^9, 
   3.5741976045041113`*^9}, {3.5741977917894015`*^9, 
   3.5741978037314215`*^9}, {3.5741979918297114`*^9, 
   3.5741979920197115`*^9}, {3.574198137107935*^9, 3.5741981380929365`*^9}, {
   3.574198222682067*^9, 3.5741982435651007`*^9}, {3.57420571399061*^9, 
   3.5742057332847548`*^9}, {3.5742058346229076`*^9, 3.574205837582912*^9}, {
   3.5742065106589613`*^9, 3.574206514063966*^9}, {3.689258459645434*^9, 
   3.68925850140989*^9}, {3.6892587358072042`*^9, 3.689258749136396*^9}, {
   3.690130629095701*^9, 3.690130629233321*^9}, {3.690130767128047*^9, 
   3.6901307673097067`*^9}, {3.690131059518929*^9, 3.690131084487533*^9}, {
   3.690137355448268*^9, 3.6901373555998917`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FAOFFREP", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FAOFFT", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FAOFFP", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FAOFF\[CapitalDelta]", "=", "6"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FAOFF\[Delta]", "=", "7"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FAOFFVAR", "=", "8"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FAOFFNF", "=", "9"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToFunctionAlgebra", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y_", ",", "curve_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pow", ",", "rep", ",", "M\[Phi]", ",", "M\[Infinity]", ",", "T\[Phi]",
         ",", "P", ",", "P\[Phi]", ",", "\[CapitalDelta]\[Phi]", ",", "n"}], 
       "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "convert", " ", "from", " ", "power", " ", "basis", " ", "to", " ", 
        "a", " ", "integral", " ", "basis", " ", "at", " ", "finite"}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "pow", ",", "rep", ",", "M\[Phi]", ",", "T\[Phi]", ",", "P\[Phi]", 
          ",", "\[CapitalDelta]\[Phi]"}], "}"}], "=", 
        RowBox[{"PowerBasisTraceTimesD", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y", ",", "curve"}], "}"}], ",", "x", ",", "nf"}], "]"}]}],
        ";", "\n", "\t", 
       RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
        RowBox[{
        "pow", ",", "rep", ",", "M\[Phi]", ",", "T\[Phi]", ",", "P\[Phi]", 
         ",", "\[CapitalDelta]\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
     RowBox[{
     "ppow_", ",", "rrep_", ",", "MM\[Phi]_", ",", "TT\[Phi]_", ",", 
      "PP\[Phi]_", ",", "\[CapitalDelta]\[CapitalDelta]\[Phi]_", ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "t", ",", "\[Epsilon]", ",", 
        "ord\[Delta]", ",", "piece", ",", "intbasis", ",", "\n", "or", ",", 
        "M\[Infinity]", ",", "T\[Infinity]", ",", "P", ",", "P\[Infinity]", 
        ",", "\[CapitalDelta]\[Infinity]", ",", "n", ",", "m", ",", "bi", ",",
         "max", ",", "num", ",", "den", ",", "places\[Infinity]", ",", "mat", 
        ",", "M", ",", "X", ",", "Y", ",", "B", ",", "Bi", ",", "S", ",", 
        "Si", ",", "dd", ",", "A", ",", "p", ",", "res", ",", "\n", 
        RowBox[{"pow", "=", "ppow"}], ",", 
        RowBox[{"rep", "=", "rrep"}], ",", 
        RowBox[{"M\[Phi]", "=", "MM\[Phi]"}], ",", 
        RowBox[{"T\[Phi]", "=", "TT\[Phi]"}], ",", 
        RowBox[{"P\[Phi]", "=", "PP\[Phi]"}], ",", 
        RowBox[{
        "\[CapitalDelta]\[Phi]", "=", 
         "\[CapitalDelta]\[CapitalDelta]\[Phi]"}]}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "T\[Phi]", "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "convert", " ", "from", " ", "power", " ", "basis", " ", "to", " ", 
         "a", " ", "integral", " ", "basis", " ", "at", " ", "finite"}], " ", 
        "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B", ",", "T\[Phi]", ",", "P\[Phi]"}], "}"}], "=", 
        RowBox[{"IntegralBasis2", "[", 
         RowBox[{"T\[Phi]", ",", "P\[Phi]", ",", "0", ",", "x", ",", "nf"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"Bi", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{"B", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rep", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[Rule]", 
             RowBox[{"PolyNormalizeFraction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
                  "B"}], ",", 
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
                  "1"}]}], "}"}], ",", "x", ",", "nf", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], "&"}], ",", "rep"}],
          "]"}]}], ";", "\n", "\t", 
       RowBox[{"M\[Phi]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "M\[Phi]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ".", "B"}], ",", 
            RowBox[{
            "M\[Phi]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"PolyGaussJordanReduce", "[", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"B", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ".", "B"}], "-", 
               RowBox[{
                RowBox[{
                "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{"D", "[", 
                 RowBox[{"B", ",", "x"}], "]"}]}]}]}], "}"}], "}"}], "]"}], 
          ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"\[CapitalDelta]\[Phi]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ";;", 
               RowBox[{"n", "+", "n"}]}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"A", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", "nf", ",", 
          
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "divide", " ", "basis", " ", "by", " ", "powers", " ", "of", " ", "x",
          " ", "to", " ", "make", " ", "it", " ", "regular", " ", "at", " ", 
         "infinite"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"or", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
              "P\[Phi]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], ",", "x"}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"T\[Infinity]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "T\[Phi]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{
                 "or", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"P\[Infinity]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "or", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}],
                  "-", 
                 RowBox[{
                 "or", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  "-", 
                 RowBox[{
                 "or", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B", ",", "T\[Infinity]", ",", "P\[Infinity]"}], "}"}], "=", 
        
        RowBox[{"IntegralBasis2", "[", 
         RowBox[{
         "T\[Infinity]", ",", "P\[Infinity]", ",", "\[Xi]", ",", "\[Xi]", ",",
           "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"normalize", " ", "integral", " ", "basis"}], " ", "*)"}], 
       "\n", "\t", 
       RowBox[{"max", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Exponent", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "B", "]"}], ",", "\[Xi]"}], "]"}], "]"}]}],
        ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ord\[Delta]", ",", "mat", ",", "Si"}], "}"}], "=", 
        RowBox[{"NormalizeAtInfinity", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "^", "max"}], "*", 
              RowBox[{
               RowBox[{"DiagonalMatrix", "[", 
                RowBox[{"x", "^", "or"}], "]"}], ".", "B"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Xi]", "\[Rule]", 
               RowBox[{"1", "/", "x"}]}], "}"}]}], ",", "x"}], "]"}], ",", 
          "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"S", ",", "dd"}], "}"}], "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{"Si", ",", "x", ",", "nf"}], "]"}]}], ";", 
       RowBox[{"S", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", "dd", ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
          "S", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"ord\[Delta]", "=", 
        RowBox[{"ord\[Delta]", "-", "max"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "convert", " ", "data", " ", "to", " ", "normalized", " ", "basis"}], 
        " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"P\[Phi]", ",", "dd"}], "}"}], "=", 
        RowBox[{"ChangeTimesBasis", "[", 
         RowBox[{"x", ",", "P\[Phi]", ",", "S", ",", "nf"}], "]"}]}], ";", 
       RowBox[{"P\[Phi]", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", "dd", ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
          "P\[Phi]", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"T\[Phi]", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"Si", ".", "T\[Phi]"}], ",", "x", ",", "nf"}], "]"}]}], ";",
        "\n", "\t", 
       RowBox[{"rep", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[Rule]", 
             RowBox[{"PolyNormalizeFraction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
                  "S"}], ",", 
                 RowBox[{
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
                  "1"}]}], "}"}], ",", "x", ",", "nf", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], "&"}], ",", "rep"}],
          "]"}]}], ";", "\n", "\t", 
       RowBox[{"M\[Phi]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "M\[Phi]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ".", "S"}], ",", 
            RowBox[{
            "M\[Phi]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"PolyGaussJordanReduce", "[", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"S", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ".", "S"}], "-", 
               RowBox[{
                RowBox[{
                "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{"D", "[", 
                 RowBox[{"S", ",", "x"}], "]"}]}]}]}], "}"}], "}"}], "]"}], 
          ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"\[CapitalDelta]\[Phi]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ";;", 
               RowBox[{"n", "+", "n"}]}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"A", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", "nf", ",", 
          
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"make", " ", "infinite", " ", "data"}], " ", "*)"}], "\n", 
       "\t", 
       RowBox[{"P\[Infinity]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ord\[Delta]", "\[LeftDoubleBracket]", "k", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "ord\[Delta]", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"T\[Infinity]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "T\[Phi]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{
                 "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"\[CapitalDelta]\[Infinity]", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{"KroneckerDelta", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], "-", 
               RowBox[{"x", "*", 
                RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "i", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}]}], ")"}], "*", 
             RowBox[{"x", "^", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"Max", "[", "ord\[Delta]", "]"}], "+", 
                RowBox[{
                "ord\[Delta]", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", "^", 
            RowBox[{"Max", "[", "ord\[Delta]", "]"}]}], "*", 
           RowBox[{
           "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\n", "\t", 
       RowBox[{"max", "=", 
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{
          "\[CapitalDelta]\[Infinity]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"max", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"max", ",", 
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"\[CapitalDelta]\[Infinity]", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", "x"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       
       RowBox[{"\[CapitalDelta]\[Infinity]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[CapitalDelta]\[Infinity]", "/", 
               RowBox[{"x", "^", "max"}]}], ")"}], "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}], ",", 
          "\[Xi]", ",", "nf", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<disc: \>\"", ",", 
           RowBox[{"Factor", "[", 
            RowBox[{"Det", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"T\[Phi]", ".", 
                RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
            "]"}]}], "]"}], ";"}], "*)"}], "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<M\[Phi]: \>\"", ",", 
           RowBox[{"1", "/", 
            RowBox[{
            "M\[Phi]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ",", "\"\<*\>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{
            "M\[Phi]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}]}], "]"}], ";"}], "*)"}], "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<int basis: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"{", 
             RowBox[{"Together", "[", 
              RowBox[{
               RowBox[{
               "M\[Phi]", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "*", 
               RowBox[{"LinearSolve", "[", 
                RowBox[{
                 RowBox[{
                 "M\[Phi]", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", "pow"}], "]"}]}], "]"}], 
             "}"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ord\[Delta]: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"{", "ord\[Delta]", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
       "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<T\[Phi] T\[Infinity]: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"{", 
             RowBox[{"T\[Phi]", ",", "T\[Infinity]"}], "}"}], "]"}]}], "]"}], 
         ";"}], "*)"}], "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<P\[Phi] P\[Infinity]: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"MatrixForm", ",", 
              RowBox[{"{", 
               RowBox[{"P\[Phi]", ",", "P\[Infinity]"}], "}"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}],
        "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<\[CapitalDelta]\[Phi] \[CapitalDelta]\[Infinity]: \>\"", ",", 
           RowBox[{"1", "/", 
            RowBox[{
            "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ",", "\"\<*\>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{
            "\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], ",", "\"\<  \>\"", ",", 
           RowBox[{"1", "/", 
            RowBox[{
            "\[CapitalDelta]\[Infinity]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ",", "\"\<*\>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{
            "\[CapitalDelta]\[Infinity]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", 
       "\t", 
       RowBox[{"FunctionAlgebra", "[", 
        RowBox[{"pow", ",", "rep", ",", "M\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{"T\[Phi]", ",", "T\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"P\[Phi]", ",", "P\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[CapitalDelta]\[Phi]", ",", "\[CapitalDelta]\[Infinity]"}], "}"}],
          ",", "ord\[Delta]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FunctionAlgebraCompositum", "[", 
    RowBox[{
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{
      "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
       "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ",", "\n", 
     "\t", 
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{
      "pow2_", ",", "rep2_", ",", "M2_", ",", "T2_", ",", "P2_", ",", 
       "\[CapitalDelta]2_", ",", "ord\[Delta]2_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "pow1", "]"}]}], ",", 
       RowBox[{"n2", "=", 
        RowBox[{"Length", "[", "pow2", "]"}]}], ",", "n", ",", "\n", "id1", 
       ",", "id2", ",", "M\[Phi]", ",", "P\[Phi]", ",", "T\[Phi]", ",", 
       "\[CapitalDelta]\[Phi]", ",", "M\[Infinity]", ",", "P\[Infinity]", ",",
        "T\[Infinity]", ",", "\[CapitalDelta]\[Infinity]", ",", "B", ",", "A",
        ",", "or", ",", "max", ",", "ord\[Delta]", ",", "mat", ",", "Si", ",",
        "S", ",", "dd", ",", "pow", ",", "inv", ",", "piece", ",", "rp1", ",",
        "rp2", ",", "rep"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"n1", "*", "n2"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"id1", ",", "id2"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"inv", "[", 
          RowBox[{
           RowBox[{
           "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "]"}], "=", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"M\[Phi]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"M1", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
              "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "id1", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
              "\[RightDoubleBracket]"}], "*", 
            RowBox[{"M2", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
              "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
              "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
          "M1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*", 
          RowBox[{
          "M2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", "\n", "\t", 
      RowBox[{"M\[Phi]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{"M\[Phi]", ",", "x", ",", "nf", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"P1", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}], "*", 
          RowBox[{"P2", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{"P\[Phi]", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"T\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"T\[Phi]", "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{"T\[Phi]", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"\[CapitalDelta]\[Phi]", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"inv", "[", 
               RowBox[{"a1", ",", "a2"}], "]"}], ",", 
              RowBox[{"inv", "[", 
               RowBox[{"b1", ",", "a2"}], "]"}]}], "\[RightDoubleBracket]"}], 
            "+=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1", ",", "a1", ",", "b1"}], 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{"\[CapitalDelta]2", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b1", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"inv", "[", 
               RowBox[{"a1", ",", "a2"}], "]"}], ",", 
              RowBox[{"inv", "[", 
               RowBox[{"a1", ",", "b2"}], "]"}]}], "\[RightDoubleBracket]"}], 
            "+=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]2", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1", ",", "a2", ",", "b2"}], 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b2", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";"}], "\n", 
        "\t", ",", 
        RowBox[{"{", 
         RowBox[{"a1", ",", "1", ",", "n1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a2", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"\[CapitalDelta]\[Phi]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[CapitalDelta]\[Phi]", ",", 
           RowBox[{
            RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
            RowBox[{"\[CapitalDelta]2", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
         ",", "x", ",", "nf", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"pow", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pow1", "\[LeftDoubleBracket]", 
           RowBox[{
           "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], "*", 
          RowBox[{"pow2", "\[LeftDoubleBracket]", 
           RowBox[{
           "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"rep", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"rp2", "=", 
          RowBox[{"1", "/.", "rep2"}]}], ";", "\n", "\t\t", 
         RowBox[{"rp1", "=", 
          RowBox[{"rep1", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"piece", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rp1", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id1", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{"rp2", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "rp1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "*", 
             RowBox[{
             "rp2", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\n", "\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"rep", ",", 
           RowBox[{
            RowBox[{"1", "*", 
             RowBox[{"rep1", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}]}], "\[Rule]", 
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{"piece", ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}], "\n", "\t", ",", 
        
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "rep1", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"rp1", "=", 
          RowBox[{"1", "/.", "rep1"}]}], ";", "\n", "\t\t", 
         RowBox[{"rp2", "=", 
          RowBox[{"rep2", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"piece", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rp1", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id1", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{"rp2", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "rp1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "*", 
             RowBox[{
             "rp2", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\n", "\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"rep", ",", 
           RowBox[{
            RowBox[{"1", "*", 
             RowBox[{"rep2", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}]}], "\[Rule]", 
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{"piece", ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}], "\n", "\t", ",", 
        
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "rep2", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
       RowBox[{"pow", ",", 
        RowBox[{"DeleteDuplicates", "[", "rep", "]"}], ",", "M\[Phi]", ",", 
        "T\[Phi]", ",", "P\[Phi]", ",", "\[CapitalDelta]\[Phi]", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.688844986216606*^9, 3.6888449900064077`*^9}, {
   3.688845021461917*^9, 3.688845072179531*^9}, 3.6888451232097893`*^9, {
   3.688846249196824*^9, 3.68884631678924*^9}, {3.68885210859066*^9, 
   3.68885212587742*^9}, {3.688852160443994*^9, 3.688852182522778*^9}, {
   3.688852312353519*^9, 3.688852320614333*^9}, {3.688852380206599*^9, 
   3.688852386089395*^9}, {3.6888527429077387`*^9, 3.6888527576810207`*^9}, {
   3.688852868356431*^9, 3.688852881937272*^9}, {3.688852912543847*^9, 
   3.6888529150889997`*^9}, 3.688852982882958*^9, {3.6888530303347893`*^9, 
   3.5741060229972596`*^9}, {3.5741060709273267`*^9, 
   3.5741060874473495`*^9}, {3.574106208312519*^9, 3.5741063388227015`*^9}, {
   3.5741064803429*^9, 3.5741065372129793`*^9}, {3.574106703248212*^9, 
   3.574106703553212*^9}, {3.5741067886033316`*^9, 3.5741068331433935`*^9}, {
   3.5741079338499346`*^9, 3.5741079706099863`*^9}, {3.5741080087050395`*^9, 
   3.5741080927501574`*^9}, {3.5741081328802137`*^9, 
   3.5741081336952143`*^9}, {3.574108213415326*^9, 3.5741082856304274`*^9}, {
   3.574108474060691*^9, 3.574108479555699*^9}, {3.5741085187007537`*^9, 
   3.5741085744858313`*^9}, {3.5741087168460307`*^9, 
   3.5741088317711916`*^9}, {3.5741088786062574`*^9, 3.574108911396303*^9}, {
   3.5741089946514196`*^9, 3.5741090174064517`*^9}, {3.574109069036524*^9, 
   3.574109131151611*^9}, {3.5741091836916847`*^9, 3.5741091843616858`*^9}, {
   3.574109277341816*^9, 3.5741092952268405`*^9}, {3.574109382266962*^9, 
   3.574109386836969*^9}, {3.5741097274224453`*^9, 3.5741097298974495`*^9}, {
   3.574110081747942*^9, 3.5741101208129964`*^9}, {3.5741103916433754`*^9, 
   3.5741104266334248`*^9}, {3.574110496869421*^9, 3.5741105040698333`*^9}, {
   3.574110642019724*^9, 3.5741106424717493`*^9}, {3.5741144411100187`*^9, 
   3.574114464102334*^9}, {3.574114660652576*^9, 3.5741146655698576`*^9}, {
   3.574115106321067*^9, 3.574115106713089*^9}, {3.574115176240066*^9, 
   3.57411518120835*^9}, {3.5741152278240166`*^9, 3.574115237431566*^9}, {
   3.574115279750986*^9, 3.574115296535947*^9}, {3.574115454421977*^9, 
   3.574115538357778*^9}, {3.574115583869381*^9, 3.5741156351733155`*^9}, {
   3.5741156654570475`*^9, 3.5741156660180798`*^9}, {3.574115731028798*^9, 
   3.5741158030839195`*^9}, {3.5741158690126905`*^9, 
   3.5741159387586794`*^9}, {3.5741159825891867`*^9, 
   3.5741160615087004`*^9}, {3.5741161188359795`*^9, 
   3.5741161802354913`*^9}, {3.5741162249150467`*^9, 
   3.5741162644753094`*^9}, {3.5741163549864864`*^9, 3.574116356338564*^9}, {
   3.5741164361151266`*^9, 3.5741166796590567`*^9}, {3.5741843615033627`*^9, 
   3.5741843691983733`*^9}, {3.5741849737372336`*^9, 3.574184974367234*^9}, {
   3.574185046337335*^9, 3.5741851114724264`*^9}, {3.574185166197503*^9, 
   3.574185264857641*^9}, {3.5741853008876915`*^9, 3.574185315412712*^9}, {
   3.5741855457980347`*^9, 3.574185558643052*^9}, {3.574185611103126*^9, 
   3.5741856201581383`*^9}, {3.5741857272682886`*^9, 3.574185727618289*^9}, {
   3.574185768163346*^9, 3.5741858907385173`*^9}, {3.5741859857536507`*^9, 
   3.5741861074288206`*^9}, {3.574186159793894*^9, 3.5741861908489375`*^9}, {
   3.574186221878981*^9, 3.574186240234007*^9}, {3.5741862986390886`*^9, 
   3.574186298819089*^9}, {3.5741863293191314`*^9, 3.57418641395925*^9}, {
   3.5741864493992996`*^9, 3.574186504109376*^9}, {3.5741870270251083`*^9, 
   3.574187027560109*^9}, {3.5741870631401587`*^9, 3.574187181280324*^9}, {
   3.574187212570368*^9, 3.574187316705514*^9}, {3.574187351715563*^9, 
   3.5741874181856556`*^9}, {3.5741875000357704`*^9, 
   3.5741875417908287`*^9}, {3.574187736921102*^9, 3.5741877563811293`*^9}, {
   3.574187849031259*^9, 3.574187876816298*^9}, {3.574191070255453*^9, 
   3.574191075584462*^9}, {3.5741970600722694`*^9, 3.5741971224183645`*^9}, {
   3.5741979644346685`*^9, 3.574197964634669*^9}, 3.57419801613375*^9, {
   3.5741981520439587`*^9, 3.5741981531439605`*^9}, {3.574198265178135*^9, 
   3.5741982712631435`*^9}, {3.574361208147375*^9, 3.574361210107487*^9}, 
   3.5743612887329845`*^9, {3.574361510378662*^9, 3.574361625087223*^9}, {
   3.575244909823805*^9, 3.5752449112288074`*^9}, {3.5752452556192894`*^9, 
   3.5752452557792892`*^9}, {3.5752453364844027`*^9, 
   3.5752454033344965`*^9}, {3.575245466654585*^9, 3.5752454842746096`*^9}, {
   3.575245548019699*^9, 3.5752455809297447`*^9}, {3.575245611609788*^9, 
   3.5752456226748033`*^9}, {3.5752462377906647`*^9, 
   3.5752462762657185`*^9}, {3.5752463333357983`*^9, 3.575246374480856*^9}, {
   3.5752464197559195`*^9, 3.575246433170938*^9}, 3.5752464806810045`*^9, {
   3.690127147289947*^9, 3.690127155236082*^9}, {3.690127802540587*^9, 
   3.690127809059807*^9}, {3.690551104396558*^9, 3.690551144279047*^9}, {
   3.690551206835569*^9, 3.6905512585470533`*^9}, {3.690551331126338*^9, 
   3.690551350115507*^9}, {3.690551770138772*^9, 3.690551829195121*^9}, 
   3.690551914684682*^9, {3.6905523298186607`*^9, 3.69055242376825*^9}, {
   3.690552454019794*^9, 3.690552566213401*^9}, {3.690552638953671*^9, 
   3.690552758958057*^9}, {3.690552944662112*^9, 3.690552952103745*^9}, {
   3.690553004930037*^9, 3.690553158142647*^9}, {3.6905539708563128`*^9, 
   3.6905539809956284`*^9}, {3.690554089240272*^9, 3.6905541285437403`*^9}, {
   3.6905544212783127`*^9, 3.6905544294406977`*^9}, {3.690554592479065*^9, 
   3.690554595039439*^9}, {3.6905549161601686`*^9, 3.690554917475978*^9}, {
   3.690555552847986*^9, 3.6905555648637753`*^9}, {3.69055560956688*^9, 
   3.690555612103053*^9}, {3.6905557960733433`*^9, 3.690555800175849*^9}, {
   3.690555975484228*^9, 3.690556069331148*^9}, {3.690556131599711*^9, 
   3.690556138443778*^9}, {3.690556322474832*^9, 3.690556355971435*^9}, {
   3.6905564623526373`*^9, 3.690556480129716*^9}, {3.690556516151422*^9, 
   3.690556600786339*^9}, {3.6905566326152353`*^9, 3.69055665572307*^9}, {
   3.690556698481471*^9, 3.6905567239414883`*^9}, {3.690557003395337*^9, 
   3.690557062982379*^9}, {3.690557096280272*^9, 3.690557145389382*^9}, {
   3.69055735825773*^9, 3.690557390706134*^9}, {3.690557422284359*^9, 
   3.690557435638138*^9}, {3.6905576423210506`*^9, 3.690557648366013*^9}, {
   3.690558058344309*^9, 3.690558069930707*^9}, {3.69055813187891*^9, 
   3.690558156757473*^9}, {3.6905586930714273`*^9, 3.690558703048596*^9}, {
   3.69055874956771*^9, 3.6905587580930347`*^9}, {3.690562569366858*^9, 
   3.690562570830398*^9}, {3.690562779976212*^9, 3.69056279144903*^9}, {
   3.690562992898807*^9, 3.690563093770646*^9}, {3.690563127803803*^9, 
   3.690563199325513*^9}, {3.690563449826315*^9, 3.690563606355549*^9}, {
   3.69056370027812*^9, 3.576168619818288*^9}, {3.576169329057934*^9, 
   3.5761693345179434`*^9}, {3.576169367059601*^9, 3.5761694588657618`*^9}, {
   3.576169498396231*^9, 3.5761695190350676`*^9}, {3.5761695561631327`*^9, 
   3.576169559766739*^9}, {3.576169627580058*^9, 3.5761696886697655`*^9}, {
   3.576169972871065*^9, 3.5761699763186707`*^9}, {3.6739090201450634`*^9, 
   3.6711258292080793`*^9}, {3.671131848039402*^9, 3.6711319147918897`*^9}, {
   3.6711459342798915`*^9, 3.6711459350455265`*^9}, {3.6932309817914124`*^9, 
   3.69323098569779*^9}, {3.70160502665259*^9, 3.701605031612021*^9}, {
   3.701615497435563*^9, 3.70161554121485*^9}, {3.701615693192037*^9, 
   3.7016157440365667`*^9}, {3.701616294001183*^9, 3.701616306387342*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y1", ",", 
       RowBox[{
        SuperscriptBox["y1", "2"], "-", "x"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y2", ",", 
       RowBox[{
        SuperscriptBox["y2", "4"], "-", 
        RowBox[{"(", "x", ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"FunctionAlgebraCompositum", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.701602122036233*^9, 3.701602161453594*^9}, {
  3.70160221194096*^9, 3.70160224391842*^9}}],

Cell[CellGroupData[{

Cell[BoxData["f1"], "Input",
 CellChangeTimes->{{3.70160212987507*^9, 3.701602129879496*^9}}],

Cell[BoxData[
 RowBox[{"FunctionAlgebra", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "y1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ",", 
     RowBox[{"y1", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox["1", "2"]}], "}"}]}], "}"}], ",", "x"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox["1", "2"]}], "}"}]}], "}"}], ",", "\[Xi]"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.701602130260103*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y1", ",", 
       RowBox[{
        SuperscriptBox["y1", "2"], "-", "x"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y2", ",", 
       RowBox[{
        SuperscriptBox["y2", "4"], "-", "x"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "=", 
  RowBox[{"FunctionAlgebraCompositum", "[", 
   RowBox[{"f1", ",", "f2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FunctionAlgebraComponents", "[", 
  RowBox[{"f", ",", "\[Phi]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5761699059781475`*^9, 3.576169921016574*^9}, {
  3.576171893390438*^9, 3.5761719298945017`*^9}, {3.5761729220406446`*^9, 
  3.5761729619143147`*^9}, {3.5761742640486016`*^9, 3.576174269430611*^9}, {
  3.701608737430851*^9, 3.7016087599761047`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"ToFunctionAlgebra", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"y", "^", "2"}], "-", 
       RowBox[{"x", "^", "2"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
    RowBox[{"NF", "[", 
     RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6765530107126646`*^9, 3.676553125939548*^9}, {
   3.6765531785161247`*^9, 3.676553188172493*^9}, {3.6765533498498607`*^9, 
   3.676553365084463*^9}, {3.6765534023192654`*^9, 3.676553436643725*^9}, {
   3.6765535070207005`*^9, 3.6765535326303954`*^9}, 3.6765704777305007`*^9, {
   3.6765706186069*^9, 3.6765706357112694`*^9}, {3.676570671180414*^9, 
   3.67657074105974*^9}, {3.676589919287325*^9, 3.676589926834345*^9}, {
   3.6766543377117805`*^9, 3.6766543378055334`*^9}, {3.6766545638869276`*^9, 
   3.676654564511962*^9}, {3.6955905570207987`*^9, 3.695590559980886*^9}, {
   3.701605156318582*^9, 3.701605159566368*^9}, 3.701606109534952*^9, 
   3.701606590791623*^9, {3.70160719168891*^9, 3.701607193592802*^9}}],

Cell[BoxData[
 RowBox[{"FunctionAlgebra", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", "1"}], "}"}]}], ",", 
     RowBox[{"y", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "x"}], "}"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "x"}], "}"}]}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "1"}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.70160611007892*^9, 3.7016065915430813`*^9, 
  3.701607194050787*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FunctionAlgebraComponents", "[", 
  RowBox[{"f", ",", "\[Phi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.701605242776321*^9, 3.701605243550467*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"FunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "1"}], "}"}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "x", "}"}], "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"FunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}], ",", "1"}], "}"}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "x", "}"}], "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], "}"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.701606450182127*^9, 3.701606474519314*^9}, 
   3.701606527423625*^9, 3.701606593160675*^9, 3.701606874032065*^9, 
   3.701607044358624*^9, 3.701607140968203*^9, {3.7016071720882893`*^9, 
   3.701607195163538*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FunctionAlgebraComponents", "[", "\n", 
    RowBox[{
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{"pow_", ",", "rep_", ",", "M\[Phi]_", ",", 
       RowBox[{"{", 
        RowBox[{"T\[Phi]_", ",", "T\[Infinity]_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"P\[Phi]_", ",", "P\[Infinity]_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]\[Phi]_", ",", "\[CapitalDelta]\[Infinity]_"}], "}"}],
        ",", "ord\[Delta]_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], "\n", ",", 
     "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Mi", ",", "rep1", ",", "M\[Phi]1", ",", "T\[Phi]1", ",", 
       "T\[Infinity]1", ",", "P\[Phi]1", ",", "P\[Infinity]1", ",", 
       "\[CapitalDelta]\[Phi]1", ",", "\[CapitalDelta]\[Infinity]1", ",", 
       "pideals", ",", "\n", "primes", ",", "ind", ",", "ind2", ",", "cind", 
       ",", "fxns", ",", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "pow", "]"}]}], ",", "piece", ",", 
       "indicators", ",", "nf1", ",", "ext", ",", "\n", "iideals", ",", "id", 
       ",", "P", ",", "Pd", ",", "\[CapitalDelta]", ",", "\[CapitalDelta]d", 
       ",", "M", ",", "Md", ",", "T", ",", "row", ",", "den", ",", "POW", ",",
        "REP", ",", 
       RowBox[{"fa", "=", 
        RowBox[{"{", "}"}]}], ",", "newnf", ",", "old\[Theta]"}], "}"}], ",", 
     "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"primes", ",", "pideals", ",", "nf1", ",", "ext"}], "}"}], 
       "=", 
       RowBox[{"PlaceDecompose", "[", 
        RowBox[{"P\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0"}], "}"}], ",", "nf", ",", "\[Phi]"}], "]"}]}],
       ";", "\n", 
      RowBox[{"cind", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"ord\[Delta]", ",", "0"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rep1", ",", "M\[Phi]1", ",", 
         RowBox[{"{", 
          RowBox[{"T\[Phi]1", ",", "T\[Infinity]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"P\[Phi]1", ",", "P\[Infinity]1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[CapitalDelta]\[Phi]1", ",", "\[CapitalDelta]\[Infinity]1"}], 
          "}"}]}], "}"}], "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rep", ",", "M\[Phi]", ",", 
            RowBox[{"{", 
             RowBox[{"T\[Phi]", ",", "T\[Infinity]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"P\[Phi]", ",", "P\[Infinity]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\[CapitalDelta]\[Phi]", ",", "\[CapitalDelta]\[Infinity]"}], 
             "}"}]}], "}"}], "/.", 
          RowBox[{
          "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf1"}], "]"}]}], ";", 
      "\n", "\n", 
      RowBox[{"Mi", "=", 
       RowBox[{"PolyMatrixInverse", "[", 
        RowBox[{
         RowBox[{
         "M\[Phi]1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "x", ",", "nf1"}], "]"}]}], ";", "\n", 
      RowBox[{"fxns", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PolyNormalizeFraction", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
               "M\[Phi]1", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "*", "#"}], ",", 
              RowBox[{
              "Mi", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "}"}], ",", "x", ",", "nf1", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "Mi", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".",
             "pow"}], ")"}], "\[LeftDoubleBracket]", "cind", 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"primes", "=", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"primes", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "cind"}], "\[RightDoubleBracket]"}], "]"}]}], 
      ";", "\n", 
      RowBox[{"primes", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"NumMatrixInverse", "[", 
         RowBox[{"primes", ",", "nf1"}], "]"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<int basis constants: \>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"FullSimplify", "[", "fxns", "]"}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<indicator fxns     : \>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"primes", ".", 
              RowBox[{"fxns", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "/", 
             RowBox[{"fxns", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
           "]"}]}], "]"}], ";"}], "*)"}], "\n", "\n", 
      RowBox[{"indicators", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "cind", "]"}], ",", "n"}], "}"}]}], "]"}]}],
       ";", "\n", 
      RowBox[{"iideals", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "cind", "]"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Do", "[", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"indicators", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{
            "cind", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"primes", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ";"}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "cind", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "cind", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<indicators   : \>\"", ",", 
          RowBox[{"MatrixForm", "[", "indicators", "]"}]}], "]"}], ";"}], 
       "*)"}], "\n", "\n", 
      RowBox[{"Do", "[", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "iideals", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"indicators", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{
               "P\[Phi]1", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
            ",", "nf1"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{
          RowBox[{
          "iideals", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"PolyHermitianReduceSingular", "[", 
           RowBox[{
            RowBox[{
            "iideals", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             ",", "x", ",", "nf1"}], "]"}]}], ";"}], "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<iideal: \>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{
             "iideals", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "cind", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\n", 
      RowBox[{"Do", "[", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "construct", " ", "ideal", " ", "to", " ", "mod", " ", "out", " ", 
         "by"}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"id", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"j", "===", "k"}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
            RowBox[{"id", "=", 
             RowBox[{
              RowBox[{"PolyHermitianReduceSingular", "[", 
               RowBox[{
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "iideals", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "}"}], ",", 
                   RowBox[{"{", "id", "}"}]}], "}"}], "]"}], ",", "x", ",", 
                "nf1"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";"}], 
           "\n", "\t", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "cind", "]"}]}], "}"}]}], "]"}], ";", 
         "\n", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "extend", " ", "nf", " ", "to", " ", "newnf", " ", "to", " ", 
           "accomodate", " ", "id"}], " ", "*)"}], "\n", "\t", 
         RowBox[{"newnf", "=", "nf1"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "could", " ", "be", " ", "something", " ", "smaller", " ", "than", 
           " ", "nf1"}], " ", "*)"}], "\n", "\t", 
         RowBox[{"id", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{"id", ",", "x", ",", "newnf"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"M", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
            "M\[Phi]1", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "x", ",", "newnf"}], "]"}]}], 
         ";", "\n", "\t", 
         RowBox[{"Md", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
            "M\[Phi]1", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "x", ",", "newnf"}], "]"}]}], 
         ";", "\n", "\t", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
            "\[CapitalDelta]\[Phi]1", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "x", ",", "newnf"}], "]"}]}], 
         ";", "\n", "\t", 
         RowBox[{"\[CapitalDelta]d", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
            "\[CapitalDelta]\[Phi]1", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "x", ",", "newnf"}], "]"}]}], 
         ";", "\n", "\t", 
         RowBox[{"P", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{"P\[Phi]1", ",", "x", ",", "newnf"}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"Pd", "=", "1"}], ";", "\n", "\t", 
         RowBox[{"POW", "=", "pow"}], ";", "\n", "\t", 
         RowBox[{"REP", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{"rep", ",", "x", ",", "newnf"}], "]"}]}], ";", "\n", "\t", 
         
         RowBox[{"Do", "[", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"ind", "=", "0"}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"id", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], "=!=", 
                 "0"}], ",", 
                RowBox[{
                 RowBox[{"ind", "=", "i"}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "id", "]"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ind", "===", "0"}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "figure", " ", "out", " ", "which", " ", "element", " ", "of", 
              " ", "power", " ", "basis", " ", "to", " ", "delete"}], " ", 
             "*)"}], "\n", "\t\t", 
            RowBox[{"row", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ".", 
                RowBox[{
                 RowBox[{"PolyMatrixInverse", "[", 
                  RowBox[{"M", ",", "x", ",", "newnf"}], "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ",", "x", ",", "Null"}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"ind2", "=", "0"}], ";", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "row", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "=!=", "0"}], ",", 
                RowBox[{
                 RowBox[{"ind2", "=", "i"}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ind2", "===", "0"}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"delete", " ", "it"}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{"den", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"id", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}]}], ",", 
               "x", ",", "newnf"}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"row", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{
               RowBox[{
               "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"{", "ind", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"id", "=", 
             RowBox[{"Rest", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "id", "]"}], ",", 
                 RowBox[{"{", "ind", "}"}]}], "]"}], "]"}], "]"}]}], ";", 
            "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "delete", " ", "element", " ", "from", " ", "change", " ", 
              "basis"}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "=", 
               RowBox[{
                RowBox[{"den", "*", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "ind", "}"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "ind"}], "\[RightDoubleBracket]"}], "*", 
                 "row"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], ";", 
            "\n", "\t\t", 
            RowBox[{"M", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"M", ",", 
               RowBox[{"{", "ind2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"M", ",", "Md"}], "}"}], "=", 
             RowBox[{"PolyNormalizeFraction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"M", ",", 
                 RowBox[{"den", "*", "Md"}]}], "}"}], ",", "x", ",", "newnf", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"POW", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"POW", ",", 
               RowBox[{"{", "ind2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "delete", " ", "element", " ", "in", " ", "representations"}], 
             " ", "*)"}], "\n", "\t\t", 
            RowBox[{"Do", "[", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"piece", "=", 
                RowBox[{"REP", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
               "\n", "\t\t\t", 
               RowBox[{
                RowBox[{
                "piece", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{
                 RowBox[{"den", "*", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{
                    "piece", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", "ind", "}"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"piece", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], "*", 
                  "row"}]}]}], ";", "\n", "\t\t\t", 
               RowBox[{
                RowBox[{"REP", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                RowBox[{"PolyNormalizeFraction", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "piece", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"den", "*", 
                    RowBox[{
                    "piece", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", 
                  "newnf", ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}]}]}], ",", "\n", "\t\t", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "REP", "]"}]}], "}"}]}], "]"}], ";", 
            "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "delete", " ", "element", " ", "from", " ", "derivative", " ", 
              "array"}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{"\[CapitalDelta]", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"\[CapitalDelta]", ",", 
               RowBox[{"{", "ind", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "\[CapitalDelta]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"den", "*", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{
                   "\[CapitalDelta]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "ind", "}"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[CapitalDelta]", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "ind"}], "\[RightDoubleBracket]"}], "*", 
                 "row"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[CapitalDelta]", "]"}]}], "}"}]}], 
             "]"}], ";", "\n", "\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[CapitalDelta]", ",", "\[CapitalDelta]d"}], "}"}], 
             "=", 
             RowBox[{"PolyNormalizeFraction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[CapitalDelta]", ",", 
                 RowBox[{"den", "*", "\[CapitalDelta]d"}]}], "}"}], ",", "x", 
               ",", "newnf", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "delete", " ", "element", " ", "from", " ", "product", " ", 
              "array"}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{"P", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", 
                    RowBox[{"{", "ind", "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"{", "ind", "}"}]}], "]"}], ",", "x", ",", "Null"}], 
              "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"P", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"den", "*", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"P", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "ind", "}"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"P", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j", ",", "ind"}], 
                  "\[RightDoubleBracket]"}], "*", "row"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "P", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}], ";", 
            "\n", "\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"P", ",", "Pd"}], "}"}], "=", 
             RowBox[{"PolyNormalizeFraction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"P", ",", 
                 RowBox[{"den", "*", "Pd"}]}], "}"}], ",", "x", ",", "newnf", 
               ",", 
               RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\n", "\t", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}], ";", "\n", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
          "change", " ", "basis", " ", "so", " ", "that", " ", "product", " ",
            "array", " ", "is", " ", "integral"}], " ", "*)"}], "\n", "\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"M", ",", "Md"}], "}"}], "=", 
          RowBox[{"PolyNormalizeFraction", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"M", ",", 
              RowBox[{"Pd", "*", "Md"}]}], "}"}], ",", "x", ",", "newnf", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalDelta]", ",", "\[CapitalDelta]d"}], "}"}], "=", 
          RowBox[{"PolyNormalizeFraction", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Pd", "*", "\[CapitalDelta]"}], "+", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"Pd", ",", "x"}], "]"}], "*", "\[CapitalDelta]d", 
                "*", 
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{"Length", "[", "\[CapitalDelta]", "]"}], "]"}]}]}], 
              ",", 
              RowBox[{"Pd", "*", "\[CapitalDelta]d"}]}], "}"}], ",", "x", ",",
             "newnf", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"T", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\n", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"fa", ",", 
           RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
            RowBox[{"POW", ",", "REP", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "Md"}], "}"}], ",", "T", ",", "P", ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalDelta]", ",", "\[CapitalDelta]d"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}], 
          "]"}], ";"}], "\n", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "cind", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "fa"}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.689527962646693*^9, 3.689527972788512*^9}, {
   3.68952801512881*^9, 3.689528068318927*^9}, {3.689528168047497*^9, 
   3.689528227271213*^9}, {3.689528357148884*^9, 3.6895284052595987`*^9}, 
   3.689528439654196*^9, {3.689528738971137*^9, 3.6895287408784113`*^9}, {
   3.689528858065405*^9, 3.6895288703664303`*^9}, {3.689528953657999*^9, 
   3.689528982099966*^9}, {3.6895290467326937`*^9, 3.689529057468944*^9}, {
   3.6895291639707603`*^9, 3.689529180012269*^9}, {3.689529222014159*^9, 
   3.689529248497363*^9}, {3.6895292942634287`*^9, 3.6895294433903017`*^9}, {
   3.689529477736355*^9, 3.689529498156266*^9}, {3.6895295359004803`*^9, 
   3.689529670903458*^9}, {3.689529770903199*^9, 3.689529792829661*^9}, {
   3.689548372532967*^9, 3.689548390179081*^9}, {3.6895485075355377`*^9, 
   3.68954860664071*^9}, {3.689549548232386*^9, 3.689549598031953*^9}, {
   3.689612872455809*^9, 3.574943129996578*^9}, {3.5749432065066853`*^9, 
   3.5749432163866997`*^9}, {3.574943296106811*^9, 3.5749434476920233`*^9}, {
   3.574943546842162*^9, 3.574943546987162*^9}, {3.5749438209575458`*^9, 
   3.57494385259759*^9}, 3.5749439628777447`*^9, {3.574943996127791*^9, 
   3.5749440329828424`*^9}, {3.574944128387976*^9, 3.574944235078126*^9}, {
   3.5749442678931713`*^9, 3.574944362438304*^9}, {3.574944400353357*^9, 
   3.5749444014933586`*^9}, {3.5749444760334625`*^9, 3.574944479723468*^9}, {
   3.574944553428571*^9, 3.5749445534935713`*^9}, {3.5749448582739983`*^9, 
   3.5749448649990077`*^9}, {3.574945989074671*^9, 3.5749459946750803`*^9}, {
   3.574953629646392*^9, 3.574953654971427*^9}, {3.5749537753865957`*^9, 
   3.5749538906967573`*^9}, {3.574953932696816*^9, 3.574953955956848*^9}, {
   3.5749540977370467`*^9, 3.5749541344570985`*^9}, {3.5749541652421417`*^9, 
   3.5749541665671434`*^9}, {3.5749542264872274`*^9, 
   3.5749543299973717`*^9}, {3.5749543722874312`*^9, 
   3.5749543730024323`*^9}, {3.5749544694175673`*^9, 
   3.5749545458076744`*^9}, {3.5749545908477373`*^9, 3.574954600807751*^9}, {
   3.5749546414078083`*^9, 3.574954674792855*^9}, {3.574955581070223*^9, 
   3.574955582480225*^9}, {3.5749556272892904`*^9, 3.574955630949295*^9}, {
   3.574958998863126*^9, 3.574959031361173*^9}, {3.5749591310713406`*^9, 
   3.574959180638414*^9}, {3.574959221118472*^9, 3.5749593760766973`*^9}, {
   3.5749598684404154`*^9, 3.5749598916494493`*^9}, {3.5749602600869856`*^9, 
   3.5749602646319914`*^9}, {3.5749619497504387`*^9, 3.574961951710441*^9}, {
   3.5749620332835608`*^9, 3.5749620368185654`*^9}, {3.5749621045526624`*^9, 
   3.5749622114728174`*^9}, {3.5749623334229946`*^9, 3.574962347938015*^9}, {
   3.574962388561074*^9, 3.5749624142641115`*^9}, {3.574962529801278*^9, 
   3.5749625770323477`*^9}, {3.5749626133274*^9, 3.5749627862006493`*^9}, {
   3.574962830950715*^9, 3.5749628345757203`*^9}, {3.5749628746167784`*^9, 
   3.574962889476799*^9}, {3.574962963167906*^9, 3.5749630615410485`*^9}, {
   3.574963135151155*^9, 3.574963179116218*^9}, {3.5749691330518007`*^9, 
   3.5749691607468414`*^9}, {3.5749691964661393`*^9, 3.574969210771159*^9}, {
   3.5749692604922304`*^9, 3.574969292067276*^9}, {3.5749693334653354`*^9, 
   3.574969405619439*^9}, {3.5749702468046494`*^9, 3.5749702476046505`*^9}, {
   3.574970421081899*^9, 3.574970491938001*^9}, {3.574970522668044*^9, 
   3.5749705643761044`*^9}, {3.5749706038361607`*^9, 3.5749706304832*^9}, {
   3.574970708576312*^9, 3.5749708080704546`*^9}, {3.5749709342156363`*^9, 
   3.574970955232667*^9}, {3.574971028438771*^9, 3.574971037237785*^9}, {
   3.5749710776128426`*^9, 3.5749711288409157`*^9}, {3.57497140341131*^9, 
   3.574971412495323*^9}, {3.5749714473193736`*^9, 3.574971447589374*^9}, {
   3.5749717305537786`*^9, 3.574971738121791*^9}, {3.5749718081258907`*^9, 
   3.5749719480450926`*^9}, {3.5749719789201355`*^9, 3.574971987380148*^9}, {
   3.57497211485533*^9, 3.574972162263399*^9}, {3.5749724179267664`*^9, 
   3.5749724181567664`*^9}, {3.5749725638279753`*^9, 3.574972598711025*^9}, {
   3.5749728807864294`*^9, 3.574972913531475*^9}, {3.5749729863015795`*^9, 
   3.574973034873649*^9}, {3.5749730720337024`*^9, 3.5749730755287075`*^9}, {
   3.5749731092007556`*^9, 3.574973215194906*^9}, {3.574973348058098*^9, 
   3.5749734333662195`*^9}, {3.574973471001272*^9, 3.574973540377372*^9}, {
   3.5749735877514396`*^9, 3.574973600776458*^9}, {3.5749736355775075`*^9, 
   3.574973666464552*^9}, {3.5749737557116795`*^9, 3.574973766211694*^9}, {
   3.5749738783288546`*^9, 3.574973900693886*^9}, {3.5749739498999577`*^9, 
   3.574973954964965*^9}, {3.5749740052940364`*^9, 3.5749740644781537`*^9}, {
   3.574974246767415*^9, 3.5749742527974243`*^9}, {3.5749745102027845`*^9, 
   3.57497452856781*^9}, {3.574974589452895*^9, 3.574974626057946*^9}, {
   3.5752387551631556`*^9, 3.575238758773161*^9}, {3.575239128258678*^9, 
   3.5752391744437428`*^9}, {3.575239245898843*^9, 3.5752392555038567`*^9}, {
   3.5752396018443413`*^9, 3.575239602799342*^9}, {3.5752397184945045`*^9, 
   3.5752397188595047`*^9}, {3.575239805234626*^9, 3.5752398609547043`*^9}, {
   3.690114793327887*^9, 3.69011482143011*^9}, {3.6901150877428827`*^9, 
   3.690115088616438*^9}, {3.690115309298379*^9, 3.6901153383400297`*^9}, {
   3.69011537692278*^9, 3.690115522950284*^9}, {3.690115586769597*^9, 
   3.690115661712225*^9}, {3.690115695459444*^9, 3.690115775508626*^9}, {
   3.690115929927223*^9, 3.6901159383585787`*^9}, {3.6901159872490587`*^9, 
   3.690116024818569*^9}, {3.690116089510037*^9, 3.690116091779344*^9}, {
   3.690124874038121*^9, 3.6901249424477873`*^9}, {3.690125335892622*^9, 
   3.690125340581893*^9}, {3.6901257049471188`*^9, 3.690125718103962*^9}, {
   3.690126091108466*^9, 3.690126104219198*^9}, {3.690126253499325*^9, 
   3.690126280849456*^9}, {3.6901264368238497`*^9, 3.6901264371375427`*^9}, {
   3.6901266254748507`*^9, 3.690126686100421*^9}, {3.6901275687741747`*^9, 
   3.690127576995867*^9}, {3.6901277560633163`*^9, 3.690127764610711*^9}, {
   3.690129947639399*^9, 3.690129957235445*^9}, {3.690131732186812*^9, 
   3.690131732975582*^9}, {3.6901462966379642`*^9, 3.690146360025773*^9}, {
   3.6901464289452963`*^9, 3.690146464675185*^9}, {3.6901465166134777`*^9, 
   3.6901465481943893`*^9}, {3.690146598390335*^9, 3.6901467314981728`*^9}, {
   3.690146828217659*^9, 3.690146849316442*^9}, {3.690146907362501*^9, 
   3.6901469891521883`*^9}, {3.6901470619858294`*^9, 3.6901471457080173`*^9}, 
   3.690554301789736*^9, {3.690558752018031*^9, 3.576171999985425*^9}, {
   3.5761720665663424`*^9, 3.576172083741972*^9}, {3.5761723576316533`*^9, 
   3.576172371765278*^9}, {3.5761724390325966`*^9, 3.5761725475307865`*^9}, {
   3.5761726082928934`*^9, 3.576172781484398*^9}, {3.576172988871162*^9, 
   3.5761730172164116`*^9}, {3.676553639423421*^9, 3.676553650142294*^9}, {
   3.676561089856937*^9, 3.676561096232028*^9}, {3.6765611288803816`*^9, 
   3.6765612606089077`*^9}, {3.676561308953163*^9, 3.6765613618912616`*^9}, 
   3.676561488722536*^9, 3.6765680689270463`*^9, {3.676568121663437*^9, 
   3.6765681403511734`*^9}, {3.6765698836759143`*^9, 3.676569925567048*^9}, {
   3.676569961411186*^9, 3.676570006052331*^9}, {3.6765700785332904`*^9, 
   3.6765701405995255`*^9}, {3.6765701708342485`*^9, 
   3.6765702516643906`*^9}, {3.6765702836647344`*^9, 
   3.6765703318996563`*^9}, {3.6765703657281756`*^9, 
   3.6765703933389115`*^9}, {3.6765704431988564`*^9, 3.676570444120743*^9}, {
   3.6765704960588136`*^9, 3.676570502996416*^9}, {3.6765705683982515`*^9, 
   3.6765705894307904`*^9}, {3.676570783485123*^9, 3.6765708170636516`*^9}, {
   3.676588720334618*^9, 3.6765887207096276`*^9}, {3.6765887647413797`*^9, 
   3.6765887874760118`*^9}, {3.676588997666993*^9, 3.6765890600124865`*^9}, {
   3.6765891290171504`*^9, 3.67658916598635*^9}, {3.676589417173786*^9, 
   3.676589529581321*^9}, 3.676589561717832*^9, {3.6765897524673843`*^9, 
   3.6765897537330217`*^9}, {3.67658981420242*^9, 3.6765898284682026`*^9}, {
   3.6765901146516933`*^9, 3.6765903932717733`*^9}, {3.6765913897076*^9, 
   3.6765914438495846`*^9}, {3.676591563368226*^9, 3.6765915677432685`*^9}, {
   3.6765916144432325`*^9, 3.676591624958978*^9}, {3.6765916662875586`*^9, 
   3.6765918831994553`*^9}, {3.6765919188873634`*^9, 
   3.6765920948395348`*^9}, {3.6765922660297065`*^9, 3.676592266357834*^9}, {
   3.6766541507551684`*^9, 3.676654165834201*^9}, {3.676654212553486*^9, 
   3.6766542540539613`*^9}, {3.676654742764686*^9, 3.671131618417864*^9}, {
   3.671131655218709*^9, 3.6711317189699545`*^9}, {3.693231130981483*^9, 
   3.6932311353446293`*^9}, {3.695572478859428*^9, 3.6955724801319933`*^9}, {
   3.695590673129611*^9, 3.676406168860737*^9}, {3.6764062287061453`*^9, 
   3.6764062844599185`*^9}, {3.6764064130389886`*^9, 3.676406463445134*^9}, {
   3.676406572734767*^9, 3.676406648413912*^9}, {3.67640669439404*^9, 
   3.6764067194435177`*^9}, {3.6764067544834275`*^9, 
   3.6764068722042327`*^9}, {3.676407020306817*^9, 3.6764070324550877`*^9}, {
   3.6764073665900154`*^9, 3.6764073746479435`*^9}, {3.676407454042568*^9, 
   3.6764074582926054`*^9}, {3.676407505214614*^9, 3.676407506262895*^9}, {
   3.6764075541418037`*^9, 3.67640765366597*^9}, {3.676407750614625*^9, 
   3.676407850116021*^9}, {3.6764080499149857`*^9, 3.6764080581505365`*^9}, {
   3.70160243514535*^9, 3.701602436769154*^9}, 3.7016030194531097`*^9, {
   3.701603062594429*^9, 3.7016030628186626`*^9}, {3.701603108785737*^9, 
   3.701603158377515*^9}, {3.701603264043256*^9, 3.701603278441448*^9}, {
   3.7016033496648827`*^9, 3.7016033502653227`*^9}, {3.701603445050446*^9, 
   3.701603549081723*^9}, {3.701603634659834*^9, 3.701603646857367*^9}, {
   3.701603753057851*^9, 3.701603813178742*^9}, {3.701603884517436*^9, 
   3.701603892204434*^9}, {3.701603960466744*^9, 3.701603976970063*^9}, {
   3.701604049460334*^9, 3.701604264530175*^9}, {3.701604294831891*^9, 
   3.70160435042864*^9}, {3.701605085202127*^9, 3.701605088089521*^9}, {
   3.701605138082364*^9, 3.701605139187646*^9}, {3.701605207336712*^9, 
   3.7016052104260893`*^9}, {3.7016052821243153`*^9, 3.701605319515366*^9}, {
   3.701605356122458*^9, 3.701605366490428*^9}, {3.701605397786562*^9, 
   3.7016054942752523`*^9}, {3.701606154229466*^9, 3.70160615851483*^9}, {
   3.701606222313114*^9, 3.7016063698335457`*^9}, {3.7016064623224077`*^9, 
   3.701606464652844*^9}, {3.701606516765167*^9, 3.7016065198286133`*^9}, {
   3.7016067033721037`*^9, 3.701606717332129*^9}, {3.701606760948634*^9, 
   3.701606763219997*^9}, {3.701606853155285*^9, 3.701606863682032*^9}, {
   3.701607017044037*^9, 3.7016070392854853`*^9}, {3.7016071118365717`*^9, 
   3.701607184157444*^9}, {3.7016087099791327`*^9, 3.7016087174184017`*^9}, {
   3.702514170853415*^9, 3.702514173319313*^9}, {3.702514226739933*^9, 
   3.702514233942621*^9}, {3.702514274942775*^9, 3.7025143216918287`*^9}, {
   3.702514363854604*^9, 3.7025144271550417`*^9}, {3.702568965452203*^9, 
   3.702568968484066*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["extensions", "Subsection",
 CellChangeTimes->{{3.7016272323982143`*^9, 3.701627236533228*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FunctionAlgebraCompositum", "[", 
    RowBox[{
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{
      "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
       "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ",", "\n", 
     "\t", 
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{
      "pow2_", ",", "rep2_", ",", "M2_", ",", "T2_", ",", "P2_", ",", 
       "\[CapitalDelta]2_", ",", "ord\[Delta]2_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}]}], "]"}], ":=",
    "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "pow1", "]"}]}], ",", 
       RowBox[{"n2", "=", 
        RowBox[{"Length", "[", "pow2", "]"}]}], ",", "n", ",", "id1", ",", 
       "id2", ",", "M\[Phi]", ",", "P\[Phi]", ",", "T\[Phi]", ",", 
       "\[CapitalDelta]\[Phi]", ",", "M\[Infinity]", ",", "P\[Infinity]", ",",
        "T\[Infinity]", ",", "\[CapitalDelta]\[Infinity]", ",", "\n", "B", 
       ",", "A", ",", "or", ",", "max", ",", "ord\[Delta]", ",", "mat", ",", 
       "Si", ",", "S", ",", "dd", ",", "pow", ",", "inv", ",", "piece", ",", 
       "rp1", ",", "rp2", ",", "rep"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"n1", "*", "n2"}]}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"id1", ",", "id2"}], "}"}], "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"inv", "[", 
          RowBox[{
           RowBox[{
           "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "]"}], "=", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"M\[Phi]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"M1", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
              "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "id1", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
              "\[RightDoubleBracket]"}], "*", 
            RowBox[{"M2", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
              "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
              "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
          "M1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*", 
          RowBox[{
          "M2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", "\n", "\t", 
      RowBox[{"M\[Phi]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{"M\[Phi]", ",", "x", ",", "nf", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"P1", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}], "*", 
          RowBox[{"P2", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{"P\[Phi]", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"T\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"T\[Phi]", "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{"T\[Phi]", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"\[CapitalDelta]\[Phi]", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"inv", "[", 
               RowBox[{"a1", ",", "a2"}], "]"}], ",", 
              RowBox[{"inv", "[", 
               RowBox[{"b1", ",", "a2"}], "]"}]}], "\[RightDoubleBracket]"}], 
            "+=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1", ",", "a1", ",", "b1"}], 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{"\[CapitalDelta]2", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b1", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"inv", "[", 
               RowBox[{"a1", ",", "a2"}], "]"}], ",", 
              RowBox[{"inv", "[", 
               RowBox[{"a1", ",", "b2"}], "]"}]}], "\[RightDoubleBracket]"}], 
            "+=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]2", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1", ",", "a2", ",", "b2"}], 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"b2", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";"}], "\n", 
        "\t", ",", 
        RowBox[{"{", 
         RowBox[{"a1", ",", "1", ",", "n1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"a2", ",", "1", ",", "n2"}], "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"\[CapitalDelta]\[Phi]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[CapitalDelta]\[Phi]", ",", 
           RowBox[{
            RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
            RowBox[{"\[CapitalDelta]2", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
         ",", "x", ",", "nf", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"pow", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pow1", "\[LeftDoubleBracket]", 
           RowBox[{
           "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], "*", 
          RowBox[{"pow2", "\[LeftDoubleBracket]", 
           RowBox[{
           "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"rep", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"rp2", "=", 
          RowBox[{"1", "/.", "rep2"}]}], ";", "\n", "\t\t", 
         RowBox[{"rp1", "=", 
          RowBox[{"rep1", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"piece", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rp1", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id1", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{"rp2", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "rp1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "*", 
             RowBox[{
             "rp2", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\n", "\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"rep", ",", 
           RowBox[{
            RowBox[{"1", "*", 
             RowBox[{"rep1", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}]}], "\[Rule]", 
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{"piece", ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}], "\n", "\t", ",", 
        
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "rep1", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"rp1", "=", 
          RowBox[{"1", "/.", "rep1"}]}], ";", "\n", "\t\t", 
         RowBox[{"rp2", "=", 
          RowBox[{"rep2", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"piece", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rp1", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id1", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{"rp2", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", 
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
             "rp1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "*", 
             RowBox[{
             "rp2", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\n", "\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"rep", ",", 
           RowBox[{
            RowBox[{"1", "*", 
             RowBox[{"rep2", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "1"}], "\[RightDoubleBracket]"}]}], "\[Rule]", 
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{"piece", ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}]}], "]"}]}], "\n", "\t", ",", 
        
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "rep2", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
       RowBox[{"pow", ",", 
        RowBox[{"DeleteDuplicates", "[", "rep", "]"}], ",", "M\[Phi]", ",", 
        "T\[Phi]", ",", "P\[Phi]", ",", "\[CapitalDelta]\[Phi]", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.701627361356717*^9, 3.7016273810607986`*^9}, {
   3.701627707165003*^9, 3.701627714044674*^9}, {3.701627814740937*^9, 
   3.701627862824201*^9}, {3.7016279452007113`*^9, 3.701627975488914*^9}, {
   3.701628024656752*^9, 3.701628045280661*^9}, {3.701628102080871*^9, 
   3.701628371217495*^9}, {3.701628866341578*^9, 3.701628866678297*^9}, {
   3.701628915194601*^9, 3.7016289694988956`*^9}, {3.7016291492186823`*^9, 
   3.70162916905615*^9}, {3.701629309531218*^9, 3.70162935867869*^9}, {
   3.701629738477644*^9, 3.701629748157134*^9}, {3.701629834037106*^9, 
   3.701629838619211*^9}, {3.701629868892071*^9, 3.701629953428235*^9}, {
   3.701630019287189*^9, 3.701630019572855*^9}, {3.701630084659997*^9, 
   3.7016301599243526`*^9}, {3.701630190188365*^9, 3.701630245877819*^9}, {
   3.701630783994816*^9, 3.701630844293192*^9}, {3.701631102975904*^9, 
   3.701631185621674*^9}, {3.7016312368453503`*^9, 3.7016312687174892`*^9}, {
   3.7016312993904753`*^9, 3.7016313243643713`*^9}, {3.701631667429599*^9, 
   3.701631753846243*^9}, {3.701631783966675*^9, 3.701631790790865*^9}, {
   3.7016322248218718`*^9, 3.70163225469475*^9}, {3.701632291102242*^9, 
   3.7016323339181147`*^9}, {3.70163240882148*^9, 3.701632508958486*^9}, {
   3.7016325575356407`*^9, 3.701632595478683*^9}, {3.701632641319664*^9, 
   3.70163269901803*^9}, 3.701632731207284*^9, {3.701632815359583*^9, 
   3.7016328156194563`*^9}, {3.701632931598709*^9, 3.701632942342202*^9}, {
   3.7016331435987577`*^9, 3.701633302201907*^9}, {3.7016333644243307`*^9, 
   3.701633380893607*^9}, {3.701633458731371*^9, 3.701633497915843*^9}, {
   3.701633545944459*^9, 3.7016335925035686`*^9}, {3.701633641696815*^9, 
   3.701633680784802*^9}, 3.7016337132713327`*^9, {3.701633792085705*^9, 
   3.701633852775508*^9}, {3.701633908943706*^9, 3.701633949568493*^9}, {
   3.7016339873285217`*^9, 3.701634302789475*^9}, {3.701634679789028*^9, 
   3.7016347058640327`*^9}, {3.701634753439117*^9, 3.7016347578929663`*^9}, {
   3.701634830585952*^9, 3.701634839033248*^9}, {3.701634883240118*^9, 
   3.7016349644969683`*^9}, {3.7016350460981703`*^9, 3.701635080026366*^9}, {
   3.701635158594933*^9, 3.7016352564021683`*^9}, {3.70163530873708*^9, 
   3.701635356681903*^9}, {3.7016353888495607`*^9, 3.701635489536851*^9}, 
   3.7016355487471533`*^9, {3.701635815722921*^9, 3.701635817941394*^9}, {
   3.701635935802237*^9, 3.701635948296246*^9}, {3.701636000170223*^9, 
   3.701636003786017*^9}, {3.7016360370978394`*^9, 3.701636079931316*^9}, {
   3.701636231277771*^9, 3.701636235785049*^9}, {3.701636269201985*^9, 
   3.7016362725323067`*^9}, {3.701636309794094*^9, 3.701636337570291*^9}, {
   3.7016365952663403`*^9, 3.701636626258956*^9}, {3.701636658890759*^9, 
   3.701636772379221*^9}, {3.7016368118283577`*^9, 3.701636836051553*^9}, {
   3.7016368737473097`*^9, 3.701636944064476*^9}, {3.701637395923793*^9, 
   3.701637448971612*^9}, {3.701637521220004*^9, 3.701637561499962*^9}, {
   3.7016376553351088`*^9, 3.7016376635410833`*^9}, {3.701637841828125*^9, 
   3.70163789123783*^9}, {3.701638166268766*^9, 3.7016382191402884`*^9}, {
   3.701638287596879*^9, 3.701638300342125*^9}, {3.701638370506687*^9, 
   3.701638372000407*^9}, {3.701638687112274*^9, 3.701638716953177*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FunctionAlgebraExtendByRadical", "[", 
   RowBox[{
    RowBox[{"FunctionAlgebra", "[", 
     RowBox[{
     "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
      "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ",", "\n", 
    "n2_Integer", ",", 
    RowBox[{"{", 
     RowBox[{"nnum_", ",", "den_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", "nnum"}], ",", "bi", ",", "fac", ",", "facc", ",", 
      RowBox[{"n1", "=", 
       RowBox[{"Length", "[", "pow1", "]"}]}], ",", "n", ",", 
      "\[CapitalDelta]\[Phi]den", ",", "id1", ",", "id2", ",", "inv", ",", 
      "\n", "P\[Phi]", ",", "T\[Phi]", ",", "\[CapitalDelta]\[Phi]", ",", 
      "M\[Phi]", ",", "t", ",", "s", ",", "g", ",", "h", ",", "pow", ",", 
      "rep", ",", "conv", ",", "fa"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"fa", "=", 
      RowBox[{"FunctionAlgebra", "[", 
       RowBox[{
       "pow1", ",", "rep1", ",", "M1", ",", "T1", ",", "P1", ",", 
        "\[CapitalDelta]1", ",", "ord\[Delta]1", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"g", "=", 
      RowBox[{"{", 
       RowBox[{"num", ",", "den"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"todo", ":", " ", 
       RowBox[{"special", " ", "case", " ", "when", " ", 
        RowBox[{"nnum", "/", "den"}], " ", "is", " ", "a", " ", "base", " ", 
        "constant"}]}], " ", "*)"}], "\n", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"n1", "*", "n2"}]}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"id1", ",", "id2"}], "}"}], "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{
          "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
          
          RowBox[{
          "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "]"}], "=", "i"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"facc", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", "n2", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"bi", "=", "0"}], ";", 
     RowBox[{"Scan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"bi", "++"}], ";", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "facc", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
             "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "facc", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{"#", "^", 
                 RowBox[{"Ceiling", "[", 
                  RowBox[{"bi", "*", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "/", "n2"}]}], "]"}]}]}], 
               ",", "x", ",", "nf"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}]}], ")"}], 
        "&"}], ",", "\n", "\t\t", 
       RowBox[{"PolyFactorSquareFree", "[", 
        RowBox[{"den", ",", "x", ",", "nf"}], "]"}]}], "]"}], ";", "\n", "\t",
      
     RowBox[{"fac", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"x", ",", 
          RowBox[{
          "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "facc", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",",
           "nf"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n2"}], "}"}]}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"P\[Phi]", "=", 
      RowBox[{"Table", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"PiecePower", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             "g", ",", 
            RowBox[{"1", "/.", "rep1"}], ",", 
            RowBox[{"Quotient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
               "-", "2"}], ",", "n2"}], "]"}], ",", "nf"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PieceTimes", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             "t", ",", 
            RowBox[{"fac", "\[LeftDoubleBracket]", 
             RowBox[{
             "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PieceTimes", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             "t", ",", 
            RowBox[{"fac", "\[LeftDoubleBracket]", 
             RowBox[{
             "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
             "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PieceDivide", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             "t", ",", 
            RowBox[{"fac", "\[LeftDoubleBracket]", 
             RowBox[{"1", "+", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "+", 
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "-", "2"}], ",", "n2"}], "]"}]}],
              "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PieceTimes", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             "t", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"P1", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{
                "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                 ",", 
                RowBox[{
                "id1", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], ",", 
              "1"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"assert", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "===",
             "1"}], ",", 
           "\"\<bad denominator in FunctionAlgebraExtendByRadical\>\""}], 
          "]"}], ";", "\n", "\t\t", 
         RowBox[{"s", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "\[LeftDoubleBracket]", 
             RowBox[{"inv", "[", 
              RowBox[{"k", ",", 
               RowBox[{"1", "+", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "id2", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", 
                   RowBox[{
                   "id2", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "2"}], ",", "n2"}], 
                 "]"}]}]}], "]"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"t", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", "s"}], "\n", "\t\t", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"P\[Phi]", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{"P\[Phi]", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"T\[Phi]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"T\[Phi]", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{"T\[Phi]", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[CapitalDelta]\[Phi]den", "=", "1"}], ";", 
     RowBox[{"\[CapitalDelta]\[Phi]", "=", "\n", "\t", 
      RowBox[{"Table", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"PieceDivide", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"PieceDiff", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "\[CapitalDelta]1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", "g", ",", "nf"}], "]"}], ",", 
            "g", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PieceMulAdd", "[", 
           RowBox[{"x", ",", 
            RowBox[{"PieceDivide", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"PieceDiff", "[", 
               RowBox[{"x", ",", 
                RowBox[{
                "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "\[CapitalDelta]1", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"fac", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "id2", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
                "nf"}], "]"}], ",", 
              RowBox[{"fac", "\[LeftDoubleBracket]", 
               RowBox[{
               "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", "nf"}], "]"}], ",", "t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "-", "1"}], ")"}], "/", "n2"}], ",", "nf"}], "]"}]}], ";", 
         "\n", "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PieceTimes", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             "t", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "n1", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{
               "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", "1"}], "}"}], ",", "nf"}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PiecePlus", "[", 
           RowBox[{"x", ",", "t", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1", ",", 
                RowBox[{
                "id1", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], ",", 
              
              RowBox[{"\[CapitalDelta]1", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
            ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"s", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s", "\[LeftDoubleBracket]", 
             RowBox[{"inv", "[", 
              RowBox[{"k", ",", 
               RowBox[{
               "id2", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}], "\[RightDoubleBracket]"}],
             "=", 
            RowBox[{"t", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n1"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"\[CapitalDelta]\[Phi]den", "=", 
          RowBox[{"PolyLCM", "[", 
           RowBox[{"\[CapitalDelta]\[Phi]den", ",", 
            RowBox[{
            "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"{", 
          RowBox[{"s", ",", 
           RowBox[{
           "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}]}], "\n", "\t", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[CapitalDelta]\[Phi]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1", ",", "j"}], 
                  "\[RightDoubleBracket]"}], "*", 
                 "\[CapitalDelta]\[Phi]den"}], ",", "x", ",", "nf"}], "]"}], 
              ",", 
              RowBox[{"\[CapitalDelta]\[Phi]", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", 
              ",", "nf"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        "\[CapitalDelta]\[Phi]den"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"pow", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pow1", "\[LeftDoubleBracket]", 
          RowBox[{
          "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "*", 
         RowBox[{"facc", "\[LeftDoubleBracket]", 
          RowBox[{
          "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"FuncPrint", "[", 
            RowBox[{"g", ",", "fa"}], "]"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "-", "1"}], ")"}], "/", "n2"}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"conv", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "id1", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], "===",
             "i"}], "&&", 
           RowBox[{
            RowBox[{
            "id2", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], "===",
             "1"}]}], ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"rep", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
               "conv"}], ",", "x", ",", "nf"}], "]"}], ",", 
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
         "&"}], ",", "rep1"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"rep", "=", 
      RowBox[{"rep", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"radical", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"{", 
            RowBox[{"b_", ",", "c_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"radical", "[", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"b", ".", "conv"}], ",", "x", ",", "nf"}], "]"}], ",", 
             "c"}], "}"}]}], "]"}]}], "}"}]}]}], ";", "\n", "\t", 
     RowBox[{"s", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "n", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"inv", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "\[RightDoubleBracket]"}], ",", 
        "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"t", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
         "facc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "*", 
         
         RowBox[{
         "conv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"rep", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"rep", ",", 
        RowBox[{
         RowBox[{"radical", "[", 
          RowBox[{"n2", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "g", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ".", "conv"}], ",", 
             RowBox[{
             "g", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
            "}"}]}], "]"}], "\[Rule]", 
         RowBox[{"PieceDivide", "[", 
          RowBox[{"x", ",", "P\[Phi]", ",", "s", ",", "t", ",", "nf"}], 
          "]"}]}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"M\[Phi]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "id2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
             RowBox[{
             "id2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"M1", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
              "id1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "id1", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
              "\[RightDoubleBracket]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
        RowBox[{
        "M1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       "}"}]}], ";", "\n", "\t", 
     RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
      RowBox[{
      "pow", ",", "rep", ",", "M\[Phi]", ",", "T\[Phi]", ",", "P\[Phi]", ",", 
       "\[CapitalDelta]\[Phi]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/XPD3DkBU147lq5VnguijY+0nwTRtfuPXgTRm2ce
uA6iha++ugOi6/7X8wYC6Ynb74Fps08RUSB6VvSCaBBd42R/EER/MJ8Bpi2e
N5wF0Q/zL1wC0YsOuTAGAek59yezgOiZqfP5QfSZx2fB9DZpHgkQ7SGjKAmi
93/s1MoC0vNcvuuBaOuCx9LZQFqhkUUJRHt/O6sGog9qOamD6H+M1btygbRg
D8ceEB3C4OuXB6RPMh4D05LaeqEgWoB1YwSIvqX0JgFEO92szwbRdyoKC8Hq
rK1KQTTD7ohKEP0r5lUbiC5w2TgTRH8pPwymb6xR2AKiVyqFgGkALt6s+w==

  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["curve information", "Subsection",
 CellChangeTimes->{{3.666961025171932*^9, 3.666961030270335*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "2"], "-", 
      RowBox[{"x", 
       RowBox[{"(", 
        RowBox[{"x", "-", "4"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"x", "-", "3"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"x", "+", "5"}], ")"}]}]}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.687887075197294*^9, 3.687887087369317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "6"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["y", "2"]}], "-", 
      RowBox[{"10", " ", 
       SuperscriptBox["x", "3"], " ", 
       SuperscriptBox["y", "2"]}], "+", 
      SuperscriptBox["y", "4"]}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.686671171808042*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "3"], "-", 
      RowBox[{"x", 
       RowBox[{"(", 
        RowBox[{"x", "+", "1"}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x", "+", "2"}], ")"}], "2"]}]}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.686669266364897*^9, {3.686759539145245*^9, 3.686759546936344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "2"], "-", "y", "-", 
      SuperscriptBox["x", "4"], "+", "x"}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.686164687882393*^9, {3.686180411624401*^9, 3.6861804226167917`*^9}, {
   3.686412079821175*^9, 3.6864121593083277`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["y", "2"], "-", "x"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["y", "3"], "-", "x"}], ")"}]}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.688231689086555*^9, 3.688231699830407*^9}, {
   3.68823281039904*^9, 3.688232820662588*^9}, {3.688300537243165*^9, 
   3.688300541763248*^9}, 3.688301420769491*^9, {3.688310166378666*^9, 
   3.688310177314142*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["y", "2"], "-", "x"}], ")"}], "2"], "-", "x"}], 
      ")"}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.688164008396222*^9, 3.6881640085642853`*^9}, {
  3.688224899499503*^9, 3.688224911650758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["y", "6"], "-", 
       RowBox[{"2", 
        SuperscriptBox["x", "3"]}]}], ")"}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.688157459401725*^9, 3.68815746024897*^9}, {
  3.6881575246749077`*^9, 3.688157527050452*^9}, {3.688157564859653*^9, 
  3.68815758536896*^9}, {3.6881617532660103`*^9, 3.688161758440197*^9}, {
  3.688163898627303*^9, 3.6881638990032682`*^9}, {3.688165276853271*^9, 
  3.6881652770296593`*^9}, {3.688165413233698*^9, 3.6881654345170803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "4"], "+", 
      RowBox[{"x", " ", 
       SuperscriptBox["y", "3"]}], "-", 
      SuperscriptBox["x", "2"], "+", 
      RowBox[{"x", " ", "y"}]}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5730023633211384`*^9, 3.5730023925595903`*^9}, 
   3.5730024406614747`*^9, {3.687881297317649*^9, 3.6878812992177963`*^9}, 
   3.687881331333262*^9, 3.687881534240065*^9, 3.6878834881842623`*^9, {
   3.687884471628374*^9, 3.6878844806885366`*^9}, {3.687884527282484*^9, 
   3.687884534115512*^9}, 3.687887054424849*^9, {3.688129230078205*^9, 
   3.688129231575095*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCurveInformation", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"y", " ", 
       SuperscriptBox["x", "3"]}], "+", 
      RowBox[{"x", " ", 
       SuperscriptBox["1", "3"]}], "+", 
      RowBox[{"1", 
       SuperscriptBox["y", "3"]}]}], ",", "y", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.686164687882393*^9, {3.686180411624401*^9, 3.6861804226167917`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetCurveInformation", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "2"], " ", 
        SuperscriptBox["y", "3"]}], "+", 
       SuperscriptBox["y", "5"], "+", 
       RowBox[{"x", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["y", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["y", "4"]}]}], ")"}]}]}], ",", "y", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6654476434113913`*^9, 3.6654476660847187`*^9}, 
   3.665449066434155*^9, 3.665529934582266*^9, 3.6660282116255617`*^9, {
   3.66602824245865*^9, 3.666028251123*^9}, {3.666033873576603*^9, 
   3.666033875926281*^9}, 3.6669605634018784`*^9, {3.667229886357802*^9, 
   3.6672298865174017`*^9}, {3.686421754097563*^9, 3.6864217632012672`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetCurveInformation", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["y", "4"], "+", 
       RowBox[{"8", "x", " ", 
        SuperscriptBox["y", "3"]}], "-", 
       RowBox[{"17", 
        SuperscriptBox["x", "2"], 
        SuperscriptBox["y", "2"]}], "-", 
       RowBox[{"x", " ", 
        SuperscriptBox["y", "2"]}], "+", 
       RowBox[{"8", 
        SuperscriptBox["x", "3"], "y"}], "-", 
       RowBox[{"2", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"5", 
        SuperscriptBox["x", "3"]}], "-", 
       RowBox[{"2", 
        SuperscriptBox["x", "4"]}]}], ",", "y", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.665528809175048*^9, 3.66552884773488*^9}, 
   3.665529866616666*^9, 3.666960494434081*^9, {3.6672298900715923`*^9, 
   3.667229890223641*^9}, {3.6864333366401997`*^9, 3.68643336423468*^9}, 
   3.686433469391049*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetCurveInformation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        SuperscriptBox["y", "4"], "-", 
        RowBox[{"2", " ", "x", " ", 
         SuperscriptBox["y", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["x", "3"]}], "-", 
           RowBox[{"6", " ", "x"}], "+", "4"}], ")"}], "y"}], "+", 
        SuperscriptBox["x", "4"], "-", 
        RowBox[{"2", 
         SuperscriptBox["x", "2"]}], "-", 
        RowBox[{"4", "x"}], "+", 
        RowBox[{"2", 
         SuperscriptBox["x", "3"]}], "+", "4"}]}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "]"}], ";"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.6654140887628183`*^9, 3.665414125870508*^9}, {
   3.66541416558309*^9, 3.665414195144125*^9}, {3.6654145827212973`*^9, 
   3.665414596568672*^9}, {3.665416100840383*^9, 3.665416145802744*^9}, {
   3.665417966501297*^9, 3.6654179666920033`*^9}, {3.665418060517461*^9, 
   3.665418060661003*^9}, {3.665418122269898*^9, 3.6654181377982197`*^9}, {
   3.66542695777639*^9, 3.66542696768988*^9}, {3.665430420607047*^9, 
   3.6654304214149323`*^9}, {3.66543188343183*^9, 3.6654319140635147`*^9}, {
   3.665445675887697*^9, 3.665445705311116*^9}, 3.6655298641685057`*^9, 
   3.666960461708933*^9, {3.667229890831951*^9, 3.66722989099964*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetCurveInformation", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "3"], "+", "y"}], ")"}], "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}], "2"]}], ",", "y", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
      RowBox[{"NF", "[", 
       RowBox[{"0", ",", "\[Theta]"}], "]"}]}], "}"}], "]"}], ";"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.665527703044303*^9, 3.665527705738521*^9}, 
   3.6655298605577173`*^9, 3.6669603476008387`*^9, {3.6672298920525093`*^9, 
   3.6672298925808764`*^9}, {3.6864216352244997`*^9, 3.686421650999728*^9}, 
   3.686421703961768*^9, {3.686433583164921*^9, 3.686433583245255*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"output", ":", "\n", "\t", 
    RowBox[{
     RowBox[{"-", " ", "discriminant"}], " ", "-", " ", 
     RowBox[{"norm", " ", "of", " ", "different", " ", "divisor"}], "\n", 
     "\t", "-", " ", 
     RowBox[{"the", " ", "different", " ", "divisor"}], "\n", "\t", "-", " ", 
     
     RowBox[{
     "square", " ", "free", " ", "factors", " ", "of", " ", "different", " ", 
      "divisor"}]}]}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"FunctionFieldInfo", "[", 
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{
      "pow_", ",", "rep_", ",", "M_", ",", "T_", ",", "P_", ",", 
       "\[CapitalDelta]_", ",", "ord\[Delta]_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "intbasis", ",", "a", ",", "b", ",", "c", ",", "B", ",", "t", ",", 
        "piece", ",", "genus", ",", "\n", "fromEpsilonBar", ",", "toEpsilon", 
        ",", "toEtaBar", ",", "fromEtaBar", ",", "toEpsilonBar", ",", 
        "fromEpsilon", ",", "derInEpsilonBar", ",", "\n", "diff3rdkind", ",", 
        "diff2ndkind", ",", "diff1stkind", ",", "diffexact", ",", "indices", 
        ",", "\n", "T\[Phi]", ",", "T\[Infinity]", ",", "B0", ",", "T0", ",", 
        "P0", ",", "P\[Phi]", ",", "P\[Infinity]", ",", "n", ",", "m", ",", 
        "bi", ",", "max", ",", "num", ",", "den", ",", "places\[Infinity]", 
        ",", "\n", "dd", ",", "\[CapitalDelta]\[Phi]", ",", "d\[Phi]", ",", 
        "\[CapitalDelta]\[Infinity]", ",", "d\[Infinity]", ",", "A", ",", 
        "gcd", ",", "disc", ",", "diff\[Phi]", ",", "diff\[Infinity]", ",", 
        "invdiff", ",", "diff", ",", "p", ",", "res", ",", "\n", "squarefree",
         ",", "badred", ",", "ord\[Rho]", ",", "sfnorm", ",", "discsq", ",", 
        RowBox[{"ff", "=", 
         RowBox[{"FunctionAlgebra", "[", 
          RowBox[{
          "pow", ",", "rep", ",", "M", ",", "T", ",", "P", ",", 
           "\[CapitalDelta]", ",", "ord\[Delta]", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], "}"}],
       ",", "\n", "\t", 
      RowBox[{
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"ord\[Delta]", ",", "0"}], "]"}], "===", "1"}], ",", 
         "\"\<count error in FunctionFieldInfo\>\""}], "]"}], ";", "\n", "\t", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "ord\[Delta]", "]"}]}], ";", "\n", "\t", 
       RowBox[{"genus", "=", 
        RowBox[{
         RowBox[{"Total", "[", "ord\[Delta]", "]"}], "-", "n", "+", "1"}]}], 
       ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"P\[Phi]", ",", "P\[Infinity]"}], "}"}], "=", "P"}], ";", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T\[Phi]", ",", "T\[Infinity]"}], "}"}], "=", "T"}], ";", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalDelta]\[Phi]", ",", "d\[Phi]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[CapitalDelta]\[Infinity]", ",", "d\[Infinity]"}], 
           "}"}]}], "}"}], "=", "\[CapitalDelta]"}], ";", "\n", "\n", "\t", 
       RowBox[{"intbasis", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{
          RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"intbasis", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
           RowBox[{
           "intbasis", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "*", 
          RowBox[{
           RowBox[{
           "intbasis", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            ".", "pow"}]}], "]"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<function field  int basis: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "intbasis", "}"}], "]"}], "]"}]}], "]"}], ";"}], 
        "*)"}], "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<ord\[Delta]: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"{", "ord\[Delta]", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
       "\n", "\n", "\t", 
       RowBox[{"diff\[Phi]", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"T\[Phi]", ".", 
               RowBox[{"P\[Phi]", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
              "x", ",", "nf"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", ",",
           "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"disc", "=", 
        RowBox[{
        "diff\[Phi]", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<discriminant: \>\"", ",", 
           RowBox[{"Times", "@@", 
            RowBox[{"Power", "@@@", 
             RowBox[{"PolyFactor", "[", 
              RowBox[{"disc", ",", "x", ",", "nf"}], "]"}]}]}]}], "]"}], 
         ";"}], "*)"}], "\n", "\n", "\t", 
       RowBox[{"max", "=", 
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{
          "diff\[Phi]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"max", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"max", ",", 
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{"diff\[Phi]", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}], 
               ",", "x"}], "]"}], "+", 
             RowBox[{
             "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "ord\[Delta]", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}], "-", "2"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       
       RowBox[{"diff\[Infinity]", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"diff\[Phi]", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}],
                 "*", 
                RowBox[{
                 RowBox[{"x", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "ord\[Delta]", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "2"}], ")"}]}], "/", 
                 RowBox[{"x", "^", "max"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
              "diff\[Phi]", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "/", 
              RowBox[{"x", "^", "max"}]}]}], "}"}], "/.", 
           RowBox[{"x", "\[Rule]", 
            RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{
        RowBox[{
        "diff\[Infinity]", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], "=", 
        RowBox[{"PolyMakeMonic", "[", 
         RowBox[{
          RowBox[{
          "diff\[Infinity]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], ",", "\[Xi]", ",", "nf"}], "]"}]}], ";",
        "\n", "\t", 
       RowBox[{"invdiff", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdealNormalForm", "[", 
           RowBox[{"x", ",", "diff\[Phi]", ",", "nf"}], "]"}], ",", 
          RowBox[{"IdealNormalFormLocal", "[", 
           RowBox[{"\[Xi]", ",", "diff\[Infinity]", ",", "nf"}], "]"}]}], 
         "}"}]}], ";", "\n", "\t", 
       RowBox[{"diff", "=", 
        RowBox[{"DivisorReciprocal", "[", 
         RowBox[{"invdiff", ",", "P", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"diff", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "===", "1"}], 
         ",", "\"\<error in GetCurveInformation: different is supposed to be \
integral\>\""}], "]"}], ";", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<(dx): \>\"", ",", 
           RowBox[{"DivisorPrint", "[", "diff", "]"}]}], "]"}], ";"}], "*)"}],
        "\n", "\n", "\t", 
       RowBox[{"p", "=", 
        RowBox[{"PolyDivide", "[", 
         RowBox[{"disc", ",", 
          RowBox[{"PolyGCD", "[", 
           RowBox[{"disc", ",", 
            RowBox[{"PolyD", "[", 
             RowBox[{"disc", ",", "x", ",", "nf"}], "]"}], ",", "x", ",", 
            "nf"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"a", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p", "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Xi]", "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], "}"}]}],
          "}"}]}], ";", "\n", "\t", 
       RowBox[{"b", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdealTimes", "[", 
           RowBox[{"x", ",", 
            RowBox[{
            "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "invdiff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             ",", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "nf"}], "]"}], ",", "\n", "\t\t", 
          RowBox[{"IdealDivide", "[", 
           RowBox[{"\[Xi]", ",", 
            RowBox[{
            "P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "invdiff", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             ",", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            "nf"}], "]"}]}], "}"}]}], ";", "\n", "\t", 
       RowBox[{"squarefree", "=", 
        RowBox[{"Table", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "=", 
            RowBox[{"DivisorDivide", "[", 
             RowBox[{"a", ",", "b", ",", "P", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"c", "=", "b"}], ";", 
           RowBox[{"b", "=", 
            RowBox[{"DivisorPlus", "[", 
             RowBox[{"a", ",", "b", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"c", "=", 
            RowBox[{"DivisorDivide", "[", 
             RowBox[{"c", ",", "b", ",", "P", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
           "\n", 
           RowBox[{"(*", "\t\t\t", 
            RowBox[{
             RowBox[{"TimePrint", "[", 
              RowBox[{
              "\"\<square free \>\"", ",", " ", "i", ",", "\"\<: \>\"", ",", 
               RowBox[{"DivisorPrint", "[", "c", "]"}]}], "]"}], ";"}], 
            "*)"}], "\n", "\t\t\t", "c"}], "\n", "\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"discsq", "=", 
        RowBox[{"PolyFactorSquareFree", "[", 
         RowBox[{"disc", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"sfnorm", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DivisorNorm", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], 
          ",", "squarefree"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"badred", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\n", "\t\t", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"CoefficientList", "[", 
               RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"squarefree", "/.", 
               RowBox[{"\[Xi]", "\[Rule]", "x"}]}], "]"}]}], "]"}], ",", "\n",
            "\t\t", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"NumRecp", "[", 
              RowBox[{
               RowBox[{"Resultant", "[", 
                RowBox[{
                 RowBox[{
                 "discsq", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"i", "===", "j"}], ",", 
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{
                    "discsq", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", "x"}], "]"}], ",", 
                   RowBox[{
                   "discsq", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "x"}], "]"}], 
               ",", "nf"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "discsq", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "i", ",", 
               RowBox[{"Length", "[", "discsq", "]"}]}], "}"}]}], "]"}]}], 
          "\n", "\t", "}"}], "]"}]}], ";", "\n", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<bad reduction: \>\"", ",", "badred"}], "]"}], ";"}], 
        "*)"}], "\n", "\n", "\n", "\t", 
       RowBox[{"places\[Infinity]", "=", 
        RowBox[{"squarefree", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"places\[Infinity]", "=", 
          RowBox[{"IdealTimes", "[", 
           RowBox[{"\[Xi]", ",", 
            RowBox[{
            "P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            "places\[Infinity]", ",", 
            RowBox[{"squarefree", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", "nf"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "squarefree", "]"}]}], "}"}]}], "]"}], ";", 
       "\n", "\t", 
       RowBox[{"places\[Infinity]", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], ",",
           "places\[Infinity]"}], "}"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"TimePrint", "[", 
          RowBox[{"\"\<places\[Infinity]: \>\"", ",", 
           RowBox[{"DivisorPrint", "[", "places\[Infinity]", "]"}]}], "]"}], 
         ";"}], "*)"}], "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"eta", " ", "bar", " ", "basis"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"toEtaBar", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
             RowBox[{"P", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}]}], 
            ",", "x", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<toEtaBar: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "toEtaBar", "]"}]}], "]"}], ";"}], 
        "*)"}], "\n", "\t", 
       RowBox[{"fromEtaBar", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{"toEtaBar", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<fromEtaBar: \>\"", ",", 
           RowBox[{"1", "/", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ",", "\"\<*\>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<etabar check: \>\"", ",", "\n", "\t", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Table", "[", "\n", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"piece", "=", 
                RowBox[{"PieceTimes", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{
                  "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fromEtaBar", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IdentityMatrix", "[", "n", "]"}], 
                    "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                    ",", "1"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
               "\t\t", 
               RowBox[{"Factor", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ".", 
                  RowBox[{
                  "piece", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "/", 
                 RowBox[{
                 "piece", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], "\n", "\t", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
          "]"}], ";"}], "*)"}], "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"epsilon", " ", "basis"}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ord\[Rho]", ",", "fromEpsilon"}], "}"}], "=", 
        RowBox[{"DivisorRRSpace", "[", 
         RowBox[{"places\[Infinity]", ",", "P", ",", "ord\[Delta]", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"fromEpsilon", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "fromEpsilon", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "x", ",", "nf"}], "]"}], "&"}], 
          ",", 
          RowBox[{
          "fromEpsilon", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ord\[Rho]: \>\"", ",", "ord\[Rho]"}], "]"}], ";"}], 
        "*)"}], "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<fromEpsilon: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "fromEpsilon", "]"}]}], "]"}], ";"}], 
        "*)"}], "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "ord\[Rho]", "]"}], "-", 
           RowBox[{"Total", "[", "ord\[Delta]", "]"}]}], "===", 
          RowBox[{"DivisorDegree", "[", 
           RowBox[{"places\[Infinity]", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ",", 
         "\"\<error in GetCurveInformation: ord not right\>\""}], "]"}], ";", 
       "\n", "\t", 
       RowBox[{"toEpsilon", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{"fromEpsilon", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"toEpsilon", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "toEpsilon", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "x", ",", "nf"}], "]"}], "&"}], 
          ",", 
          RowBox[{
          "toEpsilon", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<toEpsilon: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "toEpsilon", "]"}]}], "]"}], ";"}], 
        "*)"}], "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"epsilon", " ", "bar", " ", "basis"}], " ", "*)"}], "\n", 
       "\t", 
       RowBox[{"toEpsilonBar", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"fromEpsilon", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{
                RowBox[{
                "T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ".", 
                RowBox[{"P", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "i", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
            ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"fromEpsilonBar", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{"toEpsilonBar", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<toEpsilonBar: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "toEpsilonBar", "]"}]}], "]"}], ";"}], 
        "*)"}], "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<fromEpsilonBar: \>\"", ",", 
           RowBox[{"1", "/", 
            RowBox[{
            "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ",", "\"\<*\>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{
            "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<epsilonbar check: \>\"", ",", "\n", "\t", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Table", "[", "\n", "\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"piece", "=", 
                RowBox[{"PieceTimes", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{
                  "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"fromEpsilonBar", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "fromEpsilon", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", "1"}], "}"}], ",", "nf"}],
                  "]"}]}], ";", "\n", "\t\t", 
               RowBox[{"Factor", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ".", 
                  RowBox[{
                  "piece", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "/", 
                 RowBox[{
                 "piece", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], "\n", "\t", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
          "]"}], ";"}], "*)"}], "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<fromEtaBar.toEpsilonBar: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Factor", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "fromEtaBar", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ".", "toEpsilonBar"}], "/", 
              RowBox[{
              "fromEtaBar", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], "]"}], ";"}], 
        "*)"}], "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generate", " ", "first", " ", "kind", " ", "differentials", " ", 
         "in", " ", "EtaBar", " ", "basis"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"diff1stkind", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"diff1stkind", ",", 
            RowBox[{
             RowBox[{"x", "^", "j"}], "*", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "n", "]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";"}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{
            RowBox[{
            "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "-", "2"}]}], "}"}]}], "]"}], ";", 
       "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<diff1stkind: \>\"", ",", 
             RowBox[{
             "diff1stkind", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "\"\<   \>\"", ",", 
             RowBox[{
              RowBox[{"PrintFunction", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "diff1stkind", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "fromEtaBar", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{
                  "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "ff"}], "]"}], 
              "*", 
              RowBox[{"Dt", "[", "x", "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "diff1stkind", "]"}]}], "}"}]}], "]"}], 
         ";"}], "*)"}], "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "diff1stkind", "]"}], "===", "genus"}], ",", 
         "\"\<bad dim of second\>\""}], "]"}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generate", " ", "third", " ", "kind", " ", "differential", " ", "in",
          " ", "EtaBar", " ", "basis"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"diff3rdkind", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"piece", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"toEtaBar", ".", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "^", "j"}], "*", 
                  RowBox[{"fromEpsilonBar", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}]}], 
                 ")"}]}], ",", "x", ",", "nf"}], "]"}], ",", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "}"}]}], ";", "\n", "\t\t", 
          RowBox[{"piece", "=", 
           RowBox[{"PolyNormalizeFraction", "[", 
            RowBox[{"piece", ",", "x", ",", "nf", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{
               "piece", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", "x"}], "]"}], "===", "0"}], 
            ",", "\"\<bad third kind differential\>\""}], "]"}], ";", "\n", 
          "\t\t", 
          RowBox[{"piece", "=", 
           RowBox[{
           "piece", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ";", "\n", "\t\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<3rd kind piece: \>\"", ",", "piece"}], "]"}], ";"}],
            "*)"}], "\n", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
           "erase", " ", "portion", " ", "from", " ", "first", " ", "kind", 
            " ", "differentials"}], " ", "*)"}], "\n", "\t\t", 
          RowBox[{"piece", "=", 
           RowBox[{"Table", "[", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[LessEqual]", "1"}], ",", 
               RowBox[{
               "piece", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "\n", "\t\t\t\t", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolyQuotient", "[", 
                   RowBox[{
                    RowBox[{
                    "piece", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"x", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}], ",", "x", 
                    ",", "nf"}], "]"}], "*", 
                  RowBox[{"x", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ",", 
                 "x", ",", "nf"}], "]"}]}], "\n", "\t\t\t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"diff3rdkind", ",", "piece"}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"PolyNumRowNullSpace", "[", 
               RowBox[{"diff3rdkind", ",", "x", ",", "nf"}], "]"}], "]"}], 
             ">", "0"}], ",", "\n", "\t\t\t", 
            RowBox[{"diff3rdkind", "=", 
             RowBox[{"Most", "[", "diff3rdkind", "]"}]}]}], "\n", "\t\t", 
           "]"}]}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{
            RowBox[{
            "ord\[Rho]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "-", "2"}]}], "}"}]}], "]"}], ";", 
       "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<diff3rdkind: \>\"", ",", 
             RowBox[{
             "diff3rdkind", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "\"\<   \>\"", ",", 
             RowBox[{
              RowBox[{"PrintFunction", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "diff3rdkind", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "fromEtaBar", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{
                  "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "ff"}], "]"}], 
              "*", 
              RowBox[{"Dt", "[", "x", "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "diff3rdkind", "]"}]}], "}"}]}], "]"}], 
         ";"}], "*)"}], "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "diff3rdkind", "]"}], "===", 
          RowBox[{
           RowBox[{"DivisorDegree", "[", 
            RowBox[{"places\[Infinity]", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], "-", 
           "1"}]}], ",", "\"\<bad dim of third kind\>\""}], "]"}], ";", "\n", 
       "\n", "\t", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generate", " ", "second", " ", "kind", " ", "differentials", " ", 
         "in", " ", "EpsilonBar", " ", "then", " ", "convert", " ", "to", " ",
          "EtaBar"}], "*)"}], "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"such", " ", "that", " ", 
         RowBox[{"1", "/", 
          RowBox[{"x", "^", "r"}]}], " ", "*", " ", "diff", " ", "is", " ", 
         "regular", " ", "at", " ", "infinite"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"diff2ndkind", "=", 
        RowBox[{"{", "}"}]}], ";", "\n", "\t", 
       RowBox[{"derInEpsilonBar", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", "d\[Phi]", ",", "x", ",", "nf"}], "]"}], "&"}], 
          ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"\[CapitalDelta]\[Phi]", ".", "toEpsilonBar"}], ",", "x", 
            ",", "nf"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"diffexact", "=", 
           RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
          RowBox[{"indices", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "0", ",", 
                 RowBox[{"r", "-", 
                  RowBox[{
                  "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", "1"}], 
            "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ">", "0"}], "||", 
                 RowBox[{"j", ">", "0"}]}], ",", "\n", "\t\t\t", 
                RowBox[{
                 RowBox[{"piece", "=", 
                  RowBox[{"PolyCollect", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"j", "*", 
                    RowBox[{"x", "^", 
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}]}], "*", 
                    RowBox[{
                    "toEpsilonBar", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", 
                    RowBox[{
                    RowBox[{"x", "^", "j"}], "*", 
                    RowBox[{
                    "derInEpsilonBar", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], 
                   "]"}]}], ";", "\n", "\t\t\t", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "erase", " ", "portion", " ", "from", " ", "third", " ", 
                   "kind", " ", "integrals"}], " ", "*)"}], "\n", "\t\t\t", 
                 RowBox[{"piece", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PolyQuotient", "[", 
                    RowBox[{
                    RowBox[{
                    "piece", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"x", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ord\[Rho]", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}], ",", "x", 
                    ",", "nf"}], "]"}], "*", 
                    RowBox[{"x", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "ord\[Rho]", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], "-", "1"}], ")"}]}]}], ",", 
                    "x", ",", "nf"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
                 "\n", "\t\t\t", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"diffexact", ",", "piece"}], "]"}]}]}], "\n", 
               "\t\t", "]"}]}], "]"}], ",", "indices", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], ";", "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<diffexact: \>\"", ",", "diffexact"}], "]"}], ";"}], 
           "*)"}], "\n", "\t\t", 
          RowBox[{"indices", "=", 
           RowBox[{"Sort", "[", 
            RowBox[{"indices", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"ord\[Rho]", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], "===", 
                 RowBox[{
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"ord\[Rho]", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}]}], 
                ",", 
                RowBox[{
                 RowBox[{
                 "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  "<", 
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#1", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"ord\[Rho]", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                 "<", 
                 RowBox[{
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"ord\[Rho]", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   "\[RightDoubleBracket]"}]}]}]}], "]"}], "&"}]}], "]"}]}], 
          ";", "\n", "\t\t", 
          RowBox[{"indices", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{
                  RowBox[{
                  "ord\[Rho]", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{
                  "ord\[Rho]", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "+", "r", "-", "2"}]}], "}"}]}],
               "]"}], ",", "1"}], "]"}]}], ";", "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<indices: \>\"", ",", "indices"}], "]"}], ";"}], 
           "*)"}], "\n", "\t\t", 
          RowBox[{"Apply", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"diff2ndkind", ",", 
                 RowBox[{
                  RowBox[{"x", "^", "j"}], "*", 
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "n", "]"}], 
                   "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
                 "]"}], ";", "\n", "\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"PolyNumRowNullSpace", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"diffexact", ",", "diff2ndkind"}], "]"}], ",", 
                    "x", ",", "nf"}], "]"}], "]"}], ">", "0"}], ",", "\n", 
                 "\t\t\t\t", 
                 RowBox[{"diff2ndkind", "=", 
                  RowBox[{"Most", "[", "diff2ndkind", "]"}]}]}], "\n", 
                "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}], ",", "indices", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], ";"}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"{", 
            RowBox[{"Max", "[", "ord\[Delta]", "]"}], "}"}]}], "}"}]}], "]"}],
        ";", "\n", "\t", 
       RowBox[{"diff2ndkind", "=", 
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"piece", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ".", "toEtaBar", ".", 
               RowBox[{
               "diff2ndkind", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"piece", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "x", ",", "nf"}], "]"}], 
               "&"}], ",", "piece"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"res", "=", 
            RowBox[{"CalcResidues", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"piece", ".", 
                 RowBox[{
                 "fromEtaBar", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{
                "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", "diff3rdkind", ",", 
              "ord\[Delta]", ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalDelta]\[Infinity]", ",", "d\[Infinity]"}], 
               "}"}], ",", "toEtaBar", ",", "toEpsilonBar", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"piece", "-", 
              RowBox[{"res", ".", "diff3rdkind"}]}], ",", "x", ",", "nf"}], 
            "]"}]}], "\n", "\t", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "diff2ndkind", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\n", 
       RowBox[{"(*", "\t", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<diff2ndkind: \>\"", ",", 
             RowBox[{
             "diff2ndkind", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "\"\<   \>\"", ",", 
             RowBox[{
              RowBox[{"PrintFunction", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "diff2ndkind", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ".", 
                   RowBox[{
                   "fromEtaBar", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{
                  "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "ff"}], "]"}], 
              "*", 
              RowBox[{"Dt", "[", "x", "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "diff2ndkind", "]"}]}], "}"}]}], "]"}], 
         ";"}], "*)"}], "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "diff2ndkind", "]"}], "===", "genus"}], ",", 
         "\"\<bad dim of second\>\""}], "]"}], ";", "\n", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{
        "disc", ",", "diff", ",", "squarefree", ",", "badred", ",", 
         "toEtaBar", ",", "fromEtaBar", ",", "\n", "\t\t", "toEpsilon", ",", 
         "fromEpsilon", ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", 
         "diff1stkind", ",", "diff2ndkind", ",", "diff3rdkind"}], "}"}]}]}], 
     "\n", "\n", "]"}]}], ";"}]}]], "Code",
 CellChangeTimes->{{3.690131255874434*^9, 3.690131305561751*^9}, {
   3.690131341016412*^9, 3.69013135202007*^9}, {3.6901314047995777`*^9, 
   3.690131412237908*^9}, {3.690131443967166*^9, 3.690131619514372*^9}, {
   3.690131665276782*^9, 3.6901316839232273`*^9}, {3.690131795285947*^9, 
   3.690131799899531*^9}, {3.690132554844606*^9, 3.690132563569496*^9}, {
   3.690133233078663*^9, 3.690133278508089*^9}, {3.69013353049259*^9, 
   3.690133550102468*^9}, {3.6901339515222807`*^9, 3.690133955752294*^9}, {
   3.6901339865595417`*^9, 3.6901339971202993`*^9}, {3.6901342075987997`*^9, 
   3.690134344195962*^9}, {3.6901374456769257`*^9, 3.690137446787212*^9}, {
   3.690137547385902*^9, 3.5760974775039635`*^9}, {3.5760975191763473`*^9, 
   3.5760975282358656`*^9}, {3.576097567033085*^9, 3.5760975676231184`*^9}, 
   3.5761758396045694`*^9, {3.5761759547639713`*^9, 3.5761760161968794`*^9}, {
   3.67390922203798*^9, 3.673909419289881*^9}, {3.673909498449417*^9, 
   3.6739095481508813`*^9}, {3.6739095920118227`*^9, 
   3.6739097068256383`*^9}, {3.673910098293398*^9, 3.6739101463113556`*^9}, {
   3.6739102405976124`*^9, 3.6739103999168763`*^9}, {3.6739105690034037`*^9, 
   3.6739105805569534`*^9}, 3.673910620279773*^9, {3.6739106573597775`*^9, 
   3.673910659891033*^9}, {3.676496981875407*^9, 3.6711343708238373`*^9}, {
   3.671134405558651*^9, 3.671134412527494*^9}, 3.671134481715952*^9, {
   3.67113496563262*^9, 3.6711349849147882`*^9}, {3.671135016102174*^9, 
   3.6711350724751234`*^9}, {3.6711351459880996`*^9, 3.671135284889991*^9}, {
   3.671135328725843*^9, 3.6711353307571173`*^9}, {3.671135650513553*^9, 
   3.67113565991993*^9}, {3.671135691225339*^9, 3.671135697444172*^9}, {
   3.671135761602887*^9, 3.6711358603925643`*^9}, {3.6711359125026646`*^9, 
   3.67113594414193*^9}, {3.671135980122593*^9, 3.671136045027965*^9}, {
   3.671137092112545*^9, 3.671137093018779*^9}, {3.6711381915310144`*^9, 
   3.671138220838829*^9}, {3.671138580430811*^9, 3.671138602081807*^9}, {
   3.671141012680319*^9, 3.6711410143678417`*^9}, {3.671141412073455*^9, 
   3.671141479728178*^9}, {3.671141569648311*^9, 3.6711415807852154`*^9}, {
   3.6711417004683127`*^9, 3.671141713093463*^9}, {3.6711456950456133`*^9, 
   3.671145699076894*^9}, {3.671145940279975*^9, 3.6711459421133604`*^9}, {
   3.67114736197318*^9, 3.671147372301466*^9}, {3.6711474038867674`*^9, 
   3.671147510928708*^9}, {3.6711476601819105`*^9, 3.6711476614475527`*^9}, {
   3.7017900490317802`*^9, 3.701790051742076*^9}, {3.702240476019356*^9, 
   3.7022405069170933`*^9}, {3.702515574401165*^9, 3.702515625966957*^9}, {
   3.702524143033947*^9, 3.7025241467731123`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["integral basis", "Subsection",
 CellChangeTimes->{{3.666030641819838*^9, 3.6660306457136602`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"output", ":", "\n", "\t", 
      RowBox[{
       RowBox[{"-", " ", "integral"}], " ", "basis", " ", "B"}]}], "=", 
     "y1"}], ",", "...", ",", 
    RowBox[{
    "yn", " ", "as", " ", "a", " ", "change", " ", "of", " ", "base", " ", 
     "matrix", " ", "B", " ", "from", " ", "the", " ", "power", " ", "basis", 
     " ", "1"}], ",", "y", ",", "...", ",", 
    RowBox[{
     RowBox[{"y", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], "\n", "\t", "-", " ", 
     RowBox[{"trace", " ", "map", " ", "of", " ", "B"}], "\n", "\t", "-", " ", 
     RowBox[{"product", " ", "map", " ", "of", " ", "B"}]}]}], "\n", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IntegralBasis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "curve_"}], "}"}], ",", "filter_", ",", 
       "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Exponent", "[", 
           RowBox[{"curve", ",", "y"}], "]"}]}], ",", "A", ",", "B", ",", "k",
          ",", "k2", ",", "d", ",", "v", ",", "q", ",", "PP", ",", "P", ",", 
         "R", ",", "Q", ",", "\[CapitalNu]", ",", "M", ",", "T"}], "}"}], ",",
        "\n", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"PolynomialQ", "[", 
            RowBox[{"curve", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<defining polynomial not polynomial\>\"", "]"}], 
           ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\t", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"v", " ", "starts", " ", "as", " ", "power", " ", "basis"}],
           ",", " ", 
          RowBox[{
          "which", " ", "is", " ", "assumed", " ", "to", " ", "be", " ", 
           "integral"}], ",", " ", 
          RowBox[{"and", " ", "is", " ", "incrementally", " ", "refined"}]}], 
         " ", "*)"}], "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"we", " ", 
           RowBox[{"don", "'"}], "t", " ", "reference", " ", "v", " ", 
           "directly"}], ";", " ", 
          RowBox[{
          "it", " ", "is", " ", "always", " ", "given", " ", "by", " ", 
           RowBox[{
            RowBox[{"Inverse", "[", "B", "]"}], ".", 
            RowBox[{"y", "^", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"n", "-", "1"}]}], "]"}]}]}]}]}], " ", "*)"}], "\n", 
        "\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"v", "=", 
           RowBox[{"y", "^", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"n", "-", "1"}]}], "]"}]}]}], ";"}], "*)"}], "\n", "\t", 
        RowBox[{"B", "=", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", "P"}], "}"}], "=", 
         RowBox[{"PowerBasisTraceTimes", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "curve"}], "}"}], ",", "nf"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"T", ".", 
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
             "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"d", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"Det", "[", "M", "]"}], ",", "x"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"d", "=", 
         RowBox[{"PolyGetCommonFactors", "[", 
          RowBox[{"d", ",", "filter", ",", "x", ",", "nf"}], "]"}]}], ";", 
        RowBox[{"k", "=", "d"}], ";", "\n", "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"k", ",", "x"}], "]"}], ">", "0"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"q", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"First", "/@", 
               RowBox[{"PolyFactor", "[", 
                RowBox[{"k", ",", "x", ",", "nf"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"PolyRemainder", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"PolyCollect", "[", 
                   RowBox[{
                    RowBox[{"#", "*", "#"}], ",", "x", ",", "nf"}], "]"}], 
                  ",", "x", ",", "nf"}], "]"}], "===", "0"}], "&"}]}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"q", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"Times", "@@", "q"}], ",", "x", ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"M", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"T", ".", 
                 RowBox[{"P", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n",
            "\t\t", 
           RowBox[{"Q", "=", 
            RowBox[{
             RowBox[{"PolyHermitianReduce", "[", 
              RowBox[{
               RowBox[{"ArrayFlatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "M", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", "*", 
                    RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "}"}]}], 
                 "}"}], "]"}], ",", "x", ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n",
            "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"R", "=", 
              RowBox[{"q", "*", 
               RowBox[{"Inverse", "[", "Q", "]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"not", " ", "just", " ", "R"}], "=", 
               RowBox[{"Inverse", "[", "Q", "]"}]}], ";", " ", 
              RowBox[{
              "seems", " ", "to", " ", "be", " ", "an", " ", "error", " ", 
               "in", " ", 
               RowBox[{"Trager", "'"}], "s", " ", "thesis", " ", "here"}]}]}],
             " ", "*)"}], "\n", "\t\t", 
           RowBox[{"R", "=", 
            RowBox[{"PolyMatrixInverse", "[", 
             RowBox[{"Q", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"R", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{
                 RowBox[{"#", "*", "q"}], ",", 
                 RowBox[{
                 "R", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
              RowBox[{
              "R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"\[CapitalNu]", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolyDivide", "[", 
                   RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{"#", ",", "x", ",", "nf"}], "]"}], ",", "q", ",", 
                    "x", ",", "nf"}], "]"}], "&"}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"Q", ".", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "a"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{"P", "\[LeftDoubleBracket]", 
                    RowBox[{"b", ",", "i", ",", "l"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
                    "x", ",", "nf"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
                 
                 RowBox[{"{", "2", "}"}]}], "]"}], "\n", "\t\t\t\t", "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\[CapitalNu]", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"PolyHermitianReduce", "[", 
               RowBox[{
                RowBox[{"ArrayFlatten", "[", "\[CapitalNu]", "]"}], ",", "x", 
                ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "update", " ", "P", " ", "and", " ", "calculate", " ", "k"}], 
             "=", 
             RowBox[{"\[PlusMinus]", 
              RowBox[{"Det", "[", "N", "]"}]}]}], " ", "*)"}], "\n", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"P", ",", "k"}], "}"}], "=", 
            RowBox[{"ChangeTimesBasis", "[", 
             RowBox[{"x", ",", "P", ",", "\[CapitalNu]", ",", "nf"}], "]"}]}],
            ";", 
           RowBox[{"k2", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"k", "*", "k"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"P", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{"#", ",", "k2", ",", "x", ",", "nf"}], "]"}], "&"}], 
              ",", "P", ",", 
              RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"update", " ", "T"}], " ", "*)"}], "\n", "\t\t", 
           RowBox[{"T", "=", 
            RowBox[{"PolyGaussJordanReduce", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "\[CapitalNu]", "]"}], ",", "T"}], 
                "]"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
           "\t\t", 
           RowBox[{"T", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"T", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "x", ",", "nf"}], "]"}], "&"}], ",", 
              RowBox[{"T", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"update", " ", "integral", " ", "basis"}], " ", "*)"}], 
           "\n", "\t\t", 
           RowBox[{"B", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"B", ".", "\[CapitalNu]"}], ",", "x", ",", "nf"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{"Cancel", "[", 
               RowBox[{
                RowBox[{"Inverse", "[", "N", "]"}], ".", "v"}], "]"}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"d", "=", 
            RowBox[{"PolyDivide", "[", 
             RowBox[{"d", ",", "k2", ",", "x", ",", "nf"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ";", "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<integral basis: \>\"", ",", 
            RowBox[{"LinearSolve", "[", 
             RowBox[{"B", ",", 
              RowBox[{"y", "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"n", "-", "1"}]}], "]"}]}]}], "]"}]}], "]"}], ";", 
          "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<change of basis: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "B", "]"}]}], "]"}], ";", "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<trace map: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "T", "]"}]}], "]"}], ";", "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<times map: \>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"P", ",", 
              RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]}], "]"}], ";"}],
          "*)"}], "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"B", ",", "T", ",", "P"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
   "\n", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"output", ":", "\n", "\t", 
       RowBox[{
        RowBox[{"-", " ", "integral"}], " ", "basis", " ", "B"}]}], "=", 
      "y1"}], ",", "...", ",", 
     RowBox[{
     "yn", " ", "as", " ", "a", " ", "change", " ", "of", " ", "base", " ", 
      "matrix", " ", "B", " ", "from", " ", "the", " ", "power", " ", "basis",
       " ", "1"}], ",", "y", ",", "...", ",", 
     RowBox[{
      RowBox[{"y", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "\n", "\t", "-", " ", 
      RowBox[{"trace", " ", "map", " ", "of", " ", "B"}], "\n", "\t", "-", 
      " ", 
      RowBox[{"product", " ", "map", " ", "of", " ", "B"}]}]}], "\n", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegralBasis2", "[", 
      RowBox[{"tt_", ",", "pp_", ",", "filter_", ",", "x_", ",", "nf_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "pp", "]"}]}], ",", "A", ",", "k", ",", "k2",
          ",", "d", ",", "v", ",", "q", ",", "PP", ",", "R", ",", "Q", ",", 
         "\[CapitalNu]", ",", "M", ",", 
         RowBox[{"T", "=", "tt"}], ",", 
         RowBox[{"P", "=", "pp"}], ",", "B"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"B", "=", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"T", ".", 
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
             "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"d", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"Det", "[", "M", "]"}], ",", "x"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"d", "=", 
         RowBox[{"PolyGetCommonFactors", "[", 
          RowBox[{"d", ",", "filter", ",", "x", ",", "nf"}], "]"}]}], ";", 
        RowBox[{"k", "=", "d"}], ";", "\n", "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"k", ",", "x"}], "]"}], ">", "0"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"q", "=", 
            RowBox[{"PolyGCD", "[", 
             RowBox[{"k", ",", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"Times", "@@", 
                 RowBox[{"Rest", "[", 
                  RowBox[{"PolyFactorSquareFree", "[", 
                   RowBox[{"d", ",", "x", ",", "nf"}], "]"}], "]"}]}], ",", 
                "x", ",", "nf"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"M", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"T", ".", 
                 RowBox[{"P", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n",
            "\t\t", 
           RowBox[{"Q", "=", 
            RowBox[{
             RowBox[{"PolyHermitianReduce", "[", 
              RowBox[{
               RowBox[{"ArrayFlatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "M", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", "*", 
                    RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "}"}]}], 
                 "}"}], "]"}], ",", "x", ",", "nf"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "n"}], "]"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"R", "=", 
              RowBox[{"q", "*", 
               RowBox[{"Inverse", "[", "Q", "]"}]}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"not", " ", "just", " ", "R"}], "=", 
               RowBox[{"Inverse", "[", "Q", "]"}]}], ";", " ", 
              RowBox[{
              "seems", " ", "to", " ", "be", " ", "an", " ", "error", " ", 
               "in", " ", 
               RowBox[{"Trager", "'"}], "s", " ", "thesis", " ", "here"}]}]}],
             " ", "*)"}], "\n", "\t\t", 
           RowBox[{"R", "=", 
            RowBox[{"PolyMatrixInverse", "[", 
             RowBox[{"Q", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"R", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{
                 RowBox[{"#", "*", "q"}], ",", 
                 RowBox[{
                 "R", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
              RowBox[{
              "R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"\[CapitalNu]", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"PolyDivide", "[", 
                   RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{"#", ",", "x", ",", "nf"}], "]"}], ",", "q", ",", 
                    "x", ",", "nf"}], "]"}], "&"}], ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"Q", ".", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "a"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{"P", "\[LeftDoubleBracket]", 
                    RowBox[{"b", ",", "i", ",", "l"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
                    "x", ",", "nf"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "1", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
                 
                 RowBox[{"{", "2", "}"}]}], "]"}], "\n", "\t\t\t\t", "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"\[CapitalNu]", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"PolyHermitianReduce", "[", 
               RowBox[{
                RowBox[{"ArrayFlatten", "[", "\[CapitalNu]", "]"}], ",", "x", 
                ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "update", " ", "P", " ", "and", " ", "calculate", " ", "k"}], 
             "=", 
             RowBox[{"\[PlusMinus]", 
              RowBox[{"Det", "[", "N", "]"}]}]}], " ", "*)"}], "\n", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"P", ",", "k"}], "}"}], "=", 
            RowBox[{"ChangeTimesBasis", "[", 
             RowBox[{"x", ",", "P", ",", "\[CapitalNu]", ",", "nf"}], "]"}]}],
            ";", 
           RowBox[{"k2", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"k", "*", "k"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"P", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{"#", ",", "k2", ",", "x", ",", "nf"}], "]"}], "&"}], 
              ",", "P", ",", 
              RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"update", " ", "T"}], " ", "*)"}], "\n", "\t\t", 
           RowBox[{"T", "=", 
            RowBox[{"PolyGaussJordanReduce", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "\[CapitalNu]", "]"}], ",", "T"}], 
                "]"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
           "\t\t", 
           RowBox[{"T", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyDivide", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"T", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "x", ",", "nf"}], "]"}], "&"}], ",", 
              RowBox[{"T", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"update", " ", "integral", " ", "basis"}], " ", "*)"}], 
           "\n", "\t\t", 
           RowBox[{"B", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"B", ".", "\[CapitalNu]"}], ",", "x", ",", "nf"}], 
             "]"}]}], ";", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<det B: \>\"", ",", 
               RowBox[{"Factor", "[", 
                RowBox[{"Det", "[", "B", "]"}], "]"}]}], "]"}], ";"}], "*)"}],
            "\n", "\t\t", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{"Cancel", "[", 
               RowBox[{
                RowBox[{"Inverse", "[", "N", "]"}], ".", "v"}], "]"}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"d", "=", 
            RowBox[{"PolyDivide", "[", 
             RowBox[{"d", ",", "k2", ",", "x", ",", "nf"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ";", "\n", "\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<integral basis: \>\"", ",", 
            RowBox[{"LinearSolve", "[", 
             RowBox[{"B", ",", 
              RowBox[{"y", "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"n", "-", "1"}]}], "]"}]}]}], "]"}]}], "]"}], ";", 
          "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<change of basis: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "B", "]"}]}], "]"}], ";", "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<trace map: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "T", "]"}]}], "]"}], ";", "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<times map: \>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"P", ",", 
              RowBox[{"TableDepth", "\[Rule]", "2"}]}], "]"}]}], "]"}], ";"}],
          "*)"}], "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"B", ",", "T", ",", "P"}], "}"}]}]}], "\n", "]"}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJwd0U0og3EABvCxcsDhTbYcFGs1H0WEaNL860VKWnagmY8UBx9pNSWMLZO9
aRjKxw4yk2TJsB2UA0rNiQj5iIuvvU3LR9IW3ud/ePpdnp7LI2vprmmNFolE
KUKgtiopplXNk3yXkXVuBEhLvL8TKl3P3bBoXNsDjxprRuGus2AM9tVuTcJi
LnYWuo8Y6kIe44CP7p9FGFxVuyHLhamhDb0XPowa/fBk/PoUei2aM7ovUfyZ
NDzReUxis+DFcBwDizZVEhjhtKnw6epUDu02czqs+2UzaH9+sB0+h8o6YPl9
/rtPcPut7RNmlZasXQpmSBzUOZ+dC/bzZOpxyM8sBYh13f4GfevmENycrrcm
CDbdNFN7bS+WQsFk9cEIlPYwslgjT6Rz+9TAd046jHS9fnmcATJgExPdIE+O
dYcsDO2JKqEi009NDHdMwOpz6RRckMUEofSL/YB3K7lhmL26E4FW+U1Ug6Bq
dzkaGiqqEqFC7KXOqL7ToEm5Zbh1Cf/p9ZzMwpPcRg/1H/aLA50=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["normal basis", "Subsection",
 CellChangeTimes->{{3.581216938506771*^9, 3.581216942830778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"m", " ", "is", " ", "a", " ", "basis", " ", "for", " ", "a", " ", 
     RowBox[{"k", "[", "x", "]"}], " ", "module"}], ",", " ", 
    RowBox[{
    "m", " ", "could", " ", "have", " ", "extries", " ", "in", " ", "k", 
     RowBox[{"(", "x", ")"}]}], ",", "\n", "\t", 
    RowBox[{
    "but", " ", "assume", " ", "that", " ", "a", " ", "common", " ", 
     "denominator", " ", "of", " ", "degree", " ", "deg", " ", "has", " ", 
     "been", " ", "found", " ", "and", " ", "the", " ", "fractions", " ", 
     "have", " ", "been", " ", 
     RowBox[{"cleared", ".", "\n", "\t", "we"}], " ", "only", " ", "need", 
     " ", "the", " ", "degree", " ", "of", " ", "this", " ", "common", " ", 
     "denominator", " ", "after", " ", "the", " ", "normalization", " ", "to",
      " ", "see", " ", "if", " ", "there", " ", "is", " ", "any", " ", 
     "combo", " ", "has", " ", "no", " ", "poles", " ", "at", " ", 
     "infinity"}]}], "\n", "\t", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "result", " ", "is", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"normalized", " ", "basis", " ", "at", " ", "infinity"}], " ", 
      ",", " ", 
      RowBox[{
      "contains", " ", "fxn", " ", "with", " ", "no", " ", "poles", " ", "at",
        " ", 
       RowBox[{"infinity", "?"}]}], " ", ",", " ", 
      RowBox[{"vector", " ", "for", " ", "fxn"}]}], "}"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MakeNormalAtInfinity", "[", 
      RowBox[{"m_List", ",", "x_", ",", "deg_Integer", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "=", "m"}], ",", "i", ",", "j", ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "m", "]"}]}], ",", "ri", ",", "ord", ",", 
         "\[CapitalNu]", ",", "ci", ",", "i0", ",", "max"}], "}"}], ",", "\n",
        "\t", 
       RowBox[{
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "m", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"ri", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Max", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", 
              RowBox[{
              "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"\[CapitalNu]", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"M", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "x", 
             ",", 
             RowBox[{
             "ri", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"ci", "=", 
             RowBox[{"NumNullSpace", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "\[CapitalNu]", "]"}], ",", "nf"}], 
              "]"}]}], "]"}], ">", "0"}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"ci", "=", 
            RowBox[{
            "ci", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ";", "\n", "\t\t", 
           RowBox[{"max", "=", 
            RowBox[{"-", "\[Infinity]"}]}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "ci", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  "=!=", "0"}], "&&", 
                RowBox[{
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  ">", "max"}]}], ",", 
               RowBox[{
                RowBox[{"i0", "=", "i"}], ";", 
                RowBox[{"max", "=", 
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
           "\t\t", 
           RowBox[{"ci", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"NumCollect", "[", 
               RowBox[{"#", ",", "nf"}], "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"ci", "*", 
               RowBox[{"NumRecp", "[", 
                RowBox[{
                 RowBox[{
                 "ci", "\[LeftDoubleBracket]", "i0", 
                  "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ")"}]}]}], 
           ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{
            "M", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}], "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "ci", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                  "*", 
                 RowBox[{"x", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "ri", "\[LeftDoubleBracket]", "i0", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "ri", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], "*", 
                 RowBox[{
                 "M", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
              ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{
            "ri", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"Max", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", 
               RowBox[{
               "M", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}]}],
               "]"}]}]}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{
            "\[CapitalNu]", "\[LeftDoubleBracket]", "i0", 
             "\[RightDoubleBracket]"}], "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Coefficient", "[", 
                RowBox[{"#", ",", "x", ",", 
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i0", 
                  "\[RightDoubleBracket]"}]}], "]"}], "&"}], ",", 
              RowBox[{
              "M", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}]}], 
             "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
        RowBox[{"Catch", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "ri", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "\[LessEqual]", "deg"}], ",", 
              RowBox[{"Throw", "[", 
               RowBox[{"{", 
                RowBox[{"True", ",", 
                 RowBox[{
                 "M", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
          "\t\t", 
          RowBox[{"Throw", "[", 
           RowBox[{"{", 
            RowBox[{"False", ",", "Null"}], "}"}], "]"}]}], "\n", "\t", 
         "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "m", " ", "is", " ", "a", " ", "basis", " ", "for", " ", "a", " ", 
      RowBox[{"k", "[", "x", "]"}], " ", "module"}], ",", " ", 
     RowBox[{
     "m", " ", "could", " ", "have", " ", "extries", " ", "in", " ", "k", 
      RowBox[{"(", "x", ")"}]}], ",", "\n", "\t", 
     RowBox[{
     "but", " ", "assume", " ", "that", " ", "a", " ", "common", " ", 
      "denominator", " ", "of", " ", "degree", " ", "deg", " ", "has", " ", 
      "been", " ", "found", " ", "and", " ", "the", " ", "fractions", " ", 
      "have", " ", "been", " ", 
      RowBox[{"cleared", ".", "\n", "\t", "we"}], " ", "only", " ", "need", 
      " ", "the", " ", "degree", " ", "of", " ", "this", " ", "common", " ", 
      "denominator", " ", "after", " ", "the", " ", "normalization", " ", 
      "to", " ", "see", " ", "if", " ", "there", " ", "is", " ", "any", " ", 
      "combo", " ", "has", " ", "no", " ", "poles", " ", "at", " ", 
      "infinity"}]}], "\n", "\t", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", "result", " ", "is", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"orders", " ", "at", " ", "\[Infinity]"}], ",", " ", 
       RowBox[{"new", " ", "basis"}], ",", " ", 
       RowBox[{"change", " ", "of", " ", "basis", " ", "matrix"}]}], "}"}]}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NormalizeAtInfinity", "[", 
      RowBox[{"m_List", ",", "x_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"M", "=", "m"}], ",", "i", ",", "j", ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "m", "]"}]}], ",", "B", ",", "ri", ",", 
         "ord", ",", "\[CapitalNu]", ",", "ci", ",", "i0", ",", "max"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "m", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"B", "=", 
         RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<normalizing: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "M", "]"}]}], "]"}], ";", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<B: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "B", "]"}]}], "]"}], ";"}], "*)"}], 
        "\n", "\t", 
        RowBox[{"ri", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Max", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", 
              RowBox[{
              "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"\[CapitalNu]", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"M", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "x", 
             ",", 
             RowBox[{
             "ri", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"Label", "[", "\"\<loop\>\"", "]"}], ";", "\n", "\t", 
        RowBox[{"ci", "=", 
         RowBox[{"NumNullSpace", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "\[CapitalNu]", "]"}], ",", "nf"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ci", "]"}], "===", "0"}], ",", 
          RowBox[{"Goto", "[", "\"\<done\>\"", "]"}], ",", 
          RowBox[{"ci", "=", 
           RowBox[{
           "ci", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
         "]"}], ";", "\n", "\t", 
        RowBox[{"max", "=", 
         RowBox[{"-", "\[Infinity]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "ci", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=!=",
               "0"}], "&&", 
             RowBox[{
              RowBox[{
              "ri", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ">", "max"}]}], ",", 
            RowBox[{
             RowBox[{"i0", "=", "i"}], ";", 
             RowBox[{"max", "=", 
              RowBox[{
              "ri", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"ci", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{"#", ",", "nf"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"ci", "*", 
            RowBox[{"NumRecp", "[", 
             RowBox[{
              RowBox[{
              "ci", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}], 
              ",", "nf"}], "]"}]}], ")"}]}]}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"M", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}],
          "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "ci", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i0", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], "*", 
              RowBox[{
              "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
           ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"B", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}],
          "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "ci", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i0", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "ri", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], "*", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
           ",", "nf"}], "]"}]}], ";", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<B: \>\"", ",", 
            RowBox[{"MatrixForm", "[", "B", "]"}]}], "]"}], ";"}], "*)"}], 
        "\n", "\t", 
        RowBox[{
         RowBox[{
         "ri", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Max", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Exponent", "[", 
               RowBox[{"#", ",", "x"}], "]"}], ")"}], "&"}], ",", 
            RowBox[{
            "M", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}]}], 
           "]"}]}]}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{
         "\[CapitalNu]", "\[LeftDoubleBracket]", "i0", 
          "\[RightDoubleBracket]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{"#", ",", "x", ",", 
              RowBox[{
              "ri", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}]}],
              "]"}], "&"}], ",", 
           RowBox[{
           "M", "\[LeftDoubleBracket]", "i0", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"Goto", "[", "\"\<loop\>\"", "]"}], ";", "\n", 
        RowBox[{"Label", "[", "\"\<done\>\"", "]"}], ";", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"ri", ",", "M", ",", "B"}], "}"}]}]}], "\n", "]"}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.5812169450957813`*^9, 3.5812169482157855`*^9}, {
  3.581217066229957*^9, 3.5812170670299582`*^9}, {3.581217099453006*^9, 
  3.5812171757131166`*^9}, {3.581217214121173*^9, 3.58121732849334*^9}, {
  3.5812174009264455`*^9, 3.5812174628035355`*^9}, {3.581217496189584*^9, 
  3.5812175520286646`*^9}, {3.58121758295471*^9, 3.5812176080207467`*^9}, {
  3.5812176435397987`*^9, 3.5812176872758617`*^9}, {3.581217839116081*^9, 
  3.5812178420210853`*^9}, {3.6669612153541317`*^9, 3.666961218026003*^9}, {
  3.6677696427445717`*^9, 3.667769643829341*^9}, {3.667769711621422*^9, 
  3.667769717920689*^9}, {3.6874014645941896`*^9, 3.68740149737781*^9}, {
  3.687401599317478*^9, 3.6874016132293787`*^9}, {3.687534897835348*^9, 
  3.687534921991297*^9}, {3.687535005998822*^9, 3.687535007499853*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["power basis", "Subsection",
 CellChangeTimes->{{3.666030629504714*^9, 3.666030632008609*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"output", ",", " ", 
    RowBox[{"assuming", " ", "curve", " ", "is", " ", "monic", " ", "in", " ", 
     RowBox[{"y", ":", "\n", "\t", 
      RowBox[{
       RowBox[{"-", " ", "basis"}], " ", "a1"}]}]}], ",", " ", 
    RowBox[{"a2", "*", "y"}], ",", " ", "...", ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"an", "*", 
       RowBox[{"y", "^", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}], " ", "of", " ", "integral", " ", 
       "functions"}], "\n", "\t", "-", " ", "1"}], "\[Rule]", "piece"}], ",", 
    " ", 
    RowBox[{"y", "\[Rule]", 
     RowBox[{"piece", "\n", "\t", "-", " ", 
      RowBox[{
      "trace", " ", "map", " ", "with", " ", "respect", " ", "to", " ", 
       "a1"}]}]}], ",", " ", 
    RowBox[{"a2", "*", "y"}], ",", " ", "...", ",", " ", 
    RowBox[{
     RowBox[{"an", "*", 
      RowBox[{"y", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], "\n", "\t", "-", " ", 
     RowBox[{
     "product", " ", "map", " ", "with", " ", "respect", " ", "to", " ", 
      "a1"}]}], ",", " ", 
    RowBox[{"a2", "*", "y"}], ",", " ", "...", ",", " ", 
    RowBox[{"an", "*", 
     RowBox[{"y", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}]}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PowerBasisTraceTimesD", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"y_", ",", "ccurve_"}], "}"}], ",", "x_", ",", "nf_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Exponent", "[", 
           RowBox[{"ccurve", ",", "y"}], "]"}]}], ",", "curve", ",", "T", ",",
          "P", ",", "cl", ",", "B", ",", "Bd", ",", "cx", ",", "cy", ",", 
         "yp", ",", "\[CapitalDelta]"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"curve", "=", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "ccurve", "]"}], "]"}]}], ";", "\n", "\t", 
        
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolynomialQ", "[", 
            RowBox[{"curve", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "&&", 
           RowBox[{"n", ">", "0"}]}], ",", 
          "\"\<bad curve in PowerBasisTraceTimesD\>\""}], "]"}], ";", "\n", 
        "\t", 
        RowBox[{"T", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"cl", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{"curve", ",", "y"}], "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "cl", "]"}], "===", 
           RowBox[{"n", "+", "1"}]}], ",", 
          "\"\<bad curve coeff in PowerBasisTraceTimesD\>\""}], "]"}], ";", 
        "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">", "1"}], ",", "\n", "\t", 
          RowBox[{
           RowBox[{"Bd", "=", 
            RowBox[{
            "cl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ";", "\n", "\t", 
           RowBox[{"cl", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "===", "1"}], ",", "1", ",", 
                RowBox[{"PolyCollect", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "cl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "*", 
                   RowBox[{"Bd", "^", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "2"}], ")"}]}]}], ",", "x", ",", "nf"}],
                  "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
           
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"T", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"i", "<", "n"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "i"}], ")"}], "*", 
                    RowBox[{"cl", "\[LeftDoubleBracket]", 
                    RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",",
                    "0"}], "]"}], "-", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"cl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{"T", "\[LeftDoubleBracket]", 
                    RowBox[{"i", "-", "j", "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"i", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ",", 
                "x", ",", "nf"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"P", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{
                 RowBox[{"2", "*", "n"}], "-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n",
            "\t", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", 
              "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"cl", "\[LeftDoubleBracket]", 
                    RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], "*", 
                   RowBox[{"P", "\[LeftDoubleBracket]", 
                    RowBox[{"i", "-", "j", "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
                "x", ",", "nf"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n", ",", 
               RowBox[{
                RowBox[{"2", "*", "n"}], "-", "2"}]}], "}"}]}], "]"}], ";", 
           "\n", "\t", 
           RowBox[{"P", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"P", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "+", "j", "-", "1"}], "\[RightDoubleBracket]"}],
                 ",", "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n",
            "\n", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"first", " ", "compute", " ", "d", 
              RowBox[{
               RowBox[{"(", "ay", ")"}], "/", "dx"}]}], " ", "=", " ", 
             RowBox[{
              RowBox[{"-", "curve_x"}], "/", "curve_y"}]}], " ", "*)"}], "\n",
            "\t", 
           RowBox[{"cl", "=", 
            RowBox[{"Reverse", "[", "cl", "]"}]}], ";", "\n", "\t", 
           RowBox[{"cx", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                   "cl", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", "x"}], "]"}], ",", "x", 
                ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n",
            "\t", 
           RowBox[{"cy", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"i", "*", 
                 RowBox[{"cl", "\[LeftDoubleBracket]", 
                  RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n",
            "\t", 
           RowBox[{"yp", "=", 
            RowBox[{"PieceDivide", "[", 
             RowBox[{"x", ",", "P", ",", 
              RowBox[{"{", 
               RowBox[{"cx", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"cy", ",", "1"}], "}"}], ",", "nf"}], "]"}]}], ";", 
           "\n", "\t", 
           RowBox[{"\[CapitalDelta]", "=", 
            RowBox[{"Table", "[", "\n", "\t\t", 
             RowBox[{
              RowBox[{"Which", "[", "\n", "\t\t", 
               RowBox[{
                RowBox[{"i", "===", "0"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", "n"}], "]"}], ",", "\n", "\t\t", 
                RowBox[{"i", "===", "1"}], ",", 
                RowBox[{
                "yp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", "\n", "\t\t", "True", ",", 
                RowBox[{
                 RowBox[{"PieceTimes", "[", 
                  RowBox[{"x", ",", "P", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", "n"}], "]"}], ",", 
                    RowBox[{"i", "\[Rule]", "i"}]}], "]"}], ",", "1"}], "}"}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "yp", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "1"}], "}"}], ",", "nf"}],
                   "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "\n", "\t\t", "]"}], "\n", "\t",
               ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
           
           RowBox[{"B", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{"Bd", "^", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1", "-", "i"}], ")"}]}], ",", "x", ",", 
                 "nf"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "0", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
           "\n", "\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"y", "^", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"n", "-", "1"}]}], "]"}]}], ",", "\n", "\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "n", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", "1"}], "}"}]}], ",", 
               RowBox[{"y", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "n", "]"}], 
                   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                  ",", "Bd"}], "}"}]}]}], "}"}], ",", "\n", "\t\t", 
             RowBox[{"{", 
              RowBox[{"B", ",", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{"Bd", "^", 
                  RowBox[{"(", 
                   RowBox[{"n", "-", "1"}], ")"}]}], ",", "x", ",", "nf"}], 
                "]"}]}], "}"}], ",", "\n", "\t\t", "T", ",", "P", ",", "\n", 
             "\t\t", 
             RowBox[{"PolyNormalizeFraction", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[CapitalDelta]", ",", 
                 RowBox[{
                 "yp", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], "\n", "\t", "}"}]}], "\n", 
          ",", "\n", "\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", "\n", "\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IdentityMatrix", "[", "n", "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
                  "1"}], "}"}]}], ",", 
              RowBox[{"y", "\[Rule]", 
               RowBox[{"PolyNormalizeFraction", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"-", 
                    RowBox[{
                    "cl", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{
                   "cl", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", 
                 ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}]}]}], "}"}], ",", "\n", 
            "\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", "1", "}"}], "}"}], ",", "1"}], "}"}], ",", "\n", 
            "\t\t", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"{", "1", "}"}], "}"}], "}"}], ",", "\n", "\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}]}], "\n", 
           "\t", "}"}]}], "\n", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"output", ",", " ", 
     RowBox[{
     "assuming", " ", "curve", " ", "is", " ", "monic", " ", "in", " ", 
      RowBox[{"y", ":", "\n", "\t", 
       RowBox[{
        RowBox[{"-", " ", "trace"}], " ", "map", " ", "with", " ", "respect", 
        " ", "to", " ", "1"}]}]}], ",", "y", ",", "...", ",", 
     RowBox[{
      RowBox[{"y", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "\n", "\t", "-", " ", 
      RowBox[{
      "product", " ", "map", " ", "with", " ", "respect", " ", "to", " ", 
       "1"}]}], ",", "y", ",", "...", ",", 
     RowBox[{"y", "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PowerBasisTraceTimes", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "curve_"}], "}"}], ",", "nf_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Exponent", "[", 
           RowBox[{"curve", ",", "y"}], "]"}]}], ",", "T", ",", "P", ",", 
         "cl"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"T", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"cl", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"CoefficientList", "[", 
           RowBox[{"curve", ",", "y"}], "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "cl", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
            "1"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<error in PowerBasisTraceTimes: defining polynomial not monic\
\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "<", "n"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "i"}], ")"}], "*", 
                 RowBox[{"cl", "\[LeftDoubleBracket]", 
                  RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                "0"}], "]"}], "-", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"cl", "\[LeftDoubleBracket]", 
                  RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "*", 
                 RowBox[{"T", "\[LeftDoubleBracket]", 
                  RowBox[{"i", "-", "j", "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{"i", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ",", 
             "x", ",", "nf"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"P", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"2", "*", "n"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", "1"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"cl", "\[LeftDoubleBracket]", 
                  RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], "*", 
                RowBox[{"P", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "-", "j", "+", "1"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
             ",", "nf"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n", ",", 
            RowBox[{
             RowBox[{"2", "*", "n"}], "-", "2"}]}], "}"}]}], "]"}], ";", "\n",
         "\t", 
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "j", "-", "1"}], "\[RightDoubleBracket]"}], 
              ",", "x", ",", "nf"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "}"}]}]}], 
      "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"output", ",", " ", 
     RowBox[{
      RowBox[{
      "assuming", " ", "curve", " ", "is", " ", "monic", " ", "in", " ", 
       RowBox[{"y", ":", "\n", "\t", 
        RowBox[{
         RowBox[{"-", " ", "a"}], " ", "matrix", " ", 
         RowBox[{"(", 
          RowBox[{"M", ",", "d"}], ")"}], " ", "such", " ", "that", " ", "D", 
         
         RowBox[{"{", 
          RowBox[{"1", ",", "...", ",", 
           RowBox[{"y", "^", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], "}"}]}]}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"1", "/", "d"}], "*", 
       RowBox[{"M", ".", 
        RowBox[{"{", 
         RowBox[{"1", ",", "...", ",", 
          RowBox[{"y", "^", 
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}]}]}], "}"}]}]}]}]}], "\n", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PowerBasisD", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "curve_"}], "}"}], ",", "nf_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Exponent", "[", 
           RowBox[{"curve", ",", "y"}], "]"}]}], ",", "T", ",", "P", ",", 
         "cx", ",", "cy", ",", "yp", ",", "yn", ",", "\[CapitalDelta]"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", "P"}], "}"}], "=", 
         RowBox[{"PowerBasisTraceTimes", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "curve"}], "}"}], ",", "nf"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"first", " ", "compute", " ", 
           RowBox[{"dy", "/", "dx"}]}], " ", "=", " ", 
          RowBox[{
           RowBox[{"-", "curve_x"}], "/", "curve_y"}]}], " ", "*)"}], "\n", 
        "\t", 
        RowBox[{"cx", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"PadRight", "[", 
            RowBox[{
             RowBox[{"CoefficientList", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"-", "curve"}], ",", "x"}], "]"}], ",", "y"}], "]"}],
              ",", "n"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"cy", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"curve", ",", "y"}], "]"}], ",", "y"}], "]"}], ",", "x",
            ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"yp", "=", 
         RowBox[{"PieceDivide", "[", 
          RowBox[{"x", ",", "P", ",", 
           RowBox[{"{", 
            RowBox[{"cx", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"cy", ",", "1"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"\[CapitalDelta]", "=", 
         RowBox[{"Table", "[", "\n", "\t\t", 
          RowBox[{
           RowBox[{"Which", "[", "\n", "\t\t", 
            RowBox[{
             RowBox[{"i", "===", "0"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "n"}], "]"}], ",", "\n", "\t\t", 
             RowBox[{"i", "===", "1"}], ",", 
             RowBox[{
             "yp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "\n", "\t\t", "True", ",", 
             RowBox[{
              RowBox[{"PieceTimes", "[", 
               RowBox[{"x", ",", "P", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ReplacePart", "[", 
                   RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", "n"}], "]"}], ",", 
                    RowBox[{"i", "\[Rule]", "i"}]}], "]"}], ",", "1"}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "yp", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "1"}], "}"}], ",", "nf"}], 
               "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "\n", "\t\t", "]"}], "\n", "\t", 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"\[CapitalDelta]", ",", 
          RowBox[{
          "yp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}]}]}], "\n", "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.579830275200732*^9, 3.579830367579871*^9}, {
   3.579830398072918*^9, 3.5798304713270297`*^9}, {3.5798306019022284`*^9, 
   3.579830652099304*^9}, {3.579830696596372*^9, 3.5798307077563877`*^9}, {
   3.579830758572467*^9, 3.579830838116587*^9}, {3.5798346202572975`*^9, 
   3.579834661154359*^9}, {3.5798347002164173`*^9, 3.5798347923385544`*^9}, {
   3.579834931913765*^9, 3.57983500910588*^9}, {3.5798352005011673`*^9, 
   3.5798352206061983`*^9}, {3.579835294094307*^9, 3.5798352943343077`*^9}, {
   3.5798353367423725`*^9, 3.5798353371873727`*^9}, {3.579836467038072*^9, 
   3.579836471938079*^9}, {3.5798365892592554`*^9, 3.579836615643295*^9}, {
   3.5798366750193853`*^9, 3.579836730808467*^9}, {3.5798369081927347`*^9, 
   3.579836949947797*^9}, {3.5798370140308943`*^9, 3.5798371411590834`*^9}, {
   3.579837176473137*^9, 3.57983724505324*^9}, {3.579837324870361*^9, 
   3.579837330745369*^9}, {3.5798373720744314`*^9, 3.5798373944664636`*^9}, {
   3.579837555774706*^9, 3.579837556314707*^9}, {3.665597421233932*^9, 
   3.665597426389895*^9}, {3.665873683602179*^9, 3.665873717725773*^9}, {
   3.665873776507193*^9, 3.5812181226734934`*^9}, {3.5812181660625563`*^9, 
   3.5812182722687106`*^9}, {3.5812202258955436`*^9, 
   3.5812202260405436`*^9}, {3.5812212442400513`*^9, 
   3.5812212560650673`*^9}, {3.5812213411761913`*^9, 3.581221341446192*^9}, {
   3.688845619976137*^9, 3.688845689220104*^9}, 3.688846407513784*^9, {
   3.688848267490337*^9, 3.688848269193364*^9}, {3.688848324944963*^9, 
   3.6888484391887417`*^9}, {3.6888484950692177`*^9, 3.688848499629324*^9}, {
   3.68884855678857*^9, 3.688848591131198*^9}, {3.6888487336056013`*^9, 
   3.688848748729898*^9}, {3.688848798172821*^9, 3.688848922452642*^9}, {
   3.688848974683742*^9, 3.688849011542985*^9}, {3.688849143413699*^9, 
   3.688849231170052*^9}, {3.6888493161628838`*^9, 3.688849372190426*^9}, {
   3.688849441816201*^9, 3.6888494611535587`*^9}, {3.688849594927216*^9, 
   3.688849596410507*^9}, {3.688849681250457*^9, 3.688849709096224*^9}, {
   3.688849908573019*^9, 3.688849913617402*^9}, {3.688850045125576*^9, 
   3.688850079957981*^9}, {3.688850130178125*^9, 3.688850265816121*^9}, {
   3.688850408720943*^9, 3.6888504306938667`*^9}, {3.688850827306356*^9, 
   3.688850877569512*^9}, {3.688850931860249*^9, 3.688850950279554*^9}, {
   3.688850983099271*^9, 3.688851002842197*^9}, {3.688851070813199*^9, 
   3.688851206871276*^9}, {3.688851925187498*^9, 3.574106100912369*^9}, {
   3.690551514849716*^9, 3.690551536418435*^9}, {3.690551581799651*^9, 
   3.690551647586063*^9}, {3.6905516799988403`*^9, 3.6905517005535603`*^9}, {
   3.690553286941495*^9, 3.690553287119096*^9}, {3.690557321708667*^9, 
   3.690557324306061*^9}, {3.690557475154779*^9, 3.690557478711026*^9}, {
   3.690557544868463*^9, 3.6711260562035255`*^9}, {3.671126095110278*^9, 
   3.671126154841264*^9}, {3.6711261948112907`*^9, 3.6711263871139956`*^9}, {
   3.671126519002345*^9, 3.6711265194710875`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["third kind integrals", "Subsection",
 CellChangeTimes->{{3.666030629504714*^9, 3.666030632008609*^9}, {
  3.701348302299954*^9, 3.701348318395878*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fa", "=", 
   RowBox[{
    RowBox[{"ParseExpression", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "x"}], "-", "5"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"x", "-", "3"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "x"}], "-", "5"}], ")"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "\[Theta]"}], "]"}], 
    "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fainfo", "=", 
   RowBox[{"FunctionFieldInfo", "[", "fa", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.702238261931512*^9, 3.702238282283166*^9}, {
   3.702240420421974*^9, 3.7022404306217937`*^9}, {3.702507340892165*^9, 
   3.702507354051268*^9}, 3.702514519395844*^9, {3.702519365352867*^9, 
   3.702519387686842*^9}, {3.70252051500111*^9, 3.702520519528345*^9}, 
   3.7025241109031878`*^9, {3.702524179629663*^9, 3.702524190459546*^9}, {
   3.702525712238372*^9, 3.7025257156207952`*^9}, {3.70252598278258*^9, 
   3.7025259879972486`*^9}, {3.7027703932150717`*^9, 3.702770416158217*^9}, {
   3.702770506625235*^9, 3.702770509030436*^9}, {3.702771566278925*^9, 
   3.702771567942491*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlacesOver", "[", 
  RowBox[{"5", ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", "FAOFFP", "\[RightDoubleBracket]"}], 
   ",", 
   RowBox[{
   "fa", "\[LeftDoubleBracket]", "FAOFFVAR", "\[RightDoubleBracket]"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}],
    ",", "\[Phi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.702514450018092*^9, 3.7025144744212437`*^9}, {
  3.702514507955518*^9, 3.702514508794507*^9}, {3.702514552778843*^9, 
  3.7025145537945347`*^9}, {3.702519335127268*^9, 3.702519335198626*^9}, {
  3.702519401831244*^9, 3.7025194213509007`*^9}, {3.702521197448925*^9, 
  3.7025212024247704`*^9}, {3.702523065346312*^9, 3.7025230655623503`*^9}, {
  3.702523939683474*^9, 3.702523940931087*^9}, {3.702525755469486*^9, 
  3.7025257555406303`*^9}, {3.702526006917226*^9, 3.702526007100806*^9}, {
  3.702770074006239*^9, 3.702770074078101*^9}, {3.7027705163029118`*^9, 
  3.702770516534256*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", 
              FractionBox["1", "10"]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"-", "5"}], "+", "x"}]}], "}"}]}], "}"}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "1"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             FractionBox["1", "10"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"-", "5"}], "+", "x"}]}], "}"}]}], "}"}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "1"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"NF", "[", 
    RowBox[{"0", ",", "\[Phi]", ",", "\[Phi]", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}], ",", 
   RowBox[{"NFExt", "[", 
    RowBox[{"\[Theta]", "\[Rule]", "\[Phi]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.702514475108013*^9, {3.702514509499292*^9, 3.702514554405897*^9}, 
   3.702519335882778*^9, {3.702519394132628*^9, 3.7025194219824047`*^9}, 
   3.7025211916518183`*^9, 3.7025230662605047`*^9, 3.70252394139111*^9, 
   3.702524194558741*^9, 3.7025257206850557`*^9, 3.702525756377433*^9, 
   3.702526007516487*^9, 3.70277007484167*^9, 3.7027704231802807`*^9, {
   3.70277051324166*^9, 3.70277051687049*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IdealFactorPoly", "[", 
  RowBox[{
   RowBox[{"x", "-", "5"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", 
    RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", 
    RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.702770103151532*^9, 3.7027701521983957`*^9}, {
  3.702770187902725*^9, 3.702770194862236*^9}, {3.702770246582724*^9, 
  3.702770301350277*^9}, {3.702770347158839*^9, 3.70277034731045*^9}, {
  3.702770426750803*^9, 3.702770427198522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{"-", 
             FractionBox["1", "10"]}]}, {"0", 
           RowBox[{
             RowBox[{"-", "5"}], "+", "x"}]}}, RowSpacings -> 1, 
         ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
         Center], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 
        Rational[-1, 10]}, {0, -5 + $CellContext`x}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702770124452142*^9, 3.7027701527529287`*^9}, 
   3.7027701953481503`*^9, {3.7027702526878242`*^9, 3.702770302004265*^9}, 
   3.702770347659244*^9, 3.702770427738371*^9, 3.702770522726742*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           FractionBox["1", "10"]}, {"0", 
           RowBox[{
             RowBox[{"-", "5"}], "+", "x"}]}}, RowSpacings -> 1, 
         ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
         Center], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 
        Rational[1, 10]}, {0, -5 + $CellContext`x}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702770124452142*^9, 3.7027701527529287`*^9}, 
   3.7027701953481503`*^9, {3.7027702526878242`*^9, 3.702770302004265*^9}, 
   3.702770347659244*^9, 3.702770427738371*^9, 3.70277052277218*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Omega]", "=", 
  RowBox[{"IntegralThirdKind", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", 
            RowBox[{"-", 
             FractionBox["1", "10"]}]},
           {"0", 
            RowBox[{
             RowBox[{"-", "5"}], "+", "x"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"\[Xi]", "0"},
           {"0", "1"}
          }], ")"}], ",", "\[Xi]"}], "}"}]}], "}"}], ",", 
    RowBox[{"fa", "\[LeftDoubleBracket]", "FAOFFT", "\[RightDoubleBracket]"}],
     ",", 
    RowBox[{"fa", "\[LeftDoubleBracket]", "FAOFFP", "\[RightDoubleBracket]"}],
     ",", 
    RowBox[{
    "fa", "\[LeftDoubleBracket]", "FAOFF\[Delta]", "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{"fainfo", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
    ",", 
    RowBox[{
    "fa", "\[LeftDoubleBracket]", "FAOFFVAR", "\[RightDoubleBracket]"}], ",", 
    
    RowBox[{
    "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FuncPrint", "[", 
  RowBox[{"\[Omega]", ",", "fa"}], "]"}]}], "Input",
 CellChangeTimes->{{3.702238368124365*^9, 3.7022384341637087`*^9}, {
   3.7022390586765738`*^9, 3.702239062596447*^9}, {3.702239115620696*^9, 
   3.702239125395883*^9}, {3.702240536070142*^9, 3.702240549581789*^9}, {
   3.702501487174259*^9, 3.702501496108988*^9}, {3.702505821354602*^9, 
   3.702505830393964*^9}, {3.702506330381103*^9, 3.702506342217864*^9}, {
   3.702506443157757*^9, 3.702506459659013*^9}, {3.702506509541506*^9, 
   3.702506521506496*^9}, {3.702506562421997*^9, 3.702506575107006*^9}, {
   3.702506644438628*^9, 3.7025066897626963`*^9}, {3.702507315623304*^9, 
   3.702507328195362*^9}, {3.702507403364923*^9, 3.702507418061447*^9}, {
   3.7025114489232264`*^9, 3.7025114810162067`*^9}, {3.702511511946134*^9, 
   3.70251151436703*^9}, {3.702513563832165*^9, 3.702513587904974*^9}, {
   3.702513819247036*^9, 3.702513835745352*^9}, {3.7025145367947187`*^9, 
   3.702514537618495*^9}, 3.7025192257801533`*^9, {3.7025193110683804`*^9, 
   3.7025193416062717`*^9}, {3.702519415836401*^9, 3.702519416046192*^9}, {
   3.702519660006962*^9, 3.702519690423052*^9}, 3.7025204885892344`*^9, {
   3.702520683781803*^9, 3.702520689728023*^9}, 3.7025212589043503`*^9, {
   3.70252283225917*^9, 3.702522841738563*^9}, {3.7025229017714577`*^9, 
   3.702522911465933*^9}, {3.702523046675963*^9, 3.702523059954391*^9}, {
   3.702523104666809*^9, 3.702523108346353*^9}, {3.702523429534935*^9, 
   3.702523481171115*^9}, {3.702523749238624*^9, 3.7025238631066437`*^9}, {
   3.702523916724416*^9, 3.702523917667655*^9}, {3.702523953939043*^9, 
   3.702523998115982*^9}, {3.702525597854042*^9, 3.702525599861268*^9}, {
   3.70252566592509*^9, 3.702525665988158*^9}, {3.702525727038286*^9, 
   3.702525770156721*^9}, {3.702526041582025*^9, 3.702526056068861*^9}, {
   3.7027700388873243`*^9, 3.702770056510295*^9}, {3.7027701569828377`*^9, 
   3.702770157166091*^9}, {3.7027701983274603`*^9, 3.7027702687341413`*^9}, 
   3.702770437946616*^9, 3.702770530106655*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["25", "4"]}], "+", 
      FractionBox[
       RowBox[{"25", " ", "x"}], "3"], "-", 
      FractionBox[
       RowBox[{"43", " ", 
        SuperscriptBox["x", "2"]}], "12"], "+", 
      FractionBox[
       SuperscriptBox["x", "3"], "2"]}], ",", 
     FractionBox["5", "6"]}], "}"}], ",", 
   RowBox[{
    FractionBox["125", "2"], "-", 
    FractionBox[
     RowBox[{"575", " ", "x"}], "6"], "+", 
    FractionBox[
     RowBox[{"105", " ", 
      SuperscriptBox["x", "2"]}], "2"], "-", 
    FractionBox[
     RowBox[{"73", " ", 
      SuperscriptBox["x", "3"]}], "6"], "+", 
    SuperscriptBox["x", "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7022390513389187`*^9, 3.702239063351255*^9}, {
   3.702239126204586*^9, 3.702239142243813*^9}, {3.702240553051064*^9, 
   3.702240557244815*^9}, 3.7022415932114077`*^9, 3.7022416902293*^9, 
   3.7024998619921827`*^9, 3.7025005111979733`*^9, 3.702500616324769*^9, {
   3.7025006615500793`*^9, 3.702500690041057*^9}, 3.702500749556394*^9, 
   3.702500824173244*^9, 3.702500863738316*^9, 3.702500896543765*^9, 
   3.702500940119089*^9, {3.7025010531310873`*^9, 3.702501095440983*^9}, {
   3.7025011504646482`*^9, 3.7025012183556147`*^9}, 3.702501250453905*^9, 
   3.702501328233366*^9, 3.7025014013223143`*^9, 3.702501496772629*^9, 
   3.7025015589641*^9, {3.702505733479888*^9, 3.702505761901572*^9}, 
   3.702505797822753*^9, 3.70250583115376*^9, 3.702505871178878*^9, 
   3.7025059349940653`*^9, 3.7025061266593027`*^9, 3.702506225961268*^9, 
   3.7025062863526497`*^9, 3.702506342991971*^9, {3.702506444755169*^9, 
   3.702506460592462*^9}, {3.70250651702477*^9, 3.702506522172174*^9}, {
   3.7025065631786127`*^9, 3.702506575804723*^9}, {3.702506649281198*^9, 
   3.702506690442473*^9}, 3.702506922506978*^9, 3.702506967718109*^9, 
   3.702507001445402*^9, 3.702507144728528*^9, 3.7025071936282988`*^9, 
   3.702507238592752*^9, {3.702507294704597*^9, 3.702507328970536*^9}, 
   3.702507360787961*^9, 3.7025074207317*^9, 3.7025080600633497`*^9, 
   3.70250811598177*^9, 3.702508637554556*^9, 3.702510535159833*^9, 
   3.7025105948474617`*^9, 3.702511410924199*^9, {3.7025114544381943`*^9, 
   3.702511482312448*^9}, 3.702511515270604*^9, 3.702511561679076*^9, 
   3.702511663694058*^9, 3.7025117592645617`*^9, 3.702511828875773*^9, 
   3.702511914364779*^9, 3.702511990387899*^9, 3.702512038020465*^9, {
   3.7025120949291353`*^9, 3.702512107833809*^9}, 3.702512300285262*^9, 
   3.70251235134068*^9, 3.7025125360191793`*^9, 3.702512634093305*^9, 
   3.702512777971739*^9, 3.702512816116622*^9, 3.7025128490322027`*^9, 
   3.702512892735774*^9, 3.702512972462036*^9, 3.702513127330577*^9, 
   3.702513173896234*^9, 3.7025133085310507`*^9, 3.702513393150824*^9, 
   3.702513460649523*^9, 3.702513504842449*^9, {3.702513565155303*^9, 
   3.702513588763609*^9}, 3.7025145389422398`*^9, 3.702514726959731*^9, 
   3.702515636852783*^9, 3.702515750995145*^9, 3.7025160201503687`*^9, 
   3.702516179504015*^9, 3.702516212873674*^9, 3.7025165577034903`*^9, 
   3.702516624173888*^9, 3.7025166756301537`*^9, 3.702516726770771*^9, 
   3.702516883699051*^9, 3.702517417504196*^9, 3.702517531265274*^9, 
   3.702517650243704*^9, 3.7025180033457937`*^9, 3.7025180882793083`*^9, 
   3.7025182274341583`*^9, {3.702518493118713*^9, 3.702518510776691*^9}, 
   3.702518691020672*^9, 3.7025190148079643`*^9, 3.70251922737092*^9, {
   3.7025193157864103`*^9, 3.702519345372785*^9}, {3.7025196735160227`*^9, 
   3.7025196916320057`*^9}, {3.702520466680346*^9, 3.702520490265448*^9}, 
   3.702521260066887*^9, 3.702522744982772*^9, 3.702522809124761*^9, 
   3.70252284588192*^9, {3.702522886607777*^9, 3.702522937280855*^9}, 
   3.7025230088561687`*^9, 3.702523047973709*^9, {3.702523112182437*^9, 
   3.702523138096038*^9}, 3.7025233597460003`*^9, {3.702523445984273*^9, 
   3.702523482614327*^9}, 3.702523596232925*^9, {3.702523743398089*^9, 
   3.70252381652912*^9}, {3.7025238501950006`*^9, 3.702523873019414*^9}, {
   3.702523957130939*^9, 3.7025240001025267`*^9}, 3.7025242004624233`*^9, 
   3.702525508113542*^9, 3.7025255560570507`*^9, 3.702525601206724*^9, 
   3.702525667620554*^9, 3.7025257751299458`*^9, 3.702526057471542*^9, {
   3.7027700331412*^9, 3.7027700452932463`*^9}, {3.7027701768911457`*^9, 
   3.7027702696507053`*^9}, 3.702770439864029*^9, 3.7027705316784887`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "75"}], "+", 
   RowBox[{"100", " ", "x"}], "-", 
   RowBox[{"43", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"6", " ", 
    SuperscriptBox["x", "3"]}], "+", 
   RowBox[{"10", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "75"}], "+", 
      RowBox[{"100", " ", "x"}], "-", 
      RowBox[{"43", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["x", "3"]}]}]]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"375", "-", 
     RowBox[{"575", " ", "x"}], "+", 
     RowBox[{"315", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{"73", " ", 
      SuperscriptBox["x", "3"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox["x", "4"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.7022390513389187`*^9, 3.702239063351255*^9}, {
   3.702239126204586*^9, 3.702239142243813*^9}, {3.702240553051064*^9, 
   3.702240557244815*^9}, 3.7022415932114077`*^9, 3.7022416902293*^9, 
   3.7024998619921827`*^9, 3.7025005111979733`*^9, 3.702500616324769*^9, {
   3.7025006615500793`*^9, 3.702500690041057*^9}, 3.702500749556394*^9, 
   3.702500824173244*^9, 3.702500863738316*^9, 3.702500896543765*^9, 
   3.702500940119089*^9, {3.7025010531310873`*^9, 3.702501095440983*^9}, {
   3.7025011504646482`*^9, 3.7025012183556147`*^9}, 3.702501250453905*^9, 
   3.702501328233366*^9, 3.7025014013223143`*^9, 3.702501496772629*^9, 
   3.7025015589641*^9, {3.702505733479888*^9, 3.702505761901572*^9}, 
   3.702505797822753*^9, 3.70250583115376*^9, 3.702505871178878*^9, 
   3.7025059349940653`*^9, 3.7025061266593027`*^9, 3.702506225961268*^9, 
   3.7025062863526497`*^9, 3.702506342991971*^9, {3.702506444755169*^9, 
   3.702506460592462*^9}, {3.70250651702477*^9, 3.702506522172174*^9}, {
   3.7025065631786127`*^9, 3.702506575804723*^9}, {3.702506649281198*^9, 
   3.702506690442473*^9}, 3.702506922506978*^9, 3.702506967718109*^9, 
   3.702507001445402*^9, 3.702507144728528*^9, 3.7025071936282988`*^9, 
   3.702507238592752*^9, {3.702507294704597*^9, 3.702507328970536*^9}, 
   3.702507360787961*^9, 3.7025074207317*^9, 3.7025080600633497`*^9, 
   3.70250811598177*^9, 3.702508637554556*^9, 3.702510535159833*^9, 
   3.7025105948474617`*^9, 3.702511410924199*^9, {3.7025114544381943`*^9, 
   3.702511482312448*^9}, 3.702511515270604*^9, 3.702511561679076*^9, 
   3.702511663694058*^9, 3.7025117592645617`*^9, 3.702511828875773*^9, 
   3.702511914364779*^9, 3.702511990387899*^9, 3.702512038020465*^9, {
   3.7025120949291353`*^9, 3.702512107833809*^9}, 3.702512300285262*^9, 
   3.70251235134068*^9, 3.7025125360191793`*^9, 3.702512634093305*^9, 
   3.702512777971739*^9, 3.702512816116622*^9, 3.7025128490322027`*^9, 
   3.702512892735774*^9, 3.702512972462036*^9, 3.702513127330577*^9, 
   3.702513173896234*^9, 3.7025133085310507`*^9, 3.702513393150824*^9, 
   3.702513460649523*^9, 3.702513504842449*^9, {3.702513565155303*^9, 
   3.702513588763609*^9}, 3.7025145389422398`*^9, 3.702514726959731*^9, 
   3.702515636852783*^9, 3.702515750995145*^9, 3.7025160201503687`*^9, 
   3.702516179504015*^9, 3.702516212873674*^9, 3.7025165577034903`*^9, 
   3.702516624173888*^9, 3.7025166756301537`*^9, 3.702516726770771*^9, 
   3.702516883699051*^9, 3.702517417504196*^9, 3.702517531265274*^9, 
   3.702517650243704*^9, 3.7025180033457937`*^9, 3.7025180882793083`*^9, 
   3.7025182274341583`*^9, {3.702518493118713*^9, 3.702518510776691*^9}, 
   3.702518691020672*^9, 3.7025190148079643`*^9, 3.70251922737092*^9, {
   3.7025193157864103`*^9, 3.702519345372785*^9}, {3.7025196735160227`*^9, 
   3.7025196916320057`*^9}, {3.702520466680346*^9, 3.702520490265448*^9}, 
   3.702521260066887*^9, 3.702522744982772*^9, 3.702522809124761*^9, 
   3.70252284588192*^9, {3.702522886607777*^9, 3.702522937280855*^9}, 
   3.7025230088561687`*^9, 3.702523047973709*^9, {3.702523112182437*^9, 
   3.702523138096038*^9}, 3.7025233597460003`*^9, {3.702523445984273*^9, 
   3.702523482614327*^9}, 3.702523596232925*^9, {3.702523743398089*^9, 
   3.70252381652912*^9}, {3.7025238501950006`*^9, 3.702523873019414*^9}, {
   3.702523957130939*^9, 3.7025240001025267`*^9}, 3.7025242004624233`*^9, 
   3.702525508113542*^9, 3.7025255560570507`*^9, 3.702525601206724*^9, 
   3.702525667620554*^9, 3.7025257751299458`*^9, 3.702526057471542*^9, {
   3.7027700331412*^9, 3.7027700452932463`*^9}, {3.7027701768911457`*^9, 
   3.7027702696507053`*^9}, 3.702770439864029*^9, 3.702770531722364*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntegralThirdKind", "[", 
   RowBox[{
   "div_", ",", "T_", ",", "P_", ",", "ord_", ",", "sqf_", ",", "var_", ",", 
    "nf_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"num", ",", "den", ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"div", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
      "\n", "a", ",", "basis", ",", "bx", ",", "exp", ",", "fx", ",", "l", 
      ",", 
      RowBox[{"x", "=", 
       RowBox[{
       "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"\[Xi]", "=", 
       RowBox[{
       "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
      "ar", ",", "de", ",", "b", ",", "degb", ",", "id", ",", "f", ",", "bp", 
      ",", "b\[Infinity]", ",", "ford", ",", "fun", ",", "fund", ",", "h", 
      ",", "funi", ",", "kk", ",", "quo", ",", "rem", ",", "F", ",", "a0", 
      ",", "one"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"id", "=", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<DivisorDegree: \>\"", ",", 
         RowBox[{"DivisorDegree", "[", 
          RowBox[{"div", ",", "var", ",", "nf"}], "]"}]}], "]"}], ";"}], 
      "*)"}], "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DivisorDegree", "[", 
         RowBox[{"div", ",", "var", ",", "nf"}], "]"}], "===", "0"}], ",", 
       "\"\<divisor degree in IntegralThirdKind\>\""}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"a", "=", 
      RowBox[{"DivisorFactorSquareFree", "[", 
       RowBox[{"div", ",", "T", ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
     ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<a: \>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DivisorPrint", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", "a"}], 
          "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t", 
     RowBox[{"a0", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"id", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"id", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"a0", "=", 
        RowBox[{"DivisorTimes", "[", 
         RowBox[{"a0", ",", 
          RowBox[{
          "sqf", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
          "P", ",", "var", ",", "nf"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"b", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ")"}], "&"}],
        "[", 
       RowBox[{"DivisorNorm", "[", 
        RowBox[{"div", ",", "var", ",", "nf"}], "]"}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"b", "=", 
      RowBox[{"PolyMakeSquareFree", "[", 
       RowBox[{
        RowBox[{"b", "*", 
         RowBox[{
          RowBox[{"DivisorNorm", "[", 
           RowBox[{"a0", ",", "var", ",", "nf"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", "x", ",",
         "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"a0", "=", 
        RowBox[{"DivisorDivide", "[", 
         RowBox[{"a0", ",", 
          RowBox[{"DivisorPlus", "[", 
           RowBox[{"a0", ",", 
            RowBox[{"a", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", "var", 
            ",", "nf"}], "]"}], ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"a0", ",", "0"}], "}"}]}], "]"}], ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<b: \>\"", ",", "b"}], "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<a: \>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DivisorPrint", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", "a"}], 
          "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t", 
     RowBox[{"f", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "*", 
             RowBox[{
             "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "*", 
             RowBox[{
             "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"id", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"id", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], ";", "\n", 
     "\t", 
     RowBox[{"one", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"x", ",", 
          RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", "1", ",", "nf"}], "]"}], ",", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"\[Xi]", ",", 
          RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ",", "1", ",", "nf"}], "]"}]}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"de", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"Null", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"de", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "=", 
         RowBox[{"a", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "de", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "=", 
            RowBox[{"DivisorPlus", "[", 
             RowBox[{
              RowBox[{"a", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "sqf", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
              ",", "var", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "de", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
            RowBox[{"DivisorDivide", "[", 
             RowBox[{
              RowBox[{
              "de", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "de", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
              ",", "P", ",", "var", ",", "nf"}], "]"}]}], ";"}], "\n", "\t\t",
           ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
        "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "=", 
            RowBox[{"AffineIntersect", "[", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    RowBox[{"PolyD", "[", 
                    RowBox[{"b", ",", "x", ",", "nf"}], "]"}], "/", "r"}]}], 
                    ",", "x", ",", "nf"}], "]"}], "*", 
                    RowBox[{"one", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"one", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                   "}"}], ",", "\n", "\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"a", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "*", 
                    RowBox[{
                    RowBox[{"b", "/", 
                    RowBox[{"x", "^", 
                    RowBox[{"Exponent", "[", 
                    RowBox[{"b", ",", "x"}], "]"}]}]}], "/", "r"}]}], ")"}], "/.", 
                    RowBox[{"x", "\[Rule]", 
                    RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", 
                    "nf"}], "]"}], "*", 
                    RowBox[{"one", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"one", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                   "}"}]}], "}"}], "\n", "\t\t\t", ",", 
                RowBox[{
                "de", "\[LeftDoubleBracket]", "r", 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", "f", ",", "P", ",", 
              "var", ",", "nf"}], "]"}]}], ";"}], "\n", 
          RowBox[{"(*", "\t\t\t", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<f: \>\"", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "f", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"DivisorPrint", "[", 
                 RowBox[{
                 "f", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "]"}]}], "}"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}], "\n", 
       "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "a", "]"}]}], "}"}]}], "]"}], ";", "\n", "\n",
      "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ford", ",", 
        RowBox[{"{", 
         RowBox[{"fun", ",", "fund"}], "}"}]}], "}"}], "=", 
      RowBox[{"DivisorRRSpace", "[", 
       RowBox[{
        RowBox[{"f", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "P", ",", "ord", ",", "var", ",", "nf"}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"fund", "===", "1"}], ",", 
       "\"\<fund in IntegralThirdKind\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"ford", "=", 
      RowBox[{"ford", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"b", ",", "x"}], "]"}], "-", "1"}], ")"}]}]}], ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ford: \>\"", ",", "ford"}], "]"}], ";"}], "*)"}], "\n", 
     "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "ord", "]"}], "-", "n", "+", "1"}], "===", 
        RowBox[{"Total", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"0", ",", 
              RowBox[{"1", "-", "#"}]}], "]"}], "&"}], ",", "ford"}], "]"}], 
         "]"}]}], ",", "\"\<genus in IntegralThirdKind\>\""}], "]"}], ";", 
     "\n", "\t", "\n", "\t", 
     RowBox[{"h", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Xi]", "^", "ord"}], "*", 
              RowBox[{"f", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}],
              ",", 
             RowBox[{"f", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
            "}"}], "/.", 
           RowBox[{"\[Xi]", "\[Rule]", 
            RowBox[{"1", "/", "x"}]}]}], ")"}], "*", 
         RowBox[{"x", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "ord", "]"}], "+", 
            RowBox[{"Max", "[", 
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"f", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], 
               ",", "\[Xi]"}], "]"}], "]"}]}], ")"}]}]}], ",", "x", ",", 
        "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"h", "=", 
      RowBox[{"PieceMulAdd", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "h", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "*", 
           RowBox[{"x", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"b", ",", "x"}], "]"}], "-", "1"}], ")"}]}]}], ",", 
          RowBox[{
          "h", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], ",", 
        RowBox[{"f", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", "1"}], ",", "nf"}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"funi", "=", 
      RowBox[{"PolyMatrixInverse", "[", 
       RowBox[{"fun", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"h", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "h", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
            
            RowBox[{
            "funi", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "*", "fund"}], ",", 
          RowBox[{
           RowBox[{
           "h", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*", 
           RowBox[{
           "funi", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
          "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
     RowBox[{"kk", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"Null", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"quo", ",", "rem"}], "}"}], "=", 
         RowBox[{"PolyQuotientRemainder", "[", 
          RowBox[{
           RowBox[{"h", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "h", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"kk", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
          "=", "quo"}], ";", "\n", "\t\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{"Or", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "ford", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[LessEqual]", "0"}], ",", 
            RowBox[{"rem", "===", "0"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "ford", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{"Exponent", "[", 
               RowBox[{"rem", ",", "x"}], "]"}]}], "\[LessEqual]", 
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{
               "h", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", "x"}], "]"}]}]}], "]"}], ",", 
          "\"\<intersection empty\>\""}], "]"}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"F", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"f", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          
          RowBox[{"f", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
         "}"}], ",", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"kk", ".", "fun"}], ",", "fund"}], "}"}], ",", "x", ",", 
          "nf", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], ",", "nf"}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"F", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"F", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
           RowBox[{
           "F", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*", 
           "b"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", "F"}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.701348319743252*^9, 3.7013483212041273`*^9}, {
   3.701348356124506*^9, 3.7013483610138693`*^9}, {3.7013484778925533`*^9, 
   3.701348578532542*^9}, {3.7013486189490957`*^9, 3.7013486781889553`*^9}, {
   3.7013487130130444`*^9, 3.701348714229027*^9}, {3.701348797341099*^9, 
   3.701348881789495*^9}, {3.701349572434495*^9, 3.701349596418277*^9}, {
   3.701349747542473*^9, 3.701349812190651*^9}, {3.7013498490054903`*^9, 
   3.701349869253687*^9}, {3.7013500700657597`*^9, 3.6764116005457916`*^9}, {
   3.676411652439481*^9, 3.6764116560958357`*^9}, 3.702238183580306*^9, {
   3.702238339044271*^9, 3.702238348181108*^9}, {3.702238466332695*^9, 
   3.702238531756777*^9}, {3.7022386869005823`*^9, 3.702238735717331*^9}, {
   3.702238770317657*^9, 3.7022388036938972`*^9}, {3.702238841429215*^9, 
   3.7022390481257544`*^9}, {3.702239137222024*^9, 3.702239140060527*^9}, {
   3.702239176430003*^9, 3.702239177118042*^9}, {3.702240181278934*^9, 
   3.7022401827187443`*^9}, {3.702240227287078*^9, 3.7022402601190567`*^9}, {
   3.7022403009192953`*^9, 3.702240306535076*^9}, {3.702240384103304*^9, 
   3.702240385487221*^9}, {3.702240580735304*^9, 3.70224060993464*^9}, {
   3.702240640407646*^9, 3.70224064538266*^9}, {3.702240819319538*^9, 
   3.702240914679764*^9}, {3.702240954871937*^9, 3.7022409554557734`*^9}, {
   3.702241321088333*^9, 3.702241374208749*^9}, {3.702241423480743*^9, 
   3.7022414272637863`*^9}, {3.702241475320582*^9, 3.702241579008955*^9}, {
   3.702241637824758*^9, 3.7022416442983932`*^9}, {3.702241720424776*^9, 
   3.702241753585153*^9}, {3.7023038342835627`*^9, 3.70230386136421*^9}, {
   3.7024875154621143`*^9, 3.702487587694475*^9}, {3.702487618526153*^9, 
   3.702487619101923*^9}, {3.7024876697106953`*^9, 3.702487687782055*^9}, {
   3.702487743574738*^9, 3.702487763020241*^9}, {3.7024878602446527`*^9, 
   3.7024878891268682`*^9}, {3.702487923278541*^9, 3.70248797105468*^9}, {
   3.702488327223187*^9, 3.7024883369895678`*^9}, {3.702488384407295*^9, 
   3.702488487511217*^9}, {3.7024886503117123`*^9, 3.70248868174148*^9}, {
   3.702488757519895*^9, 3.702488803999978*^9}, {3.702488838712235*^9, 
   3.7024888576957493`*^9}, {3.702488906640706*^9, 3.70248903027239*^9}, {
   3.70248907819263*^9, 3.702489124072836*^9}, {3.7024892448409033`*^9, 
   3.7024893391457987`*^9}, {3.702489783280912*^9, 3.702489814383786*^9}, {
   3.7024899766803093`*^9, 3.702489977039817*^9}, {3.702490046264411*^9, 
   3.702490052143878*^9}, {3.702490117576233*^9, 3.70249013641868*^9}, {
   3.702490166895989*^9, 3.702490252777863*^9}, {3.70249036216055*^9, 
   3.702490363336535*^9}, {3.702490398360271*^9, 3.702490417491358*^9}, {
   3.702490448296319*^9, 3.702490467392487*^9}, {3.7024905133528214`*^9, 
   3.702490562787506*^9}, {3.702490838529285*^9, 3.7024911050822277`*^9}, 
   3.7024913548905277`*^9, {3.7024913899225607`*^9, 3.702491392320725*^9}, {
   3.702491538594685*^9, 3.702491619556888*^9}, {3.7024926489108562`*^9, 
   3.702492658279311*^9}, {3.702496630682027*^9, 3.7024966787462893`*^9}, {
   3.702496711201549*^9, 3.702496779442922*^9}, {3.7024968254586687`*^9, 
   3.7024969559868193`*^9}, {3.702496989138888*^9, 3.702496990980247*^9}, {
   3.702497422643087*^9, 3.70249742307542*^9}, {3.702498747619705*^9, 
   3.702498747966256*^9}, 3.7024998353176126`*^9, {3.702501386847391*^9, 
   3.702501395846882*^9}, {3.702501758983626*^9, 3.702501783287981*^9}, {
   3.702501922904023*^9, 3.702501923168187*^9}, {3.702503127465416*^9, 
   3.7025031790493*^9}, {3.702503220249854*^9, 3.702503240838881*^9}, {
   3.702503503586583*^9, 3.702503540257948*^9}, 3.702503628594017*^9, {
   3.702503689778483*^9, 3.702503776250556*^9}, {3.702503813051051*^9, 
   3.702503829922682*^9}, {3.702503868883053*^9, 3.702503928434881*^9}, {
   3.702503971853161*^9, 3.702504024619141*^9}, {3.7025040581950617`*^9, 
   3.702504058539184*^9}, {3.702504182171506*^9, 3.702504193770863*^9}, {
   3.702504383604007*^9, 3.702504390996334*^9}, {3.702504442003619*^9, 
   3.7025044893994513`*^9}, {3.702504670220056*^9, 3.702504816300201*^9}, {
   3.7025048593406754`*^9, 3.7025049111326027`*^9}, {3.702505125037525*^9, 
   3.702505171488205*^9}, {3.702505261444908*^9, 3.702505381296088*^9}, {
   3.702505430597184*^9, 3.70250552217315*^9}, {3.70250566797371*^9, 
   3.702505703813773*^9}, {3.7025057454780188`*^9, 3.702505760003212*^9}, {
   3.7025058021399612`*^9, 3.702505812622505*^9}, {3.702505847798009*^9, 
   3.702505927999865*^9}, {3.7025059597827*^9, 3.702505969374729*^9}, {
   3.702506072478757*^9, 3.7025060825878057`*^9}, {3.702506164078618*^9, 
   3.702506302342787*^9}, {3.702506416669499*^9, 3.7025064170071487`*^9}, {
   3.7025068774719467`*^9, 3.702506916155663*^9}, {3.702506951720039*^9, 
   3.702506965056028*^9}, {3.702506996984338*^9, 3.702506997264292*^9}, {
   3.7025077750651913`*^9, 3.7025078130012608`*^9}, {3.702507868777658*^9, 
   3.7025078804513283`*^9}, {3.702507937328744*^9, 3.7025079753197603`*^9}, {
   3.702508026793241*^9, 3.702508048825288*^9}, {3.702508106809168*^9, 
   3.702508110706031*^9}, {3.702508613202711*^9, 3.7025086329227047`*^9}, {
   3.70250943495548*^9, 3.702509460019828*^9}, {3.702509559803494*^9, 
   3.7025095618836718`*^9}, {3.7025096017672*^9, 3.702509612626021*^9}, {
   3.70250964507489*^9, 3.702509672924014*^9}, {3.7025099393553457`*^9, 
   3.702509946897017*^9}, {3.702509987467423*^9, 3.702510020908338*^9}, {
   3.702510053692101*^9, 3.7025100813391027`*^9}, {3.702510487844778*^9, 
   3.7025105248933363`*^9}, {3.702510589702602*^9, 3.702510589924267*^9}, {
   3.702511407373769*^9, 3.702511407612529*^9}, {3.702511551813281*^9, 
   3.702511660813034*^9}, {3.702511866541245*^9, 3.702511910400279*^9}, {
   3.702511942333611*^9, 3.702511985975275*^9}, {3.702512090271411*^9, 
   3.702512103846092*^9}, {3.702512295109993*^9, 3.702512348150762*^9}, {
   3.7025125298871813`*^9, 3.702512533705875*^9}, {3.7025126095268583`*^9, 
   3.702512631263863*^9}, {3.702512769904413*^9, 3.7025127732320213`*^9}, {
   3.702512876911545*^9, 3.7025128822938747`*^9}, {3.702512951352668*^9, 
   3.702512965971106*^9}, {3.702513432534709*^9, 3.702513453048815*^9}, {
   3.702514712513482*^9, 3.70251471872816*^9}, {3.702515689098044*^9, 
   3.70251573784986*^9}, {3.702515971729487*^9, 3.70251601358569*^9}, {
   3.702516126458054*^9, 3.702516126805462*^9}, {3.7025161621547728`*^9, 
   3.70251616568889*^9}, {3.702516204258049*^9, 3.7025162047306137`*^9}, {
   3.702516503618218*^9, 3.702516549746558*^9}, {3.702516606906708*^9, 
   3.702516607202551*^9}, {3.702516656906844*^9, 3.702516666296626*^9}, {
   3.7025167026834593`*^9, 3.702516719002864*^9}, {3.702516781371545*^9, 
   3.702516791865333*^9}, {3.702516868148244*^9, 3.702516877114359*^9}, {
   3.7025176349800587`*^9, 3.702517635162693*^9}, {3.702517993675514*^9, 
   3.702517994028544*^9}, {3.7025186587953157`*^9, 3.702518683709607*^9}, {
   3.702518757444951*^9, 3.702518772116912*^9}, {3.7025188207310743`*^9, 
   3.7025188461133966`*^9}, {3.702518893869063*^9, 3.702519004857018*^9}, {
   3.702520280245982*^9, 3.7025203699663277`*^9}, {3.702520444198537*^9, 
   3.7025204577534847`*^9}, {3.7025213995388317`*^9, 
   3.7025214363976707`*^9}, {3.7025214787756863`*^9, 3.702521479502472*^9}, {
   3.702521631340447*^9, 3.702521636182056*^9}, {3.702521745173564*^9, 
   3.702521801173855*^9}, {3.702522706502447*^9, 3.7025227390553627`*^9}, {
   3.7025228640547047`*^9, 3.7025228792709017`*^9}, {3.702522946751128*^9, 
   3.702523002608037*^9}, {3.70252313190362*^9, 3.702523132858933*^9}, {
   3.702523568640532*^9, 3.702523589606551*^9}, {3.7025237194540167`*^9, 
   3.702523737353249*^9}, {3.702523971929119*^9, 3.702523983309925*^9}, {
   3.70252545966679*^9, 3.7025254999391317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AffineIntersect", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]X_", ",", "\[Phi]Xd_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Infinity]X_", ",", "\[Infinity]Xd_"}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]AA_", ",", "\[Phi]AAd_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Infinity]AA_", ",", "\[Infinity]AAd_"}], "}"}]}], "}"}]}],
      "}"}], ",", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]Y_", ",", "\[Phi]Yd_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Infinity]Y_", ",", "\[Infinity]Yd_"}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]BB_", ",", "\[Phi]BBd_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Infinity]BB_", ",", "\[Infinity]BBd_"}], "}"}]}], "}"}]}],
      "}"}], ",", "P_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", "\n", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "\[Phi]AA", "]"}]}], ",", "UV", ",", "w", ",", 
      "\[Phi]Z", ",", "\[Infinity]Z", ",", "CC", ",", "CCi", ",", "q", ",", 
      "\[Phi]CC", ",", "\[Phi]CCd", ",", "\[Infinity]CC", ",", 
      "\[Infinity]CCd"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Phi]Xd", "===", "1"}], ",", 
       "\"\<\[Phi]Xd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Phi]Yd", "===", "1"}], ",", 
       "\"\<\[Phi]Yd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Phi]AAd", "===", "1"}], ",", 
       "\"\<\[Phi]AAd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Phi]BBd", "===", "1"}], ",", 
       "\"\<\[Phi]BBd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Infinity]Xd", "===", "1"}], ",", 
       "\"\<\[Infinity]Xd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Infinity]Yd", "===", "1"}], ",", 
       "\"\<\[Infinity]Yd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Infinity]AAd", "===", "1"}], ",", 
       "\"\<\[Infinity]AAd in AffineIntersect\>\""}], "]"}], ";", "\n", "\t", 
     
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"\[Infinity]BBd", "===", "1"}], ",", 
       "\"\<\[Infinity]BBd in AffineIntersect\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"UV", ",", "CC"}], "}"}], "=", 
      RowBox[{"PolyHermitianReduceWithBasis", "[", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "\[Phi]AA", "}"}], ",", 
           RowBox[{"{", "\[Phi]BB", "}"}]}], "}"}], "]"}], ",", "x", ",", 
        "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"CCi", "=", 
      RowBox[{"PolyMatrixInverse", "[", 
       RowBox[{
        RowBox[{"CC", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], ",", "x", ",", 
        "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"w", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{"#", ",", 
           RowBox[{
           "CCi", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
            "x", ",", "nf"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Phi]Y", "-", "\[Phi]X"}], ")"}], ".", 
         RowBox[{
         "CCi", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Phi]Z", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Phi]X", "+", 
         RowBox[{"w", ".", 
          RowBox[{"UV", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", "n"}], ",", 
            RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}], ".", 
          "\[Phi]AA"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\[Phi]Z: \>\"", ",", "\[Phi]Z", ",", "\"\<  check: \>\"", ",", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"\[Phi]Y", "-", 
            RowBox[{"w", ".", 
             RowBox[{"UV", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"1", ";;", "n"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}], ";;", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "n"}], ")"}]}]}], 
              "\[RightDoubleBracket]"}], ".", "\[Phi]BB"}]}], ",", "x", ",", 
           "nf"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"UV", ",", "CC"}], "}"}], "=", 
      RowBox[{"PolyHermitianReduceWithBasis", "[", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "\[Infinity]AA", "}"}], ",", 
           RowBox[{"{", "\[Infinity]BB", "}"}]}], "}"}], "]"}], ",", "\[Xi]", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"CCi", "=", 
      RowBox[{"PolyMatrixInverse", "[", 
       RowBox[{
        RowBox[{"CC", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}], ",", "\[Xi]", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"w", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{"#", ",", 
           RowBox[{
           "CCi", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
            "\[Xi]", ",", "nf"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Infinity]Y", "-", "\[Infinity]X"}], ")"}], ".", 
         RowBox[{
         "CCi", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Infinity]Z", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Infinity]X", "+", 
         RowBox[{"w", ".", 
          RowBox[{"UV", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"1", ";;", "n"}], ",", 
            RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}], ".", 
          "\[Infinity]AA"}]}], ",", "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", 
     
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<\[Infinity]Z: \>\"", ",", "\[Infinity]Z", ",", 
         "\"\<  check: \>\"", ",", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"\[Infinity]Y", "-", 
            RowBox[{"w", ".", 
             RowBox[{"UV", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"1", ";;", "n"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}], ";;", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "n"}], ")"}]}]}], 
              "\[RightDoubleBracket]"}], ".", "\[Infinity]BB"}]}], ",", 
           "\[Xi]", ",", "nf"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t", 
     "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]CC", ",", "\[Phi]CCd"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Infinity]CC", ",", "\[Infinity]CCd"}], "}"}]}], "}"}], 
      "=", 
      RowBox[{"DivisorIntersect", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Phi]AA", ",", "\[Phi]AAd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Infinity]AA", ",", "\[Infinity]AAd"}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Phi]BB", ",", "\[Phi]BBd"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Infinity]BB", ",", "\[Infinity]BBd"}], "}"}]}], "}"}], 
        ",", "P", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "=", 
         RowBox[{"PolyQuotient", "[", 
          RowBox[{
           RowBox[{
           "\[Phi]Z", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{"\[Phi]CC", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"\[Phi]Z", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"\[Phi]Z", "-", 
            RowBox[{"q", "*", 
             RowBox[{
             "\[Phi]CC", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"q", "=", 
         RowBox[{"PolyQuotient", "[", 
          RowBox[{
           RowBox[{
           "\[Infinity]Z", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"\[Infinity]CC", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", "\[Xi]", 
           ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"\[Infinity]Z", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"\[Infinity]Z", "-", 
            RowBox[{"q", "*", 
             RowBox[{
             "\[Infinity]CC", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
          "]"}]}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<final Z: \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Phi]Z", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Infinity]Z", ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ";"}], "*)"}], "\n", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]Z", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Infinity]Z", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Phi]CC", ",", "\[Phi]CCd"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Infinity]CC", ",", "\[Infinity]CCd"}], "}"}]}], "}"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJwdxU9IU3EAB/CnTV3bCxP/zUOkg4bVQRIldXnwlJpuNSYqDVGbZpgMU1Ta
mmKiM2rqQMHNWEkwch20YLUnZQVRmIhoihtBCm7WtKU9mzV1+b6/w4dPSrVG
URNOUdRZDlY1bbVtD27kDY32afHE3LMO/HwgrAeLqi5N4yPyuhk8Xpn78zd3
cvAxudfvYfFaizWS5c4vOSbEinABjY2+rhhsmbYkYncO1YjFGlMrLkrVarHe
adDh+rCle9jAvOnHmwHWjGsnDsj+q0kreN/DeHFdxCJvh3u5yBGFBfZTNB55
eZ3MnLsQjx/a3Sm4v6O2Evsj75DT08rV+Pb5GnLEC1kz7nptfIA3XbEm/DR+
6RF2yJU23Jqsd+AtGRvAs87oIO7kSYR/uItj5yU4P3v2DJ65aM7EVOl6Dq6w
C6SY9zHLjEdunLZgkXj9G35vu+bFl/vu+rA648sGTmyf+oXFN/1k/ZhiB8+Z
0/5h4+4r/h73/x6WfFxXFocVOmcCZkzKdPzdQ2fgltHCYUwfVZHtbWsM/iv0
TuL7gwtvcejJ1Dus3nN9xgZp4zyWaGg37h4PfMUJoYYfOHjF5sNKq/zTAbfs
hHoBN0kLXLh6cXUVi3qbT4a4q/T8VBxXxs/Gt7J0ZKbQWo4/bK+o8CEnhJgU

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "m", " ", "upper", " ", "triangluar", " ", "by", " ", 
    "invertible", " ", "row", " ", "operations", " ", "in", " ", 
    RowBox[{"k", "[", "x", "]"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"PolyHermitianReduceWithBasis", "[", 
     RowBox[{
      RowBox[{"m_", "?", "ArrayQ"}], ",", "x_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", "=", "m"}], ",", "ncols", ",", "nrows", ",", "min", ",", 
        "pv", ",", "new", ",", "q", ",", "B"}], "}"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nrows", ",", "ncols"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "M", "]"}]}], ";", "\n", "\t", 
       RowBox[{"B", "=", 
        RowBox[{"IdentityMatrix", "[", "nrows", "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"new", "=", 
              RowBox[{"Abs", "[", 
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{"M", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                 "x"}], "]"}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"i", "===", "j"}], "||", 
                RowBox[{"new", "<", "min"}]}], ",", 
               RowBox[{
                RowBox[{"pv", "=", "i"}], ";", 
                RowBox[{"min", "=", "new"}]}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j", ",", "nrows"}], "}"}]}], "]"}], ";", "\n",
           "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"min", "===", "\[Infinity]"}], ",", 
            RowBox[{
             RowBox[{
             "Print", "[", "\"\<HermitianReduce: matrix bad\>\"", "]"}], ";", 
             
             RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"pv", "=!=", "0"}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "=!=", "pv"}], ",", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "B", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "B", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "B", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "B", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], ";", "\n", 
                "\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}]}], "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "pv", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}]}], "\n", "\t\t\t", 
              "]"}], ";", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{
              "B", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "B", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                 "*", 
                 RowBox[{"PolyRecpLC", "[", 
                  RowBox[{
                   RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   "x", ",", "nf"}], "]"}]}], ",", "x", ",", "nf"}], "]"}]}], 
             ";", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{
              "M", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
              "=", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "M", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
                 "*", 
                 RowBox[{"PolyRecpLC", "[", 
                  RowBox[{
                   RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   "x", ",", "nf"}], "]"}]}], ",", "x", ",", "nf"}], "]"}]}], 
             ";", "\n", "\t\t\t", 
             RowBox[{"pv", "=", "0"}], ";", 
             RowBox[{"min", "=", "\[Infinity]"}], ";", "\n", "\t\t\t", 
             RowBox[{"Do", "[", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"q", "=", 
                 RowBox[{"PolyQuotient", "[", 
                  RowBox[{
                   RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"q", "=!=", "0"}], ",", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "B", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "B", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "B", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                    "nf"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"PolyCollect", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                    "nf"}], "]"}]}]}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", 
                "\t\t\t\t", 
                RowBox[{"new", "=", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"Exponent", "[", 
                   RowBox[{
                    RowBox[{"M", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "x"}], "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"new", "<", "min"}], ",", 
                  RowBox[{
                   RowBox[{"pv", "=", "i"}], ";", 
                   RowBox[{"min", "=", "new"}]}]}], "]"}], ";"}], "\n", 
               "\t\t\t", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"j", "+", "1"}], ",", "nrows"}], "}"}]}], "]"}], 
             ";"}]}], "\n", "\t\t", "]"}], ";", "\n", "\t\t", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "=", 
              RowBox[{"PolyQuotient", "[", 
               RowBox[{
                RowBox[{"M", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"M", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", "x",
                 ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"q", "=!=", "0"}], ",", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "B", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "B", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                   "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "M", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                   "nf"}], "]"}]}]}]}], "\n", "\t\t\t", "]"}], ";"}], "\n", 
            "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<M: \>\"", ",", 
             RowBox[{"MatrixForm", "[", "M", "]"}]}], "]"}], ";", 
           RowBox[{"Pause", "[", "0.5", "]"}], ";"}], "*)"}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "ncols"}], "}"}]}], "]"}], ";", "\n", 
       "\t", 
       RowBox[{"{", 
        RowBox[{"B", ",", "M"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Code",
 CellChangeTimes->{{3.702499961500304*^9, 3.702500000141129*^9}, {
   3.702500187012792*^9, 3.702500323556321*^9}, 3.702500446112694*^9, {
   3.702500588214435*^9, 3.702500593599369*^9}, {3.70250064157416*^9, 
   3.70250068426259*^9}, {3.702500737543023*^9, 3.702500737967175*^9}, {
   3.7025007776786137`*^9, 3.702500817167272*^9}, {3.70250085129492*^9, 
   3.7025008745506153`*^9}, 3.7025009304311523`*^9, {3.7025010274239683`*^9, 
   3.702501089134973*^9}, {3.7025012613196373`*^9, 3.70250126398278*^9}, {
   3.7025013637190332`*^9, 3.702501377303261*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["algebraic functions", "Section",
 CellChangeTimes->{{3.579383051611622*^9, 3.5793830562760305`*^9}, {
  3.665155942543213*^9, 3.6651559448379602`*^9}, {3.665156211455415*^9, 
  3.665156217150247*^9}, {3.666041434368834*^9, 3.666041434744851*^9}}],

Cell[CellGroupData[{

Cell["print parse", "Subsection",
 CellChangeTimes->{{3.701608981124119*^9, 3.701608992897254*^9}}],

Cell[BoxData[
 RowBox[{"ParseExpression", "[", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SqrtBox["x"], 
     RowBox[{"(", 
      RowBox[{
       SqrtBox["x"], "+", 
       SqrtBox[
        RowBox[{"x", "+", "1"}]]}], ")"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "\[Theta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7017014657531643`*^9, 3.701701480881218*^9}, {
  3.701701632961503*^9, 3.70170163408949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParseExpression", "[", 
   RowBox[{"exp_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "\[Phi]_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "help", ",", "const", ",", "fxn", ",", "fa", ",", "nf", ",", "\[Theta]", 
      ",", "flist", ",", "klist", ",", "stop", ",", "res", ",", "p", ",", "q",
       ",", "t", ",", "s"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"fa", "=", 
      RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
        RowBox[{"NF", "[", 
         RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"stop", "=", "False"}], ";", "\n", 
     RowBox[{
      RowBox[{"help", "[", "e_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "stop", "]"}], ",", 
        RowBox[{"Which", "[", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"e", "===", "x"}], "||", 
           RowBox[{
            RowBox[{"Head", "[", "e", "]"}], "===", "Integer"}], "||", 
           RowBox[{
            RowBox[{"Head", "[", "e", "]"}], "===", "Rational"}]}], ",", "\n",
           "\t\t", 
          RowBox[{"MakeBaseElement", "[", 
           RowBox[{"x", ",", 
            RowBox[{"fa", "\[LeftDoubleBracket]", 
             RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            "e", ",", 
            RowBox[{
            "fa", "\[LeftDoubleBracket]", "FAOFFNF", 
             "\[RightDoubleBracket]"}]}], "]"}], ",", "\n", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "e", "]"}], "===", "Plus"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "e", "]"}], ">", "1"}]}], ",", "\n", 
          "\t\t", 
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"help", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "e"}], ")"}]}]}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "[", "stop", "]"}], ",", "\n", "\t\t\t", 
             RowBox[{"Fold", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"FuncPlus", "[", 
                 RowBox[{"#1", ",", "#2", ",", "fa"}], "]"}], "&"}], ",", 
               RowBox[{"First", "[", "t", "]"}], ",", 
               RowBox[{"Rest", "[", "t", "]"}]}], "]"}]}], "\n", "\t\t", 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "e", "]"}], "===", "Times"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "e", "]"}], ">", "1"}]}], ",", "\n", 
          "\t\t", 
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"help", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "e"}], ")"}]}]}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "[", "stop", "]"}], ",", "\n", "\t\t\t", 
             RowBox[{"Fold", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"FuncTimes", "[", 
                 RowBox[{"#1", ",", "#2", ",", "fa"}], "]"}], "&"}], ",", 
               RowBox[{"First", "[", "t", "]"}], ",", 
               RowBox[{"Rest", "[", "t", "]"}]}], "]"}]}], "\n", "\t\t", 
            "]"}]}], ",", "\n", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "e", "]"}], "===", "Power"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "e", "]"}], "===", "2"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], "===", "Integer"}]}], ",", "\n", "\t\t", 
          RowBox[{"FuncPower", "[", 
           RowBox[{
            RowBox[{"help", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
            "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            "fa"}], "]"}], ",", "\n", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "e", "]"}], "===", "Power"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "e", "]"}], "===", "2"}], "&&", 
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], "===", "Rational"}]}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"t", "=", 
            RowBox[{"help", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"p", "=", 
            RowBox[{"Numerator", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"q", "=", 
            RowBox[{"Denominator", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "[", "stop", "]"}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"s", "=", 
               RowBox[{"radical", "[", 
                RowBox[{"q", ",", "t"}], "]"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"If", "[", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"fa", "\[LeftDoubleBracket]", 
                   RowBox[{"FAOFFREP", ",", "All", ",", "1"}], 
                   "\[RightDoubleBracket]"}], ",", "s"}], "]"}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{"FuncPower", "[", 
                 RowBox[{
                  RowBox[{"s", "/.", 
                   RowBox[{
                   "fa", "\[LeftDoubleBracket]", "FAOFFREP", 
                    "\[RightDoubleBracket]"}]}], ",", "p", ",", "fa"}], "]"}],
                 "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"fa", "=", 
                  RowBox[{"FunctionAlgebraExtendByRadical", "[", 
                   RowBox[{"fa", ",", "q", ",", "t"}], "]"}]}], ";", "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{"stop", "=", "True"}], ";"}]}], "\n", "\t\t\t", 
               "]"}]}]}], "\n", "\t\t", "]"}]}], ",", "\n", "\t", "True", ",",
           "\n", "\t\t", 
          RowBox[{"assert", "[", 
           RowBox[{
           "False", ",", "\"\<unhandled expression in ParseExpression\>\""}], 
           "]"}]}], "\n", "]"}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"stop", "=", "False"}], ";", 
        RowBox[{"res", "=", 
         RowBox[{"help", "[", "exp", "]"}]}], ";", "stop"}], ",", "Null"}], 
      "]"}], ";", "\n", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{"\[Theta]", "\[Rule]", "\[Phi]"}]}]}], ";", "\n", 
     RowBox[{"fa", "=", 
      RowBox[{"fa", "/.", 
       RowBox[{"\[Theta]", "\[Rule]", "\[Phi]"}]}]}], ";", "\n", 
     RowBox[{"{", 
      RowBox[{"res", ",", "fa"}], "}"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.7016091198680143`*^9, 3.701609186196612*^9}, {
   3.701609227813613*^9, 3.701609248925601*^9}, {3.7016093080468273`*^9, 
   3.7016093307832413`*^9}, {3.701609374799797*^9, 3.70160939644798*^9}, {
   3.7016096417221613`*^9, 3.701609805006041*^9}, {3.701610066926979*^9, 
   3.701610078638439*^9}, {3.701613737533794*^9, 3.701613766179873*^9}, {
   3.701613809234563*^9, 3.7016138234908113`*^9}, {3.701613853723475*^9, 
   3.701613861123679*^9}, {3.70161390248433*^9, 3.701613935244927*^9}, {
   3.701613992272317*^9, 3.701614030436351*^9}, {3.7016142082430763`*^9, 
   3.701614208410919*^9}, {3.701614452917254*^9, 3.701614538239338*^9}, {
   3.701614587992155*^9, 3.701614588192111*^9}, {3.701614639264983*^9, 
   3.701614664585513*^9}, {3.701614696441543*^9, 3.701614716401984*^9}, {
   3.701615395851387*^9, 3.701615401147732*^9}, {3.701615460308654*^9, 
   3.701615476692925*^9}, 3.701615587462576*^9, {3.7016156689101143`*^9, 
   3.7016156825819597`*^9}, {3.7016158657141943`*^9, 
   3.7016159430279207`*^9}, {3.70161597438137*^9, 3.701616144912983*^9}, {
   3.701616205519989*^9, 3.701616209751902*^9}, {3.701616329783554*^9, 
   3.7016163431835537`*^9}, {3.7016163853448133`*^9, 3.701616402235167*^9}, 
   3.701616441140924*^9, {3.701616482718335*^9, 3.701616566943619*^9}, {
   3.7016166190463943`*^9, 3.701616698394402*^9}, {3.701616730138151*^9, 
   3.70161691916103*^9}, {3.701617643925232*^9, 3.701617659957094*^9}, {
   3.701617918739168*^9, 3.701617972074272*^9}, {3.701618163044353*^9, 
   3.701618163611946*^9}, {3.701618212453124*^9, 3.7016182127165327`*^9}, {
   3.701618265901132*^9, 3.701618522483142*^9}, {3.701618616441527*^9, 
   3.701618666393971*^9}, {3.701618711305561*^9, 3.7016187335527163`*^9}, {
   3.701619865427458*^9, 3.701619925811212*^9}, {3.7016384264552927`*^9, 
   3.701638432958284*^9}, {3.701638502530342*^9, 3.701638622223967*^9}, {
   3.701639367671631*^9, 3.7016395025915422`*^9}, {3.70163955604043*^9, 
   3.701639810559758*^9}, {3.701639849176683*^9, 3.701639854698072*^9}, {
   3.7016399404329643`*^9, 3.701639941143433*^9}, {3.701640015953071*^9, 
   3.701640097778748*^9}, {3.701640564359872*^9, 3.7016405949948473`*^9}, {
   3.7016406847687187`*^9, 3.7016406973037567`*^9}, {3.701640980912915*^9, 
   3.701640991338214*^9}, {3.701641065673935*^9, 3.701641066024987*^9}, {
   3.7016963053559437`*^9, 3.701696305630252*^9}, {3.701698692967654*^9, 
   3.701698784840954*^9}, {3.701698864719925*^9, 3.701698934327483*^9}, {
   3.701699924322344*^9, 3.701699929200959*^9}, {3.701700080354348*^9, 
   3.701700080731032*^9}, {3.7017001488897543`*^9, 3.701700158858173*^9}, {
   3.701700776963443*^9, 3.701700798482232*^9}, {3.7017013025388203`*^9, 
   3.701701302787921*^9}, {3.701701650570438*^9, 3.701701717693162*^9}, {
   3.701701804954669*^9, 3.701701820163069*^9}, {3.7017018532118597`*^9, 
   3.7017019223710537`*^9}, {3.701701974138666*^9, 3.7017019812509117`*^9}, {
   3.701702048467165*^9, 3.701702056619671*^9}, {3.701702148356372*^9, 
   3.701702179659232*^9}, {3.701702245067993*^9, 3.701702319235832*^9}, {
   3.701702381483048*^9, 3.701702388051354*^9}, {3.70170249016457*^9, 
   3.701702490508347*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ParseFunction", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"FunctionAlgebra", "[", 
       RowBox[{
       "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
        "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}]}], "]"}], ":=",
     "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"have", ",", "ys", ",", "f"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"have", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"First", ",", "rep1"}], "]"}]}], ";", 
       RowBox[{"ys", "=", 
        RowBox[{"Alternatives", "@@", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"have", ",", "1"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"f", "[", "e_", "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{"Which", "[", "\n", "\t\t", 
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"e", ",", "ys"}], "]"}], ",", "\n", "\t\t\t", 
           RowBox[{"PolyNormalizeFraction", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Numerator", "[", 
                 RowBox[{"Together", "[", "e", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/.", "rep1"}], ")"}], "\[LeftDoubleBracket]", 
                 "1", "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{
                RowBox[{"Denominator", "[", 
                 RowBox[{"Together", "[", "e", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/.", "rep1"}], ")"}], "\[LeftDoubleBracket]", 
                 "2", "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", 
             "nf", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], ",", "\n", "\t\t", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"e", ",", "ys"}], "]"}], ",", "\n", "\t\t\t", 
           RowBox[{"e", "/.", "rep1"}], ",", "\n", "\t\t", 
           RowBox[{
            RowBox[{
            "e", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}], "===",
             "Plus"}], ",", "\n", "\t\t\t", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PiecePlus", "[", 
               RowBox[{"x", ",", "#1", ",", "#2", ",", "nf"}], "]"}], "&"}], 
             ",", 
             RowBox[{"f", "[", 
              RowBox[{"First", "[", 
               RowBox[{"List", "@@", "e"}], "]"}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"f", ",", 
               RowBox[{"Rest", "[", 
                RowBox[{"List", "@@", "e"}], "]"}]}], "]"}]}], "]"}], ",", 
           "\n", "\t\t", 
           RowBox[{
            RowBox[{
            "e", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}], "===",
             "Times"}], ",", "\n", "\t\t\t", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PieceTimes", "[", 
               RowBox[{"x", ",", 
                RowBox[{
                "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", "#1", ",", "#2", ",", "nf"}], "]"}], "&"}], ",", 
             RowBox[{"f", "[", 
              RowBox[{"First", "[", 
               RowBox[{"List", "@@", "e"}], "]"}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"f", ",", 
               RowBox[{"Rest", "[", 
                RowBox[{"List", "@@", "e"}], "]"}]}], "]"}]}], "]"}], ",", 
           "\n", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{
             "e", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}], "===",
              "Power"}], "&&", 
            RowBox[{"IntegerQ", "[", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"PiecePower", "[", 
            RowBox[{"x", ",", 
             RowBox[{
             "P1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"f", "[", 
              RowBox[{
              "e", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], ",", 
             RowBox[{"1", "/.", "rep1"}], ",", 
             RowBox[{
             "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
              "nf"}], "]"}], ",", "\n", "\t\t", "True", ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<problem in ParseFunction\>\"", "]"}], 
            ";", 
            RowBox[{"Abort", "[", "]"}], ";"}]}], "\n", "\t", "]"}], ")"}]}], 
       ";", "\n", "\t", 
       RowBox[{"f", "[", "exp", "]"}]}]}], "\t", "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PrintFunction", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"FunctionAlgebra", "[", 
       RowBox[{
       "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
        "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{
          RowBox[{
          "M1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"r", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
              "M1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "/", 
              RowBox[{
              "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "*", 
             RowBox[{
              RowBox[{
              "r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ".", "pow1"}]}], ")"}], ".", 
           RowBox[{
           "exp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "/", 
          RowBox[{
          "exp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Numerator", "[", "r", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"First", "/@", "rep1"}], ",", "1"}], "]"}]}], "]"}], "/", 
        
        RowBox[{"Denominator", "[", "r", "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"exp", " ", "is", " ", "defined", " ", "over", " ", "nf2"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FuncPrint", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"FunctionAlgebra", "[", 
       RowBox[{
       "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
        "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{
          RowBox[{
          "M1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"r", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
              "M1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "/", 
              RowBox[{
              "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "*", 
             RowBox[{
              RowBox[{
              "r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ".", "pow1"}]}], ")"}], ".", 
           RowBox[{
           "exp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "/", 
          RowBox[{
          "exp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Numerator", "[", "r", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"First", "/@", "rep1"}], ",", "1"}], "]"}]}], "]"}], "/", 
        
        RowBox[{"Denominator", "[", "r", "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"exp", " ", "is", " ", "defined", " ", "over", " ", "nf2"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FuncPrintExt", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"FunctionAlgebra", "[", 
       RowBox[{
       "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
        "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
        RowBox[{"{", 
         RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ",", 
      "nf2_", ",", "ext_"}], "]"}], ":=", "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "num", ",", "den"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{
          RowBox[{
          "M1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"num", ",", "den"}], "}"}], "=", 
        RowBox[{"Collect", "[", 
         RowBox[{"exp", ",", "x", ",", 
          RowBox[{
           RowBox[{"PolyRemainder", "[", 
            RowBox[{"#", ",", 
             RowBox[{
             "ext", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "nf2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", "nf"}], "]"}], "&"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"r", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
              "M1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "/", 
              RowBox[{
              "r", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "*", 
             RowBox[{
              RowBox[{
              "r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ".", "pow1"}]}], ")"}], ".", "num"}], "/", "den"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Numerator", "[", "r", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"First", "/@", "rep1"}], ",", "1"}], "]"}]}], "]"}], "/", 
        
        RowBox[{"Denominator", "[", "r", "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"exp", " ", "is", " ", "element", " ", "of", " ", "nf2"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstFuncPrintExt", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"FunctionAlgebra", "[", 
      RowBox[{
      "pow1_", ",", "rep1_", ",", "M1_", ",", "T1_", ",", "P1_", ",", 
       "\[CapitalDelta]1_", ",", "ord\[Delta]1_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ",", 
     "nf2_", ",", "ext_"}], "]"}], ":=", "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "num"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{"exp", ",", "x", ",", 
         RowBox[{
          RowBox[{"PolyRemainder", "[", 
           RowBox[{"#", ",", 
            RowBox[{
            "ext", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "nf2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            ",", "nf"}], "]"}], "&"}]}], "]"}]}], ";", "\n", "\t", "num"}]}], 
    "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.690815123446907*^9, 3.6908151259376802`*^9}, {
   3.690815162675095*^9, 3.690815206340466*^9}, {3.690815255329558*^9, 
   3.6908152579569387`*^9}, {3.690815293732926*^9, 3.690815334943408*^9}, {
   3.690815471867305*^9, 3.6908155140475807`*^9}, {3.6908249002630568`*^9, 
   3.690824907150522*^9}, {3.690825204791318*^9, 3.690825216904726*^9}, {
   3.690825247092454*^9, 3.5760938629792247`*^9}, {3.5760938947630424`*^9, 
   3.57609389506706*^9}, {3.5760939422747602`*^9, 3.576094060330513*^9}, {
   3.5760940920583277`*^9, 3.576094095000496*^9}, {3.576094139082017*^9, 
   3.5760941660985622`*^9}, {3.5760942032176857`*^9, 3.576094302817382*^9}, {
   3.576094383344988*^9, 3.576094387673236*^9}, {3.5760944224092226`*^9, 
   3.576094479521489*^9}, {3.5760945735208654`*^9, 3.5760946133531437`*^9}, {
   3.5760946704404087`*^9, 3.576094673552587*^9}, {3.576094770064107*^9, 
   3.576094805816152*^9}, {3.5760948642394934`*^9, 3.5760948675046806`*^9}, {
   3.576094899974538*^9, 3.5760949757458715`*^9}, {3.576095423252467*^9, 
   3.576095440115432*^9}, {3.5760955788903694`*^9, 3.576095634905573*^9}, {
   3.576095687857602*^9, 3.576095706756683*^9}, {3.57609581125666*^9, 
   3.5760958326248817`*^9}, 3.5760962153577733`*^9, {3.5761014669769106`*^9, 
   3.5761014934644256`*^9}, {3.576111703343397*^9, 3.5761117151640735`*^9}, {
   3.5761117461478453`*^9, 3.576111850615821*^9}, {3.576112234590783*^9, 
   3.576112315982438*^9}, {3.5761124105068445`*^9, 3.576112420026389*^9}, {
   3.5761125025961123`*^9, 3.576112508523451*^9}, {3.6764970116074467`*^9, 
   3.671146473844884*^9}, {3.6711465110558667`*^9, 3.6711466235712385`*^9}, {
   3.671146687649234*^9, 3.6711466886492476`*^9}, {3.6711467683122187`*^9, 
   3.6711467783904767`*^9}, {3.6711468609167337`*^9, 3.671146903218302*^9}, {
   3.67114701806857*^9, 3.6711470246936827`*^9}, {3.701609024378125*^9, 
   3.70160903152072*^9}, {3.7016409131825523`*^9, 3.701640925522521*^9}, {
   3.701787319271147*^9, 3.701787362655311*^9}, {3.701787616625935*^9, 
   3.7017876325538073`*^9}, {3.701787747820579*^9, 3.701787751753751*^9}, {
   3.701787783657213*^9, 3.701787787585656*^9}, {3.701787829864296*^9, 
   3.7017878563441057`*^9}, {3.701787950233686*^9, 3.70178798222234*^9}, {
   3.70178801992727*^9, 3.70178808248868*^9}, {3.70178812939329*^9, 
   3.701788173506007*^9}, {3.701788495736725*^9, 3.701788563695513*^9}, {
   3.7025227972596283`*^9, 3.70252279765943*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["residues", "Subsection",
 CellChangeTimes->{{3.6881290959717293`*^9, 3.688129099042542*^9}, {
  3.6905510282020683`*^9, 3.690551061033976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "produce", " ", "a", " ", "linear", " ", "combination", " ", "of", " ", 
    "pilist", " ", "that", " ", "has", " ", "the", " ", "same", " ", 
    "residues", " ", "as", " ", 
    RowBox[{
     RowBox[{"A", ".", "Eta"}], "/", "b"}], "*", "dx"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"CalcResidues", "[", 
    RowBox[{
    "\[Omega]\[Omega]_", ",", "\[Pi]listinEtaBar_", ",", "ord\[Delta]_", ",", 
     "id_", ",", "toEtaBar_", ",", "toEpsilonBar_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{
         "\[Omega]\[Omega]", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "]"}]}], ",", 
       RowBox[{"\[Omega]", "=", "\[Omega]\[Omega]"}], ",", "max", ",", "k", 
       ",", "u", ",", "v", ",", "w", ",", "t", ",", "B", ",", "n\[Omega]", 
       ",", "mat", ",", "coeff"}], "}"}], ",", "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"convert", " ", "to", " ", "\[Xi]"}], " ", "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"max", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "x"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"max", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"max", ",", 
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", "x"}],
              "]"}], "+", 
            RowBox[{
            "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{
               RowBox[{"x", "^", "ord\[Delta]"}], "/", 
               RowBox[{"x", "^", "max"}]}]}], ")"}], "/.", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}], ",", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"\[Xi]", "^", "2"}]}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "\[Omega]", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "/", 
               RowBox[{"x", "^", "max"}]}], ")"}]}], "/.", 
            RowBox[{"x", "\[Rule]", 
             RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}]}], 
        "}"}]}], ";", "\n", "\t", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{"\[Omega]", ",", "\[Xi]", ",", "nf", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";"}], 
       "*)"}], "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "perform", " ", "hermite", " ", "reduction", " ", "at", " ", 
        "infinite", " ", "places"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Exponent", "[", 
              RowBox[{
               RowBox[{
               "\[Omega]", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"1", "/", "\[Xi]"}]}], "]"}]}], "-", "1"}]}], ")"}], 
         ">", "0"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"v", "=", "\[Xi]"}], ";", "\n", "\t\t", 
         RowBox[{"u", "=", 
          RowBox[{"PolyDivide", "[", 
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"v", "^", 
               RowBox[{"(", 
                RowBox[{"k", "+", "1"}], ")"}]}], ",", "\[Xi]", ",", "nf"}], 
             "]"}], ",", "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"w", "=", 
          RowBox[{"PolyDivide", "[", 
           RowBox[{
            RowBox[{
            "id", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"PolyGCD", "[", 
             RowBox[{
              RowBox[{
              "id", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"u", "*", "v"}], ",", "\[Xi]", ",", "nf"}], "]"}], 
              ",", "\[Xi]", ",", "nf"}], "]"}], ",", "\[Xi]", ",", "nf"}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"t", "=", 
          RowBox[{"PolyDivide", "[", 
           RowBox[{
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"w", "*", "u", "*", "v"}], ",", "\[Xi]", ",", "nf"}], 
             "]"}], ",", 
            RowBox[{
            "id", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
             "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"B", "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "*", 
              RowBox[{"Transpose", "[", 
               RowBox[{
               "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}], "-", 
             RowBox[{"k", "*", "w", "*", "u", "*", 
              RowBox[{"D", "[", 
               RowBox[{"v", ",", "\[Xi]"}], "]"}], "*", 
              RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ",", "\[Xi]", 
            ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"B", "=", 
          RowBox[{
           RowBox[{"PolyGaussJordanReduceMod", "[", 
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", "B", "]"}], ",", 
                  RowBox[{"w", "*", 
                   RowBox[{
                   "\[Omega]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "]"}], ",", 
               "\[Xi]"}], "]"}], ",", "\[Xi]", ",", "v", ",", "nf"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"w", "*", 
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"B", ",", "\[Xi]"}], "]"}], "*", "w", "*", "u", "*", 
                "v"}], "+", 
               RowBox[{"t", "*", 
                RowBox[{"B", ".", 
                 RowBox[{
                 "id", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "-", 
               RowBox[{"k", "*", "B", "*", "w", "*", "u", "*", 
                RowBox[{"D", "[", 
                 RowBox[{"v", ",", "\[Xi]"}], "]"}]}]}], ")"}]}], ",", 
            "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyDivide", "[", 
              RowBox[{"#", ",", "v", ",", "\[Xi]", ",", "nf"}], "]"}], "&"}], 
            ",", 
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"w", "*", "u", "*", 
             RowBox[{"v", "^", "k"}]}], ",", "\[Xi]", ",", "nf"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"\[Omega]", "=", 
          RowBox[{"PolyNormalizeFraction", "[", 
           RowBox[{"\[Omega]", ",", "\[Xi]", ",", "nf", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], "\n", "\t\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";"}], 
        "*)"}], "\n", "\t", "]"}], ";", "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"convert", " ", "to", " ", "x"}], " ", "*)"}], "\n", "\t", 
      RowBox[{"max", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "\[Xi]"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"max", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"max", ",", 
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              "\[Xi]"}], "]"}], "+", 
            RowBox[{
            "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{
               RowBox[{"\[Xi]", "^", "ord\[Delta]"}], "/", 
               RowBox[{"\[Xi]", "^", "max"}]}]}], ")"}], "/.", 
            RowBox[{"\[Xi]", "\[Rule]", 
             RowBox[{"1", "/", "x"}]}]}], ",", "x"}], "]"}], ",", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"x", "^", "2"}]}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "\[Omega]", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "/", 
               RowBox[{"\[Xi]", "^", "max"}]}], ")"}]}], "/.", 
            RowBox[{"\[Xi]", "\[Rule]", 
             RowBox[{"1", "/", "x"}]}]}], ",", "x"}], "]"}]}], "}"}]}], ";", 
      "\n", "\t", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{"\[Omega]", ",", "x", ",", "nf", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";"}], 
       "*)"}], "\n", "\n", "\t", 
      RowBox[{"n\[Omega]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"toEpsilonBar", ".", 
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\t", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"convert", " ", "to", " ", "eta", " ", "bar", " ", "basis"}], 
       " ", "*)"}], "\n", "\t", 
      RowBox[{"n\[Omega]", "=", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"toEtaBar", ".", 
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\t", "\n", "\t", 
      RowBox[{"mat", "=", 
       RowBox[{"Table", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "===", "0"}], ",", "\n", "\t\t\t", 
           RowBox[{"PolyQuotient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"n\[Omega]", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], "*", "x"}],
              ",", 
             RowBox[{
              RowBox[{
              "n\[Omega]", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{
               "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], "]"}], 
           ",", "\n", "\t\t\t", 
           RowBox[{"PolyQuotient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Pi]listinEtaBar", "\[LeftDoubleBracket]", 
               RowBox[{"m", ",", "i"}], "\[RightDoubleBracket]"}], "*", "x"}],
              ",", 
             RowBox[{"x", "^", 
              RowBox[{
              "ord\[Delta]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf"}], "]"}]}], 
          "\n", "\t\t", "]"}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"Length", "[", "\[Pi]listinEtaBar", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"coeff", "=", 
       RowBox[{"PolyNumRowNullSpace", "[", 
        RowBox[{"mat", ",", "x", ",", "nf"}], "]"}]}], ";", "\t", "\n", "\t", 
      
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "coeff", "]"}], "===", "1"}], "&&", 
         RowBox[{
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=!=", "0"}]}],
         ",", "\"\<bad null space in RemovePoles\>\""}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"Return", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumCollect", "[", 
           RowBox[{"#", ",", "nf"}], "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Rest", "[", 
            RowBox[{
            "coeff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "*", 
          RowBox[{"NumRecp", "[", 
           RowBox[{
            RowBox[{"coeff", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "nf"}], 
           "]"}]}]}], "]"}], "]"}]}]}], "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.6875397834500933`*^9, 3.687539810789638*^9}, {
   3.687539966383967*^9, 3.6875401037615767`*^9}, {3.68754014894429*^9, 
   3.687540151016021*^9}, {3.687540219096488*^9, 3.687540220357617*^9}, {
   3.687540353599791*^9, 3.687540405018632*^9}, {3.687540455367227*^9, 
   3.6875405119956284`*^9}, {3.687540591399293*^9, 3.6875406615427*^9}, {
   3.6875407261604767`*^9, 3.687540726294647*^9}, {3.6875408377115993`*^9, 
   3.687540981056004*^9}, {3.687541011518091*^9, 3.687541020234385*^9}, {
   3.687541133428718*^9, 3.687541133789377*^9}, {3.6875411938058453`*^9, 
   3.687541264507535*^9}, {3.687541394014455*^9, 3.6875414386609087`*^9}, {
   3.687541527516055*^9, 3.687541542806081*^9}, {3.6875416975726347`*^9, 
   3.687541734261045*^9}, {3.6875418700597677`*^9, 3.687541870462841*^9}, 
   3.687541907170557*^9, {3.687541985581942*^9, 3.687542093797554*^9}, {
   3.687542172781015*^9, 3.6875422219802628`*^9}, 3.6875423160560417`*^9, {
   3.687542352048842*^9, 3.6875423796661367`*^9}, 3.687542459054635*^9, {
   3.687542533643118*^9, 3.687542563437213*^9}, {3.68754259720722*^9, 
   3.6875427728774853`*^9}, {3.68754284597896*^9, 3.687542857598919*^9}, {
   3.687542958757543*^9, 3.6875429602944317`*^9}, {3.6875430432864723`*^9, 
   3.6875430583491592`*^9}, {3.687543301588655*^9, 3.687543322527007*^9}, {
   3.687543558299383*^9, 3.6875435882595043`*^9}, {3.687543625106659*^9, 
   3.6875436255565434`*^9}, {3.6875436907801867`*^9, 3.68754370821729*^9}, {
   3.687543739907317*^9, 3.687543750578521*^9}, {3.687543788187867*^9, 
   3.6875439193296843`*^9}, {3.687543974367879*^9, 3.687543974949139*^9}, {
   3.6875441827796288`*^9, 3.687544211837494*^9}, {3.6875451734051743`*^9, 
   3.687545333278904*^9}, {3.687545531666032*^9, 3.687545539407947*^9}, {
   3.687545670668848*^9, 3.687545671988698*^9}, {3.687545747107502*^9, 
   3.6875459076015368`*^9}, {3.687545938329898*^9, 3.6875459442838707`*^9}, {
   3.687545975905253*^9, 3.687546029541597*^9}, {3.6875460721948347`*^9, 
   3.687546110475984*^9}, 3.687546158195815*^9, {3.687546206764661*^9, 
   3.687546287640059*^9}, {3.68754634907765*^9, 3.687546383868648*^9}, {
   3.687546465848982*^9, 3.687546568537992*^9}, {3.687610023422365*^9, 
   3.6876100247964582`*^9}, {3.687610064326335*^9, 3.687610152962345*^9}, {
   3.68761028306429*^9, 3.687610307295381*^9}, {3.687610443975338*^9, 
   3.687610502711473*^9}, {3.68761085747224*^9, 3.68761086974724*^9}, {
   3.687610904809759*^9, 3.6876109248289423`*^9}, {3.6876109557310534`*^9, 
   3.687610975341264*^9}, {3.687611027172559*^9, 3.687611064248272*^9}, {
   3.687611235204564*^9, 3.6876112505928383`*^9}, {3.687641995738186*^9, 
   3.687641997406951*^9}, {3.6876422376363897`*^9, 3.687642254158943*^9}, {
   3.6876423525390787`*^9, 3.687642394849284*^9}, 3.687642429229596*^9, {
   3.6876424679396753`*^9, 3.687642472433518*^9}, {3.687642541921139*^9, 
   3.687642542014472*^9}, {3.687711170669405*^9, 3.687711173737842*^9}, {
   3.687711683312374*^9, 3.687711688822145*^9}, {3.687711757125993*^9, 
   3.687711782284774*^9}, {3.687711815725761*^9, 3.687711864090434*^9}, {
   3.687711906928258*^9, 3.687711907266835*^9}, {3.687711979502769*^9, 
   3.687712001266026*^9}, {3.687713023746666*^9, 3.687713031563892*^9}, {
   3.6877132079292507`*^9, 3.687713209933476*^9}, {3.687713274103252*^9, 
   3.68771327452796*^9}, {3.687713346692947*^9, 3.68771335865473*^9}, {
   3.6877133895815887`*^9, 3.687713390214582*^9}, {3.687713597838914*^9, 
   3.687713598589727*^9}, {3.6877142341877327`*^9, 3.687714240152691*^9}, {
   3.687714295132946*^9, 3.687714320604705*^9}, 3.687714357703494*^9, {
   3.687714609167679*^9, 3.687714611401704*^9}, {3.687714722285334*^9, 
   3.687714722832529*^9}, {3.687714853949636*^9, 3.687714854220663*^9}, {
   3.6877156627831507`*^9, 3.687715696212391*^9}, {3.687718613274118*^9, 
   3.6877186253948183`*^9}, 3.6877186661715403`*^9, {3.687718903181087*^9, 
   3.687718908163891*^9}, {3.687718949270994*^9, 3.6877189508149977`*^9}, {
   3.6877196877015543`*^9, 3.687719701358252*^9}, {3.687720145667942*^9, 
   3.687720162493175*^9}, {3.687720631977302*^9, 3.687720648236665*^9}, {
   3.687720950147047*^9, 3.6877210348352547`*^9}, {3.6877210824215612`*^9, 
   3.687721084590117*^9}, {3.687721120180917*^9, 3.687721121529215*^9}, {
   3.687721898032114*^9, 3.6877219180550013`*^9}, {3.687721987181209*^9, 
   3.687721988889985*^9}, {3.6877220831235447`*^9, 3.6877220921136827`*^9}, {
   3.6877221939322977`*^9, 3.687722194449917*^9}, {3.68772248408074*^9, 
   3.687722490644705*^9}, {3.687722562931447*^9, 3.687722609001658*^9}, {
   3.6877230891728*^9, 3.687723094367679*^9}, {3.687723360636963*^9, 
   3.687723360942998*^9}, {3.687726920331674*^9, 3.68772696052393*^9}, 
   3.687728212584991*^9, {3.688129269796256*^9, 3.688129272682551*^9}, {
   3.689442330484124*^9, 3.689442330783064*^9}, {3.690137569014328*^9, 
   3.690137569472601*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["pieces", "Subsection",
 CellChangeTimes->{{3.666967608801581*^9, 3.666967612829483*^9}, {
  3.690551022322503*^9, 3.690551063929666*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ToPiece", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "curve_"}], "}"}], ",", "B_", ",", "P_", 
     ",", "func_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "intbasis", "]"}]}], ",", "tab", ",", "sol", 
       ",", "d", ",", "U", ",", 
       RowBox[{"f", "=", 
        RowBox[{"Together", "[", "func", "]"}]}], ",", "num", ",", "den"}], 
      "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"Numerator", "[", "f", "]"}], ",", "y"}], "]"}], "]"}]}], 
      ";", "\n", "\t", 
      RowBox[{"den", "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"CoefficientList", "[", 
         RowBox[{
          RowBox[{"Denominator", "[", "f", "]"}], ",", "y"}], "]"}], "]"}]}], 
      ";", "\n", "\t", 
      RowBox[{"num", "=", 
       RowBox[{"Fold", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PiecePlus", "[", 
           RowBox[{"x", ",", 
            RowBox[{"PieceTimes", "[", 
             RowBox[{"x", ",", "P", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", "1"}], "}"}], ",", "#1", ",", "nf"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"#2", "*", 
                 RowBox[{
                 "B", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf"}], "]"}], 
              ",", "1"}], "}"}], ",", "nf"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "num", "]"}], "*", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "x", ",", "nf"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"Rest", "[", "num", "]"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"den", "=", 
       RowBox[{"Fold", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PiecePlus", "[", 
           RowBox[{"x", ",", 
            RowBox[{"PieceTimes", "[", 
             RowBox[{"x", ",", "P", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", "1"}], "}"}], ",", "#1", ",", "nf"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"#2", "*", 
                 RowBox[{
                 "B", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf"}], "]"}], 
              ",", "1"}], "}"}], ",", "nf"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "den", "]"}], "*", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "x", ",", "nf"}], "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"Rest", "[", "den", "]"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"PieceDivide", "[", 
       RowBox[{"x", ",", "P", ",", "num", ",", "den", ",", "nf"}], "]"}]}]}], 
    "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.6653148325950403`*^9, 3.6653148534211693`*^9}, {
   3.665314915771716*^9, 3.665314972607925*^9}, {3.665315115188972*^9, 
   3.6653151711559277`*^9}, {3.665315207156156*^9, 3.6653152694004602`*^9}, {
   3.665315300937449*^9, 3.665315358107306*^9}, {3.665315408349813*^9, 
   3.6653154086534977`*^9}, {3.6653155017927933`*^9, 
   3.6653155047011642`*^9}, {3.6653165805207157`*^9, 3.665316618756186*^9}, {
   3.665316679333798*^9, 3.6653166865209703`*^9}, 3.6653183270527077`*^9, {
   3.665318434079118*^9, 3.6653184670214853`*^9}, {3.6653186362141037`*^9, 
   3.6653186393095627`*^9}, {3.66568222663636*^9, 3.665682228527356*^9}, 
   3.6660370763545847`*^9, {3.6660405774284077`*^9, 3.5803449624296637`*^9}, {
   3.580348955648529*^9, 3.580348963878541*^9}, {3.580349003328596*^9, 
   3.5803490113386073`*^9}, {3.5803490603436756`*^9, 3.580349157933812*^9}, {
   3.580349193703862*^9, 3.5803491972288675`*^9}, {3.580349237013923*^9, 
   3.580349279948983*^9}, {3.666965725213032*^9, 3.666965726844222*^9}, {
   3.666965767063553*^9, 3.666965811305887*^9}, {3.6677450730405903`*^9, 
   3.667745074274197*^9}, {3.6677451214658947`*^9, 3.667745174354137*^9}, {
   3.667745219748639*^9, 3.6677452435520372`*^9}, {3.6677454003364487`*^9, 
   3.667745404957979*^9}, {3.6677454571300573`*^9, 3.667745460026813*^9}, {
   3.6677455826103487`*^9, 3.667745582927134*^9}, {3.667745985740225*^9, 
   3.667746114583617*^9}, {3.667746628872826*^9, 3.6677466643814707`*^9}, {
   3.667747371920158*^9, 3.667747374638158*^9}, {3.667747655968586*^9, 
   3.667747679455106*^9}, {3.667764391875136*^9, 3.667764394117222*^9}, {
   3.6677645792443533`*^9, 3.667764579959044*^9}, {3.667764820507174*^9, 
   3.667764836463513*^9}, 3.667764872468999*^9, {3.667764912130951*^9, 
   3.667764944158765*^9}, {3.667764991904552*^9, 3.667765109143072*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["arithmetic", "Subsection",
 CellChangeTimes->{{3.580344981742498*^9, 3.5803449852057037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"adding", " ", "pieces", " ", "is", " ", "O", 
    RowBox[{"(", "n", ")"}], " ", "polynomial", " ", "operations"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PiecePlus", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"{", 
        RowBox[{"num1_", ",", "den1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"num2_", ",", "den2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"num", ",", "den", ",", "gcd"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"den", "=", 
         RowBox[{"PolyLCM", "[", 
          RowBox[{"den1", ",", "den2", ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"num", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"PolyDivide", "[", 
              RowBox[{"den", ",", "den1", ",", "x", ",", "nf"}], "]"}], "*", 
             "num1"}], "+", 
            RowBox[{
             RowBox[{"PolyDivide", "[", 
              RowBox[{"den", ",", "den2", ",", "x", ",", "nf"}], "]"}], "*", 
             "num2"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"gcd", "=", "den"}], ";", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gcd", "=", 
             RowBox[{"PolyGCD", "[", 
              RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
           "&"}], ",", "num"}], "]"}], ";", "\n", "\t", 
        RowBox[{"num", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "gcd", ",", "x", ",", "nf"}], "]"}], "&"}], 
           ",", "num"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"den", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{"den", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"num", ",", "den"}], "}"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FuncPlus", "[", 
      RowBox[{"f1_List", ",", "f2_List", ",", "fa_"}], "]"}], ":=", 
     RowBox[{"PiecePlus", "[", 
      RowBox[{
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", "f1", 
       ",", "f2", ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PieceMulAdd", "[", 
      RowBox[{"x_", ",", 
       RowBox[{"{", 
        RowBox[{"num1_", ",", "den1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"num2_", ",", "den2_"}], "}"}], ",", "a_", ",", "nf_"}], 
      "]"}], ":=", 
     RowBox[{"PolyNormalizeFraction", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"num1", "*", "den2"}], "+", 
          RowBox[{"a", "*", "num2", "*", "den1"}]}], ",", 
         RowBox[{"den1", "*", "den2"}]}], "}"}], ",", "x", ",", "nf", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "we", " ", "multiply", " ", "and", " ", "divide", " ", "pieces", " ", 
     "using", " ", "an", " ", "n", "\[Times]", "n", "\[Times]", "n", " ", 
     "array", " ", "P", " ", "for", " ", "the", " ", "product", " ", "of", 
     " ", "basis", " ", "elements"}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"with", " ", "P", " ", "this", " ", "is", " ", "O", 
     RowBox[{"(", 
      RowBox[{"n", "^", "3"}], ")"}], " ", "polynomial", " ", "operations"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PieceTimes", "[", 
      RowBox[{"x_", ",", "P_", ",", 
       RowBox[{"{", 
        RowBox[{"num1_", ",", "den1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"num2_", ",", "den2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"num", ",", "den", ",", "gcd", ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "num1", "]"}]}]}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "num1", "]"}], "===", 
          RowBox[{"{", "n", "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "num2", "]"}], "===", 
          RowBox[{"{", "n", "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "P", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"den", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"den1", "*", "den2"}], ",", "x", ",", "nf"}], "]"}]}], ";",
         "\n", "\t", 
        RowBox[{"num", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "num1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "num2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{"P", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
           ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"gcd", "=", "den"}], ";", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gcd", "=", 
             RowBox[{"PolyGCD", "[", 
              RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
           "&"}], ",", "num"}], "]"}], ";", "\n", "\t", 
        RowBox[{"gcd", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"gcd", "*", 
            RowBox[{"PolyLC", "[", 
             RowBox[{"den", ",", "x"}], "]"}]}], ",", "x", ",", "nf"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"num", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "gcd", ",", "x", ",", "nf"}], "]"}], "&"}], 
           ",", "num"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"den", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{"den", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"num", ",", "den"}], "}"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FuncTimes", "[", 
      RowBox[{"f1_List", ",", "f2_List", ",", "fa_"}], "]"}], ":=", 
     RowBox[{"PieceTimes", "[", 
      RowBox[{
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", "f1", 
       ",", "f2", ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PiecePower", "[", 
      RowBox[{"x_", ",", "P_", ",", 
       RowBox[{"{", 
        RowBox[{"num1_", ",", "den1_"}], "}"}], ",", "one_", ",", 
       "exp_Integer", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "fxn", "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"fxn", "=", 
         RowBox[{"{", 
          RowBox[{"num1", ",", "den1"}], "}"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"exp", "<", "0"}], ",", 
          RowBox[{"fxn", "=", 
           RowBox[{"PieceDivide", "[", 
            RowBox[{"x", ",", "P", ",", "one", ",", "fxn", ",", "nf"}], 
            "]"}]}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Nest", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PieceTimes", "[", 
            RowBox[{"x", ",", "P", ",", "#", ",", "fxn", ",", "nf"}], "]"}], 
           "&"}], ",", "one", ",", 
          RowBox[{"Abs", "[", "exp", "]"}]}], "]"}]}]}], "\n", "]"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FuncPower", "[", 
      RowBox[{"f1_List", ",", "exp_Integer", ",", "fa_"}], "]"}], ":=", 
     RowBox[{"PiecePower", "[", 
      RowBox[{
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", "f1", 
       ",", 
       RowBox[{"1", "/.", 
        RowBox[{
        "fa", "\[LeftDoubleBracket]", "FAOFFREP", "\[RightDoubleBracket]"}]}],
        ",", "exp", ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBaseElement", "[", 
      RowBox[{"x_", ",", "P_", ",", "poly_", ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "P", "]"}]}], ",", "A", ",", "diag", ",", 
         "num", ",", "numgcd", ",", "den", ",", "gcd"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{"PieceDivide", "[", 
        RowBox[{"x", ",", "P", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "n"}], "]"}], ",", 
             RowBox[{"1", "\[Rule]", "poly"}]}], "]"}], ",", "1"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", "n"}], "]"}], ",", 
             RowBox[{"1", "\[Rule]", "1"}]}], "]"}], ",", "1"}], "}"}], ",", 
         "nf"}], "]"}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GetConstantBaseElement", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"num_", ",", "den_"}], "}"}], ",", "P_", ",", "x_", ",", 
       "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "P", "]"}]}], ",", "one", ",", 
         RowBox[{"res", "=", "Null"}]}], "}"}], ",", "\n", 
       RowBox[{"Catch", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"den", "=!=", "1"}], ",", 
           RowBox[{"Throw", "[", 
            RowBox[{"{", 
             RowBox[{"False", ",", "Null"}], "}"}], "]"}]}], "]"}], ";", "\n",
          "\t", 
         RowBox[{"one", "=", 
          RowBox[{"PieceDivide", "[", 
           RowBox[{"x", ",", "P", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", "n"}], "]"}], ",", 
                RowBox[{"1", "\[Rule]", "1"}]}], "]"}], ",", "1"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", "n"}], "]"}], ",", 
                RowBox[{"1", "\[Rule]", "1"}]}], "]"}], ",", "1"}], "}"}], 
            ",", "nf"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"one", "=", 
          RowBox[{
          "one", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ";", "\n", "\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Which", "[", "\n", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
              "one", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
               "0"}], ",", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "num", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                 "=!=", "0"}], ",", 
               RowBox[{"Throw", "[", 
                RowBox[{"{", 
                 RowBox[{"False", ",", "Null"}], "}"}], "]"}]}], "]"}], ",", 
             "\n", "\t\t", 
             RowBox[{"res", "===", "Null"}], ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"res", "=", 
               RowBox[{"NumCollect", "[", 
                RowBox[{
                 RowBox[{
                 "num", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"NumRecp", "[", 
                  RowBox[{
                   RowBox[{
                   "one", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], "]"}]}], 
              ";", "\n", "\t\t", "True"}], ",", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"res", "=!=", 
                RowBox[{"NumCollect", "[", 
                 RowBox[{
                  RowBox[{
                  "num", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"NumRecp", "[", 
                   RowBox[{
                    RowBox[{
                    "one", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], "]"}]}], 
               ",", "\n", "\t\t\t\t", 
               RowBox[{"Throw", "[", 
                RowBox[{"{", 
                 RowBox[{"False", ",", "Null"}], "}"}], "]"}]}], "\n", 
              "\t\t\t", "]"}]}], "\n", "\t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
         "\t", 
         RowBox[{"assert", "[", 
          RowBox[{
           RowBox[{"res", "=!=", "Null"}], ",", 
           "\"\<res in GetConstantBaseElement\>\""}], "]"}], ";", "\n", "\t", 
         
         RowBox[{"Throw", "[", 
          RowBox[{"{", 
           RowBox[{"True", ",", "res"}], "}"}], "]"}]}], "\n", "]"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"behavior", " ", "undefined", " ", "if", " ", "num2"}], "===", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "...", ",", "0"}], "}"}], " ", "-", " ", 
      RowBox[{
      "PolyGaussJordanReduce", " ", "assumes", " ", "non", " ", "singular", 
       " ", "matrix"}]}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"PieceDivide", "[", 
      RowBox[{"x_", ",", "P_", ",", 
       RowBox[{"{", 
        RowBox[{"num1_", ",", "den1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"num2_", ",", "den2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "num1", "]"}]}], ",", "A", ",", "diag", ",", 
         "num", ",", "numgcd", ",", "den", ",", "gcd"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "num1", "]"}], "===", 
          RowBox[{"{", "n", "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "num2", "]"}], "===", 
          RowBox[{"{", "n", "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "P", "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"A", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "===", 
              RowBox[{"n", "+", "1"}]}], ",", 
             RowBox[{
             "num1", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "num2", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "*", 
                  RowBox[{"P", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j", ",", "k"}], 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x",
                ",", "nf"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"A", "=", 
         RowBox[{"PolyGaussJordanReduce", "[", 
          RowBox[{"A", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"den", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
            "den1"}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"num", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], "*", "den2"}], 
           ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"gcd", "=", "den"}], ";", 
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"gcd", "=", 
             RowBox[{"PolyGCD", "[", 
              RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
           "&"}], ",", "num"}], "]"}], ";", 
        RowBox[{"gcd", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"gcd", "*", 
            RowBox[{"PolyLC", "[", 
             RowBox[{"den", ",", "x"}], "]"}]}], ",", "x"}], "]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"num", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "gcd", ",", "x", ",", "nf"}], "]"}], "&"}], 
           ",", "num"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"den", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{"den", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"num", ",", "den"}], "}"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"FuncDivide", "[", 
      RowBox[{"f1_List", ",", "f2_List", ",", "fa_"}], "]"}], ":=", 
     RowBox[{"PieceDivide", "[", 
      RowBox[{
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"fa", "\[LeftDoubleBracket]", 
        RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", "f1", 
       ",", "f2", ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
      "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.664212532872252*^9, 3.664212534137127*^9}, {
   3.664212606041318*^9, 3.664212635898057*^9}, {3.664212673570942*^9, 
   3.664212796651765*^9}, {3.664212980171906*^9, 3.664212984740302*^9}, {
   3.664213024538394*^9, 3.6642130261080103`*^9}, {3.6642131064047728`*^9, 
   3.664213107777946*^9}, {3.664213150332472*^9, 3.664213153627995*^9}, {
   3.664213237332255*^9, 3.664213616328086*^9}, {3.66421365695045*^9, 
   3.664213767927772*^9}, 3.664213916190226*^9, {3.6642139585182056`*^9, 
   3.664214050668518*^9}, {3.664214200793009*^9, 3.6642142112026777`*^9}, {
   3.664214313316427*^9, 3.664214427682917*^9}, {3.6642179942693*^9, 
   3.664218010504815*^9}, {3.664219366389348*^9, 3.6642193835637503`*^9}, {
   3.664219664324823*^9, 3.664219667613105*^9}, {3.664219787305357*^9, 
   3.664219790516656*^9}, {3.6642212066471357`*^9, 3.664221223164415*^9}, {
   3.664226079262866*^9, 3.6642260983578663`*^9}, {3.664226146286866*^9, 
   3.664226156496866*^9}, {3.664227406963628*^9, 3.6642274203478274`*^9}, {
   3.664227617050002*^9, 3.664227620520002*^9}, {3.6642284248058863`*^9, 
   3.6642284252798862`*^9}, {3.66422873105949*^9, 3.66422873261942*^9}, {
   3.6642288189459467`*^9, 3.6642288258720355`*^9}, {3.6642290253301573`*^9, 
   3.664229056100157*^9}, {3.664229170633157*^9, 3.664229174185157*^9}, {
   3.664229434047418*^9, 3.664229464954418*^9}, {3.664229495348418*^9, 
   3.664229495513418*^9}, {3.6642298627589693`*^9, 3.6642299040503163`*^9}, {
   3.66422997683665*^9, 3.6642299866642094`*^9}, {3.664230045099187*^9, 
   3.6642300709160285`*^9}, {3.6642301253731847`*^9, 
   3.6642301370258617`*^9}, {3.664230168286859*^9, 3.66423016870804*^9}, {
   3.6642304852334366`*^9, 3.664230489772833*^9}, {3.6643177782313747`*^9, 
   3.6643177832699485`*^9}, {3.664326076212344*^9, 3.664326119079221*^9}, {
   3.664326153304085*^9, 3.6643261674214516`*^9}, {3.6643262113022823`*^9, 
   3.66432621403216*^9}, {3.664326406028344*^9, 3.6643266552583604`*^9}, {
   3.664326713630941*^9, 3.664326948416005*^9}, {3.664327026802488*^9, 
   3.664327102006713*^9}, {3.6643271572282352`*^9, 3.664327183653449*^9}, {
   3.6643272138224955`*^9, 3.6643272425720053`*^9}, {3.6643277182414603`*^9, 
   3.6643277915581703`*^9}, {3.6643278275457554`*^9, 
   3.6643278679479427`*^9}, {3.664327910050453*^9, 3.664328039228256*^9}, {
   3.664328074654267*^9, 3.664328153071948*^9}, {3.6643284247302785`*^9, 
   3.664328503411089*^9}, {3.6643285550175915`*^9, 3.664328585289039*^9}, {
   3.6643286367395835`*^9, 3.6643287140642843`*^9}, {3.6643288248419905`*^9, 
   3.6643289054997654`*^9}, {3.664328967595802*^9, 3.6643289680013523`*^9}, {
   3.664329659049317*^9, 3.664329680014776*^9}, {3.6643298460069275`*^9, 
   3.6643302196257615`*^9}, {3.6643303408479223`*^9, 
   3.6643303812969065`*^9}, {3.664330413244273*^9, 3.6643304294831443`*^9}, {
   3.664330508992777*^9, 3.664330521908997*^9}, {3.6643305828242636`*^9, 
   3.6643307045456014`*^9}, {3.664330857652731*^9, 3.664330863892451*^9}, {
   3.664330918926781*^9, 3.6643309196755476`*^9}, {3.664330957129467*^9, 
   3.6643309651163087`*^9}, {3.6643311090822487`*^9, 3.664331117583867*^9}, {
   3.664331218355345*^9, 3.6643312191353097`*^9}, {3.6643314559014854`*^9, 
   3.6643314585845647`*^9}, {3.6643316421571274`*^9, 
   3.6643317057710724`*^9}, {3.664331798384117*^9, 3.6643318450104246`*^9}, {
   3.6643319260019903`*^9, 3.6643320081947017`*^9}, {3.664332236272067*^9, 
   3.664332285409862*^9}, {3.6643324268175163`*^9, 3.664332665689597*^9}, {
   3.664332698104943*^9, 3.6643327310506644`*^9}, {3.664332783620305*^9, 
   3.664332806551276*^9}, {3.6643328394190016`*^9, 3.664332894983708*^9}, {
   3.6643333767889605`*^9, 3.6643334246320143`*^9}, {3.664333533312337*^9, 
   3.6643335553350973`*^9}, {3.664333613445097*^9, 3.664333623898097*^9}, {
   3.664333709004097*^9, 3.664333783574097*^9}, {3.6643340549224424`*^9, 
   3.6643340934995117`*^9}, 3.664334292842966*^9, {3.664334340701618*^9, 
   3.664334372960971*^9}, {3.6643344647316527`*^9, 3.664334537112405*^9}, {
   3.6643346467910833`*^9, 3.664334650066936*^9}, {3.664334752179954*^9, 
   3.664334765033777*^9}, {3.6643348035328493`*^9, 3.664334804328414*^9}, {
   3.6643348657272587`*^9, 3.664334867833164*^9}, {3.664334899016165*^9, 
   3.6643349425226126`*^9}, {3.664334978650591*^9, 3.6643350512029357`*^9}, {
   3.664335118669908*^9, 3.6643351250344224`*^9}, {3.6643351725342913`*^9, 
   3.66433520331171*^9}, {3.6643352379109573`*^9, 3.6643352388001175`*^9}, {
   3.6643352907457867`*^9, 3.664335293850047*^9}, {3.664335566510212*^9, 
   3.664335611670185*^9}, {3.66433606972803*^9, 3.6643362009181433`*^9}, {
   3.664336315962981*^9, 3.6643363257281427`*^9}, {3.664336445327976*^9, 
   3.6643364458427525`*^9}, {3.664336583756164*^9, 3.664336641398325*^9}, {
   3.664336677876667*^9, 3.664336704482931*^9}, {3.664336747261936*^9, 
   3.664336747480276*^9}, {3.664336788372202*^9, 3.6643368542952256`*^9}, {
   3.6643368843949265`*^9, 3.664336885049946*^9}, {3.6643369315942907`*^9, 
   3.6643369543517723`*^9}, {3.6643370349934325`*^9, 
   3.6643370457716503`*^9}, {3.6643370957944365`*^9, 3.664337191753648*^9}, {
   3.664337296780368*^9, 3.6643373242966514`*^9}, {3.6643373745091887`*^9, 
   3.6643373894840364`*^9}, {3.6643374738735447`*^9, 
   3.6643376821681013`*^9}, {3.66433776626285*^9, 3.664337883584937*^9}, {
   3.6643379531734147`*^9, 3.6643380736312094`*^9}, {3.6643381041746387`*^9, 
   3.6643382091891265`*^9}, {3.664338347289729*^9, 3.6643383592231936`*^9}, {
   3.6643383919661245`*^9, 3.664338446626072*^9}, 3.664338519849186*^9, {
   3.66433858683258*^9, 3.6643385954433937`*^9}, {3.664338653379194*^9, 
   3.664338698944749*^9}, {3.6643387314380913`*^9, 3.664339021101493*^9}, {
   3.66433905970976*^9, 3.66433916045004*^9}, {3.664339603267369*^9, 
   3.66433962886582*^9}, 3.664339732601165*^9, {3.6643401613947234`*^9, 
   3.664340166308503*^9}, 3.6643404370499535`*^9, 3.66434047523704*^9, {
   3.664340525248396*^9, 3.664340532174485*^9}, {3.664340599969043*^9, 
   3.66434060895424*^9}, {3.6643406537710285`*^9, 3.664340677045184*^9}, {
   3.6643407493323402`*^9, 3.6643409496273527`*^9}, {3.664340981652715*^9, 
   3.6643410006370635`*^9}, {3.6643410406648674`*^9, 
   3.6643411137475877`*^9}, {3.664341160779477*^9, 3.664341226343335*^9}, {
   3.6643412660591526`*^9, 3.6643412817676477`*^9}, {3.6643413998855476`*^9, 
   3.664341431552127*^9}, {3.6643416447945576`*^9, 3.6643416845571733`*^9}, {
   3.6643417261137085`*^9, 3.6643417420249944`*^9}, {3.6643417750955105`*^9, 
   3.6643418366503487`*^9}, {3.664341899187942*^9, 3.6643418992971373`*^9}, {
   3.6643420303156576`*^9, 3.664342125081405*^9}, {3.6643428494972982`*^9, 
   3.6643429279617767`*^9}, {3.6643450279009733`*^9, 
   3.6643450336557865`*^9}, {3.6643451731555243`*^9, 
   3.6643452709861803`*^9}, {3.664345622203965*^9, 3.6643458357703342`*^9}, {
   3.6643465518697834`*^9, 3.664346569855776*^9}, {3.66434662348617*^9, 
   3.664346847492118*^9}, {3.6643469277817144`*^9, 3.6643469843915744`*^9}, {
   3.66434705535279*^9, 3.66434717435985*^9}, {3.6643473695070925`*^9, 
   3.664347381487355*^9}, {3.664347424900207*^9, 3.6643474307499447`*^9}, 
   3.6643477789107213`*^9, {3.664347852414623*^9, 3.6643479188988395`*^9}, {
   3.664347972778822*^9, 3.664348000264788*^9}, {3.6643480341464677`*^9, 
   3.664348037749906*^9}, {3.6643483279748826`*^9, 3.6643483334658365`*^9}, {
   3.6643486438451085`*^9, 3.664348663375432*^9}, {3.6643498146349707`*^9, 
   3.664349826100456*^9}, {3.6643498588433867`*^9, 3.6643498610740867`*^9}, {
   3.6643757690161266`*^9, 3.6643757703341265`*^9}, {3.6643759686961775`*^9, 
   3.6643759824391603`*^9}, {3.6643760733206825`*^9, 3.664376083444628*^9}, {
   3.6643766283437767`*^9, 3.664376643880679*^9}, {3.6643766815841875`*^9, 
   3.664377077612928*^9}, {3.6643771549854555`*^9, 3.6643772545869865`*^9}, {
   3.664377303272402*^9, 3.664377321882366*^9}, {3.664377621576118*^9, 
   3.664377669910857*^9}, {3.6643784206024437`*^9, 3.6643786065149016`*^9}, {
   3.664378645263563*^9, 3.664378683481848*^9}, {3.6643787269258986`*^9, 
   3.6643787757985053`*^9}, {3.6643788182598*^9, 3.6643788941503944`*^9}, {
   3.66437899346207*^9, 3.6643790368084106`*^9}, {3.6643790691875763`*^9, 
   3.6643790881780653`*^9}, {3.6643791324721327`*^9, 3.664379150345394*^9}, {
   3.6643792641997137`*^9, 3.664379333997941*^9}, {3.664379376377523*^9, 
   3.664379627762089*^9}, {3.664379658135396*^9, 3.6643797377736797`*^9}, {
   3.6643797728147697`*^9, 3.664379776755887*^9}, {3.664379808314254*^9, 
   3.6643801182673388`*^9}, 3.664380411370533*^9, {3.664380448339326*^9, 
   3.664380462606845*^9}, {3.664383760702175*^9, 3.664383858917156*^9}, {
   3.664383896962658*^9, 3.664383924080016*^9}, {3.664384211934972*^9, 
   3.664384212105555*^9}, {3.66438436031212*^9, 3.664384365252325*^9}, {
   3.664384397459055*^9, 3.6643843975947638`*^9}, {3.664384640170249*^9, 
   3.6643846443418503`*^9}, {3.664384734260508*^9, 3.6643849106069517`*^9}, {
   3.6643849767097607`*^9, 3.664385082392219*^9}, {3.664385139682694*^9, 
   3.664385300087737*^9}, {3.6643853979268103`*^9, 3.664385443123356*^9}, {
   3.6643854948266582`*^9, 3.6643856070534563`*^9}, {3.664386942667128*^9, 
   3.664386969395652*^9}, {3.664387006378991*^9, 3.6643870917364197`*^9}, {
   3.664387263931241*^9, 3.664387264044447*^9}, {3.664389126059265*^9, 
   3.6643891551634502`*^9}, {3.6643893173171997`*^9, 3.664389326301079*^9}, {
   3.664389835391206*^9, 3.6643898394696217`*^9}, {3.6643960326953487`*^9, 
   3.6643960577408257`*^9}, {3.6643965913813143`*^9, 3.664396606623172*^9}, {
   3.664396989969396*^9, 3.664397001291065*^9}, {3.66439703413992*^9, 
   3.664397040164289*^9}, {3.664397101694104*^9, 3.664397110083139*^9}, {
   3.6643995516362343`*^9, 3.664399552497649*^9}, {3.664399770573741*^9, 
   3.664399770751679*^9}, {3.6643999302177267`*^9, 3.6643999305382032`*^9}, {
   3.66439996232821*^9, 3.664399988753824*^9}, {3.664400217571435*^9, 
   3.664400224777541*^9}, 3.6644003184102993`*^9, {3.6644012324341917`*^9, 
   3.664401232664691*^9}, {3.664401313756671*^9, 3.664401340646018*^9}, {
   3.6644013841076593`*^9, 3.664401482782634*^9}, {3.664401550424164*^9, 
   3.66440155095263*^9}, {3.66440171265205*^9, 3.664401715834909*^9}, 
   3.664402425661371*^9, {3.6644026941977253`*^9, 3.664402874066979*^9}, 
   3.664402915316906*^9, {3.664403020086631*^9, 3.664403112821315*^9}, {
   3.664403145311193*^9, 3.664403199847135*^9}, {3.664403230750238*^9, 
   3.664403263097908*^9}, 3.664403296656249*^9, {3.6644107103867083`*^9, 
   3.6644107346280203`*^9}, {3.6644107662790003`*^9, 3.664410770412814*^9}, 
   3.664410807585946*^9, {3.6644109061267242`*^9, 3.664410906688299*^9}, {
   3.664411038486785*^9, 3.6644110489383163`*^9}, {3.6644114117156367`*^9, 
   3.6644115415330114`*^9}, {3.6644116084696074`*^9, 3.6644116138825645`*^9}, 
   3.664411693969371*^9, {3.6644117244221363`*^9, 3.664411739101136*^9}, {
   3.664411942582136*^9, 3.664412006703658*^9}, {3.6644129133436637`*^9, 
   3.6644129139364367`*^9}, {3.6644129852564363`*^9, 3.664413001105325*^9}, {
   3.664413041382718*^9, 3.6644130837816153`*^9}, {3.6644131273816586`*^9, 
   3.6644132034126472`*^9}, {3.664413334462366*^9, 3.6644133463022346`*^9}, {
   3.664413470847046*^9, 3.6644134817353573`*^9}, {3.664413576594701*^9, 
   3.664413578794202*^9}, {3.664413651455742*^9, 3.6644137192347*^9}, 
   3.664413845859901*^9, {3.6644140937816095`*^9, 3.6644141028136044`*^9}, {
   3.664414150516264*^9, 3.6644142674330173`*^9}, {3.664414363524705*^9, 
   3.6644143705755887`*^9}, {3.664414418481039*^9, 3.6644144224120626`*^9}, {
   3.664414457089307*^9, 3.6644144603027625`*^9}, 3.664414996731491*^9, {
   3.664415032219898*^9, 3.66441503284387*^9}, {3.664415213873747*^9, 
   3.6644152176019793`*^9}, {3.6644152486289873`*^9, 3.664415306081209*^9}, {
   3.6644251916161156`*^9, 3.6644252075430007`*^9}, {3.664425261407384*^9, 
   3.664425330980262*^9}, 3.6644253769825974`*^9, {3.6644254578649683`*^9, 
   3.664425460095668*^9}, {3.664425499608695*^9, 3.664425502182579*^9}, {
   3.664425572878607*^9, 3.6644256355565944`*^9}, {3.6644256805605745`*^9, 
   3.664425753440504*^9}, {3.664425945436689*^9, 3.664425945920267*^9}, 
   3.6644264153188033`*^9, {3.6644264508540087`*^9, 3.6644264577488995`*^9}, {
   3.664426551422696*^9, 3.6644265669439993`*^9}, 3.6644268087175503`*^9, {
   3.664427312403348*^9, 3.6644273134485006`*^9}, {3.664427346425421*^9, 
   3.5791013177018394`*^9}, {3.579101392644371*^9, 3.5791013988687816`*^9}, {
   3.579101446246065*^9, 3.5791014482116685`*^9}, {3.5791014790841227`*^9, 
   3.579101497913356*^9}, {3.5791015468818417`*^9, 3.579101551109449*^9}, {
   3.5791016212783723`*^9, 3.579101638235602*^9}, {3.5791017748762417`*^9, 
   3.579101953168955*^9}, {3.5791019890802183`*^9, 3.5791020738663673`*^9}, {
   3.579102338910833*^9, 3.579102393152128*^9}, {3.5791024441018176`*^9, 
   3.57910244552142*^9}, {3.5791025065643272`*^9, 3.5791025214311533`*^9}, {
   3.5791043399107475`*^9, 3.579104417052883*^9}, {3.579104531182683*^9, 
   3.5791045626791387`*^9}, {3.5791045958759966`*^9, 3.579104631350459*^9}, {
   3.5791046817541475`*^9, 3.5791047467126617`*^9}, 3.579104849875643*^9, {
   3.579104903352537*^9, 3.579104904288539*^9}, {3.5791051745902133`*^9, 
   3.5791053151308603`*^9}, {3.579105370760558*^9, 3.5791053887317896`*^9}, {
   3.579105419058243*^9, 3.579105430493063*^9}, {3.5791055073231974`*^9, 
   3.5791055226112247`*^9}, {3.57910557120531*^9, 3.5791056117341814`*^9}, {
   3.579105709546353*^9, 3.579105811976133*^9}, {3.579105856607811*^9, 
   3.579105862988222*^9}, {3.579105980487629*^9, 3.579106019659298*^9}, {
   3.579106092839026*^9, 3.5791061032754445`*^9}, {3.579106176876374*^9, 
   3.5791061785143766`*^9}, {3.579106421843604*^9, 3.5791064232788067`*^9}, {
   3.579106484274914*^9, 3.5791065150225677`*^9}, {3.5791076138692374`*^9, 
   3.579107664312126*^9}, {3.5791077211334267`*^9, 3.579107722490629*^9}, {
   3.664503247769308*^9, 3.6645032616203794`*^9}, {3.6645036302909627`*^9, 
   3.6645036683861923`*^9}, {3.6645037395845146`*^9, 3.664503739804515*^9}, {
   3.664629866262273*^9, 3.664629873358823*^9}, {3.664720573962131*^9, 
   3.664720578230155*^9}, {3.6647208633741426`*^9, 3.6647208635218678`*^9}, {
   3.664721042366081*^9, 3.579143475264558*^9}, {3.5791435233594427`*^9, 
   3.579143526526248*^9}, {3.66491768720894*^9, 3.6649177005461483`*^9}, {
   3.664919372174645*^9, 3.66491944521907*^9}, {3.6649195482031803`*^9, 
   3.664919549809482*^9}, {3.6649196617555428`*^9, 3.6649197093849173`*^9}, {
   3.664923062831766*^9, 3.5792237225545096`*^9}, 3.579223807231458*^9, {
   3.57922984547178*^9, 3.5792299406019135`*^9}, {3.5792303061324253`*^9, 
   3.5792303685325127`*^9}, {3.579230399797556*^9, 3.57923042399759*^9}, {
   3.579230461212642*^9, 3.5792304704926553`*^9}, {3.579230505897705*^9, 
   3.579230507317707*^9}, {3.5792307420181007`*^9, 3.57923075606812*^9}, {
   3.579230927998516*^9, 3.5792309478865457`*^9}, {3.5792311054944077`*^9, 
   3.5792312797448964`*^9}, {3.5792313098450336`*^9, 
   3.5792313915201535`*^9}, {3.579231439251319*^9, 3.579231456917346*^9}, {
   3.5792318921564484`*^9, 3.579231988959591*^9}, 3.5792320481136785`*^9, 
   3.579232172913862*^9, {3.5792322238779364`*^9, 3.579232244380966*^9}, {
   3.5792322865210285`*^9, 3.579232298944047*^9}, {3.5792325059433503`*^9, 
   3.5792325324963884`*^9}, {3.5792326084515*^9, 3.5792326085815*^9}, {
   3.5792326565525703`*^9, 3.5792326603025756`*^9}, {3.5792327478537045`*^9, 
   3.5792327543637133`*^9}, {3.5792328333638296`*^9, 
   3.5792329074169383`*^9}, {3.579233000379075*^9, 3.579233056257156*^9}, {
   3.579233093841211*^9, 3.5792332008523674`*^9}, {3.57923323673742*^9, 
   3.57923325055344*^9}, {3.5792333531985903`*^9, 3.579233356187596*^9}, {
   3.5792335770259185`*^9, 3.5792335772459188`*^9}, {3.5792397554574556`*^9, 
   3.579239766502275*^9}, {3.579364712455144*^9, 3.5793647640444345`*^9}, {
   3.5793687257416515`*^9, 3.579368754811692*^9}, {3.579368892981886*^9, 
   3.579368893501887*^9}, {3.5793689881870193`*^9, 3.579369072197137*^9}, {
   3.579370071958536*^9, 3.5793700850185547`*^9}, {3.5793704449790587`*^9, 
   3.579370448429064*^9}, {3.5793704907841225`*^9, 3.5793704909141235`*^9}, {
   3.57938280729539*^9, 3.5793828234102182`*^9}, {3.579382881376321*^9, 
   3.5793829720374813`*^9}, {3.579387756430097*^9, 3.579387812610796*^9}, {
   3.5793878496814613`*^9, 3.5793878517406654`*^9}, {3.5793880440752044`*^9, 
   3.579388053388421*^9}, {3.5793884485957603`*^9, 3.5793885025632553`*^9}, {
   3.5793885946170177`*^9, 3.5793885950382185`*^9}, {3.57938874684389*^9, 
   3.5793887487158937`*^9}, {3.5793889544038544`*^9, 3.579389010548353*^9}, {
   3.579389055351632*^9, 3.5793890609520416`*^9}, {3.5793891074245234`*^9, 
   3.5793891313861656`*^9}, 3.5793891883262653`*^9, {3.579389244595564*^9, 
   3.5793892674028044`*^9}, {3.5793896831591344`*^9, 
   3.5793896930183516`*^9}, {3.5793898857410903`*^9, 
   3.5793898938999047`*^9}, {3.57939072840777*^9, 3.579390765442236*^9}, 
   3.5793909777898083`*^9, {3.579391077005983*^9, 3.579391215222225*^9}, {
   3.5793913484932594`*^9, 3.579391368804495*^9}, {3.5793914127341723`*^9, 
   3.5793914453382297`*^9}, {3.579393121093173*^9, 3.579393121217973*^9}, {
   3.579393188656892*^9, 3.579393191589697*^9}, {3.665155653170054*^9, 
   3.6651556727274923`*^9}, {3.665155952730616*^9, 3.665155984235865*^9}, {
   3.665156232108789*^9, 3.665156238452619*^9}, 3.665156301052876*^9, {
   3.6653136331244793`*^9, 3.66531363445881*^9}, {3.665315483517898*^9, 
   3.665315485387439*^9}, {3.665319270731868*^9, 3.6653192885525703`*^9}, {
   3.665319343450713*^9, 3.6653193617309303`*^9}, {3.6653202333990993`*^9, 
   3.6653202631219397`*^9}, {3.665320323298532*^9, 3.6653203738028727`*^9}, {
   3.66532042466681*^9, 3.665320526870161*^9}, {3.665320559388376*^9, 
   3.6653205974727793`*^9}, {3.6653206320292377`*^9, 3.665320702701477*^9}, {
   3.665320789303112*^9, 3.665320844746839*^9}, {3.665321684382744*^9, 
   3.665321698955262*^9}, {3.665322417914447*^9, 3.665322418140444*^9}, {
   3.6653293654966383`*^9, 3.6653293769463654`*^9}, {3.665329700037822*^9, 
   3.665329869411096*^9}, {3.66532990543283*^9, 3.665329969251926*^9}, 
   3.665330034907969*^9, {3.66533008269551*^9, 3.6653302892979937`*^9}, {
   3.6653537538434753`*^9, 3.6653537676818047`*^9}, {3.665353889552568*^9, 
   3.6653538970096283`*^9}, {3.665354148872058*^9, 3.665354319757516*^9}, {
   3.665354404116235*^9, 3.6653544084544563`*^9}, {3.665354451786783*^9, 
   3.665354458288623*^9}, {3.665354552245203*^9, 3.665354593412459*^9}, {
   3.665354630437118*^9, 3.665354635837174*^9}, {3.6653623997590303`*^9, 
   3.6653624713881073`*^9}, {3.665362503153756*^9, 3.665362529585841*^9}, {
   3.6653625842557077`*^9, 3.665362646331914*^9}, {3.66536267886961*^9, 
   3.665362700781596*^9}, {3.665362808252286*^9, 3.6653628103157263`*^9}, {
   3.6653628701797*^9, 3.665362911942699*^9}, {3.665411898053234*^9, 
   3.665411986643367*^9}, {3.6655070590573473`*^9, 3.665507268039049*^9}, {
   3.665516109399736*^9, 3.6655162155018167`*^9}, {3.665516250289021*^9, 
   3.665516305077403*^9}, {3.66551634852159*^9, 3.665516408616397*^9}, {
   3.665516449876602*^9, 3.665516460388959*^9}, {3.665516533970954*^9, 
   3.665516559160843*^9}, {3.665516596192904*^9, 3.66551659702839*^9}, {
   3.6655179406956053`*^9, 3.665518036223771*^9}, {3.665518368516592*^9, 
   3.665518368985177*^9}, {3.665518408402721*^9, 3.665518408672742*^9}, {
   3.6655184598681393`*^9, 3.6655185119815598`*^9}, {3.6655187852806377`*^9, 
   3.665518846380645*^9}, {3.665518930328855*^9, 3.6655189608262157`*^9}, {
   3.6655190838692303`*^9, 3.665519112708597*^9}, {3.665519570622774*^9, 
   3.6655195911706133`*^9}, 3.6655196751508713`*^9, {3.6655199200214233`*^9, 
   3.66551992610221*^9}, {3.665519956417096*^9, 3.665520010374773*^9}, {
   3.6655200661447763`*^9, 3.6655200723881493`*^9}, {3.665520121537911*^9, 
   3.665520156387735*^9}, {3.665520516292292*^9, 3.665520530410667*^9}, {
   3.665520580166857*^9, 3.665520593075432*^9}, {3.665525900988181*^9, 
   3.665525913596718*^9}, {3.6655259458002462`*^9, 3.66552599389851*^9}, {
   3.665530659152673*^9, 3.665530749117818*^9}, {3.665531006727457*^9, 
   3.665531012618288*^9}, {3.6655310570572*^9, 3.579835184899144*^9}, {
   3.5798353663864155`*^9, 3.5798353751124296`*^9}, {3.5798355446016803`*^9, 
   3.57983556410371*^9}, {3.5798357942010593`*^9, 3.5798358501381435`*^9}, {
   3.5798359586663055`*^9, 3.579836000328369*^9}, {3.579836051251446*^9, 
   3.57983610711553*^9}, {3.5798361442875853`*^9, 3.5798361445425863`*^9}, {
   3.579836189563654*^9, 3.5798361957236624`*^9}, {3.5798362361837234`*^9, 
   3.579836281772793*^9}, {3.57983631361284*^9, 3.5798363534678993`*^9}, {
   3.5798376752678857`*^9, 3.5798376773178883`*^9}, {3.665692312386063*^9, 
   3.665692323616651*^9}, {3.6657012992760878`*^9, 3.665701313597506*^9}, {
   3.6657073357365303`*^9, 3.6657073471042757`*^9}, {3.665873608824472*^9, 
   3.665873642887527*^9}, {3.6658739801783648`*^9, 3.6658739840301247`*^9}, {
   3.665874350706959*^9, 3.665874376789393*^9}, {3.665874414336656*^9, 
   3.6658744415162497`*^9}, {3.6658746424203*^9, 3.665874642699811*^9}, {
   3.665875009783518*^9, 3.665875012335511*^9}, {3.665875767193769*^9, 
   3.665875851648567*^9}, {3.665875889504903*^9, 3.665875898257286*^9}, {
   3.6658760339049997`*^9, 3.665876046019889*^9}, {3.66587611481278*^9, 
   3.6658761168312483`*^9}, {3.665876151708403*^9, 3.665876185861714*^9}, {
   3.665876229372375*^9, 3.66587625798153*^9}, {3.665876329416493*^9, 
   3.665876364817347*^9}, {3.6658828488939*^9, 3.665882896218191*^9}, {
   3.6658830378618*^9, 3.665883041742571*^9}, {3.665884972988318*^9, 
   3.665885004489945*^9}, {3.665891498088623*^9, 3.665891608916717*^9}, {
   3.66589177589832*^9, 3.6658920026287622`*^9}, 3.66589233479408*^9, {
   3.665892388577619*^9, 3.6658923891198473`*^9}, {3.6660418459677963`*^9, 
   3.5803448972215495`*^9}, {3.5803449472820377`*^9, 
   3.5803449599492598`*^9}, {3.581218323163785*^9, 3.581218550485114*^9}, {
   3.581218601003188*^9, 3.5812186431882486`*^9}, {3.5812186738862934`*^9, 
   3.581218791724464*^9}, {3.581221126450881*^9, 3.5812211619769325`*^9}, {
   3.581221193056977*^9, 3.5812211965229826`*^9}, {3.581221285726111*^9, 
   3.5812212890711155`*^9}, {3.5812213485432024`*^9, 
   3.5812213521382074`*^9}, {3.6669666475340843`*^9, 
   3.5760950472909636`*^9}, {3.576095083706046*^9, 3.5760953242478046`*^9}, {
   3.5760953636400576`*^9, 3.57609538798345*^9}, 3.576096123371512*^9, {
   3.5761093108885565`*^9, 3.5761094790811768`*^9}, {3.6765010780137415`*^9, 
   3.6765011100609856`*^9}, {3.6765015705367603`*^9, 
   3.6711199953273206`*^9}, {3.6711203767400804`*^9, 3.67112039822581*^9}, {
   3.6955735168679123`*^9, 3.6955735269180803`*^9}, {3.69557365623759*^9, 
   3.695573661153927*^9}, {3.6955743086197767`*^9, 3.6955743379288387`*^9}, {
   3.695574386997735*^9, 3.69557444501509*^9}, {3.6955744934489813`*^9, 
   3.69557450078314*^9}, {3.6955745393748417`*^9, 3.695574601338811*^9}, {
   3.695576065426179*^9, 3.695576072645453*^9}, {3.695586015144899*^9, 
   3.695586015541889*^9}, {3.7016102820605392`*^9, 3.701610295020389*^9}, {
   3.70161033822831*^9, 3.70161034223608*^9}, {3.701610390830145*^9, 
   3.701610435937057*^9}, {3.7016104836167593`*^9, 3.701610605282909*^9}, {
   3.7016106570181913`*^9, 3.7016107282060423`*^9}, {3.701610776997466*^9, 
   3.7016108158858557`*^9}, {3.701611088705503*^9, 3.7016111148593473`*^9}, {
   3.7016113622546673`*^9, 3.701611543039525*^9}, {3.701611602177477*^9, 
   3.7016117130029697`*^9}, {3.7016118187407312`*^9, 
   3.7016118189038754`*^9}, {3.7016171895501432`*^9, 3.701617466456451*^9}, {
   3.701617506768882*^9, 3.701617571859807*^9}, {3.701617619989266*^9, 
   3.7016176298596888`*^9}, {3.701640317313418*^9, 3.7016403178082943`*^9}, {
   3.701640456617087*^9, 3.701640458254882*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["norm", "Subsection",
 CellChangeTimes->{{3.580344837769845*^9, 3.5803448408898506`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"K", "/", "k"}], " ", "norm", " ", "of", " ", "a", " ", 
    "function", "\n", "\t", "we", " ", "first", " ", "compute", " ", "the", 
    " ", "matrix", " ", "representing", " ", "the", " ", "action", " ", "of", 
    " ", "the", " ", "function", " ", "on", " ", "the", " ", "basis", "\n", 
    "\t", "then", " ", "take", " ", "the", " ", "determinant", " ", "of", " ",
     "this", " ", "matrix"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"PieceNorm", "[", 
     RowBox[{"x_", ",", "P_", ",", 
      RowBox[{"{", 
       RowBox[{"num1_", ",", "den1_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "num1", "]"}]}], ",", "A", ",", "diag", ",", 
        "num", ",", "numgcd", ",", "den", ",", "gcd"}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "num1", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "*", 
                  RowBox[{"P", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x",
                ",", "nf"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
          "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"den", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"den1", "^", "n"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"gcd", "=", 
        RowBox[{"PolyGCD", "[", 
         RowBox[{"gcd", ",", "num", ",", "x", ",", "nf"}], "]"}]}], ";", 
       RowBox[{"gcd", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"gcd", "*", 
           RowBox[{"PolyLC", "[", 
            RowBox[{"den", ",", "x"}], "]"}]}], ",", "x", ",", "nf"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"num", "=", 
        RowBox[{"PolyDivide", "[", 
         RowBox[{"num", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"den", "=", 
        RowBox[{"PolyDivide", "[", 
         RowBox[{"den", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"{", 
        RowBox[{"num", ",", "den"}], "}"}]}]}], "\n", "]"}]}], 
   ";"}]}]], "Code",
 CellChangeTimes->{{3.666041855620018*^9, 3.666041907327276*^9}, {
  3.666042249791843*^9, 3.666042301313266*^9}, {3.6660423953856916`*^9, 
  3.666042580759583*^9}, {3.666042621438669*^9, 3.580344935114016*^9}, {
  3.5812188259475136`*^9, 3.581218917362647*^9}, {3.6669662638723183`*^9, 
  3.666966265727559*^9}, {3.666966434061187*^9, 3.666966533155094*^9}, {
  3.666966672203805*^9, 3.666966676648199*^9}, {3.686604173572329*^9, 
  3.6866041766065207`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["basis change", "Subsection",
 CellChangeTimes->{{3.5803448813563213`*^9, 3.58034488602073*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "if", " ", "w", " ", "and", " ", "v", " ", "are", " ", "two", " ", 
      "bases", " ", "related", " ", "by", " ", 
      RowBox[{"M", ".", "w"}]}], "=", "v"}], ",", " ", 
    RowBox[{
    "calculate", " ", "the", " ", "product", " ", "array", " ", "for", " ", 
     "w", " ", "given", " ", "the", " ", "product", " ", "array", " ", "for", 
     " ", "v"}]}], "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"changing", " ", "the", " ", "basis", " ", "is", " ", "O", 
    RowBox[{"(", 
     RowBox[{"n", "^", "4"}], ")"}], " ", "polynomial", " ", "operations"}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"O", 
     RowBox[{"(", 
      RowBox[{"n", "^", "6"}], ")"}], " ", "brute", " ", "force", " ", 
     RowBox[{"solution", ":", "  ", "P"}]}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PolynomialExactQuotient", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalNu]i", "\[LeftDoubleBracket]", 
              RowBox[{"a", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"\[CapitalNu]i", "\[LeftDoubleBracket]", 
              RowBox[{"b", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"P", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j", ",", "k"}], "\[RightDoubleBracket]"}], 
             "*", 
             RowBox[{"\[CapitalNu]", "\[LeftDoubleBracket]", 
              RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], ",", 
            "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "k2", ",", 
        "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ChangeTimesBasis", "[", 
     RowBox[{"x_", ",", "P_", ",", "M_", ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nP", ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "P", "]"}]}], ",", "A", ",", "d"}], "}"}], 
      ",", "\n", "\t", 
      RowBox[{
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "M", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}], 
                 ".", "M"}], ",", "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "M"}], 
           "]"}], "}"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"PolyGaussJordanReduce", "[", 
         RowBox[{"A", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"d", "=", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"A", "=", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ";;", 
           RowBox[{"n", "*", 
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}]}]}]}], 
         "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{"A", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], ";", "\n", 
       "\t", 
       RowBox[{"A", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"M", ",", "A"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"PolyGaussJordanReduce", "[", 
         RowBox[{"A", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"n", "+", "1"}], ";;", 
           RowBox[{"n", "*", 
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}]}]}]}], 
         "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", "A"}], "]"}], ",", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{"d", ",", "x", ",", "nf"}], "]"}]}], "}"}]}]}], "\n", 
     "]"}]}], ";"}]}]], "Code",
 CellChangeTimes->{{3.665891499541421*^9, 3.5812190439628305`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["D", "Subsection",
 CellChangeTimes->{{3.5803448518254695`*^9, 3.580344853510273*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"derivative", " ", "wrt", " ", "x", "  ", 
    RowBox[{"(", 
     RowBox[{"M", ",", "e"}], ")"}], " ", "is", " ", "the", " ", "derivative",
     " ", "matrix"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"PieceDiff", "[", 
     RowBox[{"x_", ",", "P_", ",", 
      RowBox[{"{", 
       RowBox[{"M_", ",", "e_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"num1_", ",", "den1_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "num1", "]"}]}], ",", "A", ",", "diag", ",", 
        "num", ",", "numgcd", ",", "den", ",", "gcd"}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "num1", "]"}], "===", 
         RowBox[{"{", "n", "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "M", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "P", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       
       RowBox[{"num", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"den1", "*", 
            RowBox[{"num1", ".", "M"}]}], "+", 
           RowBox[{"den1", "*", "e", "*", 
            RowBox[{"D", "[", 
             RowBox[{"num1", ",", "x"}], "]"}]}], "-", 
           RowBox[{"e", "*", 
            RowBox[{"D", "[", 
             RowBox[{"den1", ",", "x"}], "]"}], "*", "num1"}]}], ",", "x", 
          ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"den", "=", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{"e", "*", 
           RowBox[{"den1", "^", "2"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"gcd", "=", "den"}], ";", 
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gcd", "=", 
            RowBox[{"PolyGCD", "[", 
             RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
          "&"}], ",", "num"}], "]"}], ";", 
       RowBox[{"gcd", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"gcd", "*", 
           RowBox[{"PolyLC", "[", 
            RowBox[{"den", ",", "x"}], "]"}]}], ",", "x"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"num", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyDivide", "[", 
            RowBox[{"#", ",", "gcd", ",", "x", ",", "nf"}], "]"}], "&"}], ",",
           "num"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"den", "=", 
        RowBox[{"PolyDivide", "[", 
         RowBox[{"den", ",", "gcd", ",", "x", ",", "nf"}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"{", 
        RowBox[{"num", ",", "den"}], "}"}]}]}], "\n", "]"}]}], 
   ";"}]}]], "Code",
 CellChangeTimes->{{3.665318768110581*^9, 3.665318890891767*^9}, {
  3.665318932108612*^9, 3.5803449039763613`*^9}, {3.581219211248073*^9, 
  3.5812192768641677`*^9}, {3.667230017506811*^9, 3.667230044068164*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["old", "Subsection",
 CellChangeTimes->{{3.5803448572854795`*^9, 3.5803448589858823`*^9}, {
  3.667230049370009*^9, 3.667230050633882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "give", " ", "the", " ", "action", " ", "of", " ", "the", " ", "D", " ", 
    "operator", " ", "on", " ", "the", " ", "integral", " ", "basis", " ", 
    "as", " ", 
    RowBox[{"M", "/", "d"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "currently", " ", "not", " ", "robust", " ", "and", " ", "relies", " ", 
    "on", " ", "Solve"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MakeDArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "curve_"}], "}"}], ",", "intbasis_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "intbasis", "]"}]}], ",", "U", ",", "tab", 
         ",", "sol", ",", "M", ",", "d"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"tab", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"CoefficientList", "[", 
            RowBox[{
             RowBox[{"PolynomialRemainder", "[", 
              RowBox[{"#", ",", "curve", ",", "y"}], "]"}], ",", "y"}], "]"}],
            "&"}], "/@", 
          RowBox[{"Collect", "[", 
           RowBox[{
            RowBox[{"Cancel", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"curve", ",", "y"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"tab", ".", "intbasis"}], "-", 
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"intbasis", "/.", 
                    RowBox[{"y", "\[Rule]", 
                    RowBox[{"y", "[", "x", "]"}]}]}], ",", "x"}], "]"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"y", "'"}], "[", "x", "]"}], "\[Rule]", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"D", "[", 
                    RowBox[{"curve", ",", "x"}], "]"}]}], "/", 
                    RowBox[{"D", "[", 
                    RowBox[{"curve", ",", "y"}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"y", "[", "x", "]"}], "\[Rule]", "y"}]}], "}"}]}], 
               ")"}]}], "]"}], ",", "y"}], "]"}]}]}], ";", "\n", "\t", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "sol", "]"}], "\[Equal]", "0"}], "]"}], 
            ",", 
            RowBox[{"Flatten", "[", "tab", "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"M", "=", 
         RowBox[{"tab", "/.", "sol"}]}], ";", "\n", "\t", 
        RowBox[{"d", "=", 
         RowBox[{"Factor", "[", 
          RowBox[{"PolynomialLCM", "@@", 
           RowBox[{"Denominator", "[", 
            RowBox[{"Flatten", "[", "M", "]"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"M", "=", 
         RowBox[{"Cancel", "[", 
          RowBox[{"M", "*", "d"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{
            RowBox[{"UniPolynomialGCD", "[", 
             RowBox[{"d", ",", 
              RowBox[{"D", "[", 
               RowBox[{"d", ",", "x"}], "]"}]}], "]"}], ",", "x"}], "]"}], "===",
           "0"}], "]"}], ";", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"M", ",", "d"}], "}"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BasisOfMultiples", "[", 
      RowBox[{"gg_", ",", "wwi_", ",", "fxn_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "=", "fxn"}], ",", 
         RowBox[{"wi", "=", "wwi"}], ",", 
         RowBox[{"g", "=", "gg"}], ",", "tab", ",", "sol", ",", "U", ",", 
         "gM", ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "wwi", "]"}]}]}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"tab", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"sol", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CoefficientList", "[", 
             RowBox[{
              RowBox[{"PolynomialRemainder", "[", 
               RowBox[{"#", ",", "f", ",", "y"}], "]"}], ",", "y"}], "]"}], 
            "&"}], ",", 
           RowBox[{
            RowBox[{"g", "*", "wi"}], "-", 
            RowBox[{"tab", ".", "wi"}]}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"sol", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "sol", "]"}], "\[Equal]", "0"}], "]"}], 
           ",", 
           RowBox[{"Flatten", "[", "tab", "]"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"gM", "=", 
         RowBox[{"Cancel", "[", 
          RowBox[{"Together", "[", 
           RowBox[{"tab", "/.", 
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", "\n", 
        "\t", "gM"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"MakeTimesArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "curve_"}], "}"}], ",", "intbasis_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "intbasis", "]"}]}], ",", "e"}], "}"}], ",", 
      "\n", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "=", 
          RowBox[{"ToPiece", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "curve"}], "}"}], ",", "intbasis", 
            ",", 
            RowBox[{
             RowBox[{
             "intbasis", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "intbasis", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", 
         RowBox[{"Assert", "[", 
          RowBox[{
           RowBox[{
           "e", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "===",
            "1"}], "]"}], ";", 
         RowBox[{
         "e", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "\n", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.665321142790531*^9, 3.665321354800654*^9}, {
   3.665321389057054*^9, 3.665321392113278*^9}, {3.6653223068353*^9, 
   3.665322308516321*^9}, {3.6653223437001963`*^9, 3.66532235036406*^9}, 
   3.665322424715873*^9, {3.665329706867249*^9, 3.665329709500206*^9}, {
   3.6672300518609743`*^9, 3.66723005542118*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["divisors", "Section",
 CellChangeTimes->{{3.665680371192465*^9, 3.665680375358068*^9}, {
  3.666041430913245*^9, 3.666041431112874*^9}}],

Cell[CellGroupData[{

Cell["misc", "Subsection",
 CellChangeTimes->{{3.580343332537469*^9, 3.580343335610674*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"given", " ", "a", " ", 
     RowBox[{"k", "[", "x", "]"}], " ", "module", " ", "in", " ", "terms", 
     " ", "of", " ", "integral", " ", "basis", " ", 
     RowBox[{"w", "[", "1", "]"}]}], ",", "...", ",", 
    RowBox[{
     RowBox[{"w", "[", "n", "]"}], " ", "as", " ", 
     RowBox[{"M", "/", "d"}]}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
    "produce", " ", "a", " ", "similar", " ", "representation", " ", "for", 
     " ", "various", " ", "operations", "\n", "\t", "if", " ", "the", " ", 
     "ideals", " ", "are", " ", "over", " ", "a", " ", "number", " ", 
     "field"}], ",", " ", 
    RowBox[{"all", " ", "of", " ", "the", " ", "fields", " ", "should", " ", 
     RowBox[{"match", "!"}], " ", "otherwise", " ", "arithmetic", " ", "is", 
     " ", "not", " ", "automatic"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "also", " ", "need", " ", "a", " ", "n", "\[Times]", "n", 
     "\[Times]", "n", " ", "array", " ", "P", " ", "which", " ", "satisfies", 
     " ", 
     RowBox[{"w", "[", "i", "]"}], 
     RowBox[{"w", "[", "j", "]"}]}], "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
       RowBox[{"w", "[", "k", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IdealPrint", "[", 
      RowBox[{"{", 
       RowBox[{"M1_List", ",", "d1_"}], "}"}], "]"}], ":=", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "d1"}], ",", "\"\<*\>\"", ",", 
        RowBox[{"MatrixForm", "[", "M1", "]"}]}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DivisorPrint", "[", 
      RowBox[{"{", 
       RowBox[{"fin_", ",", "inf_"}], "}"}], "]"}], ":=", 
     RowBox[{"\"\<div\>\"", "[", 
      RowBox[{
       RowBox[{"IdealPrint", "[", "fin", "]"}], ",", 
       RowBox[{"IdealPrint", "[", "inf", "]"}]}], "]"}]}], ";"}]}]}]], "Code",\

 CellChangeTimes->{{3.6653160582985077`*^9, 3.66531610171128*^9}, {
   3.665316213073312*^9, 3.665316516954924*^9}, {3.665317235091547*^9, 
   3.6653172532025557`*^9}, {3.6653173108748703`*^9, 3.665317314439423*^9}, {
   3.6653173519551477`*^9, 3.665317355106654*^9}, {3.665317420663553*^9, 
   3.6653174212507477`*^9}, {3.665317576924582*^9, 3.66531772519576*^9}, {
   3.665317755717791*^9, 3.665317794733492*^9}, {3.665317832737063*^9, 
   3.665317855441175*^9}, {3.66531792603846*^9, 3.665317976269422*^9}, {
   3.665318166577044*^9, 3.6653181985153913`*^9}, {3.665318275577978*^9, 
   3.66531827942649*^9}, {3.665318565810926*^9, 3.665318598469051*^9}, {
   3.665322948315176*^9, 3.665322950280086*^9}, {3.6656803842482357`*^9, 
   3.6656804637279263`*^9}, {3.665681631307973*^9, 3.665681632313232*^9}, {
   3.665689192402532*^9, 3.665689214842456*^9}, {3.665689249881893*^9, 
   3.665689424365315*^9}, {3.665689738623601*^9, 3.665689774666358*^9}, {
   3.665689902952633*^9, 3.6656899042438374`*^9}, {3.665690056167613*^9, 
   3.6656900859754257`*^9}, {3.665690127412435*^9, 3.665690128609076*^9}, {
   3.665690162478365*^9, 3.665690270845799*^9}, {3.665690420421356*^9, 
   3.665690447027917*^9}, {3.665691408155949*^9, 3.6656914801036987`*^9}, {
   3.66569151284571*^9, 3.665691516679208*^9}, {3.6656915699819603`*^9, 
   3.665691642958692*^9}, 3.665691677522787*^9, {3.6656917192034082`*^9, 
   3.665691753434774*^9}, {3.665691799797714*^9, 3.665691800335092*^9}, {
   3.66569212483484*^9, 3.665692170483645*^9}, {3.665692216033894*^9, 
   3.665692216412856*^9}, {3.665692359911997*^9, 3.665692565201206*^9}, {
   3.66569259975311*^9, 3.665692674290123*^9}, {3.665692711522792*^9, 
   3.665692764043331*^9}, {3.665692803958796*^9, 3.665692853752779*^9}, {
   3.665692965782659*^9, 3.665693111293078*^9}, 3.665693146889099*^9, {
   3.665693252294201*^9, 3.665693321944832*^9}, {3.6656934103574553`*^9, 
   3.6656934301553926`*^9}, {3.6656941784161987`*^9, 
   3.6656942395540543`*^9}, {3.665694416393755*^9, 3.665694416760359*^9}, {
   3.665694552545525*^9, 3.665694552719474*^9}, {3.665694590527314*^9, 
   3.66569460116359*^9}, {3.6656947659703617`*^9, 3.6656947944201927`*^9}, {
   3.665695060684903*^9, 3.665695176880086*^9}, {3.6656952334607697`*^9, 
   3.6656952387698402`*^9}, {3.665695274591413*^9, 3.66569535913833*^9}, 
   3.6656957470164137`*^9, {3.665698378314392*^9, 3.665698388675303*^9}, {
   3.665698425732033*^9, 3.6656985393586693`*^9}, {3.665698573552331*^9, 
   3.665698606031228*^9}, {3.6656986428100643`*^9, 3.665698966876458*^9}, {
   3.6656990245511436`*^9, 3.6656990271513147`*^9}, {3.665699445800664*^9, 
   3.665699456890334*^9}, {3.665699508651432*^9, 3.665699523003728*^9}, {
   3.6656995959605293`*^9, 3.665699613291745*^9}, {3.665699676907846*^9, 
   3.665699678503481*^9}, {3.665699806599514*^9, 3.665699811278263*^9}, {
   3.66570332715803*^9, 3.665703500698935*^9}, {3.665703546533464*^9, 
   3.665703616216824*^9}, {3.6657036484671307`*^9, 3.665703894228416*^9}, {
   3.665704324720421*^9, 3.665704365012722*^9}, {3.665704425141039*^9, 
   3.665704436512465*^9}, {3.66570446698241*^9, 3.665704475841617*^9}, {
   3.66570673968522*^9, 3.665706748762936*^9}, {3.6657071050594788`*^9, 
   3.665707164755931*^9}, {3.665790776921771*^9, 3.665790789141799*^9}, {
   3.6657908449466143`*^9, 3.665790856953397*^9}, {3.665848913470031*^9, 
   3.665848929673459*^9}, {3.6658489947645817`*^9, 3.665849006981573*^9}, {
   3.665862165780817*^9, 3.6658621681861677`*^9}, 3.66586222524336*^9, {
   3.665862400703642*^9, 3.665862401201426*^9}, {3.665862460881773*^9, 
   3.665862522880172*^9}, {3.665862593419951*^9, 3.665862603027075*^9}, 
   3.6658626551165953`*^9, {3.6658626895206413`*^9, 3.665862799062277*^9}, {
   3.6658628345637283`*^9, 3.665862925211784*^9}, {3.665862963203532*^9, 
   3.665862980780119*^9}, {3.665863142141694*^9, 3.665863195121347*^9}, {
   3.6658632561888723`*^9, 3.66586332272579*^9}, {3.6658633539264297`*^9, 
   3.6658633848305273`*^9}, {3.6658634231604147`*^9, 
   3.6658634233835907`*^9}, {3.6658634974784307`*^9, 
   3.6658635378705482`*^9}, {3.665863586508898*^9, 3.6658635984758673`*^9}, {
   3.66586363600128*^9, 3.6658637565062*^9}, {3.6658638451061077`*^9, 
   3.665863988612184*^9}, {3.665864022333024*^9, 3.665864047582696*^9}, {
   3.665864081368753*^9, 3.665864168806147*^9}, {3.665864228429817*^9, 
   3.665864230579463*^9}, {3.6658645109869547`*^9, 3.66586451326668*^9}, {
   3.665864618529274*^9, 3.665864709468912*^9}, 3.6658647648883543`*^9, 
   3.6658650753494883`*^9, {3.665865120553022*^9, 3.6658651210901814`*^9}, {
   3.6658656459505043`*^9, 3.665865646282301*^9}, {3.66586571201476*^9, 
   3.665865714974141*^9}, {3.665865773692347*^9, 3.665865827569707*^9}, {
   3.665869726815527*^9, 3.6658697275477343`*^9}, {3.665869765175683*^9, 
   3.665869853446607*^9}, {3.6658701857820253`*^9, 3.66587018687195*^9}, {
   3.665870263173161*^9, 3.6658702677365103`*^9}, {3.665870320630556*^9, 
   3.665870358479919*^9}, {3.6658704757683477`*^9, 3.5803433649075255`*^9}, {
   3.6861612324971447`*^9, 3.686161232516389*^9}, {3.686174997734597*^9, 
   3.686175027051681*^9}, {3.68617507390145*^9, 3.686175096947935*^9}, {
   3.7022416657590027`*^9, 3.7022416697504663`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["ideal arithmetic", "Subsection",
 CellChangeTimes->{{3.665869912343129*^9, 3.5803451231879463`*^9}, {
  3.686174646910714*^9, 3.686174647711433*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdealStandardize", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"{", 
       RowBox[{"M_List", ",", "d_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "M", "]"}]}], ",", 
        RowBox[{"tab", "=", "M"}], ",", "gcd", ",", "a"}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "M", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
        "\t", 
       RowBox[{"gcd", "=", "d"}], ";", 
       RowBox[{"Scan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gcd", "=", 
            RowBox[{"PolyGCD", "[", 
             RowBox[{"gcd", ",", "#", ",", "x", ",", "nf"}], "]"}]}], ")"}], 
          "&"}], ",", "tab", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Table", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PolyLC", "[", 
                 RowBox[{
                  RowBox[{"tab", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
                  "x"}], "]"}], "*", "gcd"}], ",", "x", ",", "nf"}], "]"}]}], 
            ";", "\n", "\t\t\t", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyDivide", "[", 
               RowBox[{
                RowBox[{"tab", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "a",
                 ",", "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "\n", 
           "\t\t", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "\n", 
         "\t\t", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{"d", ",", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"gcd", "*", 
              RowBox[{"PolyLC", "[", 
               RowBox[{"d", ",", "x"}], "]"}]}], ",", "x", ",", "nf"}], "]"}],
            ",", "x", ",", "nf"}], "]"}]}], "\n", "\t", "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyLocalDivide", "[", 
    RowBox[{"a_", ",", "b_", ",", "d_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", "Y", ",", "res", ",", "pow", ",", 
       RowBox[{"c", "=", 
        RowBox[{"b", "/.", 
         RowBox[{"x", "\[Rule]", "0"}]}]}]}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"X", "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{
         RowBox[{"a", "/", "c"}], ",", "x", ",", "nf"}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"Y", "=", 
       RowBox[{"PolyCollect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "b"}], ")"}], "/", "c"}], ",", "x", ",", "nf"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"d", "<", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<d<0 in PolyLocalDivide\>\"", "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}], ",", 
        RowBox[{"d", "===", "0"}], ",", "0", ",", "\n", "\t", "True", ",", 
        "\n", "\t\t", 
        RowBox[{
         RowBox[{"res", "=", 
          RowBox[{"pow", "=", "1"}]}], ";", "\n", "\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"pow", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"pow", "*", "Y"}], ",", "x", ",", "nf"}], "]"}]}], ";",
             "\n", "\t\t\t", 
            RowBox[{"res", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"res", "+", "pow"}], ",", "x", ",", "nf"}], "]"}]}], 
            ";"}], "\n", "\t\t", ",", 
           RowBox[{"{", "d", "}"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"PolyRemainder", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"X", "*", "res"}], ",", "x", ",", "nf"}], "]"}], ",", 
           RowBox[{"x", "^", "d"}], ",", "x", ",", "nf"}], "]"}]}]}], "\n", 
       "\t", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdealStandardizeLocal", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"{", 
       RowBox[{"M_List", ",", "d_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "M", "]"}]}], ",", "num", ",", "den", ",", 
        RowBox[{"tab", "=", "M"}], ",", "ord", ",", "u", ",", "q"}], "}"}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Assert", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "M", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"ord", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"tab", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"1", "/", "x"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "first", " ", "multiply", " ", "rows", " ", "by", " ", "units", " ", 
         "to", " ", "make", " ", "monomial", " ", "diagonal"}], " ", "*)"}], 
       "\n", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"PolyDivide", "[", 
            RowBox[{
             RowBox[{"tab", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"x", "^", 
              RowBox[{
              "ord", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
              ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{
           RowBox[{"tab", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{"x", "^", 
            RowBox[{
            "ord", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
           ";", "\n", "\t\t", 
          RowBox[{"Do", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"tab", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"PolyLocalDivide", "[", 
               RowBox[{
                RowBox[{"tab", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", "u",
                 ",", 
                RowBox[{"Max", "[", "ord", "]"}], ",", "x", ",", "nf"}], 
               "]"}]}], ";"}], "\n", "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";"}], 
         "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"next", " ", "do", " ", "usual", " ", "reduction"}], " ", 
        "*)"}], "\[IndentingNewLine]", "\t", 
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "=", 
              RowBox[{"PolyQuotient", "[", 
               RowBox[{
                RowBox[{"tab", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"tab", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "j"}], "\[RightDoubleBracket]"}], ",", "x",
                 ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"q", "=!=", "0"}], ",", 
               RowBox[{
                RowBox[{
                "tab", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                 "=", 
                RowBox[{"PolyCollect", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "tab", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                    RowBox[{
                    "tab", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "q"}]}], ",", "x", ",", 
                  "nf"}], "]"}]}]}], "]"}], ";"}], "\n", "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ";"}], "\n", "\t", 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       
       RowBox[{"IdealStandardize", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"tab", ",", 
           RowBox[{"x", "^", 
            RowBox[{"-", 
             RowBox[{"Exponent", "[", 
              RowBox[{"d", ",", 
               RowBox[{"1", "/", "x"}]}], "]"}]}]}]}], "}"}], ",", "nf"}], 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealNormalForm", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"M_List", ",", "d_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"IdealStandardize", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PolyHermitianReduce", "[", 
        RowBox[{"M", ",", "x", ",", "nf"}], "]"}], ",", "d"}], "}"}], ",", 
     "nf"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealNormalFormLocal", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"M_List", ",", "d_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"IdealStandardizeLocal", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PolyHermitianReduce", "[", 
        RowBox[{"M", ",", "x", ",", "nf"}], "]"}], ",", "d"}], "}"}], ",", 
     "nf"}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.686174191184226*^9, 3.686174224100252*^9}, {
   3.686174754036426*^9, 3.68617475772843*^9}, {3.6864256633425694`*^9, 
   3.686425678951047*^9}, {3.686426035947084*^9, 3.686426041595991*^9}, {
   3.686427200706923*^9, 3.686427439452858*^9}, {3.6864276410782967`*^9, 
   3.686427648518531*^9}, {3.686427683607747*^9, 3.686427684588101*^9}, {
   3.686428717321426*^9, 3.6864287827716417`*^9}, {3.686428846418887*^9, 
   3.6864288466562243`*^9}, {3.686428960524822*^9, 3.686429036551927*^9}, {
   3.686429155595883*^9, 3.6864291728010483`*^9}, {3.68642930907705*^9, 
   3.68642935717715*^9}, 3.6864294768034353`*^9, {3.6864295118655157`*^9, 
   3.686429544128034*^9}, {3.686429656880066*^9, 3.686429660868572*^9}, {
   3.686429813230336*^9, 3.6864299043903933`*^9}, 3.686429936919083*^9, {
   3.686429982351886*^9, 3.686429990290028*^9}, {3.686431484641526*^9, 
   3.686431485218422*^9}, {3.686590254684516*^9, 3.686590372098468*^9}, {
   3.6865904536563883`*^9, 3.686590469544921*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DivisorTimes", "[", 
    RowBox[{"A_", ",", "B_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=",
    "\n", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"IdealTimes", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}], ",", 
     RowBox[{"IdealTimesLocal", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealTimes", "[", 
    RowBox[{"x_", ",", "P_List", ",", 
     RowBox[{"{", 
      RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M2_List", ",", "d2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "M1", "]"}]}], ",", "tab", ",", "gcd"}], "}"}],
      ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"M1", "\[LeftDoubleBracket]", 
                 RowBox[{"a", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                RowBox[{"M2", "\[LeftDoubleBracket]", 
                 RowBox[{"b", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                RowBox[{"P", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
             ",", "nf"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"tab", "=", 
       RowBox[{
        RowBox[{"PolyHermitianReduce", "[", 
         RowBox[{"tab", ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
        
        RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"IdealStandardize", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"tab", ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"d1", "*", "d2"}], ",", "x", ",", "nf"}], "]"}]}], "}"}], 
        ",", "nf"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdealTimesLocal", "[", 
     RowBox[{"x_", ",", "P_List", ",", 
      RowBox[{"{", 
       RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M2_List", ",", "d2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "M1", "]"}]}], ",", "tab", ",", "gcd"}], 
       "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"tab", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"M1", "\[LeftDoubleBracket]", 
                  RowBox[{"a", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                 RowBox[{"M2", "\[LeftDoubleBracket]", 
                  RowBox[{"b", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                 RowBox[{"P", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
              ",", "nf"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"tab", "=", 
        RowBox[{
         RowBox[{"PolyHermitianReduce", "[", 
          RowBox[{"tab", ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"IdealStandardizeLocal", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"tab", ",", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"d1", "*", "d2"}], ",", "x", ",", "nf"}], "]"}]}], "}"}],
          ",", "nf"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DivisorDivide", "[", 
    RowBox[{"A_", ",", "B_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=",
    "\n", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"IdealDivide", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}], ",", 
     RowBox[{"IdealDivideLocal", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealDivide", "[", 
    RowBox[{"x_", ",", "P_List", ",", "D1_", ",", "D2_", ",", "nf_"}], "]"}], 
   ":=", 
   RowBox[{"IdealTimes", "[", 
    RowBox[{"x", ",", "P", ",", "D1", ",", 
     RowBox[{"IdealReciprocal", "[", 
      RowBox[{"x", ",", "P", ",", "D2", ",", "nf"}], "]"}], ",", "nf"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdealDivideLocal", "[", 
     RowBox[{"x_", ",", "P_List", ",", "D1_", ",", "D2_", ",", "nf_"}], "]"}],
     ":=", 
    RowBox[{"IdealTimesLocal", "[", 
     RowBox[{"x", ",", "P", ",", "D1", ",", 
      RowBox[{"IdealReciprocalLocal", "[", 
       RowBox[{"x", ",", "P", ",", "D2", ",", "nf"}], "]"}], ",", "nf"}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DivisorReciprocal", "[", 
    RowBox[{"A_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=", "\n", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"IdealReciprocal", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}], ",", 
     RowBox[{"IdealReciprocalLocal", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealReciprocal", "[", 
    RowBox[{"x_", ",", "P_List", ",", 
     RowBox[{"{", 
      RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "M1", "]"}]}], ",", "tab", ",", "gcd", ",", 
       "d"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"M1", "\[LeftDoubleBracket]", 
                   RowBox[{"a", ",", "k"}], "\[RightDoubleBracket]"}], "*", 
                  RowBox[{"P", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "i", ",", "j"}], 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x",
                ",", "nf"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\n", "\t", 
      RowBox[{"tab", "=", 
       RowBox[{
        RowBox[{"PolyHermitianReduce", "[", 
         RowBox[{"tab", ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
        
        RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tab", ",", "d"}], "}"}], "=", 
       RowBox[{"PolyMatrixInverse", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "tab", "]"}], ",", "x", ",", "nf"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"tab", "=", 
       RowBox[{"PolyHermitianReduce", "[", 
        RowBox[{"tab", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"IdealStandardize", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"d1", "*", "#"}], ",", "x", ",", "nf"}], "]"}], "&"}], 
            ",", "tab", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "d"}], "}"}], ",", "nf"}], 
       "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdealReciprocalLocal", "[", 
     RowBox[{"x_", ",", "P_List", ",", 
      RowBox[{"{", 
       RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "M1", "]"}]}], ",", "tab", ",", "gcd", ",", 
        "d"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"tab", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"M1", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "k"}], "\[RightDoubleBracket]"}], "*", 
                   RowBox[{"P", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "i", ",", "j"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
                "x", ",", "nf"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"tab", "=", 
        RowBox[{
         RowBox[{"PolyHermitianReduce", "[", 
          RowBox[{"tab", ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tab", ",", "d"}], "}"}], "=", 
        RowBox[{"PolyMatrixInverse", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "tab", "]"}], ",", "x", ",", "nf"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"tab", "=", 
        RowBox[{"PolyHermitianReduce", "[", 
         RowBox[{"tab", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"IdealStandardizeLocal", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"d1", "*", "#"}], ",", "x", ",", "nf"}], "]"}], "&"}],
              ",", "tab", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", "d"}], "}"}], ",", "nf"}],
         "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DivisorPower", "[", 
    RowBox[{"A_", ",", "e_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=",
    "\n", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"IntegerQ", "[", "e", "]"}], ",", 
       "\"\<Divisor power problem\>\""}], "]"}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IdealPower", "[", 
        RowBox[{
         RowBox[{
         "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "e", ",", "nf"}], "]"}], ",", 
       RowBox[{"IdealPowerLocal", "[", 
        RowBox[{
         RowBox[{
         "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", "e", ",", "nf"}], "]"}]}], "}"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealPower", "[", 
    RowBox[{"x_", ",", "P_List", ",", 
     RowBox[{"{", 
      RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", "exponent_Integer", ",", 
     "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "=", "exponent"}], ",", 
       RowBox[{"a", "=", 
        RowBox[{"{", 
         RowBox[{"M1", ",", "d1"}], "}"}]}], ",", "r"}], "}"}], ",", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"e", "<", "0"}], ",", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"IdealReciprocal", "[", 
           RowBox[{"x", ",", "P", ",", "a", ",", "nf"}], "]"}]}], ";", 
         RowBox[{"e", "=", 
          RowBox[{"-", "e"}]}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"Which", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"e", "===", "0"}], ",", 
        RowBox[{"r", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "M1", "]"}], "]"}], ",", "1"}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"e", "===", "1"}], ",", 
        RowBox[{"r", "=", "a"}], ",", "\n", "\t\t", "True", ",", 
        RowBox[{
         RowBox[{"r", "=", "a"}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"r", "=", 
            RowBox[{"IdealTimes", "[", 
             RowBox[{"x", ",", "P", ",", "r", ",", "a", ",", "nf"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"e", "-", "1"}], "}"}]}], "]"}], ";"}]}], "\n", "\t", 
       "]"}], ";", "\n", "\t", "r"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealPowerLocal", "[", 
    RowBox[{"x_", ",", "P_List", ",", 
     RowBox[{"{", 
      RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", "exponent_Integer", ",", 
     "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "=", "exponent"}], ",", 
       RowBox[{"a", "=", 
        RowBox[{"{", 
         RowBox[{"M1", ",", "d1"}], "}"}]}], ",", "r"}], "}"}], ",", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"e", "<", "0"}], ",", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"IdealReciprocalLocal", "[", 
           RowBox[{"x", ",", "P", ",", "a", ",", "nf"}], "]"}]}], ";", 
         RowBox[{"e", "=", 
          RowBox[{"-", "e"}]}]}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"Which", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"e", "===", "0"}], ",", 
        RowBox[{"r", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"Length", "[", "M1", "]"}], "]"}], ",", "1"}], "}"}]}], 
        ",", "\n", "\t\t", 
        RowBox[{"e", "===", "1"}], ",", 
        RowBox[{"r", "=", "a"}], ",", "\n", "\t\t", "True", ",", 
        RowBox[{
         RowBox[{"r", "=", "a"}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"r", "=", 
            RowBox[{"IdealTimesLocal", "[", 
             RowBox[{"x", ",", "P", ",", "r", ",", "a", ",", "nf"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"e", "-", "1"}], "}"}]}], "]"}], ";"}]}], "\n", "\t", 
       "]"}], ";", "\n", "\t", "r"}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6658698031167088`*^9, 3.665869807227838*^9}, {
   3.665899091134007*^9, 3.665899144446101*^9}, {3.666030904579384*^9, 
   3.5811890302512646`*^9}, {3.58122171426973*^9, 3.5812218467489223`*^9}, {
   3.581221895020992*^9, 3.581222044682208*^9}, {3.686158771379591*^9, 
   3.6861587715061083`*^9}, {3.6861599243260508`*^9, 3.686159924355652*^9}, {
   3.6861618367226353`*^9, 3.68616188799645*^9}, {3.686161949910295*^9, 
   3.686162063198285*^9}, {3.686162100691432*^9, 3.686162125518841*^9}, {
   3.686162188070613*^9, 3.68616227973272*^9}, {3.686164397171504*^9, 
   3.686164455060361*^9}, {3.6861652087957*^9, 3.6861652091467257`*^9}, {
   3.686166833982689*^9, 3.686166840208724*^9}, {3.686166894163686*^9, 
   3.686166906692811*^9}, {3.686166981946968*^9, 3.686167008968886*^9}, {
   3.68616714093272*^9, 3.6861672260565557`*^9}, {3.6861672571683826`*^9, 
   3.686167287918146*^9}, {3.686167334767888*^9, 3.686167413401927*^9}, {
   3.6861674812231817`*^9, 3.6861675202896767`*^9}, {3.686167552623642*^9, 
   3.686167650833805*^9}, 3.6861676915944633`*^9, {3.6861677414948072`*^9, 
   3.686167762758246*^9}, 3.686168011681232*^9, {3.686168105783428*^9, 
   3.6861681203853903`*^9}, {3.686168191013618*^9, 3.686168193440649*^9}, 
   3.686168360806868*^9, {3.686168446878523*^9, 3.6861684617367887`*^9}, {
   3.68616849717763*^9, 3.686168525211814*^9}, {3.686168791925643*^9, 
   3.686168809188612*^9}, {3.6861688487185183`*^9, 3.686168920725513*^9}, {
   3.686168964985099*^9, 3.6861689946362123`*^9}, 3.686169029983943*^9, {
   3.686169138119207*^9, 3.686169173319721*^9}, {3.6861692946123953`*^9, 
   3.6861693005240393`*^9}, {3.686169474470536*^9, 3.686169475290101*^9}, {
   3.6861695126402607`*^9, 3.686169590251062*^9}, {3.686169625482037*^9, 
   3.686169687428836*^9}, 3.686169722650197*^9, {3.6861697871265163`*^9, 
   3.6861698165318203`*^9}, {3.686169857823347*^9, 3.686169898671887*^9}, {
   3.686169992700749*^9, 3.686170022650869*^9}, {3.6861700893509483`*^9, 
   3.686170178527217*^9}, {3.686170246878469*^9, 3.686170416519956*^9}, {
   3.686170978558359*^9, 3.686171008415341*^9}, {3.686171057230632*^9, 
   3.686171072006068*^9}, {3.686171134510055*^9, 3.686171136723155*^9}, {
   3.686171759786923*^9, 3.686171763975964*^9}, {3.68617282807907*^9, 
   3.686172874768633*^9}, {3.686172919517703*^9, 3.686172949533244*^9}, {
   3.686173006499424*^9, 3.686173027230824*^9}, {3.68617318062967*^9, 
   3.686173211695928*^9}, {3.686173249371016*^9, 3.686173372215822*^9}, {
   3.6861734066787233`*^9, 3.686173803597234*^9}, {3.686173888231988*^9, 
   3.686173890826159*^9}, {3.6861740164319687`*^9, 3.686174099162812*^9}, {
   3.6861741431845818`*^9, 3.686174158009417*^9}, {3.686174189494166*^9, 
   3.6861741903295803`*^9}, {3.686174740160426*^9, 3.686174750747018*^9}, {
   3.686175725932626*^9, 3.686175961098506*^9}, {3.6861759931292343`*^9, 
   3.686176025336543*^9}, {3.686176095130934*^9, 3.6861761257524652`*^9}, 
   3.686426118179*^9, {3.68642625218541*^9, 3.6711251368361692`*^9}, {
   3.6711400179973555`*^9, 3.671140023253605*^9}, {3.693150592969942*^9, 
   3.6931506331251707`*^9}, {3.6931518924411993`*^9, 3.693151894263693*^9}, {
   3.70134765363791*^9, 3.701347658852872*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DivisorPlus", "[", 
    RowBox[{"A_", ",", "B_", ",", "var_", ",", "nf_"}], "]"}], ":=", "\n", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"IdealPlus", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}], ",", 
     RowBox[{"IdealPlusLocal", "[", 
      RowBox[{
       RowBox[{"var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", "nf"}], "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealPlus", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"{", 
      RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M2_List", ",", "d2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "M1", "]"}]}], ",", "tab", ",", "gcd", ",", 
       "res"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"tab", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"d2", "*", "M1"}], ",", "x", ",", "nf"}], "]"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"d1", "*", "M2"}], ",", "x", ",", "nf"}], "]"}], "}"}]}],
          "}"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"tab", "=", 
       RowBox[{
        RowBox[{"PolyHermitianReduce", "[", 
         RowBox[{"tab", ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
        
        RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      "\t", 
      RowBox[{"IdealStandardize", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"tab", ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"d1", "*", "d2"}], ",", "x", ",", "nf"}], "]"}]}], "}"}], 
        ",", "nf"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdealPlusLocal", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"{", 
       RowBox[{"M1_List", ",", "d1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"M2_List", ",", "d2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "M1", "]"}]}], ",", "tab", ",", "gcd", ",", 
        "res"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"tab", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"d2", "*", "M1"}], ",", "x", ",", "nf"}], "]"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"d1", "*", "M2"}], ",", "x", ",", "nf"}], "]"}], 
            "}"}]}], "}"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"tab", "=", 
        RowBox[{
         RowBox[{"PolyHermitianReduce", "[", 
          RowBox[{"tab", ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"IdealStandardizeLocal", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"tab", ",", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"d1", "*", "d2"}], ",", "x", ",", "nf"}], "]"}]}], "}"}],
          ",", "nf"}], "]"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"works", " ", "on", " ", "integral", " ", "ideals"}], " ", "-", 
    " ", 
    RowBox[{
    "remove", " ", "factors", " ", "of", " ", "M1", " ", "to", " ", "make", 
     " ", "it", " ", "prime", " ", "to", " ", "M2"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealMakePrimeTo", "[", 
    RowBox[{"x_", ",", "P_", ",", 
     RowBox[{"{", 
      RowBox[{"M1_", ",", "d1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M2_", ",", "d2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "M1", "]"}]}], ",", "gcd", ",", 
       RowBox[{"M", "=", 
        RowBox[{"{", 
         RowBox[{"M1", ",", "d1"}], "}"}]}]}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{"d1", "===", "d2", "===", "1"}], "]"}], ";", "\n", "\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gcd", "=", 
          RowBox[{"IdealPlus", "[", 
           RowBox[{"x", ",", "M", ",", 
            RowBox[{"{", 
             RowBox[{"M2", ",", "1"}], "}"}], ",", "nf"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{
          "gcd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"M", "=", 
          RowBox[{"IdealDivide", "[", 
           RowBox[{"x", ",", "P", ",", "M", ",", "gcd", ",", "nf"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"assert", "[", 
          RowBox[{
           RowBox[{
           "M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "===",
            "1"}], "]"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
      "M"}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealMakePrimeToLocal", "[", 
    RowBox[{"x_", ",", "P_", ",", 
     RowBox[{"{", 
      RowBox[{"M1_", ",", "d1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"M2_", ",", "d2_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "M1", "]"}]}], ",", "gcd", ",", 
       RowBox[{"M", "=", 
        RowBox[{"{", 
         RowBox[{"M1", ",", "d1"}], "}"}]}]}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"Assert", "[", 
       RowBox[{"d1", "===", "d2", "===", "1"}], "]"}], ";", "\n", "\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gcd", "=", 
          RowBox[{"IdealPlusLocal", "[", 
           RowBox[{"x", ",", "M", ",", 
            RowBox[{"{", 
             RowBox[{"M2", ",", "1"}], "}"}], ",", "nf"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{
          "gcd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
          RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"M", "=", 
          RowBox[{"IdealDivideLocal", "[", 
           RowBox[{"x", ",", "P", ",", "M", ",", "gcd", ",", "nf"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"Assert", "[", 
          RowBox[{
           RowBox[{
           "M", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "===",
            "1"}], "]"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
      "M"}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.665869788706799*^9, 3.6658697915866632`*^9}, {
   3.666044897460638*^9, 3.5803452286285315`*^9}, {3.5803454044564404`*^9, 
   3.5803454126932545`*^9}, {3.5803472692761683`*^9, 
   3.5803472695611687`*^9}, {3.581222054457222*^9, 3.581222160304375*^9}, {
   3.667230105784052*^9, 3.66723013798414*^9}, {3.686167829517336*^9, 
   3.6861678508725357`*^9}, 3.686168038683156*^9, {3.686168558024127*^9, 
   3.6861685888971863`*^9}, {3.6861689767306213`*^9, 3.686168984488679*^9}, {
   3.686174168002714*^9, 3.686174175591674*^9}, {3.6861742825670958`*^9, 
   3.68617428625628*^9}, {3.686174327721084*^9, 3.686174336229888*^9}, {
   3.686174728793194*^9, 3.686174736491452*^9}, {3.686175224824006*^9, 
   3.686175275780933*^9}, {3.686176068492885*^9, 3.686176080739572*^9}, {
   3.686176221979594*^9, 3.68617623618904*^9}, {3.686178660880089*^9, 
   3.686178672744294*^9}, {3.6861788230527773`*^9, 3.686178828059883*^9}, {
   3.686654324419009*^9, 3.68665436641473*^9}, {3.693151896813448*^9, 
   3.693151903593916*^9}, {3.69315194459468*^9, 3.693151975219407*^9}, {
   3.693152022215701*^9, 3.6931520248890877`*^9}, {3.6931526872019653`*^9, 
   3.693152690830121*^9}, {3.6931532238941793`*^9, 3.693153259526*^9}, {
   3.6931537700686407`*^9, 3.6931539545442553`*^9}, {3.6931539938193617`*^9, 
   3.6931540249863462`*^9}, {3.693154056101769*^9, 3.693154058551284*^9}, {
   3.693154126097136*^9, 3.693154165293915*^9}, {3.693154213454227*^9, 
   3.693154310756467*^9}, {3.693154344817672*^9, 3.693154383159656*^9}, {
   3.6931544211827497`*^9, 3.693154475378439*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DivisorIntersect", "[", 
   RowBox[{"A_", ",", "B_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=",
   "\[IndentingNewLine]", "\t", 
  RowBox[{"DivisorDivide", "[", 
   RowBox[{
    RowBox[{"DivisorTimes", "[", 
     RowBox[{"A", ",", "B", ",", "P", ",", "var", ",", "nf"}], "]"}], ",", 
    RowBox[{"DivisorPlus", "[", 
     RowBox[{"A", ",", "B", ",", "var", ",", "nf"}], "]"}], ",", "P", ",", 
    "var", ",", "nf"}], "]"}]}]], "Code",
 CellChangeTimes->{{3.702240673922821*^9, 3.702240694693617*^9}, {
   3.7022407270536213`*^9, 3.702240804781517*^9}, 3.702498766208867*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["factoring", "Subsection",
 CellChangeTimes->{{3.676408405664386*^9, 3.676408411086383*^9}, 
   3.6764084894827137`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fa", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"y", "^", "2"}], "-", 
        RowBox[{"x", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "^", "5"}], "+", "2"}], ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"IdealFactorPoly", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "^", "5"}], "+", "2"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", 
    RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", 
    RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7027405011222143`*^9, 3.702740535763006*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{
           RowBox[{"2", "+", 
             SuperscriptBox["x", "5"]}], "0"}, {"0", "1"}}, RowSpacings -> 1, 
         ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
         Center], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "2"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{2 + $CellContext`x^5, 0}, {0, 1}}]}], " ^ ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.702740508812563*^9, 3.702740540599039*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fa", "=", 
   RowBox[{
    RowBox[{"ParseExpression", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", "x", "]"}], "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"3", "+", "x", "+", 
         RowBox[{"Sqrt", "[", "x", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "\[Theta]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"IdealFactorPoly", "[", 
  RowBox[{
   RowBox[{"x", "-", "4"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", 
    RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"fa", "\[LeftDoubleBracket]", 
    RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
   "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.702739817473893*^9, 3.7027398463059273`*^9}, {
  3.702739881721957*^9, 3.702739929906127*^9}, {3.70273997734718*^9, 
  3.702739992514018*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", 
           RowBox[{"-", 
             FractionBox["1", "6"]}]}, {"0", "1", "0", 
           RowBox[{"-", 
             FractionBox["1", "2"]}]}, {"0", "0", "1", 
           RowBox[{"-", 
             FractionBox["1", "3"]}]}, {"0", "0", "0", 
           RowBox[{
             RowBox[{"-", "4"}], "+", "x"}]}}, RowSpacings -> 1, 
         ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
         Center], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 
        Rational[-1, 6]}, {0, 1, 0, 
        Rational[-1, 2]}, {0, 0, 1, 
        Rational[-1, 3]}, {0, 0, 0, -4 + $CellContext`x}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702739909141864*^9, 3.702739931364068*^9}, 
   3.702739999204155*^9, {3.702740276127046*^9, 3.7027402955010567`*^9}, 
   3.7027403490772467`*^9, 3.702740487464116*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", "0", 
           FractionBox["1", "6"]}, {"0", "1", "0", 
           RowBox[{"-", 
             FractionBox["1", "2"]}]}, {"0", "0", "1", 
           FractionBox["1", "3"]}, {"0", "0", "0", 
           RowBox[{
             RowBox[{"-", "4"}], "+", "x"}]}}, RowSpacings -> 1, 
         ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
         Center], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 0, 
        Rational[1, 6]}, {0, 1, 0, 
        Rational[-1, 2]}, {0, 0, 1, 
        Rational[1, 3]}, {0, 0, 0, -4 + $CellContext`x}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702739909141864*^9, 3.702739931364068*^9}, 
   3.702739999204155*^9, {3.702740276127046*^9, 3.7027402955010567`*^9}, 
   3.7027403490772467`*^9, 3.702740487764806*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           FractionBox["1", "2"], "0"}, {"0", "1", "0", 
           FractionBox["1", "2"]}, {"0", "0", 
           RowBox[{
             RowBox[{"-", "4"}], "+", "x"}], "0"}, {"0", "0", "0", 
           RowBox[{
             RowBox[{"-", "4"}], "+", "x"}]}}, RowSpacings -> 1, 
         ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
         Center], "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, 
        Rational[1, 2], 0}, {0, 1, 0, 
        Rational[1, 2]}, {0, 0, -4 + $CellContext`x, 0}, {
       0, 0, 0, -4 + $CellContext`x}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702739909141864*^9, 3.702739931364068*^9}, 
   3.702739999204155*^9, {3.702740276127046*^9, 3.7027402955010567`*^9}, 
   3.7027403490772467`*^9, 3.702740488065477*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fa", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"y", "^", "3"}], "-", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"3", "x"}], "+", 
          RowBox[{"3", 
           RowBox[{"x", "^", "2"}]}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", "\[Theta]", ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"IdealFactorPoly", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "3"}], "-", "2"}], ",", 
    RowBox[{"fa", "\[LeftDoubleBracket]", 
     RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"fa", "\[LeftDoubleBracket]", 
     RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
    "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.702740426186056*^9, 3.702740426682435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{
             FractionBox["1", "3"], "-", 
             FractionBox[
              SuperscriptBox["x", "2"], "3"]}]}, {"0", "1", 
           RowBox[{
             RowBox[{"-", 
               FractionBox["1", "3"]}], "+", 
             FractionBox["x", "3"], "-", 
             FractionBox[
              SuperscriptBox["x", "2"], "3"]}]}, {"0", "0", 
           RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["x", "3"]}]}}, RowSpacings -> 1, ColumnSpacings -> 
         1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
        "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, Rational[1, 3] + Rational[-1, 3] $CellContext`x^2}, {
       0, 1, Rational[-1, 3] + Rational[1, 3] $CellContext`x + 
        Rational[-1, 3] $CellContext`x^2}, {0, 0, -2 + $CellContext`x^3}}]}], 
   " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.702740441113933*^9, 3.702740476864653*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", 
           RowBox[{
             FractionBox["1", "3"], "-", 
             FractionBox["x", "3"], "+", 
             FractionBox[
              SuperscriptBox["x", "2"], "3"]}], 
           RowBox[{
             RowBox[{"-", 
               FractionBox["1", "3"]}], "+", 
             FractionBox[
              SuperscriptBox["x", "2"], "3"]}]}, {"0", 
           RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["x", "3"]}], "0"}, {"0", "0", 
           RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["x", "3"]}]}}, RowSpacings -> 1, ColumnSpacings -> 
         1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
        "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{
       1, Rational[1, 3] + Rational[-1, 3] $CellContext`x + 
        Rational[1, 3] $CellContext`x^2, Rational[-1, 3] + 
        Rational[1, 3] $CellContext`x^2}, {0, -2 + $CellContext`x^3, 0}, {
       0, 0, -2 + $CellContext`x^3}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.702740441113933*^9, 3.702740477213539*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fa", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"y", "^", "3"}], "-", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"3", "x"}], "+", 
          RowBox[{"3", 
           RowBox[{"x", "^", "2"}]}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "^", "2"}], "+", "\[Theta]", "+", "1"}], ",", 
       "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"IdealFactorPoly", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "3"}], "-", "2"}], ",", 
    RowBox[{"fa", "\[LeftDoubleBracket]", 
     RowBox[{"FAOFFP", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{"fa", "\[LeftDoubleBracket]", 
     RowBox[{"FAOFFVAR", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
    RowBox[{
    "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.70257693962033*^9, 3.7025769898946657`*^9}, {
   3.702577087448401*^9, 3.702577087576355*^9}, {3.702577220832222*^9, 
   3.702577221327457*^9}, {3.702577520856895*^9, 3.702577520991431*^9}, {
   3.7025780147406597`*^9, 3.702578040130752*^9}, {3.70257810680232*^9, 
   3.702578107760624*^9}, {3.702578248811523*^9, 3.7025782506967793`*^9}, {
   3.702638255652897*^9, 3.7026382582110367`*^9}, {3.702638344284689*^9, 
   3.7026383505327053`*^9}, {3.702643501290563*^9, 3.7026435015522413`*^9}, {
   3.702648394902932*^9, 3.702648398741366*^9}, {3.702665739657412*^9, 
   3.702665741895102*^9}, 3.7026661229031477`*^9, 3.702667614901269*^9, 
   3.7026678982583857`*^9, {3.702667967744213*^9, 3.702667967959359*^9}, {
   3.70266817788552*^9, 3.702668179715824*^9}, {3.702668228463315*^9, 
   3.702668230420759*^9}, {3.702668364377441*^9, 3.70266836732758*^9}, {
   3.702670108173072*^9, 3.702670109779345*^9}, {3.702670650710896*^9, 
   3.70267065185985*^9}, {3.702670980657333*^9, 3.702670981556003*^9}, {
   3.7027332544665527`*^9, 3.702733255857822*^9}, {3.7027398566611567`*^9, 
   3.702739871665907*^9}, {3.702740431083407*^9, 3.7027404336107683`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{
             FractionBox["1", "3"], "-", 
             FractionBox[
              SuperscriptBox["x", "2"], "3"]}]}, {"0", "1", 
           RowBox[{
             RowBox[{"-", 
               FractionBox["1", "3"]}], "+", 
             FractionBox["x", "3"], "-", 
             FractionBox[
              SuperscriptBox["x", "2"], "3"]}]}, {"0", "0", 
           RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["x", "3"]}]}}, RowSpacings -> 1, ColumnSpacings -> 
         1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
        "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{1, 0, Rational[1, 3] + Rational[-1, 3] $CellContext`x^2}, {
       0, 1, Rational[-1, 3] + Rational[1, 3] $CellContext`x + 
        Rational[-1, 3] $CellContext`x^2}, {0, 0, -2 + $CellContext`x^3}}]}], 
   " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702667964170362*^9, 3.702668005482862*^9}, 
   3.7026681282773933`*^9, {3.702668181456319*^9, 3.702668194687785*^9}, 
   3.702668231034666*^9, 3.702668370152718*^9, 3.7026701120441313`*^9, 
   3.702670190477968*^9, 3.702670652481489*^9, 3.702670988846108*^9, {
   3.7026710280166388`*^9, 3.702671040261044*^9}, 3.702671121036182*^9, {
   3.7026714229949913`*^9, 3.702671438196739*^9}, {3.702732938527979*^9, 
   3.702732958220894*^9}, 3.702733004543064*^9, 3.702733142259775*^9, 
   3.702733182398498*^9, {3.702733218260962*^9, 3.702733339956056*^9}, {
   3.702733544916857*^9, 3.702733563344666*^9}, {3.702733605524254*^9, 
   3.702733622349367*^9}, {3.702733704157014*^9, 3.702733719461343*^9}, {
   3.702733876074856*^9, 3.702733897926641*^9}, {3.702734029642128*^9, 
   3.702734071284363*^9}, 3.7027351565961227`*^9, 3.7027383897676897`*^9, 
   3.702738459432947*^9, {3.7027385328050632`*^9, 3.702738545293838*^9}, 
   3.702739627340904*^9, 3.7027396765590477`*^9, 3.7027397738005466`*^9, 
   3.702739874784565*^9, 3.7027400931358128`*^9, 3.702740141904525*^9, 
   3.702740188052129*^9, 3.702740266746914*^9, 3.702740342904158*^9, 
   3.7027404357531033`*^9, 3.702740471626658*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{
             FractionBox["\[Theta]", "3"], "-", 
             FractionBox[
              RowBox[{
                SuperscriptBox["x", "2"], " ", "\[Theta]"}], "3"]}]}, {
          "0", "1", 
           RowBox[{
             FractionBox["1", "3"], "+", 
             RowBox[{"x", " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    FractionBox["1", "3"]}], "-", 
                   FractionBox["\[Theta]", "3"]}], ")"}]}], "+", 
             RowBox[{
               SuperscriptBox["x", "2"], " ", 
               RowBox[{"(", 
                 RowBox[{
                   FractionBox["1", "3"], "+", 
                   FractionBox["\[Theta]", "3"]}], ")"}]}], "+", 
             FractionBox["\[Theta]", "3"]}]}, {"0", "0", 
           RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["x", "3"]}]}}, RowSpacings -> 1, ColumnSpacings -> 
         1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
        "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{
       1, 0, Rational[1, 3] $CellContext`\[Theta] + 
        Rational[-1, 3] $CellContext`x^2 $CellContext`\[Theta]}, {
       0, 1, Rational[
         1, 3] + $CellContext`x (Rational[-1, 3] + 
          Rational[-1, 3] $CellContext`\[Theta]) + $CellContext`x^2 (
          Rational[1, 3] + Rational[1, 3] $CellContext`\[Theta]) + 
        Rational[1, 3] $CellContext`\[Theta]}, {
       0, 0, -2 + $CellContext`x^3}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702667964170362*^9, 3.702668005482862*^9}, 
   3.7026681282773933`*^9, {3.702668181456319*^9, 3.702668194687785*^9}, 
   3.702668231034666*^9, 3.702668370152718*^9, 3.7026701120441313`*^9, 
   3.702670190477968*^9, 3.702670652481489*^9, 3.702670988846108*^9, {
   3.7026710280166388`*^9, 3.702671040261044*^9}, 3.702671121036182*^9, {
   3.7026714229949913`*^9, 3.702671438196739*^9}, {3.702732938527979*^9, 
   3.702732958220894*^9}, 3.702733004543064*^9, 3.702733142259775*^9, 
   3.702733182398498*^9, {3.702733218260962*^9, 3.702733339956056*^9}, {
   3.702733544916857*^9, 3.702733563344666*^9}, {3.702733605524254*^9, 
   3.702733622349367*^9}, {3.702733704157014*^9, 3.702733719461343*^9}, {
   3.702733876074856*^9, 3.702733897926641*^9}, {3.702734029642128*^9, 
   3.702734071284363*^9}, 3.7027351565961227`*^9, 3.7027383897676897`*^9, 
   3.702738459432947*^9, {3.7027385328050632`*^9, 3.702738545293838*^9}, 
   3.702739627340904*^9, 3.7027396765590477`*^9, 3.7027397738005466`*^9, 
   3.702739874784565*^9, 3.7027400931358128`*^9, 3.702740141904525*^9, 
   3.702740188052129*^9, 3.702740266746914*^9, 3.702740342904158*^9, 
   3.7027404357531033`*^9, 3.702740472344365*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"factor: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"1","\"*\"",TagBox[
      RowBox[{"(", "\[NoBreak]", 
        GridBox[{{"1", "0", 
           RowBox[{
             RowBox[{"-", 
               FractionBox["1", "3"]}], "+", 
             RowBox[{
               SuperscriptBox["x", "2"], " ", 
               RowBox[{"(", 
                 RowBox[{
                   FractionBox["1", "3"], "+", 
                   FractionBox["\[Theta]", "3"]}], ")"}]}], "-", 
             FractionBox["\[Theta]", "3"]}]}, {"0", "1", 
           RowBox[{
             RowBox[{"-", 
               FractionBox["\[Theta]", "3"]}], "+", 
             FractionBox[
              RowBox[{"x", " ", "\[Theta]"}], "3"], "-", 
             FractionBox[
              RowBox[{
                SuperscriptBox["x", "2"], " ", "\[Theta]"}], "3"]}]}, {
          "0", "0", 
           RowBox[{
             RowBox[{"-", "2"}], "+", 
             SuperscriptBox["x", "3"]}]}}, RowSpacings -> 1, ColumnSpacings -> 
         1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
        "\[NoBreak]", ")"}], 
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]},
    "RowDefault"], "\[InvisibleSpace]", "\<\" ^ \"\>", "\[InvisibleSpace]", 
   "1"}],
  SequenceForm["factor: ", 
   Row[{1, "*", 
     MatrixForm[{{
       1, 0, Rational[-1, 3] + $CellContext`x^2 (Rational[1, 3] + 
          Rational[1, 3] $CellContext`\[Theta]) + 
        Rational[-1, 3] $CellContext`\[Theta]}, {
       0, 1, Rational[-1, 3] $CellContext`\[Theta] + 
        Rational[1, 3] $CellContext`x $CellContext`\[Theta] + 
        Rational[-1, 3] $CellContext`x^2 $CellContext`\[Theta]}, {
       0, 0, -2 + $CellContext`x^3}}]}], " ^ ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.702667964170362*^9, 3.702668005482862*^9}, 
   3.7026681282773933`*^9, {3.702668181456319*^9, 3.702668194687785*^9}, 
   3.702668231034666*^9, 3.702668370152718*^9, 3.7026701120441313`*^9, 
   3.702670190477968*^9, 3.702670652481489*^9, 3.702670988846108*^9, {
   3.7026710280166388`*^9, 3.702671040261044*^9}, 3.702671121036182*^9, {
   3.7026714229949913`*^9, 3.702671438196739*^9}, {3.702732938527979*^9, 
   3.702732958220894*^9}, 3.702733004543064*^9, 3.702733142259775*^9, 
   3.702733182398498*^9, {3.702733218260962*^9, 3.702733339956056*^9}, {
   3.702733544916857*^9, 3.702733563344666*^9}, {3.702733605524254*^9, 
   3.702733622349367*^9}, {3.702733704157014*^9, 3.702733719461343*^9}, {
   3.702733876074856*^9, 3.702733897926641*^9}, {3.702734029642128*^9, 
   3.702734071284363*^9}, 3.7027351565961227`*^9, 3.7027383897676897`*^9, 
   3.702738459432947*^9, {3.7027385328050632`*^9, 3.702738545293838*^9}, 
   3.702739627340904*^9, 3.7027396765590477`*^9, 3.7027397738005466`*^9, 
   3.702739874784565*^9, 3.7027400931358128`*^9, 3.702740141904525*^9, 
   3.702740188052129*^9, 3.702740266746914*^9, 3.702740342904158*^9, 
   3.7027404357531033`*^9, 3.7027404729405117`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fa", "=", 
   RowBox[{"ToFunctionAlgebra", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"y", "^", "4"}], "-", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"x", "^", "4"}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
     RowBox[{"NF", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"\[Theta]", "^", "2"}], "+", "1"}], ",", "\[Theta]", ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"Column", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DivisorPrint", "[", 
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], ",", "\"\<^\>\"", ",", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
        "]"}], "&"}], ",", 
     RowBox[{"DivisorFactor", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "^", "2"}], "+", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "^", "2"}], "-", "x", "+", "1"}], ")"}], "*", 
            RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ",", "1"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Xi]", "*", 
            RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ",", "1"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFT", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFP", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFVAR", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{
       "fa", "\[LeftDoubleBracket]", "FAOFFNF", "\[RightDoubleBracket]"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7027736461673203`*^9, 3.702773737104065*^9}, {
  3.702773894121354*^9, 3.70277389529603*^9}, {3.702774252425317*^9, 
  3.702774298264585*^9}, {3.702774630954001*^9, 3.702774635640699*^9}, {
  3.702775185473484*^9, 3.70277522517771*^9}, {3.702775268529829*^9, 
  3.702775373488201*^9}, {3.7027754073296757`*^9, 3.702775410601256*^9}, {
  3.702775441192815*^9, 3.702775466553653*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{
                   RowBox[{"x", "-", "\[Theta]"}], "0", "0", "0"}, {"0", 
                   RowBox[{"x", "-", "\[Theta]"}], "0", "0"}, {"0", "0", 
                   RowBox[{"x", "-", "\[Theta]"}], "0"}, {"0", "0", "0", 
                   RowBox[{"x", "-", "\[Theta]"}]}}, RowSpacings -> 1, 
                 ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{
                   RowBox[{"x", "+", "\[Theta]"}], "0", "0", "0"}, {"0", 
                   RowBox[{"x", "+", "\[Theta]"}], "0", "0"}, {"0", "0", 
                   RowBox[{"x", "+", "\[Theta]"}], "0"}, {"0", "0", "0", 
                   RowBox[{"x", "+", "\[Theta]"}]}}, RowSpacings -> 1, 
                 ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{"1", "0", 
                   RowBox[{"\[Theta]", "-", 
                    RowBox[{"x", " ", "\[Theta]"}]}], "0"}, {"0", "1", "0", 
                   RowBox[{"\[Theta]", "-", 
                    RowBox[{"x", " ", "\[Theta]"}]}]}, {"0", "0", 
                   RowBox[{"1", "-", "x", "+", 
                    SuperscriptBox["x", "2"]}], "0"}, {"0", "0", "0", 
                   RowBox[{"1", "-", "x", "+", 
                    SuperscriptBox["x", "2"]}]}}, RowSpacings -> 1, 
                 ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{"1", "0", 
                   RowBox[{
                    RowBox[{"-", "\[Theta]"}], "+", 
                    RowBox[{"x", " ", "\[Theta]"}]}], "0"}, {"0", "1", "0", 
                   RowBox[{
                    RowBox[{"-", "\[Theta]"}], "+", 
                    RowBox[{"x", " ", "\[Theta]"}]}]}, {"0", "0", 
                   RowBox[{"1", "-", "x", "+", 
                    SuperscriptBox["x", "2"]}], "0"}, {"0", "0", "0", 
                   RowBox[{"1", "-", "x", "+", 
                    SuperscriptBox["x", "2"]}]}}, RowSpacings -> 1, 
                 ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{"1", "0", "0", 
                   RowBox[{"-", "1"}]}, {"0", "1", "0", 
                   RowBox[{"-", "1"}]}, {"0", "0", "1", 
                   RowBox[{"-", "1"}]}, {"0", "0", "0", "\[Xi]"}}, 
                 RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                 Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{"1", "0", "0", 
                   RowBox[{"-", "\[Theta]"}]}, {"0", "1", "0", "1"}, {
                  "0", "0", "1", "\[Theta]"}, {"0", "0", "0", "\[Xi]"}}, 
                 RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                 Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "\[Theta]"}, {"0", "1", "0", "1"}, {
                  "0", "0", "1", 
                   RowBox[{"-", "\[Theta]"}]}, {"0", "0", "0", "\[Xi]"}}, 
                 RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                 Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]},
    {
     TemplateBox[{RowBox[{"\"div\"", "[", 
         RowBox[{
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                
                GridBox[{{"1", "0", "0", "0"}, {"0", "1", "0", "0"}, {
                  "0", "0", "1", "0"}, {"0", "0", "0", "1"}}, RowSpacings -> 
                 1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                 ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"], ",", 
           TemplateBox[{"1", "\"*\"", 
             TagBox[
              RowBox[{"(", "\[NoBreak]", 
                GridBox[{{"1", "0", "0", "1"}, {"0", "1", "0", 
                   RowBox[{"-", "1"}]}, {"0", "0", "1", "1"}, {
                  "0", "0", "0", "\[Xi]"}}, RowSpacings -> 1, ColumnSpacings -> 
                 1, RowAlignments -> Baseline, ColumnAlignments -> Center], 
                "\[NoBreak]", ")"}], 
              Function[BoxForm`e$, 
               MatrixForm[BoxForm`e$]]]}, "RowDefault"]}], "]"}],"\"^\"","1"},
      
      "RowDefault"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.7027737190421753`*^9, 3.702773738479353*^9}, 
   3.702773820888158*^9, {3.702773877140037*^9, 3.702773897750011*^9}, 
   3.7027739870424013`*^9, {3.702774095463118*^9, 3.702774118207614*^9}, 
   3.702774160508149*^9, 3.702774224001314*^9, {3.702774291761611*^9, 
   3.702774299943762*^9}, {3.702774357408483*^9, 3.702774363071609*^9}, 
   3.702774456593008*^9, 3.702774502597844*^9, 3.7027746377938423`*^9, 
   3.702774714216066*^9, 3.702774843524745*^9, 3.702774883079198*^9, 
   3.702774969563888*^9, 3.702775006898574*^9, 3.702775109724968*^9, {
   3.702775170513777*^9, 3.7027752284183598`*^9}, {3.7027752742732363`*^9, 
   3.702775335001774*^9}, 3.702775382074254*^9, {3.702775419832384*^9, 
   3.702775476033114*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivisorRadical", "[", 
     RowBox[{"A_", ",", "T_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=",
     "\n", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"IdealRadical", "[", 
       RowBox[{
        RowBox[{"var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{"T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "nf"}], "]"}], ",", 
      RowBox[{"IdealRadicalLocal", "[", 
       RowBox[{
        RowBox[{"var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{"T", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "nf"}], "]"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealRadical", "[", 
    RowBox[{"x_", ",", "T_", ",", "P_", ",", "ideal_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "P", "]"}]}], ",", "q", ",", "M", ",", "Q", 
       ",", "R"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ideal", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "===",
          "1"}], ",", "\"\<integral ideal in IdealRadical\>\""}], "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"q", "=", 
       RowBox[{"PolyMakeSquareFree", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"Diagonal", "[", 
             RowBox[{
             "ideal", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", "x", ",", "nf"}], "]"}], ",", "x", ",", "nf"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"T", ".", 
            RowBox[{"P", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", "x", 
           ",", "nf"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"Q", "=", 
       RowBox[{
        RowBox[{"PolyHermitianReduce", "[", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "M", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"q", "*", 
               RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "}"}]}], "}"}], 
           "]"}], ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"R", "=", 
         RowBox[{"q", "*", 
          RowBox[{"Inverse", "[", "Q", "]"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"not", " ", "just", " ", "R"}], "=", 
          RowBox[{"Inverse", "[", "Q", "]"}]}], ";", " ", 
         RowBox[{
         "seems", " ", "to", " ", "be", " ", "an", " ", "error", " ", "in", 
          " ", 
          RowBox[{"Trager", "'"}], "s", " ", "thesis", " ", "here"}]}]}], " ",
        "*)"}], "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"PolyMatrixInverse", "[", 
        RowBox[{"Q", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{
              RowBox[{"#", "*", "q"}], ",", 
              RowBox[{
              "R", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
           RowBox[{
           "R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "}"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"IdealPlus", "[", 
       RowBox[{"x", ",", "ideal", ",", "R", ",", "nf"}], "]"}]}]}], "\n", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IdealRadicalLocal", "[", 
    RowBox[{"x_", ",", "T_", ",", "P_", ",", "ideal_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "P", "]"}]}], ",", "q", ",", "M", ",", "Q", 
       ",", "R"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ideal", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "===",
          "1"}], ",", "\"\<integral ideal in IdealRadical\>\""}], "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"q", "=", "x"}], ";", "\n", "\t\t", 
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"T", ".", 
            RowBox[{"P", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", "x", 
           ",", "nf"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"Q", "=", 
       RowBox[{
        RowBox[{"PolyHermitianReduce", "[", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "M", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"q", "*", 
               RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "}"}]}], "}"}], 
           "]"}], ",", "x", ",", "nf"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"R", "=", 
         RowBox[{"q", "*", 
          RowBox[{"Inverse", "[", "Q", "]"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"not", " ", "just", " ", "R"}], "=", 
          RowBox[{"Inverse", "[", "Q", "]"}]}], ";", " ", 
         RowBox[{
         "seems", " ", "to", " ", "be", " ", "an", " ", "error", " ", "in", 
          " ", 
          RowBox[{"Trager", "'"}], "s", " ", "thesis", " ", "here"}]}]}], " ",
        "*)"}], "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"PolyMatrixInverse", "[", 
        RowBox[{"Q", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"R", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{
              RowBox[{"#", "*", "q"}], ",", 
              RowBox[{
              "R", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
           RowBox[{
           "R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "}"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"IdealPlusLocal", "[", 
       RowBox[{"x", ",", "ideal", ",", "R", ",", "nf"}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6931544764206657`*^9, 3.693154482239355*^9}, 
   3.693154604364706*^9, {3.701347469164332*^9, 3.7013474865318937`*^9}, {
   3.701347544571994*^9, 3.701347582885586*^9}, {3.701347620709985*^9, 
   3.7013476247424307`*^9}, {3.701347668847703*^9, 3.701347716726198*^9}, {
   3.70250727407759*^9, 3.7025072797322407`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DivisorFactorSquareFree", "[", 
   RowBox[{"div_", ",", "T_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\n", "i", ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"div", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ",", 
      "id", ",", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"id", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
       "}"}]}], ";", "\n", "\t", 
     RowBox[{"a", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"div", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"div", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1"}], 
         "}"}]}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"b", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"div", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", "1"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"div", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", "1"}], 
         "}"}]}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"c", "=", 
      RowBox[{"DivisorPlus", "[", 
       RowBox[{"a", ",", "b", ",", "var", ",", "nf"}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"a", "=", 
      RowBox[{"DivisorDivide", "[", 
       RowBox[{"a", ",", "c", ",", "P", ",", "var", ",", "nf"}], "]"}]}], ";",
      "\n", "\t", 
     RowBox[{"b", "=", 
      RowBox[{"DivisorDivide", "[", 
       RowBox[{"b", ",", "c", ",", "P", ",", "var", ",", "nf"}], "]"}]}], ";",
      "\n", "\t", 
     RowBox[{"i", "=", "0"}], ";", "\n", "\t", 
     RowBox[{"d", "=", 
      RowBox[{"DivisorRadical", "[", 
       RowBox[{"a", ",", "T", ",", "P", ",", "var", ",", "nf"}], "]"}]}], ";",
      "\n", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"d", "=!=", "id"}], ",", 
       RowBox[{
        RowBox[{"i", "++"}], ";", "\n", "\t\t", 
        RowBox[{"a", "=", 
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"a", ",", "d", ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"c", "=", 
         RowBox[{"DivisorPlus", "[", 
          RowBox[{"a", ",", "d", ",", "var", ",", "nf"}], "]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"e", "=", 
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"d", ",", "c", ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"d", "=", "c"}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"e", "=!=", "id"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"res", ",", 
            RowBox[{"{", 
             RowBox[{"e", ",", "i"}], "}"}]}], "]"}]}], "]"}]}]}], "\n", "\t",
       "]"}], ";", "\n", "\t", 
     RowBox[{"i", "=", "0"}], ";", "\n", "\t", 
     RowBox[{"d", "=", 
      RowBox[{"DivisorRadical", "[", 
       RowBox[{"b", ",", "T", ",", "P", ",", "var", ",", "nf"}], "]"}]}], ";",
      "\n", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"d", "=!=", "id"}], ",", 
       RowBox[{
        RowBox[{"i", "++"}], ";", "\n", "\t\t", 
        RowBox[{"b", "=", 
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"b", ",", "d", ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"c", "=", 
         RowBox[{"DivisorPlus", "[", 
          RowBox[{"b", ",", "d", ",", "var", ",", "nf"}], "]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"e", "=", 
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"d", ",", "c", ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"d", "=", "c"}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"e", "=!=", "id"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"res", ",", 
            RowBox[{"{", 
             RowBox[{"e", ",", 
              RowBox[{"-", "i"}]}], "}"}]}], "]"}]}], "]"}]}]}], "\n", "\t", 
      "]"}], ";", "\n", "\t", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.701347735515512*^9, 3.701347997116221*^9}, {
  3.7013480718845043`*^9, 3.676408591804347*^9}, {3.676408642490996*^9, 
  3.6764086762726755`*^9}, {3.676408709551164*^9, 3.676408710363671*^9}, {
  3.676410198590645*^9, 3.676410534864976*^9}, {3.676410565738846*^9, 
  3.6764105972491283`*^9}, {3.6764106591939244`*^9, 3.676410660272084*^9}, {
  3.676410691480901*^9, 3.676410716598647*^9}, {3.676410765879891*^9, 
  3.6764108047677507`*^9}, {3.676410938669755*^9, 3.676411012658457*^9}, {
  3.676411073975812*^9, 3.6764111951530733`*^9}, {3.702507094804289*^9, 
  3.702507129292531*^9}, {3.7025071752765207`*^9, 3.702507226868946*^9}, {
  3.7025117147125463`*^9, 3.702511720232565*^9}, {3.702512801772422*^9, 
  3.702512802050424*^9}, {3.702523179995607*^9, 3.7025231994133883`*^9}, {
  3.702523254205488*^9, 3.7025232993561287`*^9}, {3.7025255312392178`*^9, 
  3.702525537710513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DivisorFactor", "[", 
    RowBox[{"div_", ",", "T_", ",", "P_", ",", "var_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "id", ",", "\n", "srf", ",", "norm\[Phi]", ",", 
       "a\[Phi]", ",", "a\[Infinity]", ",", "exp", ",", "prime\[Phi]", ",", 
       RowBox[{"result", "=", 
        RowBox[{"{", "}"}]}], ",", "norm\[Infinity]", ",", 
       "prime\[Infinity]"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"id", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], ",", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
        "}"}]}], ";", "\n", "\t", 
      RowBox[{"srf", "=", 
       RowBox[{"DivisorFactorSquareFree", "[", 
        RowBox[{"div", ",", "T", ",", "P", ",", "var", ",", "nf"}], "]"}]}], 
      ";", "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"exp", "=", 
          RowBox[{"srf", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"a\[Phi]", "=", 
          RowBox[{"srf", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"norm\[Phi]", "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Diagonal", "[", 
              RowBox[{
              "a\[Phi]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"norm\[Phi]", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"First", "/@", 
               RowBox[{"PolyFactor", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ")"}], 
             "&"}], ",", "norm\[Phi]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"norm\[Phi]", "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", "norm\[Phi]", "]"}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"prime\[Phi]", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"First", "/@", 
               RowBox[{"IdealFactorPoly", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ")"}], 
             "&"}], ",", "norm\[Phi]"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"a", " ", "little", " ", "wasteful"}], " ", "*)"}], "\n", 
         "\t\t", 
         RowBox[{"prime\[Phi]", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"prime\[Phi]", ",", "1"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IdealPlus", "[", 
               RowBox[{
                RowBox[{
                "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 ",", 
                RowBox[{
                "prime\[Phi]", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ",", "a\[Phi]", ",", "nf"}], 
               "]"}], "=!=", 
              RowBox[{
              "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"assert", "[", 
               RowBox[{
                RowBox[{"IdealPlus", "[", 
                 RowBox[{
                  RowBox[{
                  "var", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "prime\[Phi]", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", "a\[Phi]", ",", "nf"}], 
                 "]"}], "===", 
                RowBox[{
                "prime\[Phi]", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", "\n", "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"result", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "prime\[Phi]", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "id", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "exp"}], "}"}]}],
                "]"}]}]}], "\n", "\t\t\t", "]"}], "\n", "\t\t", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "prime\[Phi]", "]"}]}], "}"}]}], "]"}], 
         ";", "\n", "\t\t", 
         RowBox[{"a\[Infinity]", "=", 
          RowBox[{"srf", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"norm\[Infinity]", "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Diagonal", "[", 
              RowBox[{
              "a\[Infinity]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"prime\[Infinity]", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"First", "/@", 
               RowBox[{"IdealFactorPoly", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "nf"}], "]"}]}], ")"}], 
             "&"}], ",", "norm\[Infinity]"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"a", " ", "little", " ", "wasteful"}], " ", "*)"}], "\n", 
         "\t\t", 
         RowBox[{"prime\[Infinity]", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"prime\[Infinity]", ",", "1"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IdealPlusLocal", "[", 
               RowBox[{
                RowBox[{
                "var", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 ",", 
                RowBox[{
                "prime\[Infinity]", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], ",", "a\[Infinity]", ",", "nf"}], 
               "]"}], "=!=", 
              RowBox[{
              "id", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"assert", "[", 
               RowBox[{
                RowBox[{"IdealPlusLocal", "[", 
                 RowBox[{
                  RowBox[{
                  "var", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "prime\[Infinity]", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", "a\[Infinity]", ",", 
                  "nf"}], "]"}], "===", 
                RowBox[{
                "prime\[Infinity]", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", "\n", "\t\t\t\t", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"result", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "id", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "prime\[Infinity]", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "exp"}], "}"}]}],
                "]"}]}]}], "\n", "\t\t\t", "]"}], "\n", "\t\t", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "prime\[Infinity]", "]"}]}], "}"}]}], 
          "]"}], ";"}], "\n", "\t", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "srf", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", "result"}]}], "\n", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.702769370215033*^9, 3.702769375925613*^9}, {
   3.702769504887508*^9, 3.702769513506806*^9}, {3.702769567285551*^9, 
   3.702769569437612*^9}, {3.702769613573715*^9, 3.7027696166860323`*^9}, 
   3.70276984744587*^9, {3.702769900518202*^9, 3.702769900926248*^9}, {
   3.70277086399058*^9, 3.702770939126668*^9}, {3.702770973590827*^9, 
   3.702770992942885*^9}, {3.702771193927257*^9, 3.702771207215168*^9}, {
   3.702771271382909*^9, 3.7027714260714903`*^9}, {3.70277174498374*^9, 
   3.702771777743862*^9}, {3.7027725743278913`*^9, 3.702772594312199*^9}, {
   3.7027726351276493`*^9, 3.7027726626876907`*^9}, {3.70277270216817*^9, 
   3.702772709280353*^9}, {3.702772747808116*^9, 3.702772770672903*^9}, {
   3.702772803930069*^9, 3.702772841144279*^9}, {3.702772880839979*^9, 
   3.702772985912739*^9}, {3.7027730375767736`*^9, 3.702773107776944*^9}, {
   3.7027731763927107`*^9, 3.70277319321673*^9}, {3.702773270864777*^9, 
   3.702773450706739*^9}, {3.702773512514236*^9, 3.7027735875784063`*^9}, {
   3.702773837674077*^9, 3.702773869988902*^9}, {3.702773970274622*^9, 
   3.7027739804345713`*^9}, {3.7027741104592133`*^9, 3.702774111810978*^9}, {
   3.702774151515481*^9, 3.702774217962328*^9}, {3.702774342739339*^9, 
   3.702774351204842*^9}, {3.702774443331214*^9, 3.7027744966995497`*^9}, {
   3.702774830877184*^9, 3.702774832147628*^9}, {3.702774871924285*^9, 
   3.702774875915399*^9}, {3.702774961290975*^9, 3.702774999947072*^9}, {
   3.702775158963323*^9, 3.702775159418717*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"First", "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "^", "2"}], ",", "2"}], "}"}]}], "}"}]}], ")"}], "&"}],
    ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.702771662126239*^9, 3.7027717347988787`*^9}, 
   3.7027740010904922`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.7027716870558*^9, 3.702771735345077*^9}, 
   3.702774001536284*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"factor", " ", "poly", " ", "into", " ", "prime", " ", "ideals"}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "poly", " ", "should", " ", "be", " ", "irrducible", " ", "over", " ", 
    "nf\[Theta]"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IdealFactorPoly", "[", 
    RowBox[{"poly_", ",", "P\[Theta]_", ",", "x_", ",", "nf\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "P\[Theta]", "]"}]}], ",", "\n", "\[Phi]", ",",
        "\[Psi]", ",", "\[Omega]", ",", "\[Phi]x\[Theta]", ",", "nf\[Phi]", 
       ",", "ext\[Theta]\[Phi]", ",", "P\[Phi]", ",", "xr\[Phi]", ",", 
       "char\[Phi]", ",", "\n", "z", ",", "id", ",", "rmp", ",", "check", ",",
        "m", ",", "row", ",", "exp", ",", "primeideal", ",", "tot", ",", 
       "newideal", ",", 
       RowBox[{"result", "=", 
        RowBox[{"{", "}"}]}], ",", "helper"}], "}"}], ",", "\n", "\n", "\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"poly", ",", "x"}], "]"}], "===", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\n", "\t", "\n", "\t", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"poly", ",", "x"}], "]"}], ">", "0"}], ",", 
        "\"\<poly degree in IdealFactorPoly\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{"PolyIsSquareFree", "[", 
         RowBox[{"poly", ",", "x", ",", "nf\[Theta]"}], "]"}], ",", 
        "\"\<poly in IdealFactorPoly\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
      RowBox[{"tot", "=", 
       RowBox[{"poly", "*", "id"}]}], ";", "\n", "\t", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\[Phi]", " ", "is", " ", "generator", " ", "for", " ", "k_", "0"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]", ",", 
         "\[Phi]x\[Theta]"}], "}"}], "=", 
       RowBox[{"NumExtendRootIrrExt", "[", 
        RowBox[{"poly", ",", "x", ",", "nf\[Theta]", ",", "\[Phi]"}], "]"}]}],
       ";", "\n", "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"P\[Theta]", "/.", 
        RowBox[{
        "ext\[Theta]\[Phi]", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t", 
      RowBox[{"char\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Det", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "P\[Phi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"x", "\[Rule]", "xr\[Phi]"}]}], ")"}], "-", 
             RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", "nf\[Phi]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", "\n", "\t", 
      RowBox[{
       RowBox[{"helper", "[", 
        RowBox[{
        "i_", ",", "P\[Psi]_", ",", "xr\[Psi]_", ",", "char\[Psi]_", ",", 
         "ext\[Phi]\[Psi]_", ",", "nf\[Psi]_", ",", "al\[Psi]_", ",", 
         "ideal\[Psi]_"}], "]"}], ":=", "\n", "\t", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "nf\[Omega]", ",", "a\[Omega]", ",", "extk\[Omega]", ",", 
           "char\[Omega]", ",", "ext\[Phi]\[Omega]", ",", "ideal\[Omega]", 
           ",", "al\[Omega]", ",", "P\[Omega]", ",", "ext\[Psi]\[Omega]", ",",
            "xr\[Omega]", ",", "pzl", ",", "ii"}], "}"}], ",", "\n", "\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<helper called: \>\"", ",", 
             RowBox[{"RootReduce", "[", 
              RowBox[{"al\[Psi]", "/.", 
               RowBox[{"\[Psi]", "\[Rule]", 
                RowBox[{"Root", "[", 
                 RowBox[{
                  RowBox[{
                  "nf\[Psi]", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], ",", "1"}], "]"}]}]}], "]"}]}], 
            "]"}], ";"}], "*)"}], "\n", "\t\t", 
         RowBox[{
          RowBox[{"assert", "[", 
           RowBox[{
            RowBox[{
            "nf\[Psi]", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], "===", "\[Psi]"}], "]"}], "\n", 
          "\t\t", 
          RowBox[{"Which", "[", "\n", "\t\t", 
           RowBox[{
            RowBox[{"ideal\[Psi]", "===", "id"}], ",", "\n", "\t\t\t", 
            RowBox[{"(*", " ", "fail", " ", "*)"}], "\n", "\t\t\t", "Null", 
            ",", "\n", "\t\t", 
            RowBox[{
             RowBox[{"ii", "=", 
              RowBox[{"PolyMatrixInverse", "[", 
               RowBox[{"ideal\[Psi]", ",", "x", ",", "nf\[Psi]"}], "]"}]}], 
             ";", "\n", "\t\t", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"PolyRemainder", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                   "ii", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "x", ",", "nf\[Psi]"}], 
                  "]"}], "&"}], ",", 
                RowBox[{"PolyCollect", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"tot", "/.", 
                    RowBox[{
                    "ext\[Theta]\[Phi]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], "/.", 
                    RowBox[{
                    "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], ".", 
                   RowBox[{
                   "ii", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf\[Psi]"}], 
                 "]"}], ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], "=!=", 
              RowBox[{"0", "*", "id"}]}]}], ",", "\n", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "tot", " ", "not", " ", "divisible", " ", "by", " ", "ideal"}], 
             " ", "*)"}], "\n", "\t\t\t", "Null", ",", "\n", "\t\t", 
            RowBox[{"i", ">", "n"}], ",", "\n", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"build", " ", "a", " ", "prime", " ", "ideal"}], " ", 
             "*)"}], "\n", "\t\t\t", 
            RowBox[{
             RowBox[{"rmp", "=", 
              RowBox[{"First", "/@", 
               RowBox[{"PolyFactor", "[", 
                RowBox[{
                 RowBox[{
                 "nf\[Psi]", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "\[Psi]", ",", "nf\[Phi]"}],
                 "]"}]}]}], ";", "\n", "\t\t\t", 
             RowBox[{"check", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"NumCollect", "[", 
                   RowBox[{"#", ",", "nf\[Psi]"}], "]"}], "===", "0"}], "&"}],
                 ",", 
                RowBox[{"rmp", "/.", 
                 RowBox[{
                 "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"check", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"check", ",", "True", ",", 
                RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"assert", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "check", "]"}], "===", "1"}], ",", 
               "\"\<rmp check in IdealFactorPoly\>\""}], "]"}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"rmp", "=", 
              RowBox[{"rmp", "\[LeftDoubleBracket]", 
               RowBox[{"check", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"row", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"PolyRemainder", "[", 
                  RowBox[{"#", ",", "rmp", ",", "\[Psi]", ",", "nf\[Phi]"}], 
                  "]"}], "&"}], ",", "al\[Psi]"}], "]"}]}], ";", "\n", 
             "\t\t\t", 
             RowBox[{"m", "=", 
              RowBox[{
               RowBox[{"PolyNumRowNullSpace", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "row", "}"}], "]"}], ",", "\[Psi]", ",", 
                 "nf\[Phi]"}], "]"}], "/.", 
               RowBox[{"\[Phi]", "\[Rule]", "\[Phi]x\[Theta]"}]}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"primeideal", "=", 
              RowBox[{"poly", "*", "id"}]}], ";", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"m", "=!=", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"primeideal", "=", 
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "m", "}"}], ",", 
                   RowBox[{"{", "primeideal", "}"}]}], "}"}], "]"}]}]}], 
              "]"}], ";", "\n", "\t\t\t", 
             RowBox[{"primeideal", "=", 
              RowBox[{
               RowBox[{"PolyHermitianReduce", "[", 
                RowBox[{"primeideal", ",", "x", ",", "nf\[Theta]"}], "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
             "\n", "\t\t\t", 
             RowBox[{"exp", "=", "0"}], ";", "\n", "\t\t\t", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newideal", "=", 
                 RowBox[{"IdealDivide", "[", 
                  RowBox[{"x", ",", "P\[Theta]", ",", 
                   RowBox[{"{", 
                    RowBox[{"tot", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"primeideal", ",", "1"}], "}"}], ",", 
                   "nf\[Theta]"}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{
                 "newideal", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "===", "1"}]}], ",", 
               RowBox[{
                RowBox[{"exp", "++"}], ";", 
                RowBox[{"tot", "=", 
                 RowBox[{
                 "newideal", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}]}], "]"}], ";", "\n", "\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"exp", "=!=", "0"}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"result", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"primeideal", ",", "1"}], "}"}], ",", "exp"}], 
                  "}"}]}], "]"}]}], "]"}], ";"}], "\n", "\t\t\t", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<factor: \>\"", ",", 
                RowBox[{"IdealPrint", "[", 
                 RowBox[{"{", 
                  RowBox[{"primeideal", ",", "1"}], "}"}], "]"}], ",", 
                "\"\< ^ \>\"", ",", "exp"}], "]"}], ";"}], "*)"}], ",", "\n", 
            "\t\t", "True", ",", "\n", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"try", " ", "more", " ", "factors"}], " ", "*)"}], "\n", 
            "\t\t\t", 
            RowBox[{
             RowBox[{"pzl", "=", 
              RowBox[{"First", "/@", 
               RowBox[{"PolyFactor", "[", 
                RowBox[{
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{"Det", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "P\[Psi]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/.", 
                    RowBox[{"x", "\[Rule]", "xr\[Psi]"}]}], ")"}], "-", 
                    RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", 
                   "nf\[Psi]"}], "]"}], ",", "z", ",", "nf\[Psi]"}], 
                "]"}]}]}], ";", "\n", "\t\t\t", 
             RowBox[{"Do", "[", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "nf\[Omega]", ",", "a\[Omega]", ",", "ext\[Psi]\[Omega]"}], 
                  "}"}], "=", 
                 RowBox[{"NumExtendRootIrr", "[", 
                  RowBox[{"pz", ",", "z", ",", "nf\[Psi]", ",", "\[Omega]"}], 
                  "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"P\[Omega]", "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{"P\[Psi]", "/.", 
                    RowBox[{
                    "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", 
                   "nf\[Omega]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"xr\[Omega]", "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{"xr\[Psi]", "/.", 
                    RowBox[{
                    "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", 
                   "nf\[Omega]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"char\[Omega]", "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{"char\[Psi]", "/.", 
                    RowBox[{
                    "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", 
                   "nf\[Omega]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"ext\[Phi]\[Omega]", "=", "ext\[Phi]\[Psi]"}], ";", 
                RowBox[{
                 RowBox[{"ext\[Phi]\[Omega]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"NumCollect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
                    
                    RowBox[{
                    "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "nf\[Omega]"}], "]"}]}],
                 ";", "\n", "\t\t\t\t", 
                RowBox[{"al\[Omega]", "=", 
                 RowBox[{"PolyCollect", "[", 
                  RowBox[{
                   RowBox[{"al\[Psi]", "/.", 
                    RowBox[{
                    "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "x", ",", 
                   "nf\[Omega]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                 "al\[Omega]", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "=", "a\[Omega]"}], ";", "\n", 
                "\t\t\t\t", 
                RowBox[{"ideal\[Omega]", "=", 
                 RowBox[{"ideal\[Psi]", "/.", 
                  RowBox[{
                  "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{"ideal\[Omega]", "=", 
                 RowBox[{
                  RowBox[{"PolyHermitianReduce", "[", 
                   RowBox[{
                    RowBox[{"ArrayFlatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "ideal\[Omega]", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "P\[Omega]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "al\[Omega]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "*", "id"}]}], "}"}]}], "}"}], 
                    "]"}], ",", "x", ",", "nf\[Omega]"}], "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"helper", "[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", 
                  RowBox[{"P\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}], ",", 
                  RowBox[{"xr\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}], ",", 
                  RowBox[{"char\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}], ",", 
                  RowBox[{"ext\[Phi]\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}], ",", 
                  RowBox[{"nf\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}], ",", 
                  RowBox[{"al\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}], ",", 
                  RowBox[{"ideal\[Omega]", "/.", 
                   RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], "]"}], 
                ";"}], "\n", "\t\t\t", ",", 
               RowBox[{"{", 
                RowBox[{"pz", ",", "pzl"}], "}"}]}], "]"}], ";"}]}], "\n", 
           "\t\t", "]"}]}]}], "\n", "\t", "]"}]}], ";", "\n", "\n", "\t", 
      RowBox[{"helper", "[", 
       RowBox[{"1", ",", 
        RowBox[{"P\[Phi]", "/.", 
         RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}], ",", 
        RowBox[{"xr\[Phi]", "/.", 
         RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}], ",", 
        RowBox[{"char\[Phi]", "/.", 
         RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}], ",", 
        RowBox[{"NFExt", "[", 
         RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}], "]"}], ",", 
        RowBox[{"nf\[Phi]", "/.", 
         RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", "n"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "-", "xr\[Phi]"}], "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}], ")"}], "*", "id"}]}], 
       "]"}], ";", "\n", "\n", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{"tot", "===", "id"}], ",", 
        "\"\<tot=id in IdealFactorPoly\>\""}], "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<result: \>\"", ",", "result"}], "]"}], ";"}], "*)"}], 
      "\n", "result"}]}], "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.7025690374701033`*^9, 3.7025691128051233`*^9}, {
   3.702569327709673*^9, 3.7025693577571363`*^9}, {3.702569435045545*^9, 
   3.70256951010946*^9}, {3.702573704859016*^9, 3.7025737350592337`*^9}, {
   3.702573930099269*^9, 3.70257407834791*^9}, {3.7025741119000607`*^9, 
   3.7025741253475943`*^9}, 3.70257428256425*^9, {3.702574516388569*^9, 
   3.702574557236826*^9}, {3.7025746235889587`*^9, 3.702574660644827*^9}, {
   3.7025747085007267`*^9, 3.7025747089170513`*^9}, {3.702574754724987*^9, 
   3.702574773340601*^9}, {3.702574860070899*^9, 3.702574900461481*^9}, {
   3.7025749389097357`*^9, 3.702574985189968*^9}, {3.702575016469598*^9, 
   3.702575142773576*^9}, {3.7025752301261168`*^9, 3.702575302518358*^9}, {
   3.702575333038371*^9, 3.702575335709703*^9}, {3.7025756606470327`*^9, 
   3.702575782415296*^9}, {3.7025758595030622`*^9, 3.7025758812876177`*^9}, {
   3.702575956015514*^9, 3.7025759770232973`*^9}, {3.702576023207487*^9, 
   3.702576059255286*^9}, {3.7025761133435698`*^9, 3.702576174431531*^9}, {
   3.702576232359622*^9, 3.70257627240187*^9}, {3.7025763048575687`*^9, 
   3.7025763050253563`*^9}, {3.7025763407776403`*^9, 
   3.7025765538329477`*^9}, {3.702576588003302*^9, 3.702576595209152*^9}, {
   3.7025766336583357`*^9, 3.702576698890081*^9}, {3.702577002788303*^9, 
   3.7025770258448477`*^9}, {3.7025770584040318`*^9, 3.702577064691435*^9}, {
   3.702577141315675*^9, 3.7025771571238832`*^9}, {3.702577190332767*^9, 
   3.702577203450235*^9}, {3.702577401931744*^9, 3.702577497795436*^9}, {
   3.702577566358738*^9, 3.702577620092716*^9}, {3.702577651292952*^9, 
   3.702577680309445*^9}, {3.702577755189547*^9, 3.702578000957938*^9}, {
   3.702629680565123*^9, 3.702629681508788*^9}, {3.7026299270061827`*^9, 
   3.702629927334106*^9}, {3.7026299845512657`*^9, 3.702629998046241*^9}, {
   3.7026300374224977`*^9, 3.7026301067740307`*^9}, {3.702630166454204*^9, 
   3.7026302002710667`*^9}, {3.702630239100835*^9, 3.702630267264001*^9}, {
   3.70263036947937*^9, 3.702630418864184*^9}, {3.7026304655752497`*^9, 
   3.702630702664343*^9}, {3.702630733614696*^9, 3.702631034161614*^9}, {
   3.702631089311322*^9, 3.7026311138078327`*^9}, {3.702631431047391*^9, 
   3.702631457096974*^9}, {3.702631568711631*^9, 3.7026319145032053`*^9}, {
   3.7026344318188457`*^9, 3.702634432154147*^9}, {3.702634655155199*^9, 
   3.702634832840616*^9}, {3.702635014427491*^9, 3.702635058570422*^9}, {
   3.702635108875053*^9, 3.702635164507675*^9}, {3.702635225243853*^9, 
   3.702635246284072*^9}, {3.702635283788045*^9, 3.702635286771943*^9}, {
   3.702635690612574*^9, 3.7026356910124187`*^9}, {3.702636424141666*^9, 
   3.702636425327176*^9}, 3.7026364946776*^9, {3.702636647670808*^9, 
   3.7026366617737207`*^9}, {3.702636742685689*^9, 3.702636789854401*^9}, {
   3.702636992517885*^9, 3.702637004966202*^9}, {3.702637195958434*^9, 
   3.70263728893472*^9}, {3.702637320950798*^9, 3.702637336695846*^9}, {
   3.7026373842868433`*^9, 3.702637425639083*^9}, {3.7026374621349297`*^9, 
   3.70263761074402*^9}, {3.702637645271245*^9, 3.702637645439344*^9}, {
   3.702637677695592*^9, 3.702637696783085*^9}, {3.702637778895561*^9, 
   3.702637870087698*^9}, {3.702637978912427*^9, 3.7026380826140537`*^9}, {
   3.702638169136582*^9, 3.702638206907246*^9}, {3.702657638692161*^9, 
   3.702657669994176*^9}, {3.7026577250506077`*^9, 3.7026577374268427`*^9}, {
   3.70265777781031*^9, 3.702657784530615*^9}, {3.7026601513570004`*^9, 
   3.7026601590703707`*^9}, {3.70266029261327*^9, 3.702660320750514*^9}, {
   3.7026606875098658`*^9, 3.702660688197665*^9}, {3.7026607207819347`*^9, 
   3.702660793655553*^9}, {3.702660916270576*^9, 3.702660934982698*^9}, {
   3.70266103873403*^9, 3.702661135854739*^9}, {3.70266192018452*^9, 
   3.702662007278536*^9}, {3.702662105432336*^9, 3.702662172141725*^9}, {
   3.7026622459129267`*^9, 3.702662250952691*^9}, {3.702662320464878*^9, 
   3.702662384941019*^9}, {3.702662438689145*^9, 3.7026624403959293`*^9}, {
   3.7026624723850718`*^9, 3.7026624936732492`*^9}, {3.702662541538005*^9, 
   3.702662551360878*^9}, {3.7026626040494547`*^9, 3.702662650551519*^9}, {
   3.702662724720891*^9, 3.7026627417392406`*^9}, {3.702662780729879*^9, 
   3.702662823042094*^9}, {3.702662856963056*^9, 3.702662860785462*^9}, {
   3.702662953442111*^9, 3.7026629582258673`*^9}, {3.702663142083449*^9, 
   3.702663144659083*^9}, {3.702663189587001*^9, 3.702663217675044*^9}, {
   3.702663297763844*^9, 3.702663301017667*^9}, {3.702663334858385*^9, 
   3.7026633352233877`*^9}, {3.7026635197816877`*^9, 3.702663669380715*^9}, {
   3.702663746104727*^9, 3.702663944881353*^9}, {3.702663975419998*^9, 
   3.702663984564149*^9}, {3.702664025036538*^9, 3.7026640579010687`*^9}, {
   3.70266411429451*^9, 3.702664155665284*^9}, {3.702664200511838*^9, 
   3.7026643027905684`*^9}, {3.702664468160541*^9, 3.702664489554132*^9}, {
   3.702664529684175*^9, 3.7026646586756983`*^9}, {3.7026647104230433`*^9, 
   3.702664769560782*^9}, {3.702664803825329*^9, 3.702664915296653*^9}, {
   3.702664955065072*^9, 3.70266509959872*^9}, {3.702665139274743*^9, 
   3.702665181824697*^9}, {3.7026652753675756`*^9, 3.7026653565211287`*^9}, {
   3.702665411922595*^9, 3.702665432186445*^9}, {3.702665630899094*^9, 
   3.7026656955973063`*^9}, {3.702665760445953*^9, 3.7026658016445723`*^9}, {
   3.702666520811137*^9, 3.702666525593862*^9}, {3.702666574547625*^9, 
   3.702666583809862*^9}, {3.7026675319356337`*^9, 3.702667574878634*^9}, {
   3.7026676518749447`*^9, 3.702667856237681*^9}, {3.70266790979784*^9, 
   3.7026679907326937`*^9}, {3.702670087433675*^9, 3.702670089339592*^9}, {
   3.702671018057773*^9, 3.702671019009673*^9}, {3.70267109068992*^9, 
   3.702671113753769*^9}, {3.702722351932966*^9, 3.7027223599249907`*^9}, {
   3.70272239282031*^9, 3.70272240230007*^9}, {3.7027286815786448`*^9, 
   3.702728693938314*^9}, {3.702728733417831*^9, 3.70272874775541*^9}, {
   3.70272878034827*^9, 3.70272893742855*^9}, {3.702729058274818*^9, 
   3.7027291411868553`*^9}, {3.7027291731647673`*^9, 3.702729186804433*^9}, {
   3.702729274138884*^9, 3.702729474260097*^9}, {3.702730817557629*^9, 
   3.702730871573841*^9}, {3.7027309780379133`*^9, 3.702731006897011*^9}, {
   3.702731081101141*^9, 3.7027310899440937`*^9}, {3.702731153166337*^9, 
   3.7027312134452877`*^9}, {3.702731268461059*^9, 3.702731435637041*^9}, {
   3.7027314807013483`*^9, 3.7027316587738256`*^9}, {3.7027316908380623`*^9, 
   3.702731692478126*^9}, {3.7027317429500227`*^9, 3.7027318606456127`*^9}, {
   3.702731899880342*^9, 3.702732113329886*^9}, {3.7027321548228617`*^9, 
   3.7027323762162447`*^9}, {3.702732514877214*^9, 3.7027327390686083`*^9}, {
   3.702732781902094*^9, 3.7027328188632803`*^9}, {3.702732853661248*^9, 
   3.702732923261763*^9}, {3.702732976684958*^9, 3.702733000693757*^9}, {
   3.702733037253621*^9, 3.702733138573575*^9}, {3.702733171253764*^9, 
   3.7027331774084883`*^9}, {3.7027332098699512`*^9, 3.702733213195719*^9}, {
   3.7027333623505707`*^9, 3.70273351817914*^9}, {3.702733554470455*^9, 
   3.70273359819285*^9}, {3.702733793734662*^9, 3.702733861430628*^9}, {
   3.702734008016654*^9, 3.70273401994591*^9}, {3.7027344917829237`*^9, 
   3.702734536127529*^9}, {3.702734642631296*^9, 3.702734661516151*^9}, {
   3.7027347537604113`*^9, 3.702734754159864*^9}, {3.702734792407672*^9, 
   3.702734930606719*^9}, {3.702734969049041*^9, 3.7027350838973722`*^9}, {
   3.702735126176866*^9, 3.7027351327206783`*^9}, {3.7027359135139503`*^9, 
   3.702735913929788*^9}, {3.7027360305386066`*^9, 3.7027360344566193`*^9}, {
   3.702736095817114*^9, 3.702736197376411*^9}, {3.7027362302332*^9, 
   3.7027364681228533`*^9}, {3.7027365158026752`*^9, 3.702736532411168*^9}, {
   3.702736663211116*^9, 3.7027366773357773`*^9}, {3.702736723235383*^9, 
   3.702736971972527*^9}, {3.7027370187872667`*^9, 3.702737574356864*^9}, {
   3.702737606172916*^9, 3.7027377225309*^9}, {3.702737774459255*^9, 
   3.702737794869681*^9}, {3.7027378258675537`*^9, 3.702737852980585*^9}, {
   3.702737884790506*^9, 3.702737947595945*^9}, {3.702737984396031*^9, 
   3.702737989770578*^9}, {3.702738077114646*^9, 3.702738080924358*^9}, {
   3.70273811577232*^9, 3.702738120482785*^9}, {3.7027381680457487`*^9, 
   3.702738223194211*^9}, {3.7027382667019367`*^9, 3.702738351803411*^9}, {
   3.702738413531661*^9, 3.702738450918189*^9}, {3.702738540253669*^9, 
   3.702738540554659*^9}, {3.702738591669313*^9, 3.702738592629751*^9}, {
   3.702738633205308*^9, 3.7027387038213167`*^9}, {3.702738803901826*^9, 
   3.702738822933813*^9}, {3.702738853901579*^9, 3.702739002261661*^9}, {
   3.702739051479259*^9, 3.702739188230054*^9}, {3.702739223166275*^9, 
   3.7027392482390347`*^9}, {3.702739287326847*^9, 3.702739300094495*^9}, {
   3.7027393333030024`*^9, 3.702739334279133*^9}, {3.7027393657430162`*^9, 
   3.702739439655768*^9}, {3.7027400188003197`*^9, 3.702740181295807*^9}, {
   3.7027402560080957`*^9, 3.702740257343665*^9}, {3.702740289063491*^9, 
   3.702740290784371*^9}, {3.702740336703968*^9, 3.70274033770199*^9}, {
   3.702740465103723*^9, 3.7027404661251297`*^9}, {3.702769100564165*^9, 
   3.702769104155457*^9}, {3.7027695899391403`*^9, 3.702769604283618*^9}, {
   3.702769763940548*^9, 3.702769765476655*^9}, {3.7027727780373287`*^9, 
   3.702772780549315*^9}, {3.702773780710238*^9, 3.7027738143656187`*^9}, {
   3.7027746954053707`*^9, 3.702774701979134*^9}, {3.70277503200533*^9, 
   3.702775039844634*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlaceDecompose", "[", 
     RowBox[{"PP_", ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "x0_"}], "}"}], ",", "nf_", ",", "\[Phi]_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "PP", "]"}]}], ",", "P", ",", "z", ",", "f", 
        ",", "const", ",", "conm", ",", "A", ",", "\n", "\[Lambda]", ",", 
        "cor", ",", "var", ",", "arg", ",", "ideal", ",", "newideal", ",", 
        "newnf", ",", "ext", ",", "id", ",", "tot", ",", "tot2", ",", 
        "gcdideal", ",", 
        RowBox[{"ideals", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"id", "=", 
        RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"Det", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "PP", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "/.", 
                RowBox[{"x", "\[Rule]", "x0"}]}], ")"}], "-", 
              RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", "nf"}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newnf", ",", "A", ",", "ext"}], "}"}], "=", 
        RowBox[{"NumExtendSplitList", "[", 
         RowBox[{"A", ",", "z", ",", "nf", ",", "\[Phi]"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"A", "=", 
        RowBox[{"Transpose", "[", "A", "]"}]}], ";", "\n", "\t", 
       RowBox[{"cor", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"False", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<A: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"#2", ",", 
                 RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], 
               "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"A", ",", "cor"}], "}"}], ",", "2"}], "]"}], "]"}]}], 
          "]"}], ";"}], "*)"}], "\n", "\t", 
       RowBox[{"P", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{"#", "/.", 
              RowBox[{
              "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
              ",", "newnf"}], "]"}], "&"}], ",", "PP", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"tot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"NumCollect", "[", 
            RowBox[{
             RowBox[{"x0", "/.", 
              RowBox[{
              "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
              ",", "newnf"}], "]"}]}], ")"}], "*", "id"}]}], ";", "\n", "\t", 
       
       RowBox[{"Do", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"ideal", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", 
              RowBox[{"NumCollect", "[", 
               RowBox[{
                RowBox[{"x0", "/.", 
                 RowBox[{
                 "ext", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", "newnf"}], "]"}]}], ")"}],
             "*", "id"}]}], ";", "\n", "\t\t", 
          RowBox[{"Do", "[", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Do", "[", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"newideal", "=", 
                 RowBox[{"ArrayFlatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "ideal", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                    "id"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                
                RowBox[{"newideal", "=", 
                 RowBox[{
                  RowBox[{"PolyHermitianReduce", "[", 
                   RowBox[{"newideal", ",", "x", ",", "newnf"}], "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"newideal", "===", 
                   RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                  RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
                "\t\t\t\t", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "newideal", " ", "is", " ", "now", " ", "a", " ", "proper", 
                  " ", "ideal"}], " ", "*)"}], "\n", "\t\t\t\t", 
                RowBox[{"gcdideal", "=", 
                 RowBox[{"ArrayFlatten", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "newideal", "}"}], ",", 
                    RowBox[{"{", "tot", "}"}]}], "}"}], "]"}]}], ";", "\n", 
                "\t\t\t\t", 
                RowBox[{"gcdideal", "=", 
                 RowBox[{
                  RowBox[{"PolyHermitianReduce", "[", 
                   RowBox[{"gcdideal", ",", "x", ",", "newnf"}], "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
                "\n", "\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"gcdideal", "===", 
                   RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                  RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
                "\t\t\t\t", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "newideal", " ", "now", " ", "has", " ", "a", " ", "factor", 
                  " ", "in", " ", "common", " ", "with", " ", "tot"}], " ", 
                 "*)"}], "\n", "\t\t\t\t", 
                RowBox[{"ideal", "=", "newideal"}], ";", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                  "}"}], "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                  "}"}]}], ";", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"cor", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
                 "True"}], ";", "\n", "\t\t\t\t", 
                RowBox[{"Break", "[", "]"}], ";"}], "\n", "\t\t\t", ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "i", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
             "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"cor", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<oops in PrimeDecomposition\>\"", "]"}], 
                ";", 
                RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<A: \>\"", ",", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], 
                    "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", "cor"}], "}"}], ",", "2"}], "]"}], 
                 "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
          "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ideals", ",", 
            RowBox[{"{", 
             RowBox[{"ideal", ",", "1"}], "}"}]}], "]"}], ";", "\n", "\t", 
          RowBox[{"tot", "=", 
           RowBox[{"IdealDivide", "[", 
            RowBox[{"x", ",", "P", ",", 
             RowBox[{"{", 
              RowBox[{"tot", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ideal", ",", "1"}], "}"}], ",", "newnf"}], "]"}]}], 
          ";", "\n", "\t", 
          RowBox[{"tot", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PolyDivide", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                "tot", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 ",", "x", ",", "newnf"}], "]"}], "&"}], ",", 
             RowBox[{
             "tot", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", "\t", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
       
       RowBox[{"{", 
        RowBox[{"A", ",", "ideals", ",", "newnf", ",", "ext"}], "}"}]}]}], 
     "\n", "]"}]}], ";"}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlacesOver", "[", 
    RowBox[{"\[Infinity]", ",", "P_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_", ",", "\[Phi]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "res"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"PlaceDecompose", "[", 
        RowBox[{
         RowBox[{"P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "0"}], "}"}], ",", "nf", ",", "\[Phi]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
             ",", "#"}], "}"}], "&"}], ",", 
          RowBox[{
          "res", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", 
        RowBox[{"res", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{
        "res", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
       "}"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlacesOver", "[", 
    RowBox[{"x0_", ",", "P_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_", ",", "\[Phi]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}]}], ",", "res"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"PlaceDecompose", "[", 
        RowBox[{
         RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "x0"}], "}"}], ",", "nf", ",", "\[Phi]"}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}],
             "}"}], "&"}], ",", 
          RowBox[{
          "res", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", 
        RowBox[{"res", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
         ",", 
        RowBox[{
        "res", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
       "}"}]}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.702568982476461*^9, 3.702568986732489*^9}, {
  3.702569310008174*^9, 3.702569312697246*^9}, {3.702574085902255*^9, 
  3.702574103062389*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["factor old bad", "Subsection",
 CellChangeTimes->{{3.702735971014233*^9, 3.702735979011774*^9}, {
  3.702740576002021*^9, 3.702740576434094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"factor", " ", "poly", " ", "into", " ", "prime", " ", "ideals"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IdealFactorPolyRAND", "[", 
    RowBox[{"poly_", ",", "P\[Theta]_", ",", "x_", ",", "nf\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "P\[Theta]", "]"}]}], ",", "\n", "\[Phi]", ",",
        "\[Psi]", ",", "\[Omega]", ",", "\[Phi]x\[Theta]", ",", "\n", 
       "nf\[Phi]", ",", "nf\[Psi]", ",", "nf\[Omega]", ",", "\n", 
       "ext\[Theta]\[Phi]", ",", "ext\[Phi]\[Psi]", ",", "ext\[Psi]\[Omega]", 
       ",", "\n", "P\[Phi]", ",", "P\[Psi]", ",", "P\[Omega]", ",", "\n", 
       "xr\[Phi]", ",", "xr\[Psi]", ",", "xr\[Omega]", ",", "\n", 
       "char\[Phi]", ",", "char\[Psi]", ",", "char\[Omega]", ",", "\n", 
       "a\[Omega]", ",", "al\[Psi]", ",", "al\[Omega]", ",", "\n", 
       "ideal\[Psi]", ",", "ideal\[Omega]", ",", "\n", "pz", ",", "z", ",", 
       "id", ",", "rmp", ",", "check", ",", "m", ",", "row", ",", "exp", ",", 
       "primeideal", ",", "tot", ",", "newideal", ",", 
       RowBox[{"result", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\n", "\n", "\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"poly", ",", "x"}], "]"}], ">", "0"}], ",", 
        "\"\<poly degree in IdealFactorPoly\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{"PolyIsSquareFree", "[", 
         RowBox[{"poly", ",", "x", ",", "nf\[Theta]"}], "]"}], ",", 
        "\"\<poly in IdealFactorPoly\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", "\n", 
      "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "\[Psi]", " ", "is", " ", "generator", " ", "for", " ", "k_", "0"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]", ",", 
         "\[Phi]x\[Theta]"}], "}"}], "=", 
       RowBox[{"NumExtendRootIrrExt", "[", 
        RowBox[{"poly", ",", "x", ",", "nf\[Theta]", ",", "\[Phi]"}], "]"}]}],
       ";", "\n", "\t", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{nf\[Phi],xr,ext\[Theta]\[Phi]}: \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]"}], 
         "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"P\[Theta]", "/.", 
        RowBox[{
        "ext\[Theta]\[Phi]", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t", 
      RowBox[{"char\[Phi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Det", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "P\[Phi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"x", "\[Rule]", "xr\[Phi]"}]}], ")"}], "-", 
             RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", "nf\[Phi]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", "\n", 
      RowBox[{"tot", "=", 
       RowBox[{"poly", "*", "id"}]}], ";", "\n", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"tot", "=!=", "id"}], ",", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"\[Psi]", " ", "is", " ", "generator", " ", "for", " ", "k_", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}]}], " ", "*)"}], "\n", "\t", 
        RowBox[{
         RowBox[{"P\[Psi]", "=", 
          RowBox[{"P\[Phi]", "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}]}], ";", "\n", "\t", 
         RowBox[{"xr\[Psi]", "=", 
          RowBox[{"xr\[Phi]", "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}]}], ";", "\n", "\t", 
         RowBox[{"char\[Psi]", "=", 
          RowBox[{"char\[Phi]", "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}]}], ";", "\n", "\t", 
         RowBox[{"ext\[Phi]\[Psi]", "=", 
          RowBox[{"NFExt", "[", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}], "]"}]}], ";", "\n", "\t", 
         
         RowBox[{"nf\[Psi]", "=", 
          RowBox[{"nf\[Phi]", "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Psi]"}]}]}], ";", "\n", "\t", 
         RowBox[{"al\[Psi]", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"Null", ",", "n"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"ideal\[Psi]", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "xr\[Psi]"}], ")"}], "*", "id"}]}], ";", "\n", 
         "\t", 
         RowBox[{"tryagain", "=", "False"}], ";", "\n", "\t", 
         RowBox[{"Do", "[", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"pz", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"Det", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "P\[Psi]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/.", 
                   RowBox[{"x", "\[Rule]", "xr\[Psi]"}]}], ")"}], "-", 
                 RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", 
               "nf\[Psi]"}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"pz", "=", 
             RowBox[{"First", "/@", 
              RowBox[{"PolyFactor", "[", 
               RowBox[{"pz", ",", "z", ",", "nf\[Psi]"}], "]"}]}]}], ";", 
            "\n", "\t\t", 
            RowBox[{"pz", "=", 
             RowBox[{"RandomChoice", "[", "pz", "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<pz: \>\"", ",", "pz"}], "]"}], ";", "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "\[Omega]", " ", "is", " ", "generator", " ", "for", " ", "k_", 
              RowBox[{"(", "i", ")"}]}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "nf\[Omega]", ",", "a\[Omega]", ",", "ext\[Psi]\[Omega]"}], 
              "}"}], "=", 
             RowBox[{"NumExtendRootIrr", "[", 
              RowBox[{"pz", ",", "z", ",", "nf\[Psi]", ",", "\[Omega]"}], 
              "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"P\[Omega]", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"P\[Psi]", "/.", 
                RowBox[{
                "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf\[Omega]"}], 
              "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"xr\[Omega]", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"xr\[Psi]", "/.", 
                RowBox[{
                "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf\[Omega]"}], 
              "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"char\[Omega]", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"char\[Psi]", "/.", 
                RowBox[{
                "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf\[Omega]"}], 
              "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"al\[Omega]", "=", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"al\[Psi]", "/.", 
                RowBox[{
                "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "x", ",", "nf\[Omega]"}], 
              "]"}]}], ";", "\n", "\t\t", 
            RowBox[{
             RowBox[{
             "al\[Omega]", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "=", "a\[Omega]"}], ";", "\n", 
            "\t\t", 
            RowBox[{"ideal\[Omega]", "=", 
             RowBox[{"ideal\[Psi]", "/.", 
              RowBox[{
              "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t\t", 
            RowBox[{"P\[Psi]", "=", 
             RowBox[{"P\[Omega]", "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", 
            RowBox[{"P\[Omega]", "=", "Null"}], ";", "\n", "\t\t", 
            RowBox[{"xr\[Psi]", "=", 
             RowBox[{"xr\[Omega]", "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", 
            RowBox[{"xr\[Omega]", "=", "Null"}], ";", "\n", "\t\t", 
            RowBox[{"char\[Psi]", "=", 
             RowBox[{"char\[Omega]", "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", 
            RowBox[{"char\[Omega]", "=", "Null"}], ";", "\n", "\t\t", 
            RowBox[{
             RowBox[{"ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{"NumCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
                 RowBox[{
                 "ext\[Psi]\[Omega]", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", "nf\[Omega]"}], "]"}], "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", "\n", 
            "\t\t", 
            RowBox[{"nf\[Psi]", "=", 
             RowBox[{"nf\[Omega]", "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", 
            RowBox[{"nf\[Omega]", "=", "Null"}], ";", "\n", "\t\t", 
            RowBox[{"al\[Psi]", "=", 
             RowBox[{"al\[Omega]", "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", 
            RowBox[{"al\[Omega]", "=", 
             RowBox[{"a\[Omega]", "=", "Null"}]}], ";", "\n", "\t\t", 
            RowBox[{"ideal\[Psi]", "=", 
             RowBox[{"ideal\[Omega]", "/.", 
              RowBox[{"\[Omega]", "\[Rule]", "\[Psi]"}]}]}], ";", 
            RowBox[{"ideal\[Omega]", "=", "Null"}], ";", "\n", "\t\t", 
            RowBox[{"ideal\[Psi]", "=", 
             RowBox[{
              RowBox[{"PolyHermitianReduce", "[", 
               RowBox[{
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "ideal\[Psi]", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "P\[Psi]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "al\[Psi]", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "*", "id"}]}], "}"}]}], "}"}], 
                 "]"}], ",", "x", ",", "nf\[Psi]"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
            "\n", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ideal\[Psi]", "===", "id"}], ",", 
              RowBox[{
               RowBox[{"tryagain", "=", "True"}], ";", 
               RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}], "\n", "\t", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
         "\t", 
         RowBox[{"If", "[", 
          RowBox[{"tryagain", ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", "\t\t", "\n", 
         "\t", 
         RowBox[{"rmp", "=", 
          RowBox[{"First", "/@", 
           RowBox[{"PolyFactor", "[", 
            RowBox[{
             RowBox[{
             "nf\[Psi]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "\[Psi]", ",", "nf\[Phi]"}], 
            "]"}]}]}], ";", "\n", "\t", 
         RowBox[{"check", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"NumCollect", "[", 
               RowBox[{"#", ",", "nf\[Psi]"}], "]"}], "===", "0"}], "&"}], 
            ",", 
            RowBox[{"rmp", "/.", 
             RowBox[{
             "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"check", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"check", ",", "True", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"assert", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "check", "]"}], "===", "1"}], ",", 
           "\"\<rmp check in IdealFactorPoly\>\""}], "]"}], ";", "\n", "\t", 
         RowBox[{"rmp", "=", 
          RowBox[{"rmp", "\[LeftDoubleBracket]", 
           RowBox[{"check", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}]}], ";", "\n", "\t", "\n", "\t", 
         RowBox[{"row", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyRemainder", "[", 
              RowBox[{"#", ",", "rmp", ",", "\[Psi]", ",", "nf\[Phi]"}], 
              "]"}], "&"}], ",", "al\[Psi]"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"m", "=", 
          RowBox[{
           RowBox[{"PolyNumRowNullSpace", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "row", "}"}], "]"}], ",", "\[Psi]", ",", 
             "nf\[Phi]"}], "]"}], "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Phi]x\[Theta]"}]}]}], ";", "\n", 
         "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<m: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "m", "]"}]}], "]"}], ";", "\n", "\t", 
         RowBox[{"primeideal", "=", 
          RowBox[{"poly", "*", "id"}]}], ";", "\n", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"primeideal", "=", 
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "m", "}"}], ",", 
               RowBox[{"{", "primeideal", "}"}]}], "}"}], "]"}]}]}], "]"}], 
         ";", "\n", "\t", 
         RowBox[{"primeideal", "=", 
          RowBox[{
           RowBox[{"PolyHermitianReduce", "[", 
            RowBox[{"primeideal", ",", "x", ",", "nf\[Theta]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t", "\n", "\t", 
         RowBox[{"exp", "=", "0"}], ";", "\n", "\t", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newideal", "=", 
             RowBox[{"IdealDivide", "[", 
              RowBox[{"x", ",", "P\[Theta]", ",", 
               RowBox[{"{", 
                RowBox[{"tot", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"primeideal", ",", "1"}], "}"}], ",", "nf\[Theta]"}], 
              "]"}]}], ";", 
            RowBox[{
             RowBox[{
             "newideal", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "===", "1"}]}], ",", 
           RowBox[{
            RowBox[{"exp", "++"}], ";", 
            RowBox[{"tot", "=", 
             RowBox[{
             "newideal", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}]}], "]"}], ";", "\n", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"exp", "=!=", "0"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"result", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"primeideal", ",", "1"}], "}"}], ",", "exp"}], 
              "}"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<factor: \>\"", ",", 
           RowBox[{"IdealPrint", "[", 
            RowBox[{"{", 
             RowBox[{"primeideal", ",", "1"}], "}"}], "]"}], ",", 
           "\"\< ^ \>\"", ",", "exp"}], "]"}], ";"}]}], "\n", "]"}], ";", 
      "\n", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<should be one: \>\"", ",", "tot"}], "]"}], ";", "\n", 
      "result"}]}], "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.7025690374701033`*^9, 3.7025691128051233`*^9}, {
   3.702569327709673*^9, 3.7025693577571363`*^9}, {3.702569435045545*^9, 
   3.70256951010946*^9}, {3.702573704859016*^9, 3.7025737350592337`*^9}, {
   3.702573930099269*^9, 3.70257407834791*^9}, {3.7025741119000607`*^9, 
   3.7025741253475943`*^9}, 3.70257428256425*^9, {3.702574516388569*^9, 
   3.702574557236826*^9}, {3.7025746235889587`*^9, 3.702574660644827*^9}, {
   3.7025747085007267`*^9, 3.7025747089170513`*^9}, {3.702574754724987*^9, 
   3.702574773340601*^9}, {3.702574860070899*^9, 3.702574900461481*^9}, {
   3.7025749389097357`*^9, 3.702574985189968*^9}, {3.702575016469598*^9, 
   3.702575142773576*^9}, {3.7025752301261168`*^9, 3.702575302518358*^9}, {
   3.702575333038371*^9, 3.702575335709703*^9}, {3.7025756606470327`*^9, 
   3.702575782415296*^9}, {3.7025758595030622`*^9, 3.7025758812876177`*^9}, {
   3.702575956015514*^9, 3.7025759770232973`*^9}, {3.702576023207487*^9, 
   3.702576059255286*^9}, {3.7025761133435698`*^9, 3.702576174431531*^9}, {
   3.702576232359622*^9, 3.70257627240187*^9}, {3.7025763048575687`*^9, 
   3.7025763050253563`*^9}, {3.7025763407776403`*^9, 
   3.7025765538329477`*^9}, {3.702576588003302*^9, 3.702576595209152*^9}, {
   3.7025766336583357`*^9, 3.702576698890081*^9}, {3.702577002788303*^9, 
   3.7025770258448477`*^9}, {3.7025770584040318`*^9, 3.702577064691435*^9}, {
   3.702577141315675*^9, 3.7025771571238832`*^9}, {3.702577190332767*^9, 
   3.702577203450235*^9}, {3.702577401931744*^9, 3.702577497795436*^9}, {
   3.702577566358738*^9, 3.702577620092716*^9}, {3.702577651292952*^9, 
   3.702577680309445*^9}, {3.702577755189547*^9, 3.702578000957938*^9}, {
   3.702629680565123*^9, 3.702629681508788*^9}, {3.7026299270061827`*^9, 
   3.702629927334106*^9}, {3.7026299845512657`*^9, 3.702629998046241*^9}, {
   3.7026300374224977`*^9, 3.7026301067740307`*^9}, {3.702630166454204*^9, 
   3.7026302002710667`*^9}, {3.702630239100835*^9, 3.702630267264001*^9}, {
   3.70263036947937*^9, 3.702630418864184*^9}, {3.7026304655752497`*^9, 
   3.702630702664343*^9}, {3.702630733614696*^9, 3.702631034161614*^9}, {
   3.702631089311322*^9, 3.7026311138078327`*^9}, {3.702631431047391*^9, 
   3.702631457096974*^9}, {3.702631568711631*^9, 3.7026319145032053`*^9}, {
   3.7026344318188457`*^9, 3.702634432154147*^9}, {3.702634655155199*^9, 
   3.702634832840616*^9}, {3.702635014427491*^9, 3.702635058570422*^9}, {
   3.702635108875053*^9, 3.702635164507675*^9}, {3.702635225243853*^9, 
   3.702635246284072*^9}, {3.702635283788045*^9, 3.702635286771943*^9}, {
   3.702635690612574*^9, 3.7026356910124187`*^9}, {3.702636424141666*^9, 
   3.702636425327176*^9}, 3.7026364946776*^9, {3.702636647670808*^9, 
   3.7026366617737207`*^9}, {3.702636742685689*^9, 3.702636789854401*^9}, {
   3.702636992517885*^9, 3.702637004966202*^9}, {3.702637195958434*^9, 
   3.70263728893472*^9}, {3.702637320950798*^9, 3.702637336695846*^9}, {
   3.7026373842868433`*^9, 3.702637425639083*^9}, {3.7026374621349297`*^9, 
   3.70263761074402*^9}, {3.702637645271245*^9, 3.702637645439344*^9}, {
   3.702637677695592*^9, 3.702637696783085*^9}, {3.702637778895561*^9, 
   3.702637870087698*^9}, {3.702637978912427*^9, 3.7026380826140537`*^9}, {
   3.702638169136582*^9, 3.702638206907246*^9}, {3.702657638692161*^9, 
   3.702657669994176*^9}, {3.7026577250506077`*^9, 3.7026577374268427`*^9}, {
   3.70265777781031*^9, 3.702657784530615*^9}, {3.7026601513570004`*^9, 
   3.7026601590703707`*^9}, {3.70266029261327*^9, 3.702660320750514*^9}, {
   3.7026606875098658`*^9, 3.702660688197665*^9}, {3.7026607207819347`*^9, 
   3.702660793655553*^9}, {3.702660916270576*^9, 3.702660934982698*^9}, {
   3.70266103873403*^9, 3.702661135854739*^9}, {3.70266192018452*^9, 
   3.702662007278536*^9}, {3.702662105432336*^9, 3.702662172141725*^9}, {
   3.7026622459129267`*^9, 3.702662250952691*^9}, {3.702662320464878*^9, 
   3.702662384941019*^9}, {3.702662438689145*^9, 3.7026624403959293`*^9}, {
   3.7026624723850718`*^9, 3.7026624936732492`*^9}, {3.702662541538005*^9, 
   3.702662551360878*^9}, {3.7026626040494547`*^9, 3.702662650551519*^9}, {
   3.702662724720891*^9, 3.7026627417392406`*^9}, {3.702662780729879*^9, 
   3.702662823042094*^9}, {3.702662856963056*^9, 3.702662860785462*^9}, {
   3.702662953442111*^9, 3.7026629582258673`*^9}, {3.702663142083449*^9, 
   3.702663144659083*^9}, {3.702663189587001*^9, 3.702663217675044*^9}, {
   3.702663297763844*^9, 3.702663301017667*^9}, {3.702663334858385*^9, 
   3.7026633352233877`*^9}, {3.7026635197816877`*^9, 3.702663669380715*^9}, {
   3.702663746104727*^9, 3.702663944881353*^9}, {3.702663975419998*^9, 
   3.702663984564149*^9}, {3.702664025036538*^9, 3.7026640579010687`*^9}, {
   3.70266411429451*^9, 3.702664155665284*^9}, {3.702664200511838*^9, 
   3.7026643027905684`*^9}, {3.702664468160541*^9, 3.702664489554132*^9}, {
   3.702664529684175*^9, 3.7026646586756983`*^9}, {3.7026647104230433`*^9, 
   3.702664769560782*^9}, {3.702664803825329*^9, 3.702664915296653*^9}, {
   3.702664955065072*^9, 3.70266509959872*^9}, {3.702665139274743*^9, 
   3.702665181824697*^9}, {3.7026652753675756`*^9, 3.7026653565211287`*^9}, {
   3.702665411922595*^9, 3.702665432186445*^9}, {3.702665630899094*^9, 
   3.7026656955973063`*^9}, {3.702665760445953*^9, 3.7026658016445723`*^9}, {
   3.702666520811137*^9, 3.702666525593862*^9}, {3.702666574547625*^9, 
   3.702666583809862*^9}, {3.7026675319356337`*^9, 3.702667574878634*^9}, {
   3.7026676518749447`*^9, 3.702667856237681*^9}, {3.70266790979784*^9, 
   3.7026679907326937`*^9}, {3.702670087433675*^9, 3.702670089339592*^9}, {
   3.702671018057773*^9, 3.702671019009673*^9}, {3.70267109068992*^9, 
   3.702671113753769*^9}, {3.702722351932966*^9, 3.7027223599249907`*^9}, {
   3.70272239282031*^9, 3.70272240230007*^9}, {3.7027286815786448`*^9, 
   3.702728693938314*^9}, {3.702728733417831*^9, 3.70272874775541*^9}, {
   3.70272878034827*^9, 3.70272893742855*^9}, {3.702729058274818*^9, 
   3.7027291411868553`*^9}, {3.7027291731647673`*^9, 3.702729186804433*^9}, {
   3.702729274138884*^9, 3.702729474260097*^9}, {3.702730817557629*^9, 
   3.702730871573841*^9}, {3.7027309780379133`*^9, 3.702731006897011*^9}, {
   3.702731081101141*^9, 3.7027310899440937`*^9}, {3.702731153166337*^9, 
   3.7027312134452877`*^9}, {3.702731268461059*^9, 3.702731435637041*^9}, {
   3.7027314807013483`*^9, 3.7027316587738256`*^9}, {3.7027316908380623`*^9, 
   3.702731692478126*^9}, {3.7027317429500227`*^9, 3.7027318606456127`*^9}, {
   3.702731899880342*^9, 3.702732113329886*^9}, {3.7027321548228617`*^9, 
   3.7027323762162447`*^9}, {3.702732514877214*^9, 3.7027327390686083`*^9}, {
   3.702732781902094*^9, 3.7027328188632803`*^9}, {3.702732853661248*^9, 
   3.702732923261763*^9}, {3.702732976684958*^9, 3.702733000693757*^9}, {
   3.702733037253621*^9, 3.702733138573575*^9}, {3.702733171253764*^9, 
   3.7027331774084883`*^9}, {3.7027332098699512`*^9, 3.702733213195719*^9}, {
   3.7027333623505707`*^9, 3.70273351817914*^9}, {3.702733554470455*^9, 
   3.70273359819285*^9}, {3.702733793734662*^9, 3.702733861430628*^9}, {
   3.702734008016654*^9, 3.70273401994591*^9}, {3.7027344917829237`*^9, 
   3.702734536127529*^9}, {3.702734642631296*^9, 3.702734661516151*^9}, {
   3.7027347537604113`*^9, 3.702734754159864*^9}, {3.702734792407672*^9, 
   3.702734930606719*^9}, {3.702734969049041*^9, 3.7027350838973722`*^9}, {
   3.702735126176866*^9, 3.7027351327206783`*^9}, {3.7027359135139503`*^9, 
   3.702735913929788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"factor", " ", "poly", " ", "into", " ", "prime", " ", "ideals"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IdealFactorPoly", "[", 
    RowBox[{"poly_", ",", "P\[Theta]_", ",", "x_", ",", "nf\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "P\[Theta]", "]"}]}], ",", "nf\[Phi]", ",", 
       "nf\[Psi]", ",", "ext\[Theta]\[Phi]", ",", "ext\[Phi]\[Psi]", ",", 
       "ext", ",", "A\[Theta]", ",", "A\[Phi]", ",", "A\[Psi]", ",", 
       "P\[Phi]", ",", "P\[Psi]", ",", "xr\[Phi]", ",", "xr\[Psi]", ",", 
       "\[Phi]", ",", "\[Psi]", ",", "\n", "id", ",", "z", ",", "polyd", ",", 
       "cor", ",", "tot", ",", "ideal", ",", "newideal", ",", "gcdideal", ",", 
       RowBox[{"places", "=", 
        RowBox[{"{", "}"}]}], ",", "prod", ",", 
       RowBox[{"primes", "=", 
        RowBox[{"{", "}"}]}], ",", "\[Phi]r\[Psi]", ",", "finalprimes", ",", 
       "rmp", ",", "m", ",", "row", ",", "check", ",", "\n", "res", ",", 
       RowBox[{"resideal", "=", 
        RowBox[{"{", "}"}]}], ",", "exp", ",", "\[Phi]x\[Theta]", ",", 
       "primeideal"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"poly", ",", "x"}], "]"}], ">", "0"}], ",", 
        "\"\<poly degree in IdealFactorPoly\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{"PolyIsSquareFree", "[", 
         RowBox[{"poly", ",", "x", ",", "nf\[Theta]"}], "]"}], ",", 
        "\"\<poly in poly\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
      RowBox[{"polyd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"poly", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]", ",", 
         "\[Phi]x\[Theta]"}], "}"}], "=", 
       RowBox[{"NumExtendRootIrrExt", "[", 
        RowBox[{"poly", ",", "x", ",", "nf\[Theta]", ",", "\[Phi]"}], "]"}]}],
       ";", "\n", "\t", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{nf\[Phi],xr,ext\[Theta]\[Phi]}: \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]"}], 
         "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"P\[Theta]", "/.", 
        RowBox[{
        "ext\[Theta]\[Phi]", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t", 
      RowBox[{"A\[Psi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Det", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "P\[Phi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"x", "\[Rule]", "xr\[Phi]"}]}], ")"}], "-", 
             RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", "nf\[Phi]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nf\[Psi]", ",", "A\[Psi]", ",", "ext\[Phi]\[Psi]"}], "}"}], 
       "=", 
       RowBox[{"NumExtendSplitList", "[", 
        RowBox[{"A\[Psi]", ",", "z", ",", "nf\[Phi]", ",", "\[Psi]"}], 
        "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{nf\[Psi],A\[Psi],ext\[Phi]\[Psi]}: \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"nf\[Psi]", ",", "A\[Psi]", ",", "ext\[Phi]\[Psi]"}], 
         "}"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"xr\[Psi]", "=", 
       RowBox[{"NumCollect", "[", 
        RowBox[{
         RowBox[{"xr\[Phi]", "/.", 
          RowBox[{
          "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "nf\[Psi]"}], "]"}]}], ";", "\n",
       "\t\t", 
      RowBox[{"P\[Psi]", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumCollect", "[", 
           RowBox[{"#", ",", "nf\[Psi]"}], "]"}], "&"}], ",", 
         RowBox[{"P\[Phi]", "/.", 
          RowBox[{
          "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      
      RowBox[{"A\[Psi]", "=", 
       RowBox[{"Transpose", "[", "A\[Psi]", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"cor", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"False", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", "\t\t", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<A: \>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"#2", ",", 
                RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], "&"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"A\[Psi]", ",", "cor"}], "}"}], ",", "2"}], "]"}], 
           "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", 
      RowBox[{"tot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xr\[Psi]"}], ")"}], "*", "id"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ideal", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "xr\[Psi]"}], ")"}], "*", "id"}]}], ";", "\n", 
         "\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"newideal", "=", 
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "ideal", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "P\[Psi]", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                    "id"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"newideal", "=", 
                RowBox[{
                 RowBox[{"PolyHermitianReduce", "[", 
                  RowBox[{"newideal", ",", "x", ",", "nf\[Psi]"}], "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"newideal", "===", 
                  RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                "newideal", " ", "is", " ", "now", " ", "a", " ", "proper", 
                 " ", "ideal"}], " ", "*)"}], "\n", "\t\t\t\t\t", 
               RowBox[{"gcdideal", "=", 
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "newideal", "}"}], ",", 
                   RowBox[{"{", "tot", "}"}]}], "}"}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"gcdideal", "=", 
                RowBox[{
                 RowBox[{"PolyHermitianReduce", "[", 
                  RowBox[{"gcdideal", ",", "x", ",", "nf\[Psi]"}], "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"gcdideal", "===", 
                  RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                "newideal", " ", "now", " ", "has", " ", "a", " ", "factor", 
                 " ", "in", " ", "common", " ", "with", " ", "tot"}], " ", 
                "*)"}], "\n", "\t\t\t\t\t", 
               RowBox[{"ideal", "=", "newideal"}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                 "}"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                 "}"}]}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"cor", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
                "True"}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{"Break", "[", "]"}], ";"}], "\n", "\t\t\t\t", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "i", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
            "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"cor", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], 
              ",", 
              RowBox[{
               RowBox[{
               "Print", "[", "\"\<oops in PrimeDecomposition\>\"", "]"}], ";", 
               RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "\n", 
           RowBox[{"(*", "\t\t\t", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<A: \>\"", ",", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], 
                   "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"A\[Psi]", ",", "cor"}], "}"}], ",", "2"}], "]"}], 
                "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t\t", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"places", ",", 
           RowBox[{"{", 
            RowBox[{"ideal", ",", "1"}], "}"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<got: \>\"", ",", 
           RowBox[{"IdealPrint", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"RootReduce", "[", 
               RowBox[{"ideal", "/.", 
                RowBox[{"\[Psi]", "\[Rule]", 
                 RowBox[{"Root", "[", 
                  RowBox[{
                   RowBox[{
                   "nf\[Psi]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "1"}], "]"}]}]}], "]"}], 
              ",", "1"}], "}"}], "]"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"tot", "=", 
          RowBox[{"IdealDivide", "[", 
           RowBox[{"x", ",", "P\[Psi]", ",", 
            RowBox[{"{", 
             RowBox[{"tot", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ideal", ",", "1"}], "}"}], ",", "nf\[Psi]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"tot", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyDivide", "[", 
              RowBox[{"#", ",", 
               RowBox[{
               "tot", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", "x", ",", "nf\[Psi]"}], "]"}], "&"}], ",", 
            RowBox[{
            "tot", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", "\t\t", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
      RowBox[{"rmp", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"PolyFactor", "[", 
         RowBox[{
          RowBox[{
          "nf\[Psi]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "\[Psi]", ",", "nf\[Phi]"}], "]"}]}]}], ";", "\n", 
      RowBox[{"check", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"NumCollect", "[", 
            RowBox[{"#", ",", "nf\[Psi]"}], "]"}], "===", "0"}], "&"}], ",", 
         RowBox[{"rmp", "/.", 
          RowBox[{
          "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", "\n", 
      RowBox[{"check", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"check", ",", "True", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "check", "]"}], "===", "1"}], ",", 
        "\"\<rmp check in IdealFactorPoly\>\""}], "]"}], ";", "\n", 
      RowBox[{"rmp", "=", 
       RowBox[{"rmp", "\[LeftDoubleBracket]", 
        RowBox[{"check", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}]}], ";", "\n", 
      RowBox[{"tot", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"poly", "*", "id"}], ",", "1"}], "}"}]}], ";", "\n", 
      RowBox[{"Do", "[", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<row: \>\"", ",", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"ToRadicals", "[", 
             RowBox[{"RootReduce", "[", 
              RowBox[{
               RowBox[{
               "A\[Psi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Psi]", "\[Rule]", 
                 RowBox[{"Root", "[", 
                  RowBox[{
                   RowBox[{
                   "nf\[Psi]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "3"}], "]"}]}], "}"}]}], 
              "]"}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"row", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyRemainder", "[", 
              RowBox[{"#", ",", "rmp", ",", "\[Psi]", ",", "nf\[Phi]"}], 
              "]"}], "&"}], ",", 
            RowBox[{
            "A\[Psi]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"m", "=", 
          RowBox[{
           RowBox[{"PolyNumRowNullSpace", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", "row", "}"}], "]"}], ",", "\[Psi]", ",", 
             "nf\[Phi]"}], "]"}], "/.", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Phi]x\[Theta]"}]}]}], ";", "\n", 
         "\t", "\n", "\t", 
         RowBox[{"primeideal", "=", 
          RowBox[{"poly", "*", "id"}]}], ";", "\n", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"primeideal", "=", 
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "m", "}"}], ",", 
               RowBox[{"{", "primeideal", "}"}]}], "}"}], "]"}]}]}], "]"}], 
         ";", "\n", "\t", 
         RowBox[{"primeideal", "=", 
          RowBox[{
           RowBox[{"PolyHermitianReduce", "[", 
            RowBox[{"primeideal", ",", "x", ",", "nf\[Theta]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"exp", "=", "0"}], ";", "\n", "\t", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"newideal", "=", 
             RowBox[{"IdealDivide", "[", 
              RowBox[{"x", ",", "P\[Theta]", ",", "tot", ",", 
               RowBox[{"{", 
                RowBox[{"primeideal", ",", "1"}], "}"}], ",", "nf\[Theta]"}], 
              "]"}]}], ";", 
            RowBox[{
             RowBox[{
             "newideal", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "===", "1"}]}], ",", 
           RowBox[{
            RowBox[{"exp", "++"}], ";", 
            RowBox[{"tot", "=", "newideal"}]}]}], "]"}], ";", "\n", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"exp", "=!=", "0"}], ",", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"resideal", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"primeideal", ",", "1"}], "}"}], ",", "exp"}], 
               "}"}]}], "]"}], ";", "\n", "\t", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<factor: \>\"", ",", 
              RowBox[{"IdealPrint", "[", 
               RowBox[{"{", 
                RowBox[{"primeideal", ",", "1"}], "}"}], "]"}], ",", 
              "\"\< ^ \>\"", ",", "exp"}], "]"}], ";"}]}], "\n", "\t", 
          "]"}]}], "\n", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<should be one: \>\"", ",", 
        RowBox[{"IdealPrint", "[", "tot", "]"}]}], "]"}], ";", "\n", 
      "resideal"}]}], "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.7025690374701033`*^9, 3.7025691128051233`*^9}, {
   3.702569327709673*^9, 3.7025693577571363`*^9}, {3.702569435045545*^9, 
   3.70256951010946*^9}, {3.702573704859016*^9, 3.7025737350592337`*^9}, {
   3.702573930099269*^9, 3.70257407834791*^9}, {3.7025741119000607`*^9, 
   3.7025741253475943`*^9}, 3.70257428256425*^9, {3.702574516388569*^9, 
   3.702574557236826*^9}, {3.7025746235889587`*^9, 3.702574660644827*^9}, {
   3.7025747085007267`*^9, 3.7025747089170513`*^9}, {3.702574754724987*^9, 
   3.702574773340601*^9}, {3.702574860070899*^9, 3.702574900461481*^9}, {
   3.7025749389097357`*^9, 3.702574985189968*^9}, {3.702575016469598*^9, 
   3.702575142773576*^9}, {3.7025752301261168`*^9, 3.702575302518358*^9}, {
   3.702575333038371*^9, 3.702575335709703*^9}, {3.7025756606470327`*^9, 
   3.702575782415296*^9}, {3.7025758595030622`*^9, 3.7025758812876177`*^9}, {
   3.702575956015514*^9, 3.7025759770232973`*^9}, {3.702576023207487*^9, 
   3.702576059255286*^9}, {3.7025761133435698`*^9, 3.702576174431531*^9}, {
   3.702576232359622*^9, 3.70257627240187*^9}, {3.7025763048575687`*^9, 
   3.7025763050253563`*^9}, {3.7025763407776403`*^9, 
   3.7025765538329477`*^9}, {3.702576588003302*^9, 3.702576595209152*^9}, {
   3.7025766336583357`*^9, 3.702576698890081*^9}, {3.702577002788303*^9, 
   3.7025770258448477`*^9}, {3.7025770584040318`*^9, 3.702577064691435*^9}, {
   3.702577141315675*^9, 3.7025771571238832`*^9}, {3.702577190332767*^9, 
   3.702577203450235*^9}, {3.702577401931744*^9, 3.702577497795436*^9}, {
   3.702577566358738*^9, 3.702577620092716*^9}, {3.702577651292952*^9, 
   3.702577680309445*^9}, {3.702577755189547*^9, 3.702578000957938*^9}, {
   3.702629680565123*^9, 3.702629681508788*^9}, {3.7026299270061827`*^9, 
   3.702629927334106*^9}, {3.7026299845512657`*^9, 3.702629998046241*^9}, {
   3.7026300374224977`*^9, 3.7026301067740307`*^9}, {3.702630166454204*^9, 
   3.7026302002710667`*^9}, {3.702630239100835*^9, 3.702630267264001*^9}, {
   3.70263036947937*^9, 3.702630418864184*^9}, {3.7026304655752497`*^9, 
   3.702630702664343*^9}, {3.702630733614696*^9, 3.702631034161614*^9}, {
   3.702631089311322*^9, 3.7026311138078327`*^9}, {3.702631431047391*^9, 
   3.702631457096974*^9}, {3.702631568711631*^9, 3.7026319145032053`*^9}, {
   3.7026344318188457`*^9, 3.702634432154147*^9}, {3.702634655155199*^9, 
   3.702634832840616*^9}, {3.702635014427491*^9, 3.702635058570422*^9}, {
   3.702635108875053*^9, 3.702635164507675*^9}, {3.702635225243853*^9, 
   3.702635246284072*^9}, {3.702635283788045*^9, 3.702635286771943*^9}, {
   3.702635690612574*^9, 3.7026356910124187`*^9}, {3.702636424141666*^9, 
   3.702636425327176*^9}, 3.7026364946776*^9, {3.702636647670808*^9, 
   3.7026366617737207`*^9}, {3.702636742685689*^9, 3.702636789854401*^9}, {
   3.702636992517885*^9, 3.702637004966202*^9}, {3.702637195958434*^9, 
   3.70263728893472*^9}, {3.702637320950798*^9, 3.702637336695846*^9}, {
   3.7026373842868433`*^9, 3.702637425639083*^9}, {3.7026374621349297`*^9, 
   3.70263761074402*^9}, {3.702637645271245*^9, 3.702637645439344*^9}, {
   3.702637677695592*^9, 3.702637696783085*^9}, {3.702637778895561*^9, 
   3.702637870087698*^9}, {3.702637978912427*^9, 3.7026380826140537`*^9}, {
   3.702638169136582*^9, 3.702638206907246*^9}, {3.702657638692161*^9, 
   3.702657669994176*^9}, {3.7026577250506077`*^9, 3.7026577374268427`*^9}, {
   3.70265777781031*^9, 3.702657784530615*^9}, {3.7026601513570004`*^9, 
   3.7026601590703707`*^9}, {3.70266029261327*^9, 3.702660320750514*^9}, {
   3.7026606875098658`*^9, 3.702660688197665*^9}, {3.7026607207819347`*^9, 
   3.702660793655553*^9}, {3.702660916270576*^9, 3.702660934982698*^9}, {
   3.70266103873403*^9, 3.702661135854739*^9}, {3.70266192018452*^9, 
   3.702662007278536*^9}, {3.702662105432336*^9, 3.702662172141725*^9}, {
   3.7026622459129267`*^9, 3.702662250952691*^9}, {3.702662320464878*^9, 
   3.702662384941019*^9}, {3.702662438689145*^9, 3.7026624403959293`*^9}, {
   3.7026624723850718`*^9, 3.7026624936732492`*^9}, {3.702662541538005*^9, 
   3.702662551360878*^9}, {3.7026626040494547`*^9, 3.702662650551519*^9}, {
   3.702662724720891*^9, 3.7026627417392406`*^9}, {3.702662780729879*^9, 
   3.702662823042094*^9}, {3.702662856963056*^9, 3.702662860785462*^9}, {
   3.702662953442111*^9, 3.7026629582258673`*^9}, {3.702663142083449*^9, 
   3.702663144659083*^9}, {3.702663189587001*^9, 3.702663217675044*^9}, {
   3.702663297763844*^9, 3.702663301017667*^9}, {3.702663334858385*^9, 
   3.7026633352233877`*^9}, {3.7026635197816877`*^9, 3.702663669380715*^9}, {
   3.702663746104727*^9, 3.702663944881353*^9}, {3.702663975419998*^9, 
   3.702663984564149*^9}, {3.702664025036538*^9, 3.7026640579010687`*^9}, {
   3.70266411429451*^9, 3.702664155665284*^9}, {3.702664200511838*^9, 
   3.7026643027905684`*^9}, {3.702664468160541*^9, 3.702664489554132*^9}, {
   3.702664529684175*^9, 3.7026646586756983`*^9}, {3.7026647104230433`*^9, 
   3.702664769560782*^9}, {3.702664803825329*^9, 3.702664915296653*^9}, {
   3.702664955065072*^9, 3.70266509959872*^9}, {3.702665139274743*^9, 
   3.702665181824697*^9}, {3.7026652753675756`*^9, 3.7026653565211287`*^9}, {
   3.702665411922595*^9, 3.702665432186445*^9}, {3.702665630899094*^9, 
   3.7026656955973063`*^9}, {3.702665760445953*^9, 3.7026658016445723`*^9}, {
   3.702666520811137*^9, 3.702666525593862*^9}, {3.702666574547625*^9, 
   3.702666583809862*^9}, {3.7026675319356337`*^9, 3.702667574878634*^9}, {
   3.7026676518749447`*^9, 3.702667856237681*^9}, {3.70266790979784*^9, 
   3.7026679907326937`*^9}, {3.702670087433675*^9, 3.702670089339592*^9}, {
   3.702671018057773*^9, 3.702671019009673*^9}, {3.70267109068992*^9, 
   3.702671113753769*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"factor", " ", "poly", " ", "into", " ", "prime", " ", "ideals"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IdealFactorPolyOLD", "[", 
    RowBox[{"poly_", ",", "P\[Theta]_", ",", "x_", ",", "nf\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "P\[Theta]", "]"}]}], ",", "nf\[Phi]", ",", 
       "nf\[Psi]", ",", "ext\[Theta]\[Phi]", ",", "ext\[Phi]\[Psi]", ",", 
       "ext", ",", "A\[Theta]", ",", "A\[Phi]", ",", "A\[Psi]", ",", 
       "P\[Phi]", ",", "P\[Psi]", ",", "xr\[Phi]", ",", "xr\[Psi]", ",", 
       "\[Phi]", ",", "\[Psi]", ",", "\n", "id", ",", "z", ",", "polyd", ",", 
       "cor", ",", "tot", ",", "ideal", ",", "newideal", ",", "gcdideal", ",", 
       RowBox[{"places", "=", 
        RowBox[{"{", "}"}]}], ",", "prod", ",", 
       RowBox[{"primes", "=", 
        RowBox[{"{", "}"}]}], ",", "\[Phi]r\[Psi]", ",", "finalprimes"}], 
      "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{"PolyIsSquareFree", "[", 
         RowBox[{"poly", ",", "x", ",", "nf\[Theta]"}], "]"}], ",", 
        "\"\<poly in poly\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
      RowBox[{"polyd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"poly", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]"}], 
        "}"}], "=", 
       RowBox[{"NumExtendRootIrr", "[", 
        RowBox[{"poly", ",", "x", ",", "nf\[Theta]", ",", "\[Phi]"}], "]"}]}],
       ";", "\n", "\t", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{nf\[Phi],xr,ext\[Theta]\[Phi]}: \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"nf\[Phi]", ",", "xr\[Phi]", ",", "ext\[Theta]\[Phi]"}], 
         "}"}]}], "]"}], ";", "\n", "\t", 
      RowBox[{"P\[Phi]", "=", 
       RowBox[{"P\[Theta]", "/.", 
        RowBox[{
        "ext\[Theta]\[Phi]", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t", 
      RowBox[{"A\[Psi]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Det", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "P\[Phi]", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"x", "\[Rule]", "xr\[Phi]"}]}], ")"}], "-", 
             RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", "nf\[Phi]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nf\[Psi]", ",", "A\[Psi]", ",", "ext\[Phi]\[Psi]"}], "}"}], 
       "=", 
       RowBox[{"NumExtendSplitList", "[", 
        RowBox[{"A\[Psi]", ",", "z", ",", "nf\[Phi]", ",", "\[Psi]"}], 
        "]"}]}], ";", "\n", 
      RowBox[{"(*", "\t\t", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<{nf\[Psi],A\[Psi],ext\[Phi]\[Psi]}: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{"nf\[Psi]", ",", "A\[Psi]", ",", "ext\[Phi]\[Psi]"}], 
           "}"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", 
      RowBox[{"xr\[Psi]", "=", 
       RowBox[{"NumCollect", "[", 
        RowBox[{
         RowBox[{"xr\[Phi]", "/.", 
          RowBox[{
          "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "nf\[Psi]"}], "]"}]}], ";", "\n",
       "\t\t", 
      RowBox[{"P\[Psi]", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumCollect", "[", 
           RowBox[{"#", ",", "nf\[Psi]"}], "]"}], "&"}], ",", 
         RowBox[{"P\[Phi]", "/.", 
          RowBox[{
          "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      
      RowBox[{"A\[Psi]", "=", 
       RowBox[{"Transpose", "[", "A\[Psi]", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"cor", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"False", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", "\t\t", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<A: \>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"#2", ",", 
                RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], "&"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "cor"}], "}"}], ",", "2"}], "]"}], "]"}]}], 
         "]"}], ";"}], "*)"}], "\n", "\t\t", 
      RowBox[{"tot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "-", "xr\[Psi]"}], ")"}], "*", "id"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ideal", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "xr\[Psi]"}], ")"}], "*", "id"}]}], ";", "\n", 
         "\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"newideal", "=", 
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "ideal", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "P\[Psi]", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                    "id"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"newideal", "=", 
                RowBox[{
                 RowBox[{"PolyHermitianReduce", "[", 
                  RowBox[{"newideal", ",", "x", ",", "nf\[Psi]"}], "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"newideal", "===", 
                  RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                "newideal", " ", "is", " ", "now", " ", "a", " ", "proper", 
                 " ", "ideal"}], " ", "*)"}], "\n", "\t\t\t\t\t", 
               RowBox[{"gcdideal", "=", 
                RowBox[{"ArrayFlatten", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "newideal", "}"}], ",", 
                   RowBox[{"{", "tot", "}"}]}], "}"}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"gcdideal", "=", 
                RowBox[{
                 RowBox[{"PolyHermitianReduce", "[", 
                  RowBox[{"gcdideal", ",", "x", ",", "nf\[Psi]"}], "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";", 
               "\n", "\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"gcdideal", "===", 
                  RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"(*", " ", 
                RowBox[{
                "newideal", " ", "now", " ", "has", " ", "a", " ", "factor", 
                 " ", "in", " ", "common", " ", "with", " ", "tot"}], " ", 
                "*)"}], "\n", "\t\t\t\t\t", 
               RowBox[{"ideal", "=", "newideal"}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                 "}"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"A\[Psi]", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                 "}"}]}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"cor", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
                "True"}], ";", "\n", "\t\t\t\t\t", 
               RowBox[{"Break", "[", "]"}], ";"}], "\n", "\t\t\t\t", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "i", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
            "\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"cor", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], 
              ",", 
              RowBox[{
               RowBox[{
               "Print", "[", "\"\<oops in PrimeDecomposition\>\"", "]"}], ";", 
               RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "\n", 
           RowBox[{"(*", "\t\t\t", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<A: \>\"", ",", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], 
                   "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"A", ",", "cor"}], "}"}], ",", "2"}], "]"}], 
                "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t\t", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"places", ",", 
           RowBox[{"{", 
            RowBox[{"ideal", ",", "1"}], "}"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<got: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "ideal", "]"}]}], "]"}], ";", "\n", 
         "\t\t", 
         RowBox[{"tot", "=", 
          RowBox[{"IdealDivide", "[", 
           RowBox[{"x", ",", "P\[Psi]", ",", 
            RowBox[{"{", 
             RowBox[{"tot", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ideal", ",", "1"}], "}"}], ",", "nf\[Psi]"}], "]"}]}], 
         ";", "\n", "\t\t", 
         RowBox[{"tot", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PolyDivide", "[", 
              RowBox[{"#", ",", 
               RowBox[{
               "tot", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", "x", ",", "nf\[Psi]"}], "]"}], "&"}], ",", 
            RowBox[{
            "tot", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", "\t\t", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "places", "]"}], ">", "0"}], ",", "\n", "\t", 
        
        RowBox[{
         RowBox[{"Do", "[", "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"prod", "=", 
             RowBox[{"{", 
              RowBox[{"id", ",", "1"}], "}"}]}], ";", "\n", "\t\t", 
            RowBox[{"Scan", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"prod", "=", 
                 RowBox[{"IdealTimes", "[", 
                  RowBox[{"x", ",", "P\[Psi]", ",", "prod", ",", 
                   RowBox[{
                   "places", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], ",", "nf\[Psi]"}], "]"}]}], 
                ")"}], "&"}], ",", "clusteri"}], "]"}], ";", "\n", "\t\t", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<prod: \>\"", ",", 
                RowBox[{"IdealPrint", "[", "prod", "]"}]}], "]"}], ";"}], 
             "*)"}], "\n", "\t\t", 
            RowBox[{"prod", "=", 
             RowBox[{"PolyCollectNumExtReduce", "[", 
              RowBox[{
              "prod", ",", "x", ",", "nf\[Psi]", ",", "nf\[Phi]", ",", 
               "ext\[Phi]\[Psi]"}], "]"}]}], ";", "\n", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"prod", "=!=", "$Failed"}], ",", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<1 prime: \>\"", ",", 
                 RowBox[{"IdealPrint", "[", "prod", "]"}]}], "]"}], ";", "\n",
                "\t\t\t", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"primes", ",", "prod"}], "]"}], ";", "\n", "\t\t\t", 
               RowBox[{"places", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"places", ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", "clusteri", "}"}], "]"}]}], "]"}]}], ";", 
               "\n", "\t\t\t", 
               RowBox[{"Break", "[", "]"}], ";"}]}], "\n", "\t\t", "]"}]}], 
           "\n", "\t", ",", 
           RowBox[{"{", 
            RowBox[{"clusteri", ",", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{"Subsets", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "places", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
               "Length"}], "]"}]}], "}"}]}], "]"}], ";"}]}], "\n", "]"}], ";",
       "\n", 
      RowBox[{"finalprimes", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nf\[Psi]", ",", "\[Phi]r\[Psi]", ",", "ext\[Phi]\[Psi]"}],
            "}"}], "=", 
          RowBox[{"NumExtendSplit", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "nf\[Phi]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"\[Phi]", "\[Rule]", "z"}]}], ",", "z", ",", "nf\[Phi]", 
            ",", "\[Psi]"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"P\[Psi]", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "nf\[Psi]"}], "]"}], "&"}], ",", 
            RowBox[{"P\[Phi]", "/.", 
             RowBox[{
             "ext\[Phi]\[Psi]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"prod", "=", 
          RowBox[{"{", 
           RowBox[{"id", ",", "1"}], "}"}]}], ";", "\n", "\t", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"prod", "=", 
            RowBox[{"IdealTimes", "[", 
             RowBox[{"x", ",", "P\[Psi]", ",", "prod", ",", 
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"pr", "/.", 
                 RowBox[{"\[Phi]", "\[Rule]", "\[Phi]r"}]}], ",", "x", ",", 
                "nf\[Psi]"}], "]"}], ",", "nf\[Psi]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]r", ",", "\[Phi]r\[Psi]"}], "}"}]}], "]"}], ";", 
         "\n", "\t", 
         RowBox[{"prod", "=", 
          RowBox[{"PolyCollectNumExtReduce", "[", 
           RowBox[{
           "prod", ",", "x", ",", "nf\[Psi]", ",", "nf\[Phi]", ",", 
            "ext\[Phi]\[Psi]"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"assert", "[", 
          RowBox[{
           RowBox[{"prod", "=!=", "$Failed"}], ",", 
           "\"\<conjugate prod failed\>\""}], "]"}], ";", "\n", "\t", 
         RowBox[{"prod", "=", 
          RowBox[{"PolyCollectNumExtReduce", "[", 
           RowBox[{
           "prod", ",", "x", ",", "nf\[Phi]", ",", "nf\[Theta]", ",", 
            "ext\[Theta]\[Phi]"}], "]"}]}], ";", "\n", "\t", 
         RowBox[{"assert", "[", 
          RowBox[{
           RowBox[{"prod", "=!=", "$Failed"}], ",", 
           "\"\<conjugate prod failed\>\""}], "]"}], ";", "\n", "\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<prime: \>\"", ",", 
           RowBox[{"IdealPrint", "[", "prod", "]"}]}], "]"}], ";", "\n", "\t", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"finalprimes", ",", "prod"}], "]"}], ";"}], "\n", ",", 
        RowBox[{"{", 
         RowBox[{"pr", ",", "primes"}], "}"}]}], "]"}], ";", "\n", 
      "finalprimes"}]}], "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.7025690374701033`*^9, 3.7025691128051233`*^9}, {
   3.702569327709673*^9, 3.7025693577571363`*^9}, {3.702569435045545*^9, 
   3.70256951010946*^9}, {3.702573704859016*^9, 3.7025737350592337`*^9}, {
   3.702573930099269*^9, 3.70257407834791*^9}, {3.7025741119000607`*^9, 
   3.7025741253475943`*^9}, 3.70257428256425*^9, {3.702574516388569*^9, 
   3.702574557236826*^9}, {3.7025746235889587`*^9, 3.702574660644827*^9}, {
   3.7025747085007267`*^9, 3.7025747089170513`*^9}, {3.702574754724987*^9, 
   3.702574773340601*^9}, {3.702574860070899*^9, 3.702574900461481*^9}, {
   3.7025749389097357`*^9, 3.702574985189968*^9}, {3.702575016469598*^9, 
   3.702575142773576*^9}, {3.7025752301261168`*^9, 3.702575302518358*^9}, {
   3.702575333038371*^9, 3.702575335709703*^9}, {3.7025756606470327`*^9, 
   3.702575782415296*^9}, {3.7025758595030622`*^9, 3.7025758812876177`*^9}, {
   3.702575956015514*^9, 3.7025759770232973`*^9}, {3.702576023207487*^9, 
   3.702576059255286*^9}, {3.7025761133435698`*^9, 3.702576174431531*^9}, {
   3.702576232359622*^9, 3.70257627240187*^9}, {3.7025763048575687`*^9, 
   3.7025763050253563`*^9}, {3.7025763407776403`*^9, 
   3.7025765538329477`*^9}, {3.702576588003302*^9, 3.702576595209152*^9}, {
   3.7025766336583357`*^9, 3.702576698890081*^9}, {3.702577002788303*^9, 
   3.7025770258448477`*^9}, {3.7025770584040318`*^9, 3.702577064691435*^9}, {
   3.702577141315675*^9, 3.7025771571238832`*^9}, {3.702577190332767*^9, 
   3.702577203450235*^9}, {3.702577401931744*^9, 3.702577497795436*^9}, {
   3.702577566358738*^9, 3.702577620092716*^9}, {3.702577651292952*^9, 
   3.702577680309445*^9}, {3.702577755189547*^9, 3.702578000957938*^9}, {
   3.702629680565123*^9, 3.702629681508788*^9}, {3.7026299270061827`*^9, 
   3.702629927334106*^9}, {3.7026299845512657`*^9, 3.702629998046241*^9}, {
   3.7026300374224977`*^9, 3.7026301067740307`*^9}, {3.702630166454204*^9, 
   3.7026302002710667`*^9}, {3.702630239100835*^9, 3.702630267264001*^9}, {
   3.70263036947937*^9, 3.702630418864184*^9}, {3.7026304655752497`*^9, 
   3.702630702664343*^9}, {3.702630733614696*^9, 3.702631034161614*^9}, {
   3.702631089311322*^9, 3.7026311138078327`*^9}, {3.702631431047391*^9, 
   3.702631457096974*^9}, {3.702631568711631*^9, 3.7026319145032053`*^9}, {
   3.7026344318188457`*^9, 3.702634432154147*^9}, {3.702634655155199*^9, 
   3.702634832840616*^9}, {3.702635014427491*^9, 3.702635058570422*^9}, {
   3.702635108875053*^9, 3.702635164507675*^9}, {3.702635225243853*^9, 
   3.702635246284072*^9}, {3.702635283788045*^9, 3.702635286771943*^9}, {
   3.702635690612574*^9, 3.7026356910124187`*^9}, {3.702636424141666*^9, 
   3.702636425327176*^9}, 3.7026364946776*^9, {3.702636647670808*^9, 
   3.7026366617737207`*^9}, {3.702636742685689*^9, 3.702636789854401*^9}, {
   3.702636992517885*^9, 3.702637004966202*^9}, {3.702637195958434*^9, 
   3.70263728893472*^9}, {3.702637320950798*^9, 3.702637336695846*^9}, {
   3.7026373842868433`*^9, 3.702637425639083*^9}, {3.7026374621349297`*^9, 
   3.70263761074402*^9}, {3.702637645271245*^9, 3.702637645439344*^9}, {
   3.702637677695592*^9, 3.702637696783085*^9}, {3.702637778895561*^9, 
   3.702637870087698*^9}, {3.702637978912427*^9, 3.7026380826140537`*^9}, {
   3.702638169136582*^9, 3.702638206907246*^9}, {3.7026570405888767`*^9, 
   3.70265704108469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"factor", " ", "poly", " ", "into", " ", "prime", " ", "ideals"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IdealFactorPolyOLD2", "[", 
    RowBox[{"poly_", ",", "PP_", ",", "x_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "PP", "]"}]}], ",", "newnf", ",", "ext", ",", 
       "nf1", ",", "ext1", ",", "xr", ",", "\[Phi]", ",", "\[Psi]", ",", "\n",
        "id", ",", "A", ",", "Al", ",", "z", ",", 
       RowBox[{"P", "=", "PP"}], ",", "polyd", ",", "cor", ",", "tot", ",", 
       "ideal", ",", "newideal", ",", "gcdideal", ",", 
       RowBox[{"places", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"assert", "[", 
       RowBox[{
        RowBox[{"PolyIsSquareFree", "[", 
         RowBox[{"poly", ",", "x", ",", "nf"}], "]"}], ",", 
        "\"\<poly in poly\>\""}], "]"}], ";", "\n", "\t", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\n", "\t", 
      RowBox[{"polyd", "=", 
       RowBox[{"Exponent", "[", 
        RowBox[{"poly", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newnf", ",", "xr", ",", "ext"}], "}"}], "=", 
       RowBox[{"NumExtendSplit", "[", 
        RowBox[{"poly", ",", "x", ",", "nf", ",", "\[Phi]"}], "]"}]}], ";", 
      "\n", "\t", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<{newnf,xr,ext}: \>\"", ",", 
        RowBox[{"{", 
         RowBox[{"newnf", ",", "xr", ",", "ext"}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"P", "=", 
       RowBox[{"P", "/.", 
        RowBox[{
        "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
      ";", "\n", "\t", 
      RowBox[{"Al", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", "polyd"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"Det", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "P", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                   "/.", 
                  RowBox[{"x", "\[Rule]", 
                   RowBox[{
                   "xr", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}]}]}], ")"}], "-", 
                RowBox[{"z", "*", "id"}]}], "]"}], ",", "z", ",", "nf"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nf1", ",", "A", ",", "ext1"}], "}"}], "=", 
          RowBox[{"NumExtendSplitList", "[", 
           RowBox[{"A", ",", "z", ",", "newnf", ",", "\[Psi]"}], "]"}]}], ";",
          "\n", "\t\t", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<{nf1,A,ext1}: \>\"", ",", 
           RowBox[{"{", 
            RowBox[{"nf1", ",", "A", ",", "ext1"}], "}"}]}], "]"}], ";", "\n",
          "\t\t", 
         RowBox[{"xr", "=", 
          RowBox[{"xr", "/.", 
           RowBox[{
           "ext1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
          ";", "\n", "\t\t", 
         RowBox[{"Al", "=", 
          RowBox[{"Al", "/.", 
           RowBox[{
           "ext1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
          ";", "\n", "\t\t", 
         RowBox[{"P", "=", 
          RowBox[{"P", "/.", 
           RowBox[{
           "ext1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
          ";", "\n", "\t\t", 
         RowBox[{
          RowBox[{"ext", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"ext", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
           RowBox[{
           "ext1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
          ";", "\n", "\t\t", 
         RowBox[{
          RowBox[{
          "Al", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], "=", 
          "A"}], ";", "\n", "\t\t", 
         RowBox[{"newnf", "=", 
          RowBox[{"nf1", "/.", 
           RowBox[{"{", 
            RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}]}], ";", "\n", 
         "\t\t", 
         RowBox[{
          RowBox[{"ext", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"NumCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ext", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ",", 
            "newnf"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"xr", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "newnf"}], "]"}], "&"}], ",", 
            RowBox[{"xr", "/.", 
             RowBox[{"{", 
              RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"Al", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "newnf"}], "]"}], "&"}], ",", 
            RowBox[{"Al", "/.", 
             RowBox[{"{", 
              RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"P", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{"#", ",", "newnf"}], "]"}], "&"}], ",", 
            RowBox[{"P", "/.", 
             RowBox[{"{", 
              RowBox[{"\[Psi]", "\[Rule]", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\n", "\t", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "polyd"}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{
           "Al", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
           "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"cor", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"False", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<A: \>\"", ",", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"#2", ",", 
                   RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], 
                 "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"A", ",", "cor"}], "}"}], ",", "2"}], "]"}], "]"}]}],
             "]"}], ";"}], "*)"}], "\n", "\t\t", 
         RowBox[{"P", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NumCollect", "[", 
              RowBox[{
               RowBox[{"#", "/.", 
                RowBox[{
                "ext", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "newnf"}], "]"}], "&"}], 
            ",", "PP", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"tot", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", 
             RowBox[{"NumCollect", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "xr", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
                "/.", 
                RowBox[{
                "ext", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "newnf"}], "]"}]}], ")"}], 
           "*", "id"}]}], ";", "\n", "\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"ideal", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", 
                RowBox[{"NumCollect", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "xr", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "/.", 
                   RowBox[{
                   "ext", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", "newnf"}], "]"}]}], 
               ")"}], "*", "id"}]}], ";", "\n", "\t\t\t", 
            RowBox[{"Do", "[", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newideal", "=", 
                   RowBox[{"ArrayFlatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "ideal", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                    "id"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"newideal", "=", 
                   RowBox[{
                    RowBox[{"PolyHermitianReduce", "[", 
                    RowBox[{"newideal", ",", "x", ",", "newnf"}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], 
                  ";", "\n", "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"newideal", "===", 
                    RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "newideal", " ", "is", " ", "now", " ", "a", " ", "proper",
                     " ", "ideal"}], " ", "*)"}], "\n", "\t\t\t\t\t", 
                  RowBox[{"gcdideal", "=", 
                   RowBox[{"ArrayFlatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "newideal", "}"}], ",", 
                    RowBox[{"{", "tot", "}"}]}], "}"}], "]"}]}], ";", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"gcdideal", "=", 
                   RowBox[{
                    RowBox[{"PolyHermitianReduce", "[", 
                    RowBox[{"gcdideal", ",", "x", ",", "newnf"}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], 
                  ";", "\n", "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"gcdideal", "===", 
                    RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "newideal", " ", "now", " ", "has", " ", "a", " ", 
                    "factor", " ", "in", " ", "common", " ", "with", " ", 
                    "tot"}], " ", "*)"}], "\n", "\t\t\t\t\t", 
                  RowBox[{"ideal", "=", "newideal"}], ";", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"A", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"cor", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
                   "True"}], ";", "\n", "\t\t\t\t\t", 
                  RowBox[{"Break", "[", "]"}], ";"}], "\n", "\t\t\t\t", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "i", ",", "n"}], "}"}]}], "]"}], ";", 
               "\n", "\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Not", "[", 
                  RowBox[{"cor", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], 
                 ",", 
                 RowBox[{
                  RowBox[{
                  "Print", "[", "\"\<oops in PrimeDecomposition\>\"", "]"}], 
                  ";", 
                  RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}], "\n", 
              "\t\t\t", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<A: \>\"", ",", 
                  RowBox[{"MatrixForm", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"Framed", "[", "#1", "]"}], ",", "#1"}], "]"}], 
                    "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"A", ",", "cor"}], "}"}], ",", "2"}], "]"}], 
                   "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t\t", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
            "\t\t", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"places", ",", 
              RowBox[{"{", 
               RowBox[{"ideal", ",", "1"}], "}"}]}], "]"}], ";", "\n", "\t\t", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<got: \>\"", ",", 
              RowBox[{"MatrixForm", "[", "ideal", "]"}]}], "]"}], ";", "\n", 
            "\t\t", 
            RowBox[{"tot", "=", 
             RowBox[{"IdealDivide", "[", 
              RowBox[{"x", ",", "P", ",", 
               RowBox[{"{", 
                RowBox[{"tot", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ideal", ",", "1"}], "}"}], ",", "newnf"}], "]"}]}], 
            ";", "\n", "\t\t", 
            RowBox[{"tot", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PolyDivide", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                  "tot", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], ",", "x", ",", "newnf"}], "]"}],
                 "&"}], ",", 
               RowBox[{
               "tot", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", "\t\t", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";"}], "\n", 
        "\t", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "polyd"}], "}"}]}], "]"}], ";", "\n", 
      "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t", 
       RowBox[{
        RowBox[{"Which", "[", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "cluster", "]"}], "===", "0"}], ",", "\n", 
          "\t\t", "Null", ",", "\n", "\t", 
          RowBox[{
           RowBox[{"Length", "[", "cluster", "]"}], "===", "1"}], ",", "\n", 
          "\t\t", 
          RowBox[{"Print", "[", 
           RowBox[{"IdealPrint", "[", 
            RowBox[{
            "cluster", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}], "]"}], ",", "\n", "\t", "True", ",", "\n", "\t\t", 
          RowBox[{"Print", "[", 
           RowBox[{"IdealPrint", "[", 
            RowBox[{"Fold", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"IdealTimes", "[", 
                RowBox[{"x", ",", "P", ",", "#1", ",", "#2", ",", "newnf"}], 
                "]"}], "&"}], ",", 
              RowBox[{"First", "[", "cluster", "]"}], ",", 
              RowBox[{"Rest", "[", "cluster", "]"}]}], "]"}], "]"}], "]"}]}], 
         "\n", "\t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"cluster", ",", 
          RowBox[{"Subsets", "[", "places", "]"}]}], "}"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.7025690374701033`*^9, 3.7025691128051233`*^9}, {
   3.702569327709673*^9, 3.7025693577571363`*^9}, {3.702569435045545*^9, 
   3.70256951010946*^9}, {3.702573704859016*^9, 3.7025737350592337`*^9}, {
   3.702573930099269*^9, 3.70257407834791*^9}, {3.7025741119000607`*^9, 
   3.7025741253475943`*^9}, 3.70257428256425*^9, {3.702574516388569*^9, 
   3.702574557236826*^9}, {3.7025746235889587`*^9, 3.702574660644827*^9}, {
   3.7025747085007267`*^9, 3.7025747089170513`*^9}, {3.702574754724987*^9, 
   3.702574773340601*^9}, {3.702574860070899*^9, 3.702574900461481*^9}, {
   3.7025749389097357`*^9, 3.702574985189968*^9}, {3.702575016469598*^9, 
   3.702575142773576*^9}, {3.7025752301261168`*^9, 3.702575302518358*^9}, {
   3.702575333038371*^9, 3.702575335709703*^9}, {3.7025756606470327`*^9, 
   3.702575782415296*^9}, {3.7025758595030622`*^9, 3.7025758812876177`*^9}, {
   3.702575956015514*^9, 3.7025759770232973`*^9}, {3.702576023207487*^9, 
   3.702576059255286*^9}, {3.7025761133435698`*^9, 3.702576174431531*^9}, {
   3.702576232359622*^9, 3.70257627240187*^9}, {3.7025763048575687`*^9, 
   3.7025763050253563`*^9}, {3.7025763407776403`*^9, 
   3.7025765538329477`*^9}, {3.702576588003302*^9, 3.702576595209152*^9}, {
   3.7025766336583357`*^9, 3.702576698890081*^9}, {3.702577002788303*^9, 
   3.7025770258448477`*^9}, {3.7025770584040318`*^9, 3.702577064691435*^9}, {
   3.702577141315675*^9, 3.7025771571238832`*^9}, {3.702577190332767*^9, 
   3.702577203450235*^9}, {3.702577401931744*^9, 3.702577497795436*^9}, {
   3.702577566358738*^9, 3.702577620092716*^9}, {3.702577651292952*^9, 
   3.702577680309445*^9}, {3.702577755189547*^9, 3.702578000957938*^9}, {
   3.7026291402691383`*^9, 3.702629140669135*^9}, 3.702657035435857*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["norm, degree", "Subsection",
 CellChangeTimes->{{3.5803451439983826`*^9, 3.580345146182387*^9}, {
  3.666453860702846*^9, 3.66645386181319*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DivisorDegree", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A_", ",", "Ad_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"B_", ",", "Bd_"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", "\n", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"A", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", "x"}], 
            "]"}], "-", 
           RowBox[{"Exponent", "[", 
            RowBox[{"Ad", ",", "x"}], "]"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{
             RowBox[{"B", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             "\[Xi]"}], "]"}], "-", 
           RowBox[{"Exponent", "[", 
            RowBox[{"Bd", ",", "\[Xi]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"DivisorNorm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A_", ",", "Ad_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"B_", ",", "Bd_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "A", "]"}]}], "}"}], ",", "\n", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"A", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
            ",", "nf"}], "]"}], ",", 
          RowBox[{"Ad", "^", "n"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "0", "}"}]}], "]"}], ",", "\n", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"B", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            "\[Xi]", ",", "nf"}], "]"}], ",", 
          RowBox[{"Bd", "^", "n"}]}], "}"}], ",", "\[Xi]", ",", "nf", ",", 
        RowBox[{"{", "0", "}"}]}], "]"}]}], "}"}]}], "\n", "]"}]}]}], "Code",
 CellChangeTimes->{{3.686174669541533*^9, 3.6861746781929693`*^9}, {
  3.686175119562223*^9, 3.6861751202023487`*^9}, {3.6861751645229053`*^9, 
  3.686175178738841*^9}, {3.686175286228457*^9, 3.6861752891334667`*^9}, {
  3.686601389403694*^9, 3.68660151477008*^9}, {3.6866016544111958`*^9, 
  3.686601657493161*^9}, {3.68665340905471*^9, 3.6866535526826773`*^9}, {
  3.6875382997463303`*^9, 3.6739097991074443`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["rr space", "Subsection",
 CellChangeTimes->{{3.6658698737005663`*^9, 3.580345126027151*^9}, {
  3.686588972756411*^9, 3.686588973650646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DivisorRRSpace", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A_", ",", "Ad_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"B_", ",", "Bd_"}], "}"}]}], "}"}], ",", "P_", ",", "ord_", 
    ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "e", ",", "f", ",", "a", ",", "b", ",", "diag", ",", "mat", ",", "or", 
      ",", "M", ",", "Bs", ",", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "A", "]"}]}], ",", "Binv", ",", "t"}], "}"}], 
    ",", "\n", "\t", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<RR: \>\"", ",", 
        RowBox[{"DivisorPrint", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"A", ",", "Ad"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"B", ",", "Bd"}], "}"}]}], "}"}], "]"}]}], "]"}], ";"}], 
     "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"diag", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Diagonal", "[", "B", "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat", "=", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "n", "]"}], "-", 
       RowBox[{"B", ".", 
        RowBox[{"Inverse", "[", "diag", "]"}]}]}]}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{"Diagonal", "[", "mat", "]"}], "===", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"Binv", "=", 
      RowBox[{"t", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"t", ".", "mat"}], ",", "\[Xi]", ",", "nf"}], "]"}]}], ";", 
        RowBox[{"Binv", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Binv", "+", "t"}], ",", "\[Xi]", ",", "nf"}], "]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"n", "-", "1"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<check: \>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"B", ".", 
           RowBox[{"Inverse", "[", "diag", "]"}], ".", "Binv"}], "]"}]}], 
        "]"}], ";"}], "*)"}], "\n", "\t", 
     RowBox[{"Binv", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Inverse", "[", "diag", "]"}], ".", "Binv"}], ")"}], "/.", 
         
         RowBox[{"\[Xi]", "\[Rule]", 
          RowBox[{"1", "/", "x"}]}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"mat", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"A", ".", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{"x", "^", "ord"}], "]"}], ".", "Binv"}], ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Ad", "/", "Bd"}], "/.", 
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{"1", "/", "x"}]}]}], ",", "x", ",", "nf"}], "]"}]}], 
         "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<mat: \>\"", ",", 
         RowBox[{"1", "/", 
          RowBox[{
          "mat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", "\"\<*\>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{
          "mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"or", ",", "M", ",", "Bs"}], "}"}], "=", 
      RowBox[{"NormalizeAtInfinity", "[", 
       RowBox[{
        RowBox[{"mat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<func: \>\"", ",", 
         RowBox[{"1", "/", "Ad"}], ",", "\"\<*\>\"", ",", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{"Bs", ".", "A"}], ",", "x", ",", "nf"}], "]"}], "]"}]}], 
        "]"}], ";", "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<orders: \>\"", ",", 
         RowBox[{"or", "-", 
          RowBox[{"Exponent", "[", 
           RowBox[{
            RowBox[{
            "mat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", "x"}], "]"}]}]}], "]"}], ";"}], "*)"}], "\n", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"or", "-", 
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{
          "mat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          "x"}], "]"}]}], ",", 
       RowBox[{"PolyNormalizeFraction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Bs", ".", "A"}], ",", "Ad"}], "}"}], ",", "x", ",", "nf", 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}]}]}], "\n", "]"}]}]], "Code",\

 CellChangeTimes->{{3.686589008929949*^9, 3.686589009813414*^9}, {
   3.686589047936895*^9, 3.686589070010447*^9}, {3.6865891088740664`*^9, 
   3.6865891132756367`*^9}, {3.6865894920515547`*^9, 3.686589516534874*^9}, {
   3.686589623655525*^9, 3.6865896697626543`*^9}, 3.686589700146541*^9, {
   3.686589765711935*^9, 3.686589766362653*^9}, {3.686589809338873*^9, 
   3.686589823339329*^9}, {3.686589935187133*^9, 3.686589979307892*^9}, {
   3.686590143243208*^9, 3.686590187729206*^9}, {3.686590911025799*^9, 
   3.686591044174219*^9}, {3.6865911847029457`*^9, 3.686591225481155*^9}, {
   3.686591267724441*^9, 3.6865913220208178`*^9}, 3.686591360564399*^9, {
   3.686591569220601*^9, 3.686591626086895*^9}, {3.6865917196316442`*^9, 
   3.686591825064783*^9}, {3.686591866144578*^9, 3.686591951499817*^9}, {
   3.6865920086852837`*^9, 3.686592061853607*^9}, {3.686592165844861*^9, 
   3.686592231737029*^9}, {3.6865922632827597`*^9, 3.686592291912875*^9}, {
   3.686592331864869*^9, 3.686592360229972*^9}, {3.68659355060907*^9, 
   3.6865935883648252`*^9}, {3.686593955886245*^9, 3.686594027757937*^9}, {
   3.686594095577159*^9, 3.686594135918559*^9}, {3.686594196268173*^9, 
   3.6865942267357197`*^9}, {3.686594308982164*^9, 3.6865943110921803`*^9}, 
   3.686595643335555*^9, {3.686595716866064*^9, 3.686595852920879*^9}, {
   3.686596175912887*^9, 3.686596176904812*^9}, {3.686596229707614*^9, 
   3.686596247238048*^9}, 3.6865964092908*^9, {3.686596468775249*^9, 
   3.686596472579762*^9}, {3.686596578620772*^9, 3.6865966408098097`*^9}, {
   3.6865966779775143`*^9, 3.686596682134383*^9}, {3.6865967455620737`*^9, 
   3.686596749449209*^9}, {3.686596801279935*^9, 3.686597007954238*^9}, {
   3.686597051028866*^9, 3.686597063332056*^9}, {3.686597225814011*^9, 
   3.686597232423974*^9}, {3.6865993999424686`*^9, 3.6865994253940353`*^9}, {
   3.686670124410927*^9, 3.6866701359233522`*^9}, {3.686670267555924*^9, 
   3.68667029759608*^9}, {3.686671865220694*^9, 3.686671869149053*^9}, {
   3.6874017412810993`*^9, 3.687401741373704*^9}, {3.68740217754252*^9, 
   3.687402179022784*^9}, {3.6874023089149313`*^9, 3.6874023089944477`*^9}, {
   3.687535844938191*^9, 3.6875358680674477`*^9}, {3.687536066410911*^9, 
   3.687536069443989*^9}, {3.687536337939992*^9, 3.687536338119774*^9}, {
   3.687635833091564*^9, 3.687635866788554*^9}, {3.687635959461882*^9, 
   3.687635959648182*^9}, {3.6876891578064632`*^9, 3.6876891624386578`*^9}, {
   3.6876892433909807`*^9, 3.687689254302599*^9}, {3.687689297723596*^9, 
   3.687689305661216*^9}, {3.687689546223084*^9, 3.687689555924983*^9}, {
   3.687896224375331*^9, 3.687896224585758*^9}, {3.69014553471982*^9, 
   3.690145535804009*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["principal", "Subsection",
 CellChangeTimes->{{3.6658698737005663`*^9, 3.580345126027151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolyReduceTrans", "[", 
    RowBox[{"fxn_", ",", "var_", ",", "nf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fxn1", ",", "nf1", ",", "sub", ",", "elem"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"sub", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"nf", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}],
          "\[Rule]", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "nf", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
            "]"}]}], "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<sub: \>\"", ",", "sub"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"Catch", "[", "\n", "\t", 
         RowBox[{
          RowBox[{"nf1", "=", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"elem", "=", 
                 RowBox[{"Together", "[", "#", "]"}]}], ";", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "elem", " ", "is", " ", "member", " ", "of", " ", "Q", 
                  RowBox[{"(", 
                   RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], " ", "*)"}], 
                "\n", "\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Denominator", "[", "elem", "]"}], "/.", "sub"}], 
                    ")"}], "===", "0"}], ",", 
                  RowBox[{"Throw", "[", "True", "]"}]}], "]"}], ";", "\n", 
                "\t\t\t", 
                RowBox[{"elem", "/.", "sub"}]}], "\n", "\t\t", ")"}], "&"}]}],
             "]"}]}], ";", "\n", "\t", 
          RowBox[{"nf1", "=", 
           RowBox[{
            RowBox[{"FactorList", "[", "nf1", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
          "\t", 
          RowBox[{"nf1", "=", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"nf1", "/", 
              RowBox[{"Coefficient", "[", 
               RowBox[{"nf1", ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{"Exponent", "[", 
                 RowBox[{"nf1", ",", 
                  RowBox[{
                  "nf", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
            "]"}]}], ";", "\n", "\t", 
          RowBox[{"nf1", "=", 
           RowBox[{"NF", "[", 
            RowBox[{"0", ",", "nf1", ",", 
             RowBox[{
             "nf", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<nf1: \>\"", ",", "nf1"}], "]"}], ";", "\n", "\t", 
          RowBox[{"fxn1", "=", 
           RowBox[{"Collect", "[", 
            RowBox[{"fxn", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"var", ",", 
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", "\n", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"elem", "=", 
                 RowBox[{"Together", "[", "#", "]"}]}], ";", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "elem", " ", "is", " ", "member", " ", "of", " ", "Q", 
                  RowBox[{"(", 
                   RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], " ", "*)"}], 
                "\n", "\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Denominator", "[", "elem", "]"}], "/.", "sub"}], 
                    ")"}], "===", "0"}], ",", 
                  RowBox[{"Throw", "[", "True", "]"}]}], "]"}], ";", "\n", 
                "\t\t\t", 
                RowBox[{"elem", "/.", "sub"}]}], "\n", "\t\t", ")"}], "&"}]}],
             "]"}]}], ";", "\n", "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<fxn1: \>\"", ",", "fxn1"}], "]"}], ";", "\n", "\t", 
          RowBox[{"fxn1", "=", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{"fxn1", ",", "var", ",", "nf1"}], "]"}]}], ";", "\n", 
          "\t", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<fxn1: \>\"", ",", "fxn1"}], "]"}], ";", "\n", "\t", 
          RowBox[{"Throw", "[", "False", "]"}], ";"}], "\n", "]"}], ",", "\n", 
        RowBox[{"assert", "[", 
         RowBox[{"False", ",", "\"\<case in PolyReduceTrans\>\""}], "]"}]}], 
       "\n", "]"}], ";", "\n", 
      RowBox[{"{", 
       RowBox[{"fxn1", ",", "nf1"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7017782284156647`*^9, 3.7017782603750267`*^9}, {
   3.701778316983982*^9, 3.70177831989648*^9}, {3.701778419197014*^9, 
   3.701778642505404*^9}, {3.701778694702003*^9, 3.701778730187826*^9}, {
   3.701779141512116*^9, 3.701779248786283*^9}, {3.701779304529331*^9, 
   3.701779321713482*^9}, 3.7017794633788137`*^9, {3.7017794967310133`*^9, 
   3.7017795256509237`*^9}, {3.70177956277363*^9, 3.701779571534431*^9}, {
   3.701779634127123*^9, 3.701779652095294*^9}, {3.701779700064312*^9, 
   3.701779729064954*^9}, {3.7017798329044123`*^9, 3.701779851004621*^9}, {
   3.70178016292663*^9, 3.701780170134609*^9}, {3.701780273328616*^9, 
   3.701780309129486*^9}, {3.701782277026278*^9, 3.701782300294363*^9}, {
   3.7017823451468153`*^9, 3.701782345682406*^9}, {3.701782385739027*^9, 
   3.7017823927786827`*^9}, {3.701783468204834*^9, 3.7017835525592833`*^9}, {
   3.70178373326822*^9, 3.701783749043766*^9}, {3.7017838524354877`*^9, 
   3.701783877724427*^9}, {3.701783934228313*^9, 3.701783962356613*^9}, {
   3.701783999164749*^9, 3.7017839996460333`*^9}, {3.701784047380919*^9, 
   3.701784047637089*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"construct", " ", "principal", " ", "ideal"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"DivisorMakePrincipal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num_", ",", "den_"}], "}"}], ",", "P_", ",", "ord_", ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "num", "]"}]}], ",", "max"}], "}"}], ",", 
      RowBox[{"{", "\n", "\t", 
       RowBox[{
        RowBox[{"IdealMakePrincipal", "[", 
         RowBox[{"x", ",", 
          RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"num", ",", "den"}], "}"}], ",", "nf"}], "]"}], ",", "\n", 
        "\t", 
        RowBox[{
         RowBox[{"max", "=", 
          RowBox[{"Exponent", "[", 
           RowBox[{"den", ",", "x"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"max", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"max", ",", 
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{
                 "num", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "x"}], "]"}], "+", 
               RowBox[{
               "ord", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", 
         "\t", 
         RowBox[{"IdealMakePrincipalLocal", "[", 
          RowBox[{"\[Xi]", ",", 
           RowBox[{
           "P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"num", "*", 
                  RowBox[{"x", "^", "ord"}]}], ",", "den"}], "}"}], "/", 
               RowBox[{"x", "^", "max"}]}], "/.", 
              RowBox[{"x", "\[Rule]", 
               RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]"}], "]"}], ",", 
           "nf"}], "]"}]}]}], "\n", "}"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IdealMakePrincipal", "[", 
      RowBox[{"x_", ",", "P_List", ",", 
       RowBox[{"{", 
        RowBox[{"num_", ",", "den_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "num", "]"}]}], ",", "tab", ",", "gcd"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"tab", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "num", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}],
                 "*", 
                RowBox[{"P", "\[LeftDoubleBracket]", 
                 RowBox[{"k", ",", "i", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
             ",", "nf"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"tab", "=", 
         RowBox[{"PolyHermitianReduce", "[", 
          RowBox[{"tab", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"IdealStandardize", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"tab", ",", "den"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IdealMakePrincipalLocal", "[", 
      RowBox[{"x_", ",", "P_List", ",", 
       RowBox[{"{", 
        RowBox[{"num_", ",", "den_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "num", "]"}]}], ",", "tab", ",", "gcd"}], 
        "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"tab", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "num", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}],
                 "*", 
                RowBox[{"P", "\[LeftDoubleBracket]", 
                 RowBox[{"k", ",", "i", ",", "j"}], 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "x", 
             ",", "nf"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"tab", "=", 
         RowBox[{"PolyHermitianReduce", "[", 
          RowBox[{"tab", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"IdealStandardizeLocal", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"tab", ",", "den"}], "}"}], ",", "nf"}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"test", " ", "for", " ", "principal", " ", "ideal"}], " ", "*)"}],
    "\n", 
   RowBox[{
    RowBox[{"DivisorIsPrincipal", "[", 
     RowBox[{"div_", ",", "P_", ",", "ord\[Delta]_", ",", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nf_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", "ord", ",", "fun", ",", "ind", ",", ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "P", "]"}]}]}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DivisorDegree", "[", 
           RowBox[{"div", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], "===", 
          "0"}], ",", "\"\<degree in DivisorIsTorsion\>\""}], "]"}], ";", 
       "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ord", ",", "fun"}], "}"}], "=", 
        RowBox[{"DivisorRRSpace", "[", 
         RowBox[{"div", ",", "P", ",", "ord\[Delta]", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"ind", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"ord", ",", 
           RowBox[{"Min", "[", "ord", "]"}]}], "]"}], "\[LeftDoubleBracket]", 
         
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
       "\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ord", "\[LeftDoubleBracket]", "ind", "\[RightDoubleBracket]"}], "===",
           "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fun", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "fun", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}]}], "}"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DivisorIsTorsion", "[", 
      RowBox[{
      "div_", ",", "P_", ",", "ord\[Delta]_", ",", "badred_", ",", "var_", 
       ",", "nf_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "ord\[Delta]", "]"}]}], ",", "p", ",", "q", 
         ",", "rediv", ",", "redP", ",", "redorder", ",", "nfp", ",", "nfq", 
         ",", "op", ",", "oq", ",", "kp", ",", "kq", ",", "\n", "m", ",", 
         "divk", ",", "fk", ",", "div2k", ",", "f2k", ",", "ord", ",", "fun", 
         ",", "ind", ",", "succ", ",", "func", ",", "powk", ",", "pow2k", ",",
          "badred1", ",", "div1", ",", "P1", ",", "nf1"}], "}"}], ",", "\n", 
       "\t", 
       RowBox[{
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<entering DivisorIsTorsion: \>\"", ",", 
          RowBox[{"DivisorPrint", "[", "div", "]"}], ",", "\"\< over \>\"", 
          ",", "nf"}], "]"}], ";", "\n", "\t", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<nf: \>\"", ",", "nf"}], "]"}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"badred1", ",", "div1", ",", "P1"}], "}"}], ",", "nf1"}], 
          "}"}], "=", 
         RowBox[{"PolyReduceTrans", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"badred", ",", "div", ",", "P"}], "}"}], ",", "var", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<{{badred1,div1,P1},nf1}: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"badred1", ",", "div1", ",", "P1"}], "}"}], ",", "nf1"}],
            "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"p", "=", 
         RowBox[{"NextPrime", "[", "n", "]"}]}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nfp", "=", 
              RowBox[{"NumReduce", "[", 
               RowBox[{"nf1", ",", "p"}], "]"}]}], ")"}], "===", "$Failed"}], 
           "||", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rediv", "=", 
              RowBox[{"PolyReduce", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"badred1", ",", "div1", ",", "P1"}], "}"}], ",", 
                "var", ",", "nfp"}], "]"}]}], ")"}], "===", "$Failed"}]}], 
          ",", 
          RowBox[{"p", "=", 
           RowBox[{"NextPrime", "[", "p", "]"}]}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"op", "=", 
         RowBox[{"DivisorOrder", "[", 
          RowBox[{
           RowBox[{
           "rediv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "rediv", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           ",", "ord\[Delta]", ",", "var", ",", "nfp"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{
         "\"\<order after reduction to \>\"", ",", "nfp", ",", "\"\<: \>\"", 
          ",", "op"}], "]"}], ";", "\n", "\t", 
        RowBox[{"q", "=", 
         RowBox[{"NextPrime", "[", "p", "]"}]}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nfq", "=", 
              RowBox[{"NumReduce", "[", 
               RowBox[{"nf1", ",", "q"}], "]"}]}], ")"}], "===", "$Failed"}], 
           "||", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rediv", "=", 
              RowBox[{"PolyReduce", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"badred1", ",", "div1", ",", "P1"}], "}"}], ",", 
                "var", ",", "nfq"}], "]"}]}], ")"}], "===", "$Failed"}]}], 
          ",", 
          RowBox[{"q", "=", 
           RowBox[{"NextPrime", "[", "q", "]"}]}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"oq", "=", 
         RowBox[{"DivisorOrder", "[", 
          RowBox[{
           RowBox[{
           "rediv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "rediv", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           ",", "ord\[Delta]", ",", "var", ",", "nfq"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{
         "\"\<order after reduction to \>\"", ",", "nfq", ",", "\"\<: \>\"", 
          ",", "oq"}], "]"}], ";", "\n", "\t", 
        RowBox[{"op", "=", 
         RowBox[{"Quotient", "[", 
          RowBox[{"op", ",", 
           RowBox[{"p", "^", 
            RowBox[{"IntegerExponent", "[", 
             RowBox[{"op", ",", "p"}], "]"}]}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"oq", "=", 
         RowBox[{"Quotient", "[", 
          RowBox[{"oq", ",", 
           RowBox[{"q", "^", 
            RowBox[{"IntegerExponent", "[", 
             RowBox[{"oq", ",", "q"}], "]"}]}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"kp", "=", 
         RowBox[{"IntegerExponent", "[", 
          RowBox[{"oq", ",", "p"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"kq", "=", 
         RowBox[{"IntegerExponent", "[", 
          RowBox[{"op", ",", "q"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Quotient", "[", 
            RowBox[{"op", ",", 
             RowBox[{"q", "^", "kq"}]}], "]"}], "=!=", 
           RowBox[{"Quotient", "[", 
            RowBox[{"oq", ",", 
             RowBox[{"p", "^", "kp"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"False", ",", "Null", ",", "Null"}], "}"}], ",", "\n", 
          RowBox[{"(*", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"DivisorIsPrincipal", "[", 
              RowBox[{
               RowBox[{"DivisorPower", "[", 
                RowBox[{"div", ",", 
                 RowBox[{"op", "*", 
                  RowBox[{"p", "^", "kp"}]}]}], "]"}], ",", "P", ",", 
               "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", 
             RowBox[{"op", "*", 
              RowBox[{"p", "^", "kp"}]}]}], "]"}], "*)"}], "\n", "\t\t", 
          RowBox[{
           RowBox[{"divk", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], 
               "}"}]}], "}"}]}], ";", 
           RowBox[{"powk", "=", "0"}], ";", 
           RowBox[{"pow2k", "=", "1"}], ";", "\n", "\t\t", 
           RowBox[{"fk", "=", 
            RowBox[{"MakeBaseElement", "[", 
             RowBox[{
              RowBox[{
              "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "1", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"div2k", "=", "div"}], ";", "\n", "\t\t", 
           RowBox[{"f2k", "=", "fk"}], ";", "\n", "\t\t", 
           RowBox[{"m", "=", 
            RowBox[{"op", "*", 
             RowBox[{"p", "^", "kp"}]}]}], ";", "\n", "\t\t", 
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<testing canditate order \>\"", ",", "m"}], "]"}], 
           ";", "\n", "\t\t", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"OddQ", "[", "m", "]"}], ",", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"divk", "=", 
                  RowBox[{"DivisorTimes", "[", 
                   RowBox[{
                   "divk", ",", "div2k", ",", "P", ",", "var", ",", "nf"}], 
                   "]"}]}], ";", 
                 RowBox[{"powk", "+=", "pow2k"}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"fk", "=", 
                  RowBox[{"PieceTimes", "[", 
                   RowBox[{
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "fk", ",", "f2k", ",", 
                    "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ord", ",", "fun"}], "}"}], "=", 
                  RowBox[{"DivisorRRSpace", "[", 
                   RowBox[{
                   "divk", ",", "P", ",", "ord\[Delta]", ",", "var", ",", 
                    "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"ind", "=", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"ord", ",", 
                    RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
                   "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\n", "\t\t\t\t", 
                 RowBox[{"divk", "=", 
                  RowBox[{"DivisorDivide", "[", 
                   RowBox[{"divk", ",", 
                    RowBox[{"DivisorMakePrincipal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "P", ",", 
                    "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", "P", 
                    ",", "var", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"fk", "=", 
                  RowBox[{"PieceTimes", "[", 
                   RowBox[{
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "fk", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], 
                   "]"}]}]}]}], "\n", "\t\t\t", "]"}], ";", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"m", "=", 
               RowBox[{"Quotient", "[", 
                RowBox[{"m", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"m", ">", "0"}], ",", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"div2k", "=", 
                  RowBox[{"DivisorTimes", "[", 
                   RowBox[{
                   "div2k", ",", "div2k", ",", "P", ",", "var", ",", "nf"}], 
                   "]"}]}], ";", 
                 RowBox[{"pow2k", "+=", "pow2k"}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"f2k", "=", 
                  RowBox[{"PieceTimes", "[", 
                   RowBox[{
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "f2k", ",", "f2k", ",", 
                    "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"ord", ",", "fun"}], "}"}], "=", 
                  RowBox[{"DivisorRRSpace", "[", 
                   RowBox[{
                   "div2k", ",", "P", ",", "ord\[Delta]", ",", "var", ",", 
                    "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"ind", "=", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"ord", ",", 
                    RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
                   "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\n", "\t\t\t\t", 
                 RowBox[{"div2k", "=", 
                  RowBox[{"DivisorDivide", "[", 
                   RowBox[{"div2k", ",", 
                    RowBox[{"DivisorMakePrincipal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "P", ",", 
                    "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", "P", 
                    ",", "var", ",", "nf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
                 RowBox[{"f2k", "=", 
                  RowBox[{"PieceTimes", "[", 
                   RowBox[{
                    RowBox[{
                    "var", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "f2k", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"fun", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "fun", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], 
                   "]"}]}]}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
              RowBox[{"TimePrint", "[", 
               RowBox[{"\"\<div^\>\"", ",", "powk", ",", "\"\<: \>\"", ",", 
                RowBox[{"DivisorPrint", "[", "divk", "]"}], ",", 
                "\"\< * \>\"", ",", "fk"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\t\t", "]"}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"succ", ",", "func"}], "}"}], "=", 
            RowBox[{"DivisorIsPrincipal", "[", 
             RowBox[{
             "divk", ",", "P", ",", "ord\[Delta]", ",", "var", ",", "nf"}], 
             "]"}]}], ";", "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"succ", ",", "\n", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"succ", ",", 
               RowBox[{"PieceTimes", "[", 
                RowBox[{
                 RowBox[{
                 "var", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "func", ",", "fk", ",", "nf"}], "]"}], ",", 
               RowBox[{"op", "*", 
                RowBox[{"p", "^", "kp"}]}]}], "}"}], ",", "\n", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"False", ",", "Null", ",", "Null"}], "}"}]}], "\n", 
            "\t\t", "]"}]}]}], "\n", "\n", "\t", "]"}]}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "nf", " ", "should", " ", "be", " ", "a", " ", "finite", " ", "field"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"DivisorOrder", "[", 
     RowBox[{
     "div_", ",", "P_", ",", "ord\[Delta]_", ",", "var_", ",", "nf_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", "divk", ",", "ord", ",", "fun", ",", 
        "ind", ",", 
        RowBox[{"succ", "=", "False"}], ",", "fpiece", ",", "limit", ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "ord\[Delta]", "]"}]}]}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"TimePrint", "[", 
        RowBox[{"\"\<entering DivisorOrder: \>\"", ",", 
         RowBox[{"DivisorPrint", "[", "div", "]"}], ",", "\"\< over \>\"", 
         ",", "nf"}], "]"}], ";", "\n", "\t", 
       RowBox[{"limit", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumCard", "[", "nf", "]"}], "===", "\[Infinity]"}], ",", 
          "7", ",", 
          RowBox[{"Ceiling", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"NumCard", "[", "nf", "]"}], "]"}]}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Total", "[", "ord\[Delta]", "]"}], "-", "n", "+", 
                "1"}], ")"}]}], ")"}]}], "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DivisorDegree", "[", 
           RowBox[{"div", ",", "var", ",", "nf"}], "]"}], "===", "0"}], ",", 
         "\"\<degree in DivisorOrder\>\""}], "]"}], ";", "\n", "\t", 
       RowBox[{"divk", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
         "}"}]}], ";", "\n", "\t", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"!", "succ"}], ",", 
           RowBox[{
            RowBox[{"++", "k"}], "\[LessEqual]", "limit"}]}], "]"}], ",", 
         "\n", "\t\t", 
         RowBox[{
          RowBox[{"divk", "=", 
           RowBox[{"DivisorTimes", "[", 
            RowBox[{"divk", ",", "div", ",", "P", ",", "var", ",", "nf"}], 
            "]"}]}], ";", "\n", "\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ord", ",", "fun"}], "}"}], "=", 
           RowBox[{"DivisorRRSpace", "[", 
            RowBox[{
            "divk", ",", "P", ",", "ord\[Delta]", ",", "var", ",", "nf"}], 
            "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"ind", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"ord", ",", 
              RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
          "\t\t", 
          RowBox[{"divk", "=", 
           RowBox[{"DivisorDivide", "[", 
            RowBox[{"divk", ",", 
             RowBox[{"DivisorMakePrincipal", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"fun", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "fun", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", "P", ",", 
               "ord\[Delta]", ",", "var", ",", "nf"}], "]"}], ",", "P", ",", 
             "var", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"TimePrint", "[", 
           RowBox[{"\"\<div^\>\"", ",", "k", ",", "\"\<: \>\"", ",", 
            RowBox[{"DivisorPrint", "[", "divk", "]"}]}], "]"}], ";", "\n", 
          "\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "ord", "\[LeftDoubleBracket]", "ind", "\[RightDoubleBracket]"}], 
             "===", "0"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\n", "\t", "]"}], ";", 
       "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", ">", "limit"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<error in DivisorOrder: limit \>\"", ",", "limit", ",", 
            "\"\< reached \>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\t", "k"}]}], 
     "\n", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.665869773407901*^9, 3.6658697769395723`*^9}, {
   3.6659012218213577`*^9, 3.665901271561818*^9}, {3.665901318755294*^9, 
   3.665901374891144*^9}, {3.665901406258815*^9, 3.665901439202098*^9}, {
   3.6659014744016237`*^9, 3.665901834567787*^9}, {3.66590201624123*^9, 
   3.665902019811092*^9}, 3.665902068614105*^9, {3.665902108431107*^9, 
   3.6659021162013206`*^9}, {3.665902182810042*^9, 3.665902189031893*^9}, {
   3.6659023506920633`*^9, 3.6659023507704897`*^9}, {3.665902424944662*^9, 
   3.665902431745298*^9}, {3.665902499127236*^9, 3.665902499374707*^9}, {
   3.6660408406561823`*^9, 3.6660408608133*^9}, {3.66645585326504*^9, 
   3.666455853496122*^9}, {3.666455887927813*^9, 3.666455940560082*^9}, {
   3.666455978120338*^9, 3.666455987169467*^9}, {3.666456091022986*^9, 
   3.5811789343448095`*^9}, {3.5811789757448673`*^9, 
   3.5811790464949665`*^9}, {3.5811790914900293`*^9, 
   3.5811790929100313`*^9}, {3.5811791348850904`*^9, 3.581179162520129*^9}, {
   3.5811792033651867`*^9, 3.5811792048701887`*^9}, {3.5811792392452364`*^9, 
   3.5811792714302816`*^9}, {3.581179324020355*^9, 3.58117940616047*^9}, {
   3.5811794729605637`*^9, 3.581179478975572*^9}, {3.581179509575615*^9, 
   3.5811795206806307`*^9}, {3.581179623840775*^9, 3.581179721645912*^9}, {
   3.581179759450965*^9, 3.5811798092910347`*^9}, {3.5811799470412273`*^9, 
   3.5811800152013226`*^9}, {3.581182051943461*^9, 3.581182053218463*^9}, {
   3.581182120863558*^9, 3.5811821316785727`*^9}, {3.581182257908749*^9, 
   3.581182260393753*^9}, {3.5811824037389536`*^9, 3.581182468979045*^9}, {
   3.5811826016742306`*^9, 3.581182607449239*^9}, {3.5811826702343264`*^9, 
   3.5811827493994374`*^9}, {3.581182852594582*^9, 3.581182894689641*^9}, {
   3.5811829533447227`*^9, 3.5811829808297615`*^9}, {3.581186110184142*^9, 
   3.581186131224172*^9}, {3.5811862775593767`*^9, 3.581186277769377*^9}, {
   3.581186538984743*^9, 3.581186542079747*^9}, {3.5811865950048213`*^9, 
   3.581186614324848*^9}, {3.581186680459941*^9, 3.581186708894981*^9}, {
   3.581186783295085*^9, 3.581186789860094*^9}, 3.581187334790857*^9, {
   3.5812225278269053`*^9, 3.581222596399003*^9}, {3.6669611956907263`*^9, 
   3.666961198530792*^9}, {3.6669612464355907`*^9, 3.666961336531907*^9}, {
   3.666962719118127*^9, 3.666962719226635*^9}, {3.666962840557227*^9, 
   3.666962842720858*^9}, {3.666962889546459*^9, 3.6669631833717012`*^9}, {
   3.666963216713211*^9, 3.6669633373938*^9}, 3.66696339253579*^9, {
   3.666964242099292*^9, 3.6669642776208*^9}, {3.666964310382332*^9, 
   3.6669643591761713`*^9}, {3.666964397086879*^9, 3.666964901166451*^9}, {
   3.666964996985023*^9, 3.666964997338715*^9}, {3.666967839842429*^9, 
   3.666967888833559*^9}, {3.666968070412547*^9, 3.66696807303181*^9}, {
   3.666968169407209*^9, 3.666968169869052*^9}, {3.666968227081367*^9, 
   3.66696823876404*^9}, {3.666968650602942*^9, 3.666968684338059*^9}, {
   3.666968719723256*^9, 3.66696873323108*^9}, {3.666968864130723*^9, 
   3.666968906872335*^9}, {3.6669693469827223`*^9, 3.6669693486386414`*^9}, {
   3.666969394226919*^9, 3.666969401928317*^9}, {3.6669695198913603`*^9, 
   3.666969613497603*^9}, {3.666983068743134*^9, 3.6669831026760893`*^9}, {
   3.666983297780415*^9, 3.6669833099443913`*^9}, {3.6669833862690487`*^9, 
   3.6669833945189867`*^9}, {3.666983504927438*^9, 3.666983505248186*^9}, {
   3.666992256087263*^9, 3.666992256443204*^9}, 3.686158771570108*^9, 
   3.686159924403262*^9, {3.6861612325665493`*^9, 3.68616123261287*^9}, 
   3.686174099218713*^9, {3.686176858227779*^9, 3.686176974560391*^9}, {
   3.686177011785334*^9, 3.686177101548682*^9}, {3.686177140656962*^9, 
   3.686177166105537*^9}, {3.686177294676099*^9, 3.6861773783086348`*^9}, {
   3.686177431108614*^9, 3.6861775470545692`*^9}, {3.69014333199964*^9, 
   3.6901433327730513`*^9}, {3.690144299386312*^9, 3.6901443064625683`*^9}, {
   3.6901443460032663`*^9, 3.690144515259199*^9}, {3.690144564608992*^9, 
   3.690144665145679*^9}, {3.690144710579567*^9, 3.690144784951687*^9}, {
   3.690144859107624*^9, 3.690144926437196*^9}, {3.690144979406116*^9, 
   3.69014497986869*^9}, {3.690145011159688*^9, 3.6901451814105577`*^9}, {
   3.6901452417065697`*^9, 3.6901452608718977`*^9}, {3.690145299736865*^9, 
   3.69014531049561*^9}, {3.6901453547533293`*^9, 3.6901453559849453`*^9}, {
   3.6901453908692303`*^9, 3.690145410057673*^9}, {3.6901455914042387`*^9, 
   3.690145606836787*^9}, {3.690145658653966*^9, 3.690145675629672*^9}, {
   3.69014734826163*^9, 3.690147348392498*^9}, {3.690147403172975*^9, 
   3.69014740390432*^9}, {3.690814022325932*^9, 3.6908140518230753`*^9}, {
   3.690814119539712*^9, 3.690814128571188*^9}, {3.6908141767335377`*^9, 
   3.690814176812932*^9}, {3.690814543108939*^9, 3.690814560777853*^9}, {
   3.690814957438645*^9, 3.576107859745556*^9}, {3.5761080585379267`*^9, 
   3.576108062019126*^9}, {3.576108131737113*^9, 3.5761081817269726`*^9}, {
   3.5761082430064774`*^9, 3.5761082784625053`*^9}, {3.5761083538308163`*^9, 
   3.576108354150834*^9}, {3.576108602277026*^9, 3.5761087206117945`*^9}, {
   3.576108769539593*^9, 3.5761090341777296`*^9}, {3.5761090842745953`*^9, 
   3.57610915324854*^9}, {3.576109208176682*^9, 3.576109255960415*^9}, {
   3.576109514767218*^9, 3.576109518039405*^9}, {3.5761095488711686`*^9, 
   3.5761095489421725`*^9}, {3.576109582783108*^9, 3.5761095829261165`*^9}, {
   3.67389743989754*^9, 3.67389744210069*^9}, {3.6738976659425964`*^9, 
   3.673897673380174*^9}, {3.6738977149744067`*^9, 3.6738977273346014`*^9}, {
   3.673903692949687*^9, 3.6739036952309628`*^9}, {3.673903728302575*^9, 
   3.6739037313807344`*^9}, {3.6739044326527553`*^9, 
   3.6739045503426533`*^9}, {3.673904703185319*^9, 3.673904767951683*^9}, {
   3.673904849172075*^9, 3.6739048566565113`*^9}, {3.6739049040945807`*^9, 
   3.67390494477674*^9}, {3.6739050059812613`*^9, 3.6739050347472367`*^9}, {
   3.673905345235876*^9, 3.67390539351839*^9}, {3.673905445343035*^9, 
   3.67390545485877*^9}, {3.6739074854911766`*^9, 3.673907504647642*^9}, {
   3.6739075693791676`*^9, 3.6739076733966904`*^9}, {3.673907878970924*^9, 
   3.673907902643056*^9}, {3.6739079959480605`*^9, 3.673907998104335*^9}, {
   3.6739080830064454`*^9, 3.6739080833814497`*^9}, {3.6739113926332736`*^9, 
   3.673911418961671*^9}, {3.6739114674776645`*^9, 3.673911503537773*^9}, {
   3.676475295723937*^9, 3.6764752961770926`*^9}, {3.6764963277745113`*^9, 
   3.676496343384064*^9}, {3.6764964081349225`*^9, 3.6764964146037273`*^9}, {
   3.676496733456003*^9, 3.6764967460811496`*^9}, {3.6764977957222815`*^9, 
   3.676497875691975*^9}, {3.6764981660094013`*^9, 3.6764982371039724`*^9}, {
   3.6764983759035273`*^9, 3.67649839818503*^9}, {3.6764984365136642`*^9, 
   3.676498559156766*^9}, {3.676498651684767*^9, 3.6764986691231785`*^9}, {
   3.676498756631238*^9, 3.676498777131468*^9}, {3.6764988569458823`*^9, 
   3.6764988743054566`*^9}, {3.6764989154934297`*^9, 3.676498916368431*^9}, {
   3.676500011388373*^9, 3.6765000115602207`*^9}, {3.67650004534186*^9, 
   3.6765000793422475`*^9}, {3.6765001103738523`*^9, 3.676500117640656*^9}, {
   3.67650017256316*^9, 3.676500347995276*^9}, {3.676500445621394*^9, 
   3.676500527373404*^9}, {3.6765005743878613`*^9, 3.67650072495192*^9}, {
   3.6765008554893217`*^9, 3.6765008946460247`*^9}, {3.6765009495945883`*^9, 
   3.676500969360441*^9}, {3.676501153905179*^9, 3.6765011581239758`*^9}, 
   3.6765012342632647`*^9, {3.6765013818278723`*^9, 3.6765015395540857`*^9}, {
   3.67650158570881*^9, 3.671122546504854*^9}, {3.6711402953613973`*^9, 
   3.671140364619172*^9}, {3.6930098024367113`*^9, 3.6930098186249332`*^9}, {
   3.693009864907928*^9, 3.693009986606525*^9}, {3.693232316947095*^9, 
   3.6932323172642593`*^9}, {3.693232622809688*^9, 3.693232640355356*^9}, {
   3.6932330341149387`*^9, 3.6932330347309732`*^9}, {3.693233072916525*^9, 
   3.693233102992009*^9}, {3.6932331787761106`*^9, 3.6932331928944483`*^9}, 
   3.701776485840887*^9, {3.7017765714091578`*^9, 3.701776571873423*^9}, {
   3.7017767156331367`*^9, 3.701776724558289*^9}, {3.7017770262673883`*^9, 
   3.701777048971244*^9}, {3.701777097307332*^9, 3.701777173276556*^9}, {
   3.70177812128935*^9, 3.701778129301752*^9}, {3.701782400383646*^9, 
   3.701782448378271*^9}, {3.701783816585772*^9, 3.701783816935297*^9}, 
   3.701784094146069*^9, {3.701784311890142*^9, 3.701784314026236*^9}, {
   3.701784349163598*^9, 3.70178437838649*^9}, {3.701784612827365*^9, 
   3.701784613171487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pow", "[", 
   RowBox[{"X_", ",", "M_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "=", "X"}], ",", 
      RowBox[{"m", "=", "M"}], ",", 
      RowBox[{"r", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "m", "]"}], ",", 
          RowBox[{"r", "*=", "x"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Quotient", "[", 
          RowBox[{"m", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m", ">", "0"}], ",", 
          RowBox[{"x", "*=", "x"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6764978838639417`*^9, 3.6764979445244784`*^9}, {
  3.676497993181245*^9, 3.6764980907801886`*^9}, {3.676498572376588*^9, 
  3.6764985782516828`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["integration", "Section",
 CellChangeTimes->{{3.579383051611622*^9, 3.5793830562760305`*^9}}],

Cell[CellGroupData[{

Cell["integrals", "Subsection",
 CellChangeTimes->{{3.6672367209115973`*^9, 3.667236729007429*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgInt", "[", 
   RowBox[{"curvelist_", ",", "ffunc_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nnff_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fa", ",", "ff", ",", "ipow", ",", "irep", ",", "g", ",", "d", ",", "n", 
      ",", "z", ",", "B", ",", "handled", ",", "tt", ",", "\n", "\[Omega]", 
      ",", "\[Omega]q", ",", "\[Omega]r", ",", "v", ",", "u", ",", "k", ",", 
      "expp", ",", "m", ",", "w", ",", "a", ",", "c", ",", "t", ",", "b", ",",
       "ratpart", ",", 
      RowBox[{"logpart", "=", "0"}], ",", "rempart", ",", 
      RowBox[{"rem2part", "=", "0"}], ",", "Ci", ",", "dd", ",", "res", ",", 
      "fac", ",", "alpha", ",", "coeff", ",", "mat", ",", "resl", ",", 
      "indices", ",", "r", ",", "\n", "DATA", ",", "RES", ",", "IDEAL", ",", 
      "succ", ",", "fpiece", ",", "logterm", ",", "fpiecemlogd", ",", 
      "normres", ",", "mm", ",", "res\[Phi]", ",", "res\[Infinity]", ",", 
      "cap\[Phi]", ",", "cap\[Infinity]", ",", "cap", ",", "mat2", ",", "\n", 
      "toEtaBar", ",", "fromEtaBar", ",", "toEpsilon", ",", "fromEpsilon", 
      ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", "diff1stkind", ",", 
      "diff2ndkind", ",", "diff3rdkind", ",", "derInEtaBar", ",", "\n", 
      "nfk0d", ",", "ibasis", ",", "imat", ",", "irord", ",", "itrace", ",", 
      "iprod", ",", "id", ",", "idisc", ",", "idiff", ",", "BR", ",", "\n", 
      "nf", ",", "\n", "nfk1", ",", "\[Theta]k21", ",", "\[Theta]k10", ",", 
      "prodk1", ",", "dk1", ",", "BRk1", ",", "\n", "nfk2", ",", 
      "\[Theta]k20", ",", "dk2", ",", "prodk2", ",", "BRk2", ",", "\n", "ord",
       ",", "ind", ",", "Ddiv", ",", "Ddeg", ",", "\n", "bigrmat", ",", 
      "bigrbasis", ",", "bigmp", ",", "rbasisk1", ",", "ratden", ",", "\n", 
      "new\[Omega]", ",", "jsf", ",", "isf", ",", "ibadred", ",", "fun", ",", 
      "pfact", ",", "\n", "pow", ",", "respiece", ",", "reslist", ",", 
      "roots", ",", "term", ",", "rbasis", ",", "rel", ",", "rmat", ",", 
      "div", ",", 
      RowBox[{"\[Delta]rz", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[Delta]z", ",", "flogd", ",",
       "newrmp"}], "}"}], ",", "\n", "\t", "\n", "\t", 
    RowBox[{
     RowBox[{"SetTime", "[", "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", "\"\<starting\>\"", "]"}], ";", "\n", "\t", 
     RowBox[{"fa", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToFunctionAlgebra", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nnff"}], "]"}], "&"}], 
        ",", "curvelist"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Which", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "fa", "]"}], "===", "0"}], ",", " ", 
       RowBox[{"fa", "=", 
        RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"{", "1", "}"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nnff"}], "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"Length", "[", "fa", "]"}], "===", "1"}], ",", " ", 
       RowBox[{"fa", "=", 
        RowBox[{
        "fa", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"Length", "[", "fa", "]"}], ">", "1"}], ",", " ", 
       RowBox[{"fa", "=", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FunctionAlgebraCompositum", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"First", "[", "fa", "]"}], ",", 
          RowBox[{"Rest", "[", "fa", "]"}]}], "]"}]}]}], "\n", "\t", "]"}], 
     ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<function algebra: \>\"", ",", "fa"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"fa", "=", 
      RowBox[{"FunctionAlgebraComponents", "[", "fa", "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<components: \>\"", ",", "fa"}], "]"}], ";", "\n", "\n", 
     "\t", 
     RowBox[{"ff", "=", 
      RowBox[{"fa", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"nf", "=", 
      RowBox[{"ff", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ipow", ",", "irep", ",", "imat", ",", "itrace", ",", "iprod", ",", 
        "id", ",", "irord"}], "}"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "ff"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "3"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "irord", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "idisc", ",", "idiff", ",", "isf", ",", "ibadred", ",", "\n", "\t\t", 
        "toEtaBar", ",", "fromEtaBar", ",", "toEpsilon", ",", "fromEpsilon", 
        ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", "\n", "\t\t", 
        "diff1stkind", ",", "diff2ndkind", ",", "diff3rdkind"}], "}"}], "=", 
      RowBox[{"FunctionFieldInfo", "[", "ff", "]"}]}], ";", "\n", "\n", "\n", 
     "\t", 
     RowBox[{"ibasis", "=", 
      RowBox[{"PolyMatrixInverse", "[", 
       RowBox[{
        RowBox[{
        "imat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ibasis", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "imat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
         
         RowBox[{
         "ibasis", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "*", 
        RowBox[{
         RowBox[{
         "ibasis", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ".", "ipow"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"ParseFunction", "[", 
       RowBox[{"ffunc", ",", "ff"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ratpart", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}], ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integral basis: \>\"", ",", "ibasis"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"\[Omega]", ",", "ff"}], "]"}]}], "]"}], ";", "\n", "\t", 
     "\n", 
     RowBox[{
     "TimePrint", "[", "\"\<starting hermite reduction at finite places \>\"",
       "]"}], ";", "\n", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"PolyFactorSquareFree", "[", 
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", "x", ",", "nf"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "=", 
           RowBox[{
            RowBox[{"Length", "[", "v", "]"}], "-", "1"}]}], ")"}], ">", 
         "0"}]}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t", 
        
        RowBox[{"u", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"v", "^", 
              RowBox[{"(", 
               RowBox[{"k", "+", "1"}], ")"}]}], ",", "x", ",", "nf"}], "]"}],
            ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"w", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PolyGCD", "[", 
            RowBox[{
             RowBox[{"id", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"u", "*", "v"}], ",", "x", ",", "nf"}], "]"}], ",", 
             "x", ",", "nf"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"t", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"w", "*", "u", "*", "v"}], ",", "x", ",", "nf"}], "]"}], 
           ",", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"B", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"t", "*", 
             RowBox[{"Transpose", "[", 
              RowBox[{"id", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "-", 
            RowBox[{"k", "*", "w", "*", "u", "*", 
             RowBox[{"D", "[", 
              RowBox[{"v", ",", "x"}], "]"}], "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ",", "x", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"B", "=", 
         RowBox[{
          RowBox[{"PolyGaussJordanReduceMod", "[", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "B", "]"}], ",", 
                 RowBox[{"w", "*", 
                  RowBox[{
                  "\[Omega]", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], "]"}], ",", "x"}], 
             "]"}], ",", "x", ",", "v", ",", "nf"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"w", "*", 
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"B", ",", "x"}], "]"}], "*", "w", "*", "u", "*", 
               "v"}], "+", 
              RowBox[{"t", "*", 
               RowBox[{"B", ".", 
                RowBox[{"id", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "-", 
              
              RowBox[{"k", "*", "B", "*", "w", "*", "u", "*", 
               RowBox[{"D", "[", 
                RowBox[{"v", ",", "x"}], "]"}]}]}], ")"}]}], ",", "x", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "v", ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
           
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"w", "*", "u", "*", 
            RowBox[{"v", "^", "k"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{"PolyNormalizeFraction", "[", 
          RowBox[{"\[Omega]", ",", "x", ",", "nf", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"ratpart", "=", 
         RowBox[{"PiecePlus", "[", 
          RowBox[{"x", ",", "ratpart", ",", 
           RowBox[{"{", 
            RowBox[{"B", ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"v", "^", "k"}], ",", "x", ",", "nf"}], "]"}]}], "}"}],
            ",", "nf"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ratpart: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
          "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
          "*", 
         RowBox[{
          RowBox[{
          "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ".", "ibasis"}]}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand after finite hermite reduction: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}], ";", "\n", "\n", 
     RowBox[{
     "TimePrint", "[", 
      "\"\<starting hermite reduction at infinite places \>\"", "]"}], ";", 
     "\n", "\t", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            ".", "toEpsilonBar"}], ",", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"\[Omega]r", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", "n"}], "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Omega]q", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "\[Omega]r", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "}"}], "=", 
        RowBox[{"PolyQuotientRemainder", "[", 
         RowBox[{
          RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "x", ",", "nf"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]q", ".", 
           RowBox[{
           "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{
          "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"resl", "=", 
      RowBox[{"CalcResidues", "[", 
       RowBox[{"\[Omega]q", ",", "diff3rdkind", ",", "irord", ",", 
        RowBox[{"id", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "toEtaBar", ",", "toEpsilonBar", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<resl: \>\"", ",", "resl"}], "]"}], ";"}], "*)"}], "\n", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff3rdkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"PiecePlus", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]r", ".", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"resl", ".", "diff3rdkind", ".", 
             RowBox[{
             "fromEtaBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]r", ".", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", "nf", ",", 
          
          RowBox[{"{", "1", "}"}]}], "]"}]}]}], "\n", "\t", "]"}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";"}], "*)"}],
      "\n", "\t", 
     RowBox[{"derInEtaBar", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{"#", ",", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}], "&"}], ",", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
           "toEtaBar"}], ",", "x", ",", "nf"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{"#", ",", "x", ",", "nf"}], "]"}], ",", 
           RowBox[{
           "\[Omega]q", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "x", ",", "nf"}], "]"}], "&"}], 
        ",", 
        RowBox[{
         RowBox[{
         "\[Omega]q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ".", "toEtaBar"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Omega]q", "-", 
         RowBox[{"resl", ".", "diff3rdkind"}]}], ",", "x", ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "\[Omega]q", "}"}], ",", "diff1stkind", ",", 
        "diff2ndkind"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat2", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", "\[Omega]q"}], 
           "]"}], "+", "2", "-", "irord"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"indices", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "irord", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "===", "0"}], ",", "1", ",", "0"}],
              "]"}], ",", 
            RowBox[{"r", "-", 
             RowBox[{
             "irord", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"mat", ",", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "*", 
                RowBox[{"x", "^", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "*", 
                RowBox[{
                "toEtaBar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"x", "^", "j"}], "*", 
                RowBox[{
                "derInEtaBar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], 
             "]"}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"mat2", ",", 
            RowBox[{
             RowBox[{"x", "^", "j"}], "*", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "n", "]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";"}]}], "\n", "\t", "]"}], ",", "indices", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"coeff", "=", 
      RowBox[{"PolyNumRowNullSpace", "[", 
       RowBox[{"mat", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "coeff", "]"}], "===", "1"}], "&&", 
       RowBox[{
        RowBox[{"coeff", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=!=", "0"}]}], 
      "]"}], ";", "\n", "\t", 
     RowBox[{"coeff", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NumCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumRecp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"coeff", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
             "nf"}], "]"}], "*", "#"}], ",", "nf"}], "]"}], "&"}], "/@", 
       RowBox[{"Rest", "[", 
        RowBox[{
        "coeff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff1stkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"\[Omega]", "=", 
         RowBox[{"PiecePlus", "[", 
          RowBox[{"x", ",", "\[Omega]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"coeff", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"Length", "[", "diff1stkind", "]"}]}], 
               "\[RightDoubleBracket]"}], ".", "diff1stkind", ".", 
              RowBox[{
              "fromEtaBar", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
             "fromEtaBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"coeff", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"coeff", ",", 
           RowBox[{"Length", "[", "diff1stkind", "]"}]}], "]"}]}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff2ndkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"rem2part", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{
                "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"diff2ndkind", ".", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"rem2part", "=", 
         RowBox[{
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "diff2ndkind", "]"}]}], 
           "\[RightDoubleBracket]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Int2ndKindPiece", "/@", "rem2part"}], ")"}]}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"coeff", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"coeff", ",", 
           RowBox[{"Length", "[", "diff2ndkind", "]"}]}], "]"}]}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"ratpart", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"x", ",", "ratpart", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coeff", ".", "mat2"}], ",", "1"}], "}"}], ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"rempart", "=", "\[Omega]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ratpart: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"ratpart", ",", "ff"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<rem2part: \>\"", ",", "rem2part"}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand after infinite hermite reduction: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "rempart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "rempart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"rempart", ",", "ff"}], "]"}]}], "]"}], ";", "\n", "\n", "\n",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "compute", " ", "the", " ", "log", " ", "terms", " ", "for",
        " ", "integrand", " ", 
       RowBox[{"omega", ".", " ", "this"}], " ", "can", " ", "fail", " ", 
       "so", " ", "the", " ", "remaining", " ", "unintegrated", " ", 
       "portion", " ", "is", " ", "stored", " ", "in", " ", "rempart"}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "*", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ".", "ibasis"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<everything done\>\"", "]"}]}], "]"}], ";", 
     "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"functions", " ", "that", " ", "captures", " ", "residues"}], 
      " ", "*)"}], "\n", "\t", 
     RowBox[{"cap\[Phi]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", "1"}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"x", ",", 
          RowBox[{
          "iprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "x"}], "]"}], ",", "nf"}], 
         "]"}]}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Phi]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"cap\[Phi]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"cap\[Phi]", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"z", "*", 
          RowBox[{"cap\[Phi]", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"cap\[Phi]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{"cap\[Phi]", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
         RowBox[{"cap\[Phi]", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
     ";", "\n", "\t", 
     RowBox[{"cap\[Infinity]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{"1", "+", "irord", "-", 
                 RowBox[{"Exponent", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Omega]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ")"}]}]}],
              "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
           "]"}], ",", "1"}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"\[Xi]", ",", 
          RowBox[{
          "iprod", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"Exponent", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Omega]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ")"}]}]}],
              "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
           "]"}], ",", "nf"}], "]"}]}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Infinity]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"cap\[Infinity]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"cap\[Infinity]", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
         RowBox[{"z", "*", 
          RowBox[{"cap\[Infinity]", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"cap\[Infinity]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
        RowBox[{
         RowBox[{"cap\[Infinity]", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "*", 
         RowBox[{"cap\[Infinity]", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
     ";", "\n", "\t", 
     RowBox[{"cap", "=", 
      RowBox[{"{", 
       RowBox[{"cap\[Phi]", ",", "cap\[Infinity]"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<cap finite: \>\"", ",", "cap\[Phi]"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<cap infinite: \>\"", ",", "cap\[Infinity]"}], "]"}], ";", 
     "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "interpolate", " ", "polynomials", " ", "that", " ", "captures", " ", 
       "residues"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"res\[Phi]", "=", 
      RowBox[{"PolyGaussJordanReduce", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pp", "===", "0"}], ",", "1", ",", 
            RowBox[{"pp", "<", 
             RowBox[{"n", "+", "1"}]}], ",", 
            RowBox[{"zz", "^", "pp"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"PieceNorm", "[", 
              RowBox[{"x", ",", 
               RowBox[{
               "iprod", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"cap\[Phi]", "/.", 
                RowBox[{"z", "\[Rule]", "zz"}]}], ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", "0", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "\n", "\t", ",", "x", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Phi]", "=", 
      RowBox[{"PolyNormalizeVector", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res\[Phi]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"n", "+", "2"}]}], "\[RightDoubleBracket]"}], "/", 
             RowBox[{"res\[Phi]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            "x", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "x", ",", 
        "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Infinity]", "=", 
      RowBox[{"PolyGaussJordanReduce", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pp", "===", "0"}], ",", "1", ",", 
            RowBox[{"pp", "<", 
             RowBox[{"n", "+", "1"}]}], ",", 
            RowBox[{"zz", "^", "pp"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"PieceNorm", "[", 
              RowBox[{"\[Xi]", ",", 
               RowBox[{
               "iprod", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"cap\[Infinity]", "/.", 
                RowBox[{"z", "\[Rule]", "zz"}]}], ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", "0", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "\n", "\t", ",", 
        "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Infinity]", "=", 
      RowBox[{"PolyNormalizeVector", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res\[Infinity]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"n", "+", "2"}]}], "\[RightDoubleBracket]"}], "/", 
             RowBox[{"res\[Infinity]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            "\[Xi]", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "\[Xi]", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues finite: \>\"", ",", 
       RowBox[{"res\[Phi]", ".", 
        RowBox[{"#", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}]}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues infinite: \>\"", ",", 
       RowBox[{"res\[Infinity]", ".", 
        RowBox[{"#", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}]}]}], "]"}], ";", "\n", "\n", "\t", 
     
     RowBox[{"BR", "=", 
      RowBox[{"RES", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "isf", "]"}], ",", "2"}], "}"}]}], 
        "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], "}"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", ">", "1"}], ",", 
           RowBox[{"IdealPlus", "[", 
            RowBox[{"x", ",", 
             RowBox[{"BR", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"isf", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", "nf"}],
             "]"}], ",", 
           RowBox[{"IdealMakePrimeTo", "[", 
            RowBox[{"x", ",", 
             RowBox[{
             "iprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"BR", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "idiff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "nf"}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"isf", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{
         "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"DivisorNorm", "[", 
          RowBox[{
           RowBox[{
           "BR", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{"RES", "\[LeftDoubleBracket]", 
           RowBox[{"r", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "===",
           "1", "===", 
          RowBox[{"RES", "\[LeftDoubleBracket]", 
           RowBox[{"r", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
         "]"}], ";", "\n", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TimePrint", "[", 
           RowBox[{
           "\"\<BR\[LeftDoubleBracket]\>\"", ",", "r", ",", 
            "\"\<\[RightDoubleBracket]: \>\"", ",", 
            RowBox[{"DivisorPrint", "[", 
             RowBox[{
             "BR", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
             "]"}], ",", "\"\< , norm of B\[LeftDoubleBracket]\>\"", ",", "r",
             ",", "\"\<\[RightDoubleBracket]: \>\"", ",", 
            RowBox[{"Factor", "[", 
             RowBox[{
             "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
             "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"res\[Phi]", ".", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "/", "r"}], ")"}], "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "n"}], "]"}]}]}], ",", 
             RowBox[{"PolyMakeSquareFree", "[", 
              RowBox[{
               RowBox[{"RES", "\[LeftDoubleBracket]", 
                RowBox[{"r", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", "x", ",", "nf"}], "]"}], ",", "x"}], "]"}], ",", "z", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyRemoveCommonFactors", "[", 
          RowBox[{
           RowBox[{"PolyMakeSquareFree", "[", 
            RowBox[{
             RowBox[{"RES", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", "z", 
             ",", "nf"}], "]"}], ",", "z", ",", "z", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"res\[Infinity]", ".", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "/", "r"}], ")"}], "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "n"}], "]"}]}]}], ",", 
             RowBox[{"PolyMakeSquareFree", "[", 
              RowBox[{
               RowBox[{"RES", "\[LeftDoubleBracket]", 
                RowBox[{"r", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", "\[Xi]", ",", "nf"}], "]"}], ",", "\[Xi]"}], "]"}], ",", 
           "z", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyRemoveCommonFactors", "[", 
          RowBox[{
           RowBox[{"PolyMakeSquareFree", "[", 
            RowBox[{
             RowBox[{"RES", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", "z", 
             ",", "nf"}], "]"}], ",", "z", ",", "z", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{
         "\"\<residues from ramification index \>\"", ",", "r", ",", 
          "\"\<: \>\"", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
             "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"z", "\[Rule]", "#"}]}], "]"}], "&"}]}], "]"}], ";"}], 
       "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", 
         RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z"}], "]"}], "===", 
        "0"}], ",", 
       RowBox[{"Goto", "[", "\"\<no poles\>\"", "]"}]}], "]"}], ";", "\n", 
     "\n", "\t", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "irord", "]"}], "-", "n", "+", "1"}], "===", 
        "0"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{
        "TimePrint", "[", "\"\<******** genus zero case! *********\>\"", 
         "]"}], ";", "\n", "\t\t", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DivisorDegree", "[", 
            RowBox[{"idiff", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], "===", 
           RowBox[{"-", "2"}]}], ",", 
          "\"\<bad degree of canonical divisor\>\""}], "]"}], ";", "\n", "\n",
         "\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"find", " ", "divisor", " ", "of", " ", "degree"}], " ", 
          "-", 
          RowBox[{"1", " ", "or"}], " ", "-", "2"}], " ", "*)"}], "\n", 
        "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "n", "]"}], ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Ddiv", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Xi]", "*", 
                 RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], 
               "}"}]}], "}"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"Ddiv", "=", 
            RowBox[{"DivisorTimes", "[", 
             RowBox[{
              RowBox[{"DivisorPower", "[", 
               RowBox[{"idiff", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], ",", "iprod", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], ",", 
              "Ddiv", ",", "iprod", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
           "\n", "\t\t", "True"}], ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"pfact", "=", 
            RowBox[{"First", "/@", 
             RowBox[{"PolyFactor", "[", 
              RowBox[{"idisc", ",", "x", ",", "nf"}], "]"}]}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"pfact", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "*", 
                    RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], 
                  "}"}]}], "}"}], "&"}], ",", "pfact"}], "]"}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"pfact", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Xi]", "*", 
                  RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], 
                "}"}]}], "}"}]}], "]"}], ";", "\n", "\t\t\t", 
           RowBox[{"Ddiv", "=", "Null"}], ";", 
           RowBox[{"b", "=", "\[Infinity]"}], ";", "\n", "\t\t\t", 
           RowBox[{"Do", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "=", 
               RowBox[{"DivisorPlus", "[", 
                RowBox[{
                 RowBox[{
                 "isf", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "pfact", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], 
              ";", "\n", "\t\t\t\t", 
              RowBox[{"c", "=", 
               RowBox[{"DivisorDegree", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], 
              ";", "\n", "\t\t\t\t", 
              RowBox[{"Which", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"EvenQ", "[", "c", "]"}], ",", 
                RowBox[{"Continue", "[", "]"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"c", ">", "b"}], ",", 
                RowBox[{"Continue", "[", "]"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"c", "<", "b"}], ",", 
                RowBox[{
                 RowBox[{"b", "=", "c"}], ";", 
                 RowBox[{"Ddiv", "=", "a"}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"ByteCount", "[", "a", "]"}], "<", 
                 RowBox[{"ByteCount", "[", "Ddiv", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"b", "=", "c"}], ";", 
                 RowBox[{"Ddiv", "=", "a"}]}]}], "\n", "\t\t\t\t", "]"}], 
              ";"}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "pfact", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Ddiv", "===", "Null"}], ",", 
             RowBox[{"Ddiv", "=", "idiff"}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"Ddiv", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{
                 RowBox[{"DivisorPower", "[", 
                  RowBox[{"idiff", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"b", "+", "1"}], ")"}], "/", "2"}], ",", "iprod", 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], 
                 ",", "Ddiv", ",", "iprod", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], 
              ";"}]}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}], ";", 
        "\n", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ord", ",", "fun"}], "}"}], "=", 
         RowBox[{"DivisorRRSpace", "[", 
          RowBox[{"Ddiv", ",", "iprod", ",", "irord", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"ind", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ord", ",", 
            RowBox[{"Min", "[", "ord", "]"}]}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"Ddiv", "=", 
         RowBox[{"DivisorDivide", "[", 
          RowBox[{"Ddiv", ",", 
           RowBox[{"DivisorMakePrincipal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"fun", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "fun", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "}"}], ",", "iprod", ",", 
             "irord", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}], ",", 
           "iprod", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
        "\n", "\n", "\t\t", 
        RowBox[{"Ddeg", "=", 
         RowBox[{"-", 
          RowBox[{"DivisorDegree", "[", 
           RowBox[{"Ddiv", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<found divisor \>\"", ",", 
          RowBox[{"DivisorPrint", "[", "Ddiv", "]"}], ",", 
          "\"\< of degree \>\"", ",", 
          RowBox[{"-", "Ddeg"}]}], "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
        "\n", "\t\t", 
        RowBox[{"bigmp", "=", 
         RowBox[{"PolyMakeSquareFree", "[", 
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z", ",", "nf"}], 
          "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"bigmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"PolyMakeMonic", "[", 
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], ",", "z", ",", "nf"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"PolyFactor", "[", 
           RowBox[{"bigmp", ",", "z", ",", "nf"}], "]"}]}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<residue polys: \>\"", ",", 
          RowBox[{"bigmp", "/.", 
           RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}], ";", "\n", "\n", "\n", 
        "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<******* looking at factor \>\"", ",", 
             RowBox[{
              RowBox[{
              "bigmp", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
               "/.", 
              RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}], ";", "\n", "\n", 
           "\t\t\t", 
           RowBox[{"nfk1", "=", 
            RowBox[{"RootReduce", "[", 
             RowBox[{"z", "/.", 
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NumFieldEmbedding", "[", 
                   RowBox[{
                    RowBox[{
                    "bigmp", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", "nf"}], "]"}], "\[Equal]",
                   "0"}], ",", "z"}], "]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"nfk1", "=", 
            RowBox[{"NF", "[", 
             RowBox[{"0", ",", 
              RowBox[{"MinimalPolynomial", "[", 
               RowBox[{"nfk1", ",", "\[Theta]"}], "]"}], ",", "nfk1"}], 
             "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<nfk1: \>\"", ",", "nfk1"}], "]"}], ";", "\n", "\n", 
           "\t\t\t", 
           RowBox[{"\[Theta]k10", "=", 
            RowBox[{"First", "/@", 
             RowBox[{"PolyFactor", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "nf", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "/.", 
                RowBox[{"\[Theta]", "\[Rule]", "tt"}]}], ",", "tt", ",", 
               "nfk1"}], "]"}]}]}], ";", "\n", "\t\t\t", 
           RowBox[{"\[Theta]k10", "=", 
            RowBox[{"Sort", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"\[Theta]k10", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exponent", "[", 
                  RowBox[{"#", ",", "tt"}], "]"}], "===", "1"}], "&"}]}], 
              "]"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Theta]k10", "]"}], ">", "0"}], ",", 
             "\"\<problem in reduction\>\""}], "]"}], ";", "\n", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<\[Theta]k10: \>\"", ",", "\[Theta]k10"}], "]"}], ";",
            "\n", "\t\t\t", 
           RowBox[{"\[Theta]k10", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"NumCollect", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Coefficient", "[", 
                   RowBox[{
                    RowBox[{
                    "\[Theta]k10", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "tt", ",", "0"}], "]"}]}],
                  "*", 
                 RowBox[{"NumRecp", "[", 
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    "\[Theta]k10", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "tt", ",", "1"}], "]"}], 
                   ",", "nfk1"}], "]"}]}], ",", "nfk1"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Theta]k10", "]"}]}], "}"}]}], 
             "]"}]}], ";", "\n", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<\[Theta]k10: \>\"", ",", "\[Theta]k10"}], "]"}], ";",
            "\n", "\t\t\t", 
           RowBox[{"\[Theta]k10", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"\[Theta]k10", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"RootReduce", "[", 
                 RowBox[{
                  RowBox[{"NumFieldEmbedding", "[", 
                   RowBox[{"\[Theta]", ",", "nf"}], "]"}], "-", 
                  RowBox[{"NumFieldEmbedding", "[", 
                   RowBox[{"#", ",", "nfk1"}], "]"}]}], "]"}], "===", "0"}], 
               "&"}]}], "]"}]}], ";", "\n", 
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<\[Theta]k10: \>\"", ",", "\[Theta]k10"}], "]"}], ";",
            "\n", "\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "\[Theta]k10", "]"}], "===", "1"}], ",", 
             "\"\<problem in reduction\>\""}], "]"}], ";", "\n", "\t\t\t", 
           RowBox[{"\[Theta]k10", "=", 
            RowBox[{
            "\[Theta]k10", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ";", "\n", 
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<\[Theta]k10: \>\"", ",", "\[Theta]k10"}], "]"}], ";",
            "\n", "\n", "\t\t\t", 
           RowBox[{"prodk1", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"iprod", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"dk1", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"id", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"BRk1", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"BR", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
              "x", ",", "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], 
               "}"}]}], "}"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"Do", "[", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<cap\[LeftDoubleBracket]1\[RightDoubleBracket]: \>\"", ",", 
                RowBox[{
                "cap", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{"\[Theta]", "/", "r"}]}]}], "}"}]}], ",", "x", 
                 ",", "nfk1"}], "]"}]}], ";", "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Delta]rz\[LeftDoubleBracket]1\[RightDoubleBracket]: \
\>\"", ",", 
                RowBox[{
                "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<BRk1\[LeftDoubleBracket]r,1\[RightDoubleBracket]: \>\"", 
                ",", 
                RowBox[{"BRk1", "\[LeftDoubleBracket]", 
                 RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
              ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"BRk1", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"BRk1", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipal", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    "prodk1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "nfk1"}], "]"}], ",", 
                   "nfk1"}], "]"}]}], "]"}]}], ";", "\n", "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<cap\[LeftDoubleBracket]2\[RightDoubleBracket]: \>\"", ",", 
                RowBox[{
                "cap", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{"\[Theta]", "/", "r"}]}]}], "}"}]}], ",", "\[Xi]",
                  ",", "nfk1"}], "]"}]}], ";", "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\[Delta]rz\[LeftDoubleBracket]2\[RightDoubleBracket]: \
\>\"", ",", 
                RowBox[{
                "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "]"}], ";", "\n", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<BRk1\[LeftDoubleBracket]r,2\[RightDoubleBracket]: \>\"", 
                ",", 
                RowBox[{"BRk1", "\[LeftDoubleBracket]", 
                 RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
              ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"BRk1", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"\[Xi]", ",", 
                   RowBox[{"BRk1", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipalLocal", "[", 
                    RowBox[{"\[Xi]", ",", 
                    RowBox[{
                    "prodk1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "nfk1"}], "]"}], ",", 
                   "nfk1"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"\[Delta]z", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{"\[Delta]z", ",", "\[Delta]rz", ",", "prodk1", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
              ";"}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "1", ",", 
               RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<divisor \[Delta]z: \>\"", ",", 
             RowBox[{"DivisorPrint", "[", "\[Delta]z", "]"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"a", "=", 
            RowBox[{"DivisorDegree", "[", 
             RowBox[{"\[Delta]z", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<degree of \[Delta]z: \>\"", ",", "a"}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"c", "=", 
            RowBox[{"Ddeg", "/", 
             RowBox[{"GCD", "[", 
              RowBox[{"a", ",", "Ddeg"}], "]"}]}]}], ";", "\n", "\t\t\t", 
           RowBox[{"div", "=", 
            RowBox[{"DivisorPower", "[", 
             RowBox[{
              RowBox[{"PolyCollect", "[", 
               RowBox[{
                RowBox[{"Ddiv", "/.", 
                 RowBox[{"{", 
                  RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}], 
              ",", 
              RowBox[{"a", "*", 
               RowBox[{"c", "/", "Ddeg"}]}], ",", "prodk1", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"div", "=", 
            RowBox[{"DivisorTimes", "[", 
             RowBox[{
              RowBox[{"DivisorPower", "[", 
               RowBox[{"\[Delta]z", ",", "c", ",", "prodk1", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}], 
              ",", "div", ",", "prodk1", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\t", "\n", "\t\t\t", 
           RowBox[{"TimePrint", "[", 
            RowBox[{"\"\<div: \>\"", ",", 
             RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";", "\n", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ord", ",", "fpiece"}], "}"}], "=", 
            RowBox[{"DivisorRRSpace", "[", 
             RowBox[{"div", ",", "prodk1", ",", "irord", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"ind", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"ord", ",", 
               RowBox[{"Min", "[", "ord", "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "ord", "\[LeftDoubleBracket]", "ind", "\[RightDoubleBracket]"}],
               "===", "0"}], ",", "\"\<bad rr space\>\""}], "]"}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"fpiece", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"fpiece", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "ind"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "fpiece", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "}"}]}], ";", "\n", "\n", 
           "\t\t\t", 
           RowBox[{"dk1", "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{"id", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDiff", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "prodk1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "dk1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "fpiece", ",", "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDivide", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "prodk1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", "flogd", ",", "fpiece", ",", 
              "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Theta]"}], "/", "c"}], "*", 
             RowBox[{
             "flogd", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t\t\t", 
           RowBox[{"ratden", "=", 
            RowBox[{
             RowBox[{"Resultant", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "flogd", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "/.", 
                RowBox[{"\[Theta]", "\[Rule]", "tt"}]}], ",", 
               RowBox[{
                RowBox[{
                "bigmp", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "/.", 
                RowBox[{"z", "\[Rule]", "tt"}]}], ",", "tt"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}]}], ";", 
           "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "flogd", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "*", 
               RowBox[{"PolyDivide", "[", 
                RowBox[{"ratden", ",", 
                 RowBox[{
                 "flogd", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "x", ",", "nfk1"}], "]"}]}],
               ",", "x", ",", "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "=", "ratden"}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PolyCollectExt", "[", 
             RowBox[{
              RowBox[{"flogd", "/.", 
               RowBox[{"\[Theta]", "\[Rule]", "#"}]}], ",", "x", ",", "nfk1", 
              ",", "nf", ",", 
              RowBox[{
               RowBox[{
               "bigmp", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"RootSum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{
                  "bigmp", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"z", "\[Rule]", "#"}]}], "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                 "flogd", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{
               "flogd", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", "Slot"}], "]"}], ",", 
             "\"\<problem rationalizing denominator\>\""}], "]"}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"rempart", "=", 
            RowBox[{"PiecePlus", "[", 
             RowBox[{"x", ",", "rempart", ",", "flogd", ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"rbasisk1", "=", 
            RowBox[{"PolyCollectExt", "[", 
             RowBox[{"#", ",", "x", ",", "nfk1", ",", "nf", ",", 
              RowBox[{
               RowBox[{
               "bigmp", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"fpiece", "=", 
            RowBox[{"PolyCollectExt", "[", 
             RowBox[{
              RowBox[{"fpiece", "/.", 
               RowBox[{"\[Theta]", "\[Rule]", "#"}]}], ",", "x", ",", "nfk1", 
              ",", "nf", ",", 
              RowBox[{
               RowBox[{
               "bigmp", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], "/.", 
               RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}]}], ";", "\n", "\n", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<adding \>\"", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{
                  RowBox[{
                  "bigmp", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "<", "2"}], 
               ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Simplify", "[", 
                 RowBox[{"rbasisk1", "/", "c"}], "]"}], "*", 
                RowBox[{"Log", "[", 
                 RowBox[{"PrintFunction", "[", 
                  RowBox[{"fpiece", ",", "ff"}], "]"}], "]"}]}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"RootPlus", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{
                   "bigmp", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "/.", 
                   RowBox[{"z", "\[Rule]", "#"}]}], "]"}], ",", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"Simplify", "[", 
                    RowBox[{"rbasisk1", "/", "c"}], "]"}], "*", 
                   RowBox[{"Log", "[", 
                    RowBox[{"PrintFunction", "[", 
                    RowBox[{"fpiece", ",", "ff"}], "]"}], "]"}]}], "]"}]}], 
                "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "]"}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"logpart", "+=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{
                 "bigmp", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], ",", "z"}], "]"}], "<", "2"}], 
              ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Simplify", "[", 
                RowBox[{"rbasisk1", "/", "c"}], "]"}], "*", 
               RowBox[{"Log", "[", 
                RowBox[{"PrintFunction", "[", 
                 RowBox[{"fpiece", ",", "ff"}], "]"}], "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"RootPlus", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{
                  "bigmp", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"z", "\[Rule]", "#"}]}], "]"}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"Simplify", "[", 
                   RowBox[{"rbasisk1", "/", "c"}], "]"}], "*", 
                  RowBox[{"Log", "[", 
                   RowBox[{"PrintFunction", "[", 
                    RowBox[{"fpiece", ",", "ff"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ";"}], "\n", "\n", 
          "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "bigmp", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", "\t\t", "\n", "\t\t", 
        RowBox[{"Goto", "[", "\"\<no poles\>\"", "]"}], ";"}]}], "\n", "\t", 
      "]"}], ";", "\n", "\n", "\n", "\n", "\n", "\n", "\n", "\n", "\n", "\n", 
     "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"next", " ", "get", " ", "a", " ", "Q"}], "-", 
       RowBox[{"basis", " ", "for", " ", "the", " ", "Q"}], "-", 
       RowBox[{"span", " ", "of", " ", "the", " ", "residues"}]}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", ",", "\[Theta]k20", ",", "nfk2", ",", "newrmp"}], 
       "}"}], "=", 
      RowBox[{"SplittingField", "[", 
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z", ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<\[Theta]k20,nfk2: \>\"", ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]k20", ",", "nfk2"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<newrmp: \>\"", ",", "newrmp"}], "]"}], ";", "\n", "\t", 
     "\n", "\t", 
     RowBox[{"roots", "=", 
      RowBox[{"roots", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rmat", ",", "rbasis", ",", "bigmp"}], "}"}], "=", 
      RowBox[{"NewQBasisForQSpan", "[", 
       RowBox[{"roots", ",", "nfk2", ",", "nf", ",", "\[Theta]k20"}], "]"}]}],
      ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", "\"\<***** basis done *****\>\"", "]"}], ";", 
     "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues: \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "roots", "}"}], "]"}], "]"}], ",", "\"\< = \>\"", ",", 
       RowBox[{"MatrixForm", "[", "rmat", "]"}], ",", "\"\< . \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "rbasis", "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<minpoly: \>\"", ",", 
       RowBox[{"MatrixForm", "[", "bigmp", "]"}]}], "]"}], ";", "\n", "\n", 
     "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "combine", " ", "divisors", " ", "and", " ", "test", " ", "if", " ", 
       "they", " ", "are", " ", "torsion"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"rempart", "=", "\[Omega]"}], ";", "\n", "\t", 
     RowBox[{"prodk2", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"iprod", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k20"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk2"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"dk2", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"id", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k20"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk2"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"BRk2", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"BR", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k20"}], "}"}]}], ",", "x", 
        ",", "nfk2"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"handled", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<***** looking at residue basis element \>\"", ",", 
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\"\< *****\>\""}], "]"}], ";", "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"handled", ",", 
            RowBox[{"bigmp", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",",
           "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"TimePrint", "[", "\"\<already handled\>\"", "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"Continue", "[", "]"}]}]}], "\n", "\t\t", "]"}], ";", "\n",
         "\t\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"handled", ",", 
          RowBox[{"bigmp", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ";", 
        "\n", "\n", "\t\t", 
        RowBox[{"b", "=", 
         RowBox[{"LCM", "@@", 
          RowBox[{"Denominator", "/@", 
           RowBox[{"rmat", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"t", "=", 
         RowBox[{"GCD", "@@", 
          RowBox[{"(", 
           RowBox[{"b", "*", 
            RowBox[{"(", 
             RowBox[{"rmat", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "j"}], "\[RightDoubleBracket]"}], ")"}]}], 
           ")"}]}]}], ";", "\n", "\n", "\t\t", 
        RowBox[{"div", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
          "}"}]}], ";", "\n", "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], 
               "}"}]}], "}"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"Do", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k20"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "roots", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/", "r"}]}]}], "}"}]}], ",", 
                 "x", ",", "nfk2"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"BRk2", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"BRk2", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipal", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    "prodk2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "nfk2"}], "]"}], ",", 
                   "nfk2"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k20"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "roots", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/", "r"}]}]}], "}"}]}], ",", 
                 "\[Xi]", ",", "nfk2"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"BRk2", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"\[Xi]", ",", 
                   RowBox[{"BRk2", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipalLocal", "[", 
                    RowBox[{"\[Xi]", ",", 
                    RowBox[{
                    "prodk2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "nfk2"}], "]"}], ",", 
                   "nfk2"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"\[Delta]z", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{"\[Delta]z", ",", "\[Delta]rz", ",", "prodk2", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk2"}], "]"}]}], 
              ";"}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "1", ",", 
               RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{"IntegerQ", "[", 
              RowBox[{"b", "*", 
               RowBox[{
                RowBox[{"rmat", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "/", 
                "t"}]}], "]"}], ",", "\"\<non integral exponent\>\""}], "]"}],
            ";", "\n", "\t\t\t", 
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"DivisorPower", "[", 
             RowBox[{"\[Delta]z", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "/", "t"}], ")"}], "*", 
               RowBox[{"rmat", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
              "prodk2", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk2"}], "]"}]}], 
           ";", "\n", "\t\t", "\n", "\t\t\t", 
           RowBox[{"div", "=", 
            RowBox[{"DivisorTimes", "[", 
             RowBox[{"div", ",", "\[Delta]z", ",", "prodk2", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk2"}], "]"}]}], 
           ";"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<divisor \[Delta][\>\"", ",", 
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\"\<]: \>\"", ",", 
          RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";", "\n", "\n",
         "\t\t", 
        RowBox[{"nfk1", "=", 
         RowBox[{"bigmp", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"\[Theta]k10", "=", 
         RowBox[{"bigmp", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"\[Theta]k21", "=", 
         RowBox[{"bigmp", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "4"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"div", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{"div", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"NumRewrite", "[", 
             RowBox[{"#", ",", "nfk2", ",", "nfk1", ",", "\[Theta]k21"}], 
             "]"}], "&"}]}], "]"}]}], ";", "\n", "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<now defined over \>\"", ",", "nfk1"}], "]"}], ";", "\n",
         "\n", "\t\t", 
        RowBox[{"rbasisk1", "=", 
         RowBox[{"NumRewrite", "[", 
          RowBox[{
           RowBox[{
           "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           ",", "nfk2", ",", "nfk1", ",", "\[Theta]k21"}], "]"}]}], ";", "\n",
         "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{
         "\"\<divisor \[Delta][\>\"", ",", "rbasisk1", ",", "\"\<]: \>\"", 
          ",", 
          RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";", "\n", "\n",
         "\t\t", 
        RowBox[{"prodk1", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"iprod", "/.", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"dk1", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"id", "/.", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], ";", 
        "\n", "\n", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Continue", "[", "]"}], ";"}], "*)"}], "\n", "\n", "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"succ", ",", "fpiece", ",", "pow"}], "}"}], "=", 
         RowBox[{"DivisorIsTorsion", "[", 
          RowBox[{"div", ",", "prodk1", ",", "irord", ",", 
           RowBox[{"ibadred", "/.", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nfk1"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"succ", ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDiff", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "prodk1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "dk1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "fpiece", ",", "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDivide", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "prodk1", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", "flogd", ",", "fpiece", ",", 
              "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "rbasisk1"}], "/", "pow"}], "/", 
              RowBox[{"(", 
               RowBox[{"b", "/", "t"}], ")"}]}], "*", 
             RowBox[{
             "flogd", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], ";", "\n", "\t\t\t", 
           RowBox[{"ratden", "=", 
            RowBox[{
             RowBox[{"Resultant", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "flogd", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"\[Theta]", "\[Rule]", 
                    RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "5"}], "\[RightDoubleBracket]"}]}], 
                   "}"}]}], ")"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"#", "\[Rule]", "tt"}], "}"}]}], ",", 
               RowBox[{
                RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"#", "\[Rule]", "tt"}], "}"}]}], ",", "tt"}], "]"}], 
             "/.", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", "\[Rule]", "\[Theta]k10"}], "}"}]}]}], ";", 
           "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "flogd", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "*", 
               RowBox[{"PolyDivide", "[", 
                RowBox[{"ratden", ",", 
                 RowBox[{
                 "flogd", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "x", ",", "nfk1"}], "]"}]}],
               ",", "x", ",", "nfk1"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "=", "ratden"}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PolyCollectExt", "[", 
             RowBox[{
              RowBox[{"flogd", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", 
                 RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "5"}], "\[RightDoubleBracket]"}]}], 
                "}"}]}], ",", "x", ",", "nfk1", ",", "nf", ",", 
              RowBox[{"bigmp", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{
            "flogd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"RootSum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
                "&"}], ",", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                 "flogd", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"assert", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{
               "flogd", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", "Slot"}], "]"}], ",", 
             "\"\<problem rationalizing denominator\>\""}], "]"}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"rempart", "=", 
            RowBox[{"PiecePlus", "[", 
             RowBox[{"x", ",", "rempart", ",", "flogd", ",", "nf"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"rbasisk1", "=", 
            RowBox[{"PolyCollectExt", "[", 
             RowBox[{
              RowBox[{"rbasisk1", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", 
                 RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "5"}], "\[RightDoubleBracket]"}]}], 
                "}"}]}], ",", "x", ",", "nfk1", ",", "nf", ",", 
              RowBox[{"bigmp", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"fpiece", "=", 
            RowBox[{"PolyCollectExt", "[", 
             RowBox[{
              RowBox[{"fpiece", "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", 
                 RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "5"}], "\[RightDoubleBracket]"}]}], 
                "}"}]}], ",", "x", ",", "nfk1", ",", "nf", ",", 
              RowBox[{"bigmp", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"logpart", "+=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "#"}], "]"}], "<", "2"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Simplify", "[", 
                RowBox[{
                 RowBox[{"rbasisk1", "/", "pow"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"b", "/", "t"}], ")"}]}], "]"}], "*", 
               RowBox[{"Log", "[", 
                RowBox[{"PrintFunction", "[", 
                 RowBox[{"fpiece", ",", "ff"}], "]"}], "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"RootPlus", "[", 
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"bigmp", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
                ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"Simplify", "[", 
                   RowBox[{
                    RowBox[{"rbasisk1", "/", "pow"}], "/", "b"}], "]"}], "*", 
                  
                  RowBox[{"Log", "[", 
                   RowBox[{"PrintFunction", "[", 
                    RowBox[{"fpiece", ",", "ff"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ";"}]}], "\n", "\t\t", 
         "]"}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "rbasis", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\n", 
     RowBox[{"Label", "[", "\"\<no poles\>\"", "]"}], ";", "\n", "\n", 
     RowBox[{"Label", "[", "\"\<everything done\>\"", "]"}], ";", "\n", "\t", 
     
     RowBox[{
      RowBox[{
       RowBox[{"Piece", "[", "ratpart", "]"}], "+", "rem2part", "+", 
       "logpart", "+", 
       RowBox[{"IntPiece", "[", "rempart", "]"}]}], "/.", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Piece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"PrintFunction", "[", 
          RowBox[{"expr", ",", "ff"}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Int2ndKindPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Int2ndKind", "[", 
          RowBox[{"PrintFunction", "[", 
           RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"IntPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Int", "[", 
          RowBox[{"PrintFunction", "[", 
           RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}]}], "\n", "\t", 
       "}"}]}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.664212532872252*^9, 3.664212534137127*^9}, {
   3.664212606041318*^9, 3.664212635898057*^9}, {3.664212673570942*^9, 
   3.664212796651765*^9}, {3.664212980171906*^9, 3.664212984740302*^9}, {
   3.664213024538394*^9, 3.6642130261080103`*^9}, {3.6642131064047728`*^9, 
   3.664213107777946*^9}, {3.664213150332472*^9, 3.664213153627995*^9}, {
   3.664213237332255*^9, 3.664213616328086*^9}, {3.66421365695045*^9, 
   3.664213767927772*^9}, 3.664213916190226*^9, {3.6642139585182056`*^9, 
   3.664214050668518*^9}, {3.664214200793009*^9, 3.6642142112026777`*^9}, {
   3.664214313316427*^9, 3.664214427682917*^9}, {3.6642179942693*^9, 
   3.664218010504815*^9}, {3.664219366389348*^9, 3.6642193835637503`*^9}, {
   3.664219664324823*^9, 3.664219667613105*^9}, {3.664219787305357*^9, 
   3.664219790516656*^9}, {3.6642212066471357`*^9, 3.664221223164415*^9}, {
   3.664226079262866*^9, 3.6642260983578663`*^9}, {3.664226146286866*^9, 
   3.664226156496866*^9}, {3.664227406963628*^9, 3.6642274203478274`*^9}, {
   3.664227617050002*^9, 3.664227620520002*^9}, {3.6642284248058863`*^9, 
   3.6642284252798862`*^9}, {3.66422873105949*^9, 3.66422873261942*^9}, {
   3.6642288189459467`*^9, 3.6642288258720355`*^9}, {3.6642290253301573`*^9, 
   3.664229056100157*^9}, {3.664229170633157*^9, 3.664229174185157*^9}, {
   3.664229434047418*^9, 3.664229464954418*^9}, {3.664229495348418*^9, 
   3.664229495513418*^9}, {3.6642298627589693`*^9, 3.6642299040503163`*^9}, {
   3.66422997683665*^9, 3.6642299866642094`*^9}, {3.664230045099187*^9, 
   3.6642300709160285`*^9}, {3.6642301253731847`*^9, 
   3.6642301370258617`*^9}, {3.664230168286859*^9, 3.66423016870804*^9}, {
   3.6642304852334366`*^9, 3.664230489772833*^9}, {3.6643177782313747`*^9, 
   3.6643177832699485`*^9}, {3.664326076212344*^9, 3.664326119079221*^9}, {
   3.664326153304085*^9, 3.6643261674214516`*^9}, {3.6643262113022823`*^9, 
   3.66432621403216*^9}, {3.664326406028344*^9, 3.6643266552583604`*^9}, {
   3.664326713630941*^9, 3.664326948416005*^9}, {3.664327026802488*^9, 
   3.664327102006713*^9}, {3.6643271572282352`*^9, 3.664327183653449*^9}, {
   3.6643272138224955`*^9, 3.6643272425720053`*^9}, {3.6643277182414603`*^9, 
   3.6643277915581703`*^9}, {3.6643278275457554`*^9, 
   3.6643278679479427`*^9}, {3.664327910050453*^9, 3.664328039228256*^9}, {
   3.664328074654267*^9, 3.664328153071948*^9}, {3.6643284247302785`*^9, 
   3.664328503411089*^9}, {3.6643285550175915`*^9, 3.664328585289039*^9}, {
   3.6643286367395835`*^9, 3.6643287140642843`*^9}, {3.6643288248419905`*^9, 
   3.6643289054997654`*^9}, {3.664328967595802*^9, 3.6643289680013523`*^9}, {
   3.664329659049317*^9, 3.664329680014776*^9}, {3.6643298460069275`*^9, 
   3.6643302196257615`*^9}, {3.6643303408479223`*^9, 
   3.6643303812969065`*^9}, {3.664330413244273*^9, 3.6643304294831443`*^9}, {
   3.664330508992777*^9, 3.664330521908997*^9}, {3.6643305828242636`*^9, 
   3.6643307045456014`*^9}, {3.664330857652731*^9, 3.664330863892451*^9}, {
   3.664330918926781*^9, 3.6643309196755476`*^9}, {3.664330957129467*^9, 
   3.6643309651163087`*^9}, {3.6643311090822487`*^9, 3.664331117583867*^9}, {
   3.664331218355345*^9, 3.6643312191353097`*^9}, {3.6643314559014854`*^9, 
   3.6643314585845647`*^9}, {3.6643316421571274`*^9, 
   3.6643317057710724`*^9}, {3.664331798384117*^9, 3.6643318450104246`*^9}, {
   3.6643319260019903`*^9, 3.6643320081947017`*^9}, {3.664332236272067*^9, 
   3.664332285409862*^9}, {3.6643324268175163`*^9, 3.664332665689597*^9}, {
   3.664332698104943*^9, 3.6643327310506644`*^9}, {3.664332783620305*^9, 
   3.664332806551276*^9}, {3.6643328394190016`*^9, 3.664332894983708*^9}, {
   3.6643333767889605`*^9, 3.6643334246320143`*^9}, {3.664333533312337*^9, 
   3.6643335553350973`*^9}, {3.664333613445097*^9, 3.664333623898097*^9}, {
   3.664333709004097*^9, 3.664333783574097*^9}, {3.6643340549224424`*^9, 
   3.6643340934995117`*^9}, 3.664334292842966*^9, {3.664334340701618*^9, 
   3.664334372960971*^9}, {3.6643344647316527`*^9, 3.664334537112405*^9}, {
   3.6643346467910833`*^9, 3.664334650066936*^9}, {3.664334752179954*^9, 
   3.664334765033777*^9}, {3.6643348035328493`*^9, 3.664334804328414*^9}, {
   3.6643348657272587`*^9, 3.664334867833164*^9}, {3.664334899016165*^9, 
   3.6643349425226126`*^9}, {3.664334978650591*^9, 3.6643350512029357`*^9}, {
   3.664335118669908*^9, 3.6643351250344224`*^9}, {3.6643351725342913`*^9, 
   3.66433520331171*^9}, {3.6643352379109573`*^9, 3.6643352388001175`*^9}, {
   3.6643352907457867`*^9, 3.664335293850047*^9}, {3.664335566510212*^9, 
   3.664335611670185*^9}, {3.66433606972803*^9, 3.6643362009181433`*^9}, {
   3.664336315962981*^9, 3.6643363257281427`*^9}, {3.664336445327976*^9, 
   3.6643364458427525`*^9}, {3.664336583756164*^9, 3.664336641398325*^9}, {
   3.664336677876667*^9, 3.664336704482931*^9}, {3.664336747261936*^9, 
   3.664336747480276*^9}, {3.664336788372202*^9, 3.6643368542952256`*^9}, {
   3.6643368843949265`*^9, 3.664336885049946*^9}, {3.6643369315942907`*^9, 
   3.6643369543517723`*^9}, {3.6643370349934325`*^9, 
   3.6643370457716503`*^9}, {3.6643370957944365`*^9, 3.664337191753648*^9}, {
   3.664337296780368*^9, 3.6643373242966514`*^9}, {3.6643373745091887`*^9, 
   3.6643373894840364`*^9}, {3.6643374738735447`*^9, 
   3.6643376821681013`*^9}, {3.66433776626285*^9, 3.664337883584937*^9}, {
   3.6643379531734147`*^9, 3.6643380736312094`*^9}, {3.6643381041746387`*^9, 
   3.6643382091891265`*^9}, {3.664338347289729*^9, 3.6643383592231936`*^9}, {
   3.6643383919661245`*^9, 3.664338446626072*^9}, 3.664338519849186*^9, {
   3.66433858683258*^9, 3.6643385954433937`*^9}, {3.664338653379194*^9, 
   3.664338698944749*^9}, {3.6643387314380913`*^9, 3.664339021101493*^9}, {
   3.66433905970976*^9, 3.66433916045004*^9}, {3.664339603267369*^9, 
   3.66433962886582*^9}, 3.664339732601165*^9, {3.6643401613947234`*^9, 
   3.664340166308503*^9}, 3.6643404370499535`*^9, 3.66434047523704*^9, {
   3.664340525248396*^9, 3.664340532174485*^9}, {3.664340599969043*^9, 
   3.66434060895424*^9}, {3.6643406537710285`*^9, 3.664340677045184*^9}, {
   3.6643407493323402`*^9, 3.6643409496273527`*^9}, {3.664340981652715*^9, 
   3.6643410006370635`*^9}, {3.6643410406648674`*^9, 
   3.6643411137475877`*^9}, {3.664341160779477*^9, 3.664341226343335*^9}, {
   3.6643412660591526`*^9, 3.6643412817676477`*^9}, {3.6643413998855476`*^9, 
   3.664341431552127*^9}, {3.6643416447945576`*^9, 3.6643416845571733`*^9}, {
   3.6643417261137085`*^9, 3.6643417420249944`*^9}, {3.6643417750955105`*^9, 
   3.6643418366503487`*^9}, {3.664341899187942*^9, 3.6643418992971373`*^9}, {
   3.6643420303156576`*^9, 3.664342125081405*^9}, {3.6643428494972982`*^9, 
   3.6643429279617767`*^9}, {3.6643450279009733`*^9, 
   3.6643450336557865`*^9}, {3.6643451731555243`*^9, 
   3.6643452709861803`*^9}, {3.664345622203965*^9, 3.6643458357703342`*^9}, {
   3.6643465518697834`*^9, 3.664346569855776*^9}, {3.66434662348617*^9, 
   3.664346847492118*^9}, {3.6643469277817144`*^9, 3.6643469843915744`*^9}, {
   3.66434705535279*^9, 3.66434717435985*^9}, {3.6643473695070925`*^9, 
   3.664347381487355*^9}, {3.664347424900207*^9, 3.6643474307499447`*^9}, 
   3.6643477789107213`*^9, {3.664347852414623*^9, 3.6643479188988395`*^9}, {
   3.664347972778822*^9, 3.664348000264788*^9}, {3.6643480341464677`*^9, 
   3.664348037749906*^9}, {3.6643483279748826`*^9, 3.6643483334658365`*^9}, {
   3.6643486438451085`*^9, 3.664348663375432*^9}, {3.6643498146349707`*^9, 
   3.664349826100456*^9}, {3.6643498588433867`*^9, 3.6643498610740867`*^9}, {
   3.6643757690161266`*^9, 3.6643757703341265`*^9}, {3.6643759686961775`*^9, 
   3.6643759824391603`*^9}, {3.6643760733206825`*^9, 3.664376083444628*^9}, {
   3.6643766283437767`*^9, 3.664376643880679*^9}, {3.6643766815841875`*^9, 
   3.664377077612928*^9}, {3.6643771549854555`*^9, 3.6643772545869865`*^9}, {
   3.664377303272402*^9, 3.664377321882366*^9}, {3.664377621576118*^9, 
   3.664377669910857*^9}, {3.6643784206024437`*^9, 3.6643786065149016`*^9}, {
   3.664378645263563*^9, 3.664378683481848*^9}, {3.6643787269258986`*^9, 
   3.6643787757985053`*^9}, {3.6643788182598*^9, 3.6643788941503944`*^9}, {
   3.66437899346207*^9, 3.6643790368084106`*^9}, {3.6643790691875763`*^9, 
   3.6643790881780653`*^9}, {3.6643791324721327`*^9, 3.664379150345394*^9}, {
   3.6643792641997137`*^9, 3.664379333997941*^9}, {3.664379376377523*^9, 
   3.664379627762089*^9}, {3.664379658135396*^9, 3.6643797377736797`*^9}, {
   3.6643797728147697`*^9, 3.664379776755887*^9}, {3.664379808314254*^9, 
   3.6643801182673388`*^9}, 3.664380411370533*^9, {3.664380448339326*^9, 
   3.664380462606845*^9}, {3.664383760702175*^9, 3.664383858917156*^9}, {
   3.664383896962658*^9, 3.664383924080016*^9}, {3.664384211934972*^9, 
   3.664384212105555*^9}, {3.66438436031212*^9, 3.664384365252325*^9}, {
   3.664384397459055*^9, 3.6643843975947638`*^9}, {3.664384640170249*^9, 
   3.6643846443418503`*^9}, {3.664384734260508*^9, 3.6643849106069517`*^9}, {
   3.6643849767097607`*^9, 3.664385082392219*^9}, {3.664385139682694*^9, 
   3.664385300087737*^9}, {3.6643853979268103`*^9, 3.664385443123356*^9}, {
   3.6643854948266582`*^9, 3.6643856070534563`*^9}, {3.664386942667128*^9, 
   3.664386969395652*^9}, {3.664387006378991*^9, 3.6643870917364197`*^9}, {
   3.664387263931241*^9, 3.664387264044447*^9}, {3.664389126059265*^9, 
   3.6643891551634502`*^9}, {3.6643893173171997`*^9, 3.664389326301079*^9}, {
   3.664389835391206*^9, 3.6643898394696217`*^9}, {3.6643960326953487`*^9, 
   3.6643960577408257`*^9}, {3.6643965913813143`*^9, 3.664396606623172*^9}, {
   3.664396989969396*^9, 3.664397001291065*^9}, {3.66439703413992*^9, 
   3.664397040164289*^9}, {3.664397101694104*^9, 3.664397110083139*^9}, {
   3.6643995516362343`*^9, 3.664399552497649*^9}, {3.664399770573741*^9, 
   3.664399770751679*^9}, {3.6643999302177267`*^9, 3.6643999305382032`*^9}, {
   3.66439996232821*^9, 3.664399988753824*^9}, {3.664400217571435*^9, 
   3.664400224777541*^9}, 3.6644003184102993`*^9, {3.6644012324341917`*^9, 
   3.664401232664691*^9}, {3.664401313756671*^9, 3.664401340646018*^9}, {
   3.6644013841076593`*^9, 3.664401482782634*^9}, {3.664401550424164*^9, 
   3.66440155095263*^9}, {3.66440171265205*^9, 3.664401715834909*^9}, 
   3.664402425661371*^9, {3.6644026941977253`*^9, 3.664402874066979*^9}, 
   3.664402915316906*^9, {3.664403020086631*^9, 3.664403112821315*^9}, {
   3.664403145311193*^9, 3.664403199847135*^9}, {3.664403230750238*^9, 
   3.664403263097908*^9}, 3.664403296656249*^9, {3.6644107103867083`*^9, 
   3.6644107346280203`*^9}, {3.6644107662790003`*^9, 3.664410770412814*^9}, 
   3.664410807585946*^9, {3.6644109061267242`*^9, 3.664410906688299*^9}, {
   3.664411038486785*^9, 3.6644110489383163`*^9}, {3.6644114117156367`*^9, 
   3.6644115415330114`*^9}, {3.6644116084696074`*^9, 3.6644116138825645`*^9}, 
   3.664411693969371*^9, {3.6644117244221363`*^9, 3.664411739101136*^9}, {
   3.664411942582136*^9, 3.664412006703658*^9}, {3.6644129133436637`*^9, 
   3.6644129139364367`*^9}, {3.6644129852564363`*^9, 3.664413001105325*^9}, {
   3.664413041382718*^9, 3.6644130837816153`*^9}, {3.6644131273816586`*^9, 
   3.6644132034126472`*^9}, {3.664413334462366*^9, 3.6644133463022346`*^9}, {
   3.664413470847046*^9, 3.6644134817353573`*^9}, {3.664413576594701*^9, 
   3.664413578794202*^9}, {3.664413651455742*^9, 3.6644137192347*^9}, 
   3.664413845859901*^9, {3.6644140937816095`*^9, 3.6644141028136044`*^9}, {
   3.664414150516264*^9, 3.6644142674330173`*^9}, {3.664414363524705*^9, 
   3.6644143705755887`*^9}, {3.664414418481039*^9, 3.6644144224120626`*^9}, {
   3.664414457089307*^9, 3.6644144603027625`*^9}, 3.664414996731491*^9, {
   3.664415032219898*^9, 3.66441503284387*^9}, {3.664415213873747*^9, 
   3.6644152176019793`*^9}, {3.6644152486289873`*^9, 3.664415306081209*^9}, {
   3.6644251916161156`*^9, 3.6644252075430007`*^9}, {3.664425261407384*^9, 
   3.664425330980262*^9}, 3.6644253769825974`*^9, {3.6644254578649683`*^9, 
   3.664425460095668*^9}, {3.664425499608695*^9, 3.664425502182579*^9}, {
   3.664425572878607*^9, 3.6644256355565944`*^9}, {3.6644256805605745`*^9, 
   3.664425753440504*^9}, {3.664425945436689*^9, 3.664425945920267*^9}, 
   3.6644264153188033`*^9, {3.6644264508540087`*^9, 3.6644264577488995`*^9}, {
   3.664426551422696*^9, 3.6644265669439993`*^9}, 3.6644268087175503`*^9, {
   3.664427312403348*^9, 3.6644273134485006`*^9}, {3.664427346425421*^9, 
   3.5791013177018394`*^9}, {3.579101392644371*^9, 3.5791013988687816`*^9}, {
   3.579101446246065*^9, 3.5791014482116685`*^9}, {3.5791014790841227`*^9, 
   3.579101497913356*^9}, {3.5791015468818417`*^9, 3.579101551109449*^9}, {
   3.5791016212783723`*^9, 3.579101638235602*^9}, {3.5791017748762417`*^9, 
   3.579101953168955*^9}, {3.5791019890802183`*^9, 3.5791020738663673`*^9}, {
   3.579102338910833*^9, 3.579102393152128*^9}, {3.5791024441018176`*^9, 
   3.57910244552142*^9}, {3.5791025065643272`*^9, 3.5791025214311533`*^9}, {
   3.5791043399107475`*^9, 3.579104417052883*^9}, {3.579104531182683*^9, 
   3.5791045626791387`*^9}, {3.5791045958759966`*^9, 3.579104631350459*^9}, {
   3.5791046817541475`*^9, 3.5791047467126617`*^9}, 3.579104849875643*^9, {
   3.579104903352537*^9, 3.579104904288539*^9}, {3.5791051745902133`*^9, 
   3.5791053151308603`*^9}, {3.579105370760558*^9, 3.5791053887317896`*^9}, {
   3.579105419058243*^9, 3.579105430493063*^9}, {3.5791055073231974`*^9, 
   3.5791055226112247`*^9}, {3.57910557120531*^9, 3.5791056117341814`*^9}, {
   3.579105709546353*^9, 3.579105811976133*^9}, {3.579105856607811*^9, 
   3.579105862988222*^9}, {3.579105980487629*^9, 3.579106019659298*^9}, {
   3.579106092839026*^9, 3.5791061032754445`*^9}, {3.579106176876374*^9, 
   3.5791061785143766`*^9}, {3.579106421843604*^9, 3.5791064232788067`*^9}, {
   3.579106484274914*^9, 3.5791065150225677`*^9}, {3.5791076138692374`*^9, 
   3.579107664312126*^9}, {3.5791077211334267`*^9, 3.579107722490629*^9}, {
   3.664503247769308*^9, 3.6645032616203794`*^9}, {3.6645036302909627`*^9, 
   3.6645036683861923`*^9}, {3.6645037395845146`*^9, 3.664503739804515*^9}, {
   3.664629866262273*^9, 3.664629873358823*^9}, {3.664720573962131*^9, 
   3.664720578230155*^9}, {3.6647208633741426`*^9, 3.6647208635218678`*^9}, {
   3.664721042366081*^9, 3.579143475264558*^9}, {3.5791435233594427`*^9, 
   3.579143526526248*^9}, {3.66491768720894*^9, 3.6649177005461483`*^9}, {
   3.664919372174645*^9, 3.66491944521907*^9}, {3.6649195482031803`*^9, 
   3.664919549809482*^9}, {3.6649196617555428`*^9, 3.6649197093849173`*^9}, {
   3.664923062831766*^9, 3.5792237225545096`*^9}, 3.579223807231458*^9, {
   3.57922984547178*^9, 3.5792299406019135`*^9}, {3.5792303061324253`*^9, 
   3.5792303685325127`*^9}, {3.579230399797556*^9, 3.57923042399759*^9}, {
   3.579230461212642*^9, 3.5792304704926553`*^9}, {3.579230505897705*^9, 
   3.579230507317707*^9}, {3.5792307420181007`*^9, 3.57923075606812*^9}, {
   3.579230927998516*^9, 3.5792309478865457`*^9}, {3.5792311054944077`*^9, 
   3.5792312797448964`*^9}, {3.5792313098450336`*^9, 
   3.5792313915201535`*^9}, {3.579231439251319*^9, 3.579231456917346*^9}, {
   3.5792318921564484`*^9, 3.579231988959591*^9}, 3.5792320481136785`*^9, 
   3.579232172913862*^9, {3.5792322238779364`*^9, 3.579232244380966*^9}, {
   3.5792322865210285`*^9, 3.579232298944047*^9}, {3.5792325059433503`*^9, 
   3.5792325324963884`*^9}, {3.5792326084515*^9, 3.5792326085815*^9}, {
   3.5792326565525703`*^9, 3.5792326603025756`*^9}, {3.5792327478537045`*^9, 
   3.5792327543637133`*^9}, {3.5792328333638296`*^9, 
   3.5792329074169383`*^9}, {3.579233000379075*^9, 3.579233056257156*^9}, {
   3.579233093841211*^9, 3.5792332008523674`*^9}, {3.57923323673742*^9, 
   3.57923325055344*^9}, {3.5792333531985903`*^9, 3.579233356187596*^9}, {
   3.5792335770259185`*^9, 3.5792335772459188`*^9}, {3.5792397554574556`*^9, 
   3.579239766502275*^9}, {3.579364712455144*^9, 3.5793647640444345`*^9}, {
   3.5793687257416515`*^9, 3.579368754811692*^9}, {3.579368892981886*^9, 
   3.579368893501887*^9}, {3.5793689881870193`*^9, 3.579369072197137*^9}, {
   3.579370071958536*^9, 3.5793700850185547`*^9}, {3.5793704449790587`*^9, 
   3.579370448429064*^9}, {3.5793704907841225`*^9, 3.5793704909141235`*^9}, {
   3.57938280729539*^9, 3.5793828234102182`*^9}, {3.579382881376321*^9, 
   3.5793829720374813`*^9}, {3.579387756430097*^9, 3.579387812610796*^9}, {
   3.5793878496814613`*^9, 3.5793878517406654`*^9}, {3.5793880440752044`*^9, 
   3.579388053388421*^9}, {3.5793884485957603`*^9, 3.5793885025632553`*^9}, {
   3.5793885946170177`*^9, 3.5793885950382185`*^9}, {3.57938874684389*^9, 
   3.5793887487158937`*^9}, {3.5793889544038544`*^9, 3.579389010548353*^9}, {
   3.579389055351632*^9, 3.5793890609520416`*^9}, {3.5793891074245234`*^9, 
   3.5793891313861656`*^9}, 3.5793891883262653`*^9, {3.579389244595564*^9, 
   3.5793892674028044`*^9}, {3.5793896831591344`*^9, 
   3.5793896930183516`*^9}, {3.5793898857410903`*^9, 
   3.5793898938999047`*^9}, {3.57939072840777*^9, 3.579390765442236*^9}, 
   3.5793909777898083`*^9, {3.579391077005983*^9, 3.579391215222225*^9}, {
   3.5793913484932594`*^9, 3.579391368804495*^9}, {3.5793914127341723`*^9, 
   3.5793914453382297`*^9}, {3.579393121093173*^9, 3.579393121217973*^9}, {
   3.579393188656892*^9, 3.579393191589697*^9}, {3.665155653170054*^9, 
   3.6651556727274923`*^9}, {3.6651560002713537`*^9, 3.665156001965193*^9}, {
   3.6651589674245234`*^9, 3.665159022854332*^9}, {3.665159079341106*^9, 
   3.665159079594887*^9}, {3.665175898742531*^9, 3.665176006117669*^9}, {
   3.6651761466108522`*^9, 3.66517617448067*^9}, {3.665176215033832*^9, 
   3.6651762214801283`*^9}, {3.665176324260211*^9, 3.6651763463521967`*^9}, {
   3.665176439805685*^9, 3.665176494671886*^9}, {3.665176540715707*^9, 
   3.665176545345071*^9}, {3.6651769645154247`*^9, 3.665177073039266*^9}, {
   3.665177117927754*^9, 3.665177122068222*^9}, {3.66517716000613*^9, 
   3.665177170966887*^9}, {3.66517725772668*^9, 3.6651772831153584`*^9}, {
   3.665177368537176*^9, 3.665177369900372*^9}, {3.665177414027041*^9, 
   3.665177419107461*^9}, {3.665177570479567*^9, 3.6651775710785303`*^9}, {
   3.665177842230053*^9, 3.665178021633629*^9}, {3.665178054676456*^9, 
   3.6651780838024282`*^9}, {3.665178128396652*^9, 3.665178130312084*^9}, {
   3.665178160411717*^9, 3.665178163185104*^9}, {3.665178291773486*^9, 
   3.665178429955662*^9}, {3.66517847509582*^9, 3.665178487596607*^9}, {
   3.6651785309254303`*^9, 3.665178532154665*^9}, {3.6651796829158792`*^9, 
   3.665179725896727*^9}, {3.6651797559956713`*^9, 3.665179767238926*^9}, {
   3.6651806988191757`*^9, 3.665180718058815*^9}, {3.6651807618301783`*^9, 
   3.665180784048107*^9}, {3.665181245976635*^9, 3.665181254735407*^9}, {
   3.665181291055862*^9, 3.665181508031505*^9}, {3.6651815393371143`*^9, 
   3.579479331706009*^9}, {3.5794793901749115`*^9, 3.5794794078185425`*^9}, {
   3.57947947455546*^9, 3.579479545083184*^9}, {3.5794795812908473`*^9, 
   3.57947962261532*^9}, {3.5794796622237897`*^9, 3.579479663627792*^9}, {
   3.579481043044615*^9, 3.5794810538398337`*^9}, {3.5794812249097342`*^9, 
   3.579481237732957*^9}, {3.579481414964868*^9, 3.579481623755635*^9}, {
   3.5794816777005296`*^9, 3.5794817146569943`*^9}, {3.579482129789324*^9, 
   3.5794821439697485`*^9}, 3.579482507060386*^9, {3.5794827182223573`*^9, 
   3.579482806814913*^9}, {3.5794828410569725`*^9, 3.5794830413457246`*^9}, {
   3.5794831083322425`*^9, 3.5794832929273663`*^9}, {3.57948332350342*^9, 
   3.579483389039135*^9}, {3.579483496070923*^9, 3.579483539204999*^9}, {
   3.5794838091946735`*^9, 3.579483876181191*^9}, {3.5794844516506014`*^9, 
   3.5794846343425226`*^9}, {3.579484734307498*^9, 3.579484757520339*^9}, {
   3.579485124261383*^9, 3.579485124994584*^9}, {3.5794852007951174`*^9, 
   3.5794852944576817`*^9}, {3.579485409944685*^9, 3.5794854574623685`*^9}, {
   3.6653134899628363`*^9, 3.665313524236817*^9}, {3.6653154456770267`*^9, 
   3.665315470154439*^9}, {3.665315709748488*^9, 3.6653157318080473`*^9}, {
   3.665321492750957*^9, 3.66532149637994*^9}, {3.665321561875204*^9, 
   3.6653215791445837`*^9}, {3.665321609907619*^9, 3.665321621956912*^9}, {
   3.6653217984375668`*^9, 3.665321803579092*^9}, {3.665321841796953*^9, 
   3.665321896566659*^9}, {3.66532206659762*^9, 3.665322147249268*^9}, {
   3.665322218510642*^9, 3.665322247829217*^9}, {3.665322470755147*^9, 
   3.66532247349922*^9}, {3.665322517033276*^9, 3.665322518215*^9}, {
   3.665322561482271*^9, 3.665322740882722*^9}, 3.6653227939524612`*^9, {
   3.6653228318135767`*^9, 3.665322888216897*^9}, {3.665323029497397*^9, 
   3.665323037134194*^9}, {3.665323111403577*^9, 3.6653231414408903`*^9}, {
   3.6653232005189857`*^9, 3.665323267261189*^9}, {3.665323315486537*^9, 
   3.665323329126897*^9}, {3.665323392861702*^9, 3.665323402250762*^9}, {
   3.6653234467881813`*^9, 3.665323448028338*^9}, {3.665323511779586*^9, 
   3.665323534156535*^9}, {3.6653235865539017`*^9, 3.665323607787244*^9}, {
   3.665323738271916*^9, 3.665323743091112*^9}, {3.665323885641737*^9, 
   3.665323892112851*^9}, {3.665329081556306*^9, 3.665329113900915*^9}, {
   3.665329166611368*^9, 3.6653293028235893`*^9}, {3.665350373587636*^9, 
   3.665350390815228*^9}, {3.6653506768511467`*^9, 3.665350685323389*^9}, {
   3.6653508131047993`*^9, 3.665350888393527*^9}, {3.6653512165275106`*^9, 
   3.665351217006035*^9}, {3.665351759558442*^9, 3.665351762218141*^9}, 
   3.665351849839781*^9, 3.665353026230669*^9, {3.665353291936214*^9, 
   3.665353337669775*^9}, {3.6655971433220797`*^9, 3.665597149248451*^9}, {
   3.665597207010466*^9, 3.665597242300131*^9}, {3.665597394934321*^9, 
   3.665597401921382*^9}, {3.665597447544096*^9, 3.665597460961033*^9}, {
   3.665597594568564*^9, 3.665597623081333*^9}, {3.665597735490238*^9, 
   3.665597807316535*^9}, {3.6655978649447193`*^9, 3.665598002249653*^9}, {
   3.665598033495433*^9, 3.6655980657396717`*^9}, {3.665598109807536*^9, 
   3.6655981508259277`*^9}, {3.665598203555045*^9, 3.665598252782692*^9}, {
   3.665598356912704*^9, 3.665598361309401*^9}, {3.665598463189866*^9, 
   3.665598473122675*^9}, {3.665598621205535*^9, 3.665598621390462*^9}, {
   3.665598705250464*^9, 3.6655987176638327`*^9}, {3.665598796094378*^9, 
   3.665598797104491*^9}, {3.665598862901514*^9, 3.665598874899393*^9}, {
   3.6655989452118387`*^9, 3.66559896638507*^9}, {3.665599022034453*^9, 
   3.665599026161664*^9}, {3.665599060198173*^9, 3.665599110026639*^9}, {
   3.6655992008323812`*^9, 3.665599201190422*^9}, {3.665599248686144*^9, 
   3.665599281021172*^9}, {3.665599369176877*^9, 3.665599373286728*^9}, {
   3.665600365175962*^9, 3.66560036904633*^9}, {3.665600418370668*^9, 
   3.665600455628646*^9}, {3.6656006940784903`*^9, 3.665600772884461*^9}, {
   3.6656009120914593`*^9, 3.665600979176784*^9}, {3.6656011483079557`*^9, 
   3.665601150533061*^9}, {3.6656020132627907`*^9, 3.665602076980567*^9}, {
   3.665602329361817*^9, 3.665602395121551*^9}, {3.665602724011647*^9, 
   3.665602729507799*^9}, {3.665605393439917*^9, 3.665605395151613*^9}, {
   3.665605440207925*^9, 3.665605471825378*^9}, {3.665605761129209*^9, 
   3.665605761625153*^9}, {3.665606079106227*^9, 3.665606146049346*^9}, {
   3.665606188300271*^9, 3.6656062360626583`*^9}, {3.665606270331736*^9, 
   3.665606438443535*^9}, {3.665606736041679*^9, 3.6656068128263693`*^9}, {
   3.6656068510385113`*^9, 3.665606864860598*^9}, {3.665681652171296*^9, 
   3.665681653200533*^9}, {3.665689891694409*^9, 3.66568989319173*^9}, {
   3.6656901034428043`*^9, 3.6656901062625017`*^9}, {3.665693501677679*^9, 
   3.665693524429576*^9}, {3.665693564431335*^9, 3.6656935827419653`*^9}, {
   3.665693707051228*^9, 3.665694087999135*^9}, {3.665694268163025*^9, 
   3.665694309641535*^9}, {3.6656944009875593`*^9, 3.66569441302559*^9}, {
   3.665694498231357*^9, 3.6656945275347147`*^9}, {3.6656946416057167`*^9, 
   3.665694678564864*^9}, {3.665694905628598*^9, 3.665694912728559*^9}, {
   3.665695222459715*^9, 3.665695224843157*^9}, 3.6656986370095797`*^9, {
   3.665699088076789*^9, 3.665699241016527*^9}, {3.665699640236145*^9, 
   3.6656996407020483`*^9}, {3.665699884344429*^9, 3.665699957907641*^9}, {
   3.665700115561656*^9, 3.6657001191877413`*^9}, {3.665700155788245*^9, 
   3.6657001618574743`*^9}, {3.665700195984644*^9, 3.665700220143198*^9}, {
   3.665700366928344*^9, 3.665700732983986*^9}, 3.665700764837831*^9, {
   3.6657008113700323`*^9, 3.665700926285343*^9}, {3.665700997928211*^9, 
   3.6657009984078293`*^9}, {3.665701061681903*^9, 3.665701104486109*^9}, {
   3.6657011385226927`*^9, 3.665701190584838*^9}, {3.665701255267782*^9, 
   3.665701278409162*^9}, {3.665701342599245*^9, 3.665701481118869*^9}, {
   3.6657015385841513`*^9, 3.6657017179545383`*^9}, {3.665701769078926*^9, 
   3.665701888253008*^9}, {3.665701935443767*^9, 3.6657019597985764`*^9}, {
   3.6657020723770533`*^9, 3.665702084171494*^9}, {3.665702573867591*^9, 
   3.6657026188025417`*^9}, {3.6657026545885477`*^9, 3.665702689931941*^9}, {
   3.665702827352335*^9, 3.665702988729731*^9}, {3.6657030336834497`*^9, 
   3.6657030338029957`*^9}, {3.665703084840172*^9, 3.6657031303167877`*^9}, {
   3.6657039338444366`*^9, 3.665703985391467*^9}, 3.665704071897051*^9, {
   3.665704219384921*^9, 3.6657042650977*^9}, {3.6657062486045856`*^9, 
   3.6657062731751423`*^9}, {3.665706488680977*^9, 3.665706497846725*^9}, {
   3.665706557385262*^9, 3.6657065955420732`*^9}, {3.665706659125029*^9, 
   3.665706717827986*^9}, {3.665706833477236*^9, 3.665706852795672*^9}, {
   3.6657068998439627`*^9, 3.665706968793736*^9}, {3.665790324530241*^9, 
   3.665790352707738*^9}, {3.665865139713608*^9, 3.665865145733716*^9}, {
   3.665865658153097*^9, 3.6658656760089207`*^9}, {3.665865891892643*^9, 
   3.66586589709544*^9}, 3.665868398954199*^9, {3.665868449409255*^9, 
   3.665868453788254*^9}, {3.665868536591917*^9, 3.6658686244239483`*^9}, {
   3.665868692235895*^9, 3.665868696723549*^9}, {3.665868979992255*^9, 
   3.6658691681117353`*^9}, {3.665869391990374*^9, 3.665869392609748*^9}, {
   3.665869451986679*^9, 3.665869647855419*^9}, {3.665869678615595*^9, 
   3.6658696797772007`*^9}, {3.665869953631968*^9, 3.6658700967795353`*^9}, {
   3.665870134912058*^9, 3.6658701354876633`*^9}, {3.66587030179252*^9, 
   3.665870306276498*^9}, {3.665870368194807*^9, 3.665870412684149*^9}, {
   3.6658704451696253`*^9, 3.665870445558105*^9}, {3.665870610745554*^9, 
   3.665870614829775*^9}, {3.6658706749717607`*^9, 3.6658707062470303`*^9}, {
   3.665870784696785*^9, 3.665870807466365*^9}, {3.6658708963128653`*^9, 
   3.66587091203292*^9}, {3.6658715841140833`*^9, 3.665871594328886*^9}, {
   3.665871629434697*^9, 3.665871631133875*^9}, {3.665871853516376*^9, 
   3.6658718704438*^9}, {3.665871918495844*^9, 3.6658719871520767`*^9}, {
   3.665872082273636*^9, 3.665872137330187*^9}, {3.6658730781544237`*^9, 
   3.665873119959405*^9}, {3.665873437520224*^9, 3.6658735668223124`*^9}, {
   3.665873894973858*^9, 3.6658739475112343`*^9}, {3.665874144644248*^9, 
   3.665874147235568*^9}, {3.665874187191638*^9, 3.665874230107746*^9}, {
   3.665874276303273*^9, 3.665874297614599*^9}, {3.665874512402281*^9, 
   3.665874597354937*^9}, {3.6658746286177053`*^9, 3.665874632480824*^9}, {
   3.66587492581561*^9, 3.665874954181077*^9}, 3.665875001073769*^9, {
   3.6658755974594193`*^9, 3.665875625617578*^9}, {3.665876299531551*^9, 
   3.665876300332575*^9}, {3.665877916978876*^9, 3.665877919028028*^9}, {
   3.665877954220109*^9, 3.665878133230411*^9}, {3.665878258128646*^9, 
   3.665878263798297*^9}, {3.665878706574479*^9, 3.6658787083177423`*^9}, {
   3.665882011409841*^9, 3.6658820127864227`*^9}, {3.665882752570901*^9, 
   3.66588276097088*^9}, {3.665883580315637*^9, 3.665883581696229*^9}, {
   3.665883636681488*^9, 3.6658836865725183`*^9}, {3.665883969869603*^9, 
   3.665884095174905*^9}, {3.665884155071184*^9, 3.665884155871152*^9}, {
   3.665884228883156*^9, 3.665884355434701*^9}, {3.665884472895742*^9, 
   3.665884533073042*^9}, {3.6658848850188932`*^9, 3.6658849125626497`*^9}, {
   3.665884944332057*^9, 3.665884957080426*^9}, {3.665885015237363*^9, 
   3.6658850608334923`*^9}, {3.665885097241433*^9, 3.6658851881491737`*^9}, {
   3.6658853128573914`*^9, 3.665885335274982*^9}, {3.665887137448464*^9, 
   3.665887168959024*^9}, {3.665887251379233*^9, 3.665887342512764*^9}, {
   3.665887835473682*^9, 3.6658878356560497`*^9}, {3.6658924989186153`*^9, 
   3.665892507350218*^9}, {3.665892578367231*^9, 3.665892631584573*^9}, {
   3.66589268300835*^9, 3.665892714746752*^9}, {3.665892911778453*^9, 
   3.665892913889247*^9}, {3.665892987499146*^9, 3.665892989996941*^9}, {
   3.665893708452713*^9, 3.665893709763442*^9}, {3.665898708634221*^9, 
   3.6658987228642063`*^9}, {3.665898761887792*^9, 3.665898780660562*^9}, {
   3.665899002450149*^9, 3.665899029529838*^9}, {3.665899479143351*^9, 
   3.665899541344997*^9}, {3.665899578215353*^9, 3.665899578961142*^9}, {
   3.665900095240148*^9, 3.665900104379044*^9}, {3.665900577006373*^9, 
   3.6659005786048603`*^9}, 3.665900623516251*^9, {3.665901077557097*^9, 
   3.665901134214118*^9}, {3.665901863613731*^9, 3.6659019457543364`*^9}, {
   3.665902521311644*^9, 3.665902599772499*^9}, {3.665902730143436*^9, 
   3.6659027419439898`*^9}, 3.6659028201822443`*^9, {3.666037150145627*^9, 
   3.666037150451673*^9}, {3.666037229488202*^9, 3.666037267535159*^9}, 
   3.666037308450042*^9, {3.666037349072899*^9, 3.666037380807584*^9}, {
   3.666037420746769*^9, 3.666037491538063*^9}, {3.666037531684462*^9, 
   3.666037576001148*^9}, {3.666037769448628*^9, 3.666037809220265*^9}, {
   3.666037904225234*^9, 3.666037935874713*^9}, 3.6660380140592623`*^9, {
   3.666038476185831*^9, 3.6660384763564043`*^9}, {3.666038935218671*^9, 
   3.666039200621087*^9}, {3.66603923268151*^9, 3.6660392949363403`*^9}, {
   3.666039349399706*^9, 3.666039401096746*^9}, {3.666039543112743*^9, 
   3.6660395480826683`*^9}, {3.66603967130055*^9, 3.6660396827510138`*^9}, {
   3.666039769824173*^9, 3.666039771458899*^9}, {3.6660398131393547`*^9, 
   3.666039814083852*^9}, {3.666039867043582*^9, 3.66603991530625*^9}, {
   3.666040066706558*^9, 3.666040075319833*^9}, {3.666040109668653*^9, 
   3.666040109925047*^9}, {3.666040219371112*^9, 3.666040361749082*^9}, {
   3.6660404127155867`*^9, 3.6660404407699947`*^9}, {3.6660405018436193`*^9, 
   3.6660405089296827`*^9}, {3.6660433346380253`*^9, 
   3.6660433386078167`*^9}, {3.66604367719058*^9, 3.666043717352191*^9}, {
   3.666043756453107*^9, 3.666043931103705*^9}, 3.6660440046829042`*^9, {
   3.666044040843101*^9, 3.666044085945198*^9}, {3.666044169481512*^9, 
   3.666044248972769*^9}, {3.666044281813225*^9, 3.666044495224635*^9}, 
   3.6660445414628897`*^9, {3.6660445831447783`*^9, 3.666044701265811*^9}, {
   3.6660447358350554`*^9, 3.666044756977395*^9}, {3.6660479505526953`*^9, 
   3.6660480841622057`*^9}, {3.666048281152564*^9, 3.666048283822213*^9}, {
   3.666048343815414*^9, 3.666048344682542*^9}, {3.666048438811541*^9, 
   3.6660484406356707`*^9}, {3.6660485616407423`*^9, 3.666048689720387*^9}, {
   3.666048752484268*^9, 3.666049015765583*^9}, {3.6660491922365627`*^9, 
   3.666049200834278*^9}, {3.66604925757692*^9, 3.666049418781931*^9}, {
   3.666049484715513*^9, 3.5803420560652266`*^9}, {3.5803429490731955`*^9, 
   3.5803429758896427`*^9}, {3.580344137202482*^9, 3.5803442110374117`*^9}, {
   3.5803442633131037`*^9, 3.580344324590011*^9}, {3.5803443595028725`*^9, 
   3.5803443718736944`*^9}, {3.5803444107021627`*^9, 3.580344417612975*^9}, {
   3.5803447347004642`*^9, 3.5803447537948976`*^9}, {3.5803447987853765`*^9, 
   3.580344807614992*^9}, {3.5803450311321845`*^9, 3.5803450612402377`*^9}, {
   3.580345318094689*^9, 3.580345319888692*^9}, {3.580345567570327*^9, 
   3.5803455684439287`*^9}, {3.5803456005643845`*^9, 
   3.5803456170068135`*^9}, {3.5803459417369843`*^9, 3.580345955496208*^9}, {
   3.580346553133258*^9, 3.5803465653948793`*^9}, {3.580346641727256*^9, 
   3.5803466522522707`*^9}, {3.5803467073023477`*^9, 
   3.5803467672124314`*^9}, {3.5803468636675663`*^9, 3.580346932532663*^9}, {
   3.580347012662775*^9, 3.5803470673378515`*^9}, {3.580347142442957*^9, 
   3.580347171882998*^9}, {3.5803472335480843`*^9, 3.580347235913088*^9}, {
   3.5803472889061956`*^9, 3.580347311856228*^9}, {3.580347542631551*^9, 
   3.580347610461646*^9}, {3.580347721766802*^9, 3.580347725466807*^9}, {
   3.5803478366869626`*^9, 3.5803478792120223`*^9}, {3.5803482799525833`*^9, 
   3.580348280742584*^9}, {3.580348410497766*^9, 3.5803484280077906`*^9}, {
   3.580348718193197*^9, 3.5803488265533485`*^9}, {3.580349356754091*^9, 
   3.580349386539132*^9}, {3.5803494810742645`*^9, 3.5803494836792684`*^9}, {
   3.58034953498434*^9, 3.5803495398593473`*^9}, {3.666101808077424*^9, 
   3.6661018144142323`*^9}, {3.6661024297856283`*^9, 
   3.6661024795395393`*^9}, {3.6661039559410267`*^9, 3.666103957516128*^9}, 
   3.6661042400265493`*^9, {3.666104414189391*^9, 3.666104536003034*^9}, {
   3.666104754476179*^9, 3.66610478551643*^9}, {3.6661048476546907`*^9, 
   3.666104849692499*^9}, {3.666104911590177*^9, 3.666104936957725*^9}, {
   3.666105093848118*^9, 3.666105125761047*^9}, {3.666105367958047*^9, 
   3.666105379766624*^9}, {3.666105495640685*^9, 3.6661055100203257`*^9}, {
   3.666105608076226*^9, 3.666105643289493*^9}, {3.6661057019181747`*^9, 
   3.66610574529812*^9}, {3.666105857851609*^9, 3.666105880837557*^9}, {
   3.666105957100266*^9, 3.666105958700961*^9}, {3.666106051677517*^9, 
   3.6661061481292686`*^9}, {3.666106207479895*^9, 3.666106362466343*^9}, {
   3.666106418026594*^9, 3.666106420439664*^9}, {3.666106451547317*^9, 
   3.666106481441969*^9}, {3.666106891808302*^9, 3.666106908147484*^9}, {
   3.666106962826207*^9, 3.666106968216902*^9}, {3.6661070587780647`*^9, 
   3.666107074286203*^9}, {3.6661071179394093`*^9, 3.666107148085794*^9}, 
   3.666107469129162*^9, {3.666107518232059*^9, 3.6661075437991667`*^9}, {
   3.666107972873678*^9, 3.6661079846334343`*^9}, {3.666108128862115*^9, 
   3.666108129593753*^9}, {3.6661083816691837`*^9, 3.666108392131956*^9}, {
   3.66610877202522*^9, 3.6661087816369667`*^9}, {3.6661089058855267`*^9, 
   3.666108912049205*^9}, {3.6661089756440277`*^9, 3.666108975953759*^9}, {
   3.666109025307495*^9, 3.666109060597085*^9}, {3.666109759883691*^9, 
   3.666109776381238*^9}, {3.6661098074582*^9, 3.666109819074924*^9}, {
   3.6661099319129963`*^9, 3.666109934807321*^9}, {3.6661099842085447`*^9, 
   3.6661099861404867`*^9}, {3.666110191353816*^9, 3.666110200627686*^9}, {
   3.6661102648430967`*^9, 3.666110333857682*^9}, {3.666110364371251*^9, 
   3.666110386642127*^9}, {3.66611045241293*^9, 3.666110509443203*^9}, {
   3.666110607446733*^9, 3.666110679611784*^9}, {3.6661115248234377`*^9, 
   3.666111529886622*^9}, {3.666111589643422*^9, 3.6661115927722263`*^9}, {
   3.666111627325886*^9, 3.6661116421063757`*^9}, {3.666123956699181*^9, 
   3.666123963281376*^9}, {3.666309068198161*^9, 3.66630917440235*^9}, 
   3.666309237026218*^9, {3.666311228721856*^9, 3.6663112349551086`*^9}, {
   3.66631151492458*^9, 3.6663115243054123`*^9}, {3.666311612238721*^9, 
   3.666311615991064*^9}, {3.66631165196097*^9, 3.666311661330872*^9}, {
   3.666311771712078*^9, 3.666311779752164*^9}, {3.666311893323347*^9, 
   3.6663118984300337`*^9}, {3.666311936541479*^9, 3.666311964261833*^9}, {
   3.666312171759823*^9, 3.666312239304304*^9}, {3.66631235866142*^9, 
   3.666312371350051*^9}, {3.666312555258019*^9, 3.666312556860293*^9}, {
   3.666312594429336*^9, 3.666312632467145*^9}, {3.666312709242042*^9, 
   3.666312781807611*^9}, {3.666312819133191*^9, 3.666312821591724*^9}, {
   3.6663129610900497`*^9, 3.666312994652301*^9}, {3.666313030740884*^9, 
   3.6663130541313553`*^9}, {3.6663133554789124`*^9, 
   3.6663134008231487`*^9}, {3.66631454566315*^9, 3.666314546300149*^9}, {
   3.6663149844627323`*^9, 3.66631506602845*^9}, {3.666315262215528*^9, 
   3.666315262460557*^9}, {3.666315295827529*^9, 3.666315297147341*^9}, {
   3.666317862198415*^9, 3.6663178751192617`*^9}, {3.666317974252252*^9, 
   3.66631798464154*^9}, {3.6663189391887283`*^9, 3.66631894427914*^9}, {
   3.6663272760498753`*^9, 3.6663272769490347`*^9}, {3.666368162564871*^9, 
   3.666368223394017*^9}, {3.666368311784597*^9, 3.666368328183453*^9}, {
   3.666368706350466*^9, 3.666368765503977*^9}, 3.666368852287282*^9, {
   3.666455659937731*^9, 3.666455674217162*^9}, {3.666456470100747*^9, 
   3.666456471547996*^9}, {3.666475999744268*^9, 3.581179742490941*^9}, {
   3.666965552001648*^9, 3.66696559847363*^9}, {3.666965634013054*^9, 
   3.6669656342548018`*^9}, {3.666965843318424*^9, 3.666965866715043*^9}, {
   3.666965955069276*^9, 3.666966108819721*^9}, {3.6669661392374887`*^9, 
   3.6669662209530287`*^9}, {3.666966318987899*^9, 3.666966323419108*^9}, {
   3.666966698605213*^9, 3.666966746983933*^9}, {3.6669668767637367`*^9, 
   3.666966971410186*^9}, {3.666967631846241*^9, 3.666967666122058*^9}, {
   3.66696779421314*^9, 3.666967800544138*^9}, {3.666969650067123*^9, 
   3.666969651086574*^9}, {3.666969682421054*^9, 3.666969683057621*^9}, {
   3.6669697377982807`*^9, 3.666969745781939*^9}, {3.6669836384736347`*^9, 
   3.6669836646978083`*^9}, {3.666983797831324*^9, 3.6669837983015757`*^9}, {
   3.66698816555665*^9, 3.6669881656672907`*^9}, {3.666988586736762*^9, 
   3.666988618751822*^9}, {3.666988730492195*^9, 3.66698873336271*^9}, {
   3.6669890784636717`*^9, 3.666989078757585*^9}, {3.66698916173917*^9, 
   3.666989162093769*^9}, {3.666992143108715*^9, 3.666992143410687*^9}, {
   3.667167074895195*^9, 3.667167076074875*^9}, {3.667167108070867*^9, 
   3.66716716571815*^9}, {3.667167220521873*^9, 3.667167225347169*^9}, {
   3.667167315246868*^9, 3.667167317715488*^9}, 3.667231355771237*^9, {
   3.667337718543992*^9, 3.667337817932954*^9}, {3.667658502330854*^9, 
   3.667658527687475*^9}, {3.6676751668651237`*^9, 3.667675168207584*^9}, {
   3.667675240553527*^9, 3.667675299017297*^9}, {3.667675344725163*^9, 
   3.667675355677205*^9}, {3.667675410406062*^9, 3.667675421553164*^9}, {
   3.667743285240264*^9, 3.667743492444006*^9}, {3.6677435259284163`*^9, 
   3.667743541876462*^9}, {3.667743595262018*^9, 3.6677436132534122`*^9}, {
   3.6677436938816347`*^9, 3.667743773887302*^9}, {3.6677440115805807`*^9, 
   3.667744025271256*^9}, {3.6677440938831263`*^9, 3.6677440950896397`*^9}, {
   3.6677441561507587`*^9, 3.6677441580413322`*^9}, {3.667744220556978*^9, 
   3.667744231837758*^9}, {3.6677444313626547`*^9, 3.667744434063169*^9}, {
   3.667744516779023*^9, 3.667744643647962*^9}, {3.667764809978861*^9, 
   3.6677648123342533`*^9}, {3.667765684274218*^9, 3.66776568799426*^9}, {
   3.686161232696477*^9, 3.686161232727941*^9}, 3.686168038751679*^9, 
   3.68617432782675*^9, 3.686174402429064*^9, {3.686179713980443*^9, 
   3.686179731428941*^9}, 3.686180573959531*^9, {3.686180652055667*^9, 
   3.6861806530267687`*^9}, {3.686180714725923*^9, 3.686180755528062*^9}, {
   3.6861807893138027`*^9, 3.6861808315636673`*^9}, {3.6861808861171427`*^9, 
   3.6861809873200397`*^9}, {3.6861810318539457`*^9, 
   3.6861811146227922`*^9}, {3.6861813155948753`*^9, 
   3.6861813157699203`*^9}, {3.686181400768738*^9, 3.686181402071125*^9}, {
   3.686181488516592*^9, 3.686181491351005*^9}, {3.68618194241949*^9, 
   3.686181953408875*^9}, {3.686182092223156*^9, 3.686182101359419*^9}, {
   3.6861821478818007`*^9, 3.686182216248911*^9}, {3.686182297830338*^9, 
   3.686182323701356*^9}, {3.686604572585741*^9, 3.6866045928817883`*^9}, {
   3.686604839075553*^9, 3.686604848185595*^9}, {3.6866048902784452`*^9, 
   3.686604913513763*^9}, {3.6866050291221313`*^9, 3.686605036476383*^9}, {
   3.686605129755805*^9, 3.68660514054278*^9}, {3.686605236455162*^9, 
   3.686605236562976*^9}, {3.686605384236857*^9, 3.686605384852517*^9}, {
   3.686605940441584*^9, 3.68660602218412*^9}, {3.6866061347747726`*^9, 
   3.686606147543593*^9}, {3.686606182652628*^9, 3.686606401223754*^9}, {
   3.686606462295817*^9, 3.686606474255134*^9}, {3.6866065378928022`*^9, 
   3.6866065620574083`*^9}, {3.686606632341873*^9, 3.6866066396212273`*^9}, {
   3.686606834884595*^9, 3.686607039925128*^9}, {3.6866070806254053`*^9, 
   3.6866071128104267`*^9}, {3.686607167298065*^9, 3.6866071729080677`*^9}, {
   3.6866072097290087`*^9, 3.686607228022265*^9}, {3.6866072650517073`*^9, 
   3.686607328981977*^9}, {3.686607375132942*^9, 3.686607479903754*^9}, {
   3.6866075313767767`*^9, 3.686607573973699*^9}, {3.686607626610609*^9, 
   3.686607628815261*^9}, {3.68660775367885*^9, 3.686607757890417*^9}, {
   3.686607804778028*^9, 3.686607831333942*^9}, {3.686607863453535*^9, 
   3.6866079343448353`*^9}, {3.686607988047798*^9, 3.686608026171172*^9}, {
   3.686608089553258*^9, 3.686608232025366*^9}, {3.68660830608589*^9, 
   3.686608392608004*^9}, {3.686608457254394*^9, 3.686608469622452*^9}, {
   3.686608502881422*^9, 3.68660855721325*^9}, {3.686608596383472*^9, 
   3.686608683200881*^9}, {3.686608716960815*^9, 3.686608812442046*^9}, {
   3.686608844072626*^9, 3.686608930086144*^9}, {3.686608973647263*^9, 
   3.6866089839005547`*^9}, {3.6866090501054163`*^9, 3.686609055209485*^9}, {
   3.686609124429887*^9, 3.686609153642488*^9}, {3.6866092164061213`*^9, 
   3.686609236247623*^9}, {3.686609286884295*^9, 3.68660929683291*^9}, {
   3.686609349454844*^9, 3.6866093972413607`*^9}, {3.6866094285279617`*^9, 
   3.686609460859208*^9}, {3.686609498036242*^9, 3.68660954747716*^9}, {
   3.6866095801446466`*^9, 3.686609580811314*^9}, {3.686609616184421*^9, 
   3.686609618574543*^9}, {3.6866096908845663`*^9, 3.686609691482627*^9}, {
   3.686609725198*^9, 3.686609762005104*^9}, {3.686609798336321*^9, 
   3.68660981368498*^9}, {3.686624922268877*^9, 3.686624946684607*^9}, {
   3.6866511218922567`*^9, 3.686651214058462*^9}, {3.6866512816949987`*^9, 
   3.686651282110014*^9}, {3.686651385266314*^9, 3.686651385675201*^9}, {
   3.6866514637576733`*^9, 3.686651467567219*^9}, {3.686651936830863*^9, 
   3.686651959895007*^9}, 3.686652073762205*^9, {3.686652544311936*^9, 
   3.6866525588568153`*^9}, {3.6866531327662573`*^9, 
   3.6866531456658373`*^9}, {3.686653182780698*^9, 3.686653253335429*^9}, {
   3.6866532899066153`*^9, 3.6866533347164288`*^9}, {3.68665338174746*^9, 
   3.6866533897062263`*^9}, {3.686653635486319*^9, 3.686653658846141*^9}, {
   3.6866538965042553`*^9, 3.6866539673461437`*^9}, {3.686654018548437*^9, 
   3.686654083953383*^9}, {3.6866541140687428`*^9, 3.6866541171984*^9}, {
   3.686654154371064*^9, 3.6866541561432447`*^9}, {3.686654194256715*^9, 
   3.686654231548008*^9}, {3.686654261680113*^9, 3.686654263618539*^9}, {
   3.686654443022056*^9, 3.686654444503558*^9}, {3.686654496365649*^9, 
   3.6866545206337433`*^9}, {3.6866546345309896`*^9, 
   3.6866546396191387`*^9}, {3.6866546725242853`*^9, 
   3.6866547053327227`*^9}, {3.686654848347542*^9, 3.686654848518978*^9}, {
   3.686654904561698*^9, 3.6866549555998363`*^9}, {3.686655106576477*^9, 
   3.686655112183008*^9}, {3.6866656589166317`*^9, 3.686665661737069*^9}, {
   3.686665714308938*^9, 3.686665717288529*^9}, {3.68788984927495*^9, 
   3.687889851452046*^9}, {3.6878899619151373`*^9, 3.687889964163999*^9}, {
   3.687890523902821*^9, 3.6878905260413857`*^9}, {3.68789067851256*^9, 
   3.6878907281946898`*^9}, {3.687891848594905*^9, 3.687891848728903*^9}, {
   3.687891895275734*^9, 3.687891912206829*^9}, {3.687892160709991*^9, 
   3.687892176260622*^9}, {3.687892209846271*^9, 3.68789226228833*^9}, {
   3.6878923253277597`*^9, 3.687892327409419*^9}, {3.687892767598171*^9, 
   3.687892773529532*^9}, {3.68789427037936*^9, 3.6878942989574957`*^9}, {
   3.687894458636754*^9, 3.687894491577156*^9}, {3.687895727434269*^9, 
   3.68789577072791*^9}, {3.687895817095004*^9, 3.687895896606386*^9}, {
   3.687895959167659*^9, 3.687896081396837*^9}, {3.688069518129613*^9, 
   3.688069528292594*^9}, {3.688069730889783*^9, 3.6880697313983707`*^9}, {
   3.688069842927936*^9, 3.688069844026939*^9}, {3.688070105367819*^9, 
   3.68807012067618*^9}, {3.688070662079383*^9, 3.6880706636576433`*^9}, {
   3.6880706947671022`*^9, 3.688070702023712*^9}, {3.688070740032238*^9, 
   3.6880707617068357`*^9}, {3.688070989681781*^9, 3.6880710258038263`*^9}, {
   3.688071117704007*^9, 3.688071180734871*^9}, {3.6880715634246883`*^9, 
   3.688071578544895*^9}, {3.68807168958871*^9, 3.688071744613975*^9}, {
   3.6880718451466703`*^9, 3.688071855780793*^9}, {3.688071897215568*^9, 
   3.688071902752385*^9}, {3.68807195261271*^9, 3.688071997525037*^9}, 
   3.688072041806848*^9, {3.6880726281665373`*^9, 3.688072726248879*^9}, {
   3.688072803085725*^9, 3.6880728282714033`*^9}, {3.688073077108385*^9, 
   3.6880731041848288`*^9}, {3.688073377096032*^9, 3.688073418155999*^9}, {
   3.688073516187398*^9, 3.688073524662923*^9}, {3.688074741359592*^9, 
   3.688074775703458*^9}, {3.6880748364723883`*^9, 3.6880749971015673`*^9}, {
   3.688075028248296*^9, 3.688075068826088*^9}, 3.68807514680929*^9, {
   3.688075196129966*^9, 3.688075226771421*^9}, 3.688075448740116*^9, {
   3.6880755717486887`*^9, 3.688075601685951*^9}, {3.688075695368294*^9, 
   3.688075697020276*^9}, {3.6880758806038933`*^9, 3.68807588621663*^9}, {
   3.688076075164824*^9, 3.688076082099997*^9}, 3.6880761187740393`*^9, {
   3.688076248981687*^9, 3.6880763124258223`*^9}, 3.6880763554385242`*^9, {
   3.688076436672988*^9, 3.688076438546679*^9}, {3.6880764948892593`*^9, 
   3.6880765423309593`*^9}, {3.6880766282675943`*^9, 3.6880766798511744`*^9}, 
   3.688076732918498*^9, {3.688076932869195*^9, 3.688076988441168*^9}, {
   3.688077123984116*^9, 3.688077148393693*^9}, {3.6880772660782747`*^9, 
   3.688077322038952*^9}, {3.688077438051421*^9, 3.6880774391331797`*^9}, {
   3.688077561064191*^9, 3.688077578773262*^9}, {3.688077803676054*^9, 
   3.6880778094076843`*^9}, {3.6880779054779673`*^9, 3.688077982682579*^9}, {
   3.688128588727724*^9, 3.68812861396348*^9}, {3.688128667514781*^9, 
   3.688128712933608*^9}, 3.688128772606694*^9, {3.6881288063030577`*^9, 
   3.688128821922142*^9}, {3.6881295176719713`*^9, 3.688129559859549*^9}, {
   3.688129607245014*^9, 3.688129612378593*^9}, {3.6881296558616858`*^9, 
   3.68812965675839*^9}, {3.688129687624982*^9, 3.68812972446953*^9}, {
   3.688129770392906*^9, 3.688129780252713*^9}, {3.688129814110176*^9, 
   3.6881298258182592`*^9}, {3.688129976655026*^9, 3.688130005727783*^9}, {
   3.688130101558576*^9, 3.688130120132637*^9}, {3.688130205131669*^9, 
   3.688130218078484*^9}, {3.688130299915304*^9, 3.6881303017350616`*^9}, {
   3.688130390339808*^9, 3.68813043131682*^9}, {3.688130496430684*^9, 
   3.688130524661128*^9}, {3.68813068726856*^9, 3.688130689338272*^9}, {
   3.6881307499079647`*^9, 3.688130752341775*^9}, {3.688130787849409*^9, 
   3.688130849028646*^9}, {3.688130888709774*^9, 3.688130936114859*^9}, {
   3.68813816174189*^9, 3.688138170903564*^9}, {3.688138372318707*^9, 
   3.5760967253749447`*^9}, {3.576096758366832*^9, 3.5760967616870213`*^9}, {
   3.5760968100807896`*^9, 3.5760968602296576`*^9}, {3.576096902295064*^9, 
   3.5760970547427835`*^9}, {3.5760970948530774`*^9, 
   3.5760971372125006`*^9}, {3.5760971843331957`*^9, 3.576097237140216*^9}, {
   3.576097330626563*^9, 3.576097345802431*^9}, {3.5760973926201086`*^9, 
   3.576097444009048*^9}, 3.576097549347073*^9, {3.576097687730988*^9, 
   3.5760977393219385`*^9}, {3.576097779136216*^9, 3.576097821035613*^9}, {
   3.5760979307388873`*^9, 3.576097942529562*^9}, {3.5760979883861847`*^9, 
   3.5760980125455666`*^9}, {3.576098068448764*^9, 3.576098127490141*^9}, {
   3.5760981942409587`*^9, 3.5760982268808255`*^9}, {3.5760983665428143`*^9, 
   3.576098377991469*^9}, {3.5760984081511936`*^9, 3.576098459693142*^9}, {
   3.576098492124997*^9, 3.576098498757376*^9}, {3.576098540364756*^9, 
   3.576098616788127*^9}, {3.5760987060282316`*^9, 3.576098707387309*^9}, {
   3.576098747556607*^9, 3.5760987915411224`*^9}, {3.5760990362951217`*^9, 
   3.576099079960619*^9}, {3.576099111433419*^9, 3.576099127313328*^9}, {
   3.5760992089609976`*^9, 3.5760992100810614`*^9}, {3.5760992590328617`*^9, 
   3.57609926127999*^9}, {3.576099299200159*^9, 3.576099361199705*^9}, {
   3.5760994038481445`*^9, 3.5760994182949705`*^9}, {3.576099516302576*^9, 
   3.576099520437813*^9}, {3.57609969277267*^9, 3.5760997145479155`*^9}, {
   3.5760999037397366`*^9, 3.5760999145233536`*^9}, {3.576099963724168*^9, 
   3.576099976226883*^9}, {3.5761000131389937`*^9, 3.576100019147338*^9}, {
   3.5761000584645863`*^9, 3.5761000596036515`*^9}, {3.576100271544774*^9, 
   3.5761002813443346`*^9}, {3.5761003355124326`*^9, 
   3.5761003491292114`*^9}, {3.5761003949438314`*^9, 
   3.5761004073185396`*^9}, {3.576100499495812*^9, 3.576100512956582*^9}, {
   3.5761005535259023`*^9, 3.5761005911420536`*^9}, {3.576100694006937*^9, 
   3.576100699285239*^9}, 3.576100739916563*^9, {3.5761007868622484`*^9, 
   3.57610078723627*^9}, {3.576100818324048*^9, 3.576100820731186*^9}, {
   3.5761012065710163`*^9, 3.5761012391858816`*^9}, {3.5761013503312387`*^9, 
   3.5761013524123583`*^9}, {3.5761015747040725`*^9, 3.576101578217273*^9}, {
   3.576101622065781*^9, 3.5761016470232086`*^9}, {3.5761016923208*^9, 
   3.576101725141677*^9}, {3.576101818069992*^9, 3.5761018326618266`*^9}, {
   3.57610192502911*^9, 3.576101959813099*^9}, {3.5761020054527097`*^9, 
   3.576102008110862*^9}, {3.576102051908367*^9, 3.576102052731414*^9}, {
   3.5761020948388224`*^9, 3.576102095124839*^9}, {3.576102187194105*^9, 
   3.5761021963456283`*^9}, {3.5761097806124234`*^9, 
   3.5761097866917715`*^9}, {3.576109872131658*^9, 3.5761099241476336`*^9}, {
   3.5761101756910205`*^9, 3.576110186066614*^9}, {3.576110267408266*^9, 
   3.576110272431554*^9}, {3.576110447637575*^9, 3.576110504045801*^9}, {
   3.5761107798315754`*^9, 3.576110811775402*^9}, {3.5761108489265275`*^9, 
   3.576110855766919*^9}, {3.5761109198605847`*^9, 3.576110923734806*^9}, {
   3.5761109669322767`*^9, 3.5761110031883507`*^9}, {3.5761110440266867`*^9, 
   3.5761110908663654`*^9}, {3.5761111470515795`*^9, 
   3.5761111601713295`*^9}, {3.576111193698247*^9, 3.5761112416099873`*^9}, {
   3.576111291713854*^9, 3.576111304451582*^9}, {3.5761113533283777`*^9, 
   3.5761113669131546`*^9}, {3.576111545094346*^9, 3.5761116549326286`*^9}, {
   3.5761119701476574`*^9, 3.5761119877866664`*^9}, {3.5761688857363553`*^9, 
   3.5761688980915766`*^9}, {3.57617007277364*^9, 3.576170081353655*^9}, {
   3.5761701214301257`*^9, 3.5761703178188705`*^9}, {3.5761703622165484`*^9, 
   3.5761703777229757`*^9}, {3.5761705250028343`*^9, 
   3.5761705431612663`*^9}, {3.576171107695058*^9, 3.5761711214230824`*^9}, {
   3.5761711543235397`*^9, 3.5761711672559624`*^9}, {3.5761712149140463`*^9, 
   3.5761712154288473`*^9}, 3.5761712634301314`*^9, {3.5761712944585857`*^9, 
   3.5761713667023125`*^9}, {3.5761731973031282`*^9, 
   3.5761732436508093`*^9}, {3.5761761777975636`*^9, 3.5761762281700516`*^9}, 
   3.5761763701459007`*^9, {3.57617691636526*^9, 3.5761769416529045`*^9}, {
   3.5761769904809904`*^9, 3.576176990808591*^9}, {3.5761771186196156`*^9, 
   3.5761771304600363`*^9}, {3.576177505734296*^9, 3.5761775222391243`*^9}, {
   3.576177553454779*^9, 3.5761775696944075`*^9}, {3.5761776071656733`*^9, 
   3.5761776504557495`*^9}, {3.5761776824670057`*^9, 
   3.5761776994554358`*^9}, {3.6764753916909094`*^9, 
   3.6764754058640285`*^9}, {3.6764755827525487`*^9, 3.671110076052392*^9}, {
   3.6711101736953945`*^9, 3.671110202508254*^9}, {3.671110252587079*^9, 
   3.6711102555245996`*^9}, {3.6711103158407545`*^9, 3.671110350623521*^9}, {
   3.6711103892646613`*^9, 3.6711104854905653`*^9}, {3.6711105561488276`*^9, 
   3.671110627868544*^9}, {3.6711109172232876`*^9, 3.6711109192545404`*^9}, {
   3.6711109841147895`*^9, 3.6711109910524044`*^9}, {3.6711110215371675`*^9, 
   3.671111049881299*^9}, {3.671111141017798*^9, 3.6711112779582787`*^9}, {
   3.671112928464212*^9, 3.6711129378081093`*^9}, {3.671113024496771*^9, 
   3.67111311376429*^9}, {3.671113166030636*^9, 3.6711131704837885`*^9}, {
   3.6711132907359877`*^9, 3.671113413785203*^9}, {3.671113467723427*^9, 
   3.6711134901299944`*^9}, {3.6711135404004316`*^9, 
   3.6711135480099373`*^9}, {3.6711136425534415`*^9, 3.671113674397592*^9}, {
   3.6711138495321264`*^9, 3.6711139248925123`*^9}, {3.6711140721742506`*^9, 
   3.671114103915152*^9}, {3.671114152751012*^9, 3.671114221423802*^9}, {
   3.671114268067738*^9, 3.6711144016831784`*^9}, {3.6711148456316853`*^9, 
   3.6711148537411623`*^9}, {3.671114902491825*^9, 3.671115268888678*^9}, {
   3.6711153504684434`*^9, 3.6711153519684663`*^9}, {3.6711154136255627`*^9, 
   3.671115424469457*^9}, {3.671115462516823*^9, 3.671115463688733*^9}, {
   3.6711155781605453`*^9, 3.6711155815668216`*^9}, {3.671115692506523*^9, 
   3.671115709053619*^9}, {3.6711157767576485`*^9, 3.671115798945447*^9}, {
   3.6711158378053412`*^9, 3.6711158703220844`*^9}, {3.671115927713481*^9, 
   3.671115933213564*^9}, {3.6711159779641757`*^9, 3.671116067669088*^9}, {
   3.671116122935433*^9, 3.671116141873209*^9}, {3.671116295000949*^9, 
   3.6711162951728463`*^9}, {3.6711163540798874`*^9, 3.671116391908498*^9}, {
   3.6711164353354855`*^9, 3.671116482266651*^9}, {3.6711165143452134`*^9, 
   3.6711167705835743`*^9}, {3.6711168342570257`*^9, 
   3.6711169312270823`*^9}, {3.671117109870815*^9, 3.671117240545141*^9}, {
   3.671117479423916*^9, 3.671117497018606*^9}, {3.671117887181388*^9, 
   3.6711178891345453`*^9}, {3.671117948838473*^9, 3.6711180739971848`*^9}, {
   3.67111820026451*^9, 3.671118266203624*^9}, {3.6711183229231143`*^9, 
   3.671118836401189*^9}, {3.67111887451105*^9, 3.6711190430610504`*^9}, {
   3.6711191013899574`*^9, 3.6711191326723137`*^9}, {3.6711192560801997`*^9, 
   3.671119314206683*^9}, {3.6711193529884777`*^9, 3.6711193551134853`*^9}, 
   3.671119387160787*^9, {3.6711195143350983`*^9, 3.671119653165064*^9}, {
   3.6711196898069086`*^9, 3.6711196907131724`*^9}, {3.671120043422419*^9, 
   3.6711203432396317`*^9}, {3.671120444413951*^9, 3.671120481148797*^9}, {
   3.6711205144773707`*^9, 3.6711205633217754`*^9}, {3.671120623604535*^9, 
   3.6711206237451725`*^9}, {3.6711207007618284`*^9, 
   3.6711207339653993`*^9}, {3.6711208281864862`*^9, 3.671120830405261*^9}, {
   3.6711210090176387`*^9, 3.671121010955145*^9}, {3.671121111972833*^9, 
   3.671121121972967*^9}, {3.671121403197027*^9, 3.6711214161503344`*^9}, {
   3.6711214642603545`*^9, 3.6711214645572357`*^9}, {3.671121915018779*^9, 
   3.6711219218313694`*^9}, {3.6711227788689327`*^9, 
   3.6711228388853426`*^9}, {3.671122990935305*^9, 3.671123022060741*^9}, {
   3.67112305676431*^9, 3.6711230585612307`*^9}, {3.6711230900460277`*^9, 
   3.6711231785790973`*^9}, {3.6711232654396534`*^9, 
   3.6711233028002234`*^9}, {3.671123353504029*^9, 3.6711233637541666`*^9}, {
   3.671123848017502*^9, 3.6711239336941385`*^9}, 3.6711240055445914`*^9, {
   3.6711242376354504`*^9, 3.671124549780929*^9}, {3.6711246795639925`*^9, 
   3.671124758025755*^9}, {3.671124838244173*^9, 3.6711248653539124`*^9}, {
   3.671124926663797*^9, 3.671125052106284*^9}, {3.671125218962278*^9, 
   3.671125240837566*^9}, {3.671133753639351*^9, 3.6711338673919754`*^9}, {
   3.671133907939396*^9, 3.6711339756757517`*^9}, {3.6711340412547297`*^9, 
   3.67113408442719*^9}, {3.6711341597417707`*^9, 3.67113417635139*^9}, 
   3.671134226633317*^9, {3.6711342835871773`*^9, 3.671134312088653*^9}, {
   3.6711361734194703`*^9, 3.6711361783414288`*^9}, {3.6711364617943525`*^9, 
   3.6711365119350967`*^9}, {3.6711365650903563`*^9, 3.671136632057279*^9}, {
   3.6711369017172413`*^9, 3.6711369024985037`*^9}, {3.671137230628478*^9, 
   3.671137238550432*^9}, {3.671137269256397*^9, 3.671137296242665*^9}, {
   3.671137424643697*^9, 3.671137492936301*^9}, {3.6711376589998713`*^9, 
   3.6711377398112583`*^9}, {3.671137786653102*^9, 3.671137824991395*^9}, {
   3.671137890456905*^9, 3.6711379340072517`*^9}, {3.671140536745322*^9, 
   3.67114056718195*^9}, {3.6711409584703193`*^9, 3.67114097529126*^9}, {
   3.6711410275239196`*^9, 3.6711412221961603`*^9}, {3.6711455717156854`*^9, 
   3.6711455741219873`*^9}, {3.6711458153124866`*^9, 3.6711458166094*^9}, {
   3.6711459035098577`*^9, 3.6711459149787626`*^9}, {3.6711462172152195`*^9, 
   3.6711462794471846`*^9}, {3.6711470598047066`*^9, 
   3.6711471043344755`*^9}, {3.6711471544183064`*^9, 
   3.6711471545745597`*^9}, {3.6711472751839733`*^9, 
   3.6711472939820824`*^9}, {3.6711492488311615`*^9, 3.671149267206436*^9}, {
   3.6711497678939524`*^9, 3.6711497749409227`*^9}, {3.6711498099569025`*^9, 
   3.671149829195449*^9}, {3.671192313186693*^9, 3.6711923142492065`*^9}, {
   3.6711924633144217`*^9, 3.671192464173807*^9}, {3.671192547159296*^9, 
   3.671192548815568*^9}, {3.671193324786928*^9, 3.6711933429277987`*^9}, {
   3.6711952191897297`*^9, 3.671195250783904*^9}, {3.671195283268734*^9, 
   3.6711953528641043`*^9}, {3.6711954925995646`*^9, 
   3.6711954972715025`*^9}, {3.671195662336218*^9, 3.671195664258099*^9}, {
   3.671195932574959*^9, 3.6711959344499617`*^9}, {3.6711961045623503`*^9, 
   3.6711961164062405`*^9}, {3.6711961531567335`*^9, 3.671196163235013*^9}, {
   3.6711962465024624`*^9, 3.6711962603151474`*^9}, {3.6711963104876957`*^9, 
   3.671196311393937*^9}, {3.6711975235719604`*^9, 3.6711975280407696`*^9}, {
   3.671197616258892*^9, 3.6711976236652417`*^9}, {3.6929926644799147`*^9, 
   3.692992665322199*^9}, {3.692992763487002*^9, 3.692992764006143*^9}, {
   3.6929976711074047`*^9, 3.692997701623753*^9}, 3.692997897544279*^9, {
   3.692997957543654*^9, 3.692997958512796*^9}, {3.692998043936452*^9, 
   3.692998050549108*^9}, {3.6930022894101562`*^9, 3.693002309481279*^9}, {
   3.693002345037498*^9, 3.69300255891518*^9}, {3.693002693624547*^9, 
   3.69300270452734*^9}, {3.693002738914015*^9, 3.693002758825835*^9}, {
   3.693002792689444*^9, 3.693003004140223*^9}, {3.6930030961103497`*^9, 
   3.6930031043199053`*^9}, {3.693003212171483*^9, 3.6930032960842857`*^9}, {
   3.693003354287759*^9, 3.6930034740696363`*^9}, {3.693003507554706*^9, 
   3.693003519984157*^9}, {3.693003572470437*^9, 3.693003822579152*^9}, {
   3.69300465678872*^9, 3.69300470180155*^9}, {3.693004778349103*^9, 
   3.693004942884951*^9}, {3.693004983511285*^9, 3.69300500986972*^9}, {
   3.693005046564494*^9, 3.6930050694631033`*^9}, {3.693005114728532*^9, 
   3.693005122417107*^9}, {3.6930051601616077`*^9, 3.6930051704694023`*^9}, {
   3.693005208396352*^9, 3.693005357639982*^9}, {3.69300539634673*^9, 
   3.69300554903564*^9}, {3.693005636384079*^9, 3.693005729110052*^9}, {
   3.693005774984478*^9, 3.6930058373058043`*^9}, {3.6930058717006817`*^9, 
   3.6930058742922773`*^9}, {3.693005909508974*^9, 3.693005919503731*^9}, {
   3.693006128684308*^9, 3.693006169003385*^9}, {3.693006305176065*^9, 
   3.693006344315443*^9}, {3.693006385020344*^9, 3.693006412288464*^9}, {
   3.693006457958972*^9, 3.693006461136836*^9}, {3.693006494189063*^9, 
   3.693006535989654*^9}, {3.693006614057087*^9, 3.693006630381195*^9}, {
   3.693006675902198*^9, 3.693006699497631*^9}, {3.693006753295795*^9, 
   3.693006821428616*^9}, {3.693006869708454*^9, 3.693006893910727*^9}, {
   3.693006950318779*^9, 3.6930069850855913`*^9}, {3.6930070289073277`*^9, 
   3.693007031465509*^9}, {3.693007147820691*^9, 3.693007234276328*^9}, {
   3.6930073068207903`*^9, 3.693007380544201*^9}, {3.693007506230504*^9, 
   3.693007570599814*^9}, {3.693007633826556*^9, 3.693007647643649*^9}, {
   3.69300769472925*^9, 3.693007730598916*^9}, {3.693007773937772*^9, 
   3.693007785987059*^9}, {3.693007947620059*^9, 3.693007948844552*^9}, {
   3.6930082804605703`*^9, 3.693008417701264*^9}, {3.693008453609983*^9, 
   3.693008746045196*^9}, {3.6930087860113583`*^9, 3.693008858358755*^9}, {
   3.6930088952186613`*^9, 3.693008942833445*^9}, {3.693008980904655*^9, 
   3.693009027236311*^9}, {3.693009057539719*^9, 3.6930090609361973`*^9}, {
   3.6930101954773893`*^9, 3.693010280828594*^9}, {3.693010388910778*^9, 
   3.6930103919547777`*^9}, {3.693010457725675*^9, 3.6930104809820433`*^9}, {
   3.69301095976937*^9, 3.6930109648960943`*^9}, {3.6930110199457703`*^9, 
   3.6930110777501717`*^9}, {3.6930113414702673`*^9, 3.693011406177195*^9}, {
   3.69301163244277*^9, 3.693011707813126*^9}, {3.69301175698102*^9, 
   3.6930118297807827`*^9}, {3.6930119027288237`*^9, 3.693011941193859*^9}, 
   3.69301201345527*^9, {3.693012469073626*^9, 3.693012514218977*^9}, {
   3.693012590696171*^9, 3.693012671908196*^9}, {3.693012708210909*^9, 
   3.6930127340685797`*^9}, {3.693052005001545*^9, 3.693052026415256*^9}, {
   3.693052071234679*^9, 3.693052106357082*^9}, {3.693052137712208*^9, 
   3.693052166349441*^9}, {3.693052371748407*^9, 3.693052383843245*^9}, {
   3.693052477283127*^9, 3.693052518375029*^9}, {3.6930525606126966`*^9, 
   3.693052610520083*^9}, {3.693052789594063*^9, 3.693052789765555*^9}, {
   3.6930528587440987`*^9, 3.693052870929049*^9}, {3.693052908257497*^9, 
   3.6930529093638153`*^9}, {3.6930529818402357`*^9, 3.693053005906456*^9}, {
   3.693053305857847*^9, 3.6930533105872507`*^9}, {3.693053607377822*^9, 
   3.693053706298077*^9}, {3.693053903305773*^9, 3.6930539180884037`*^9}, {
   3.6930540636336603`*^9, 3.6930543246809807`*^9}, {3.693054371537265*^9, 
   3.693054498366322*^9}, {3.693054535098043*^9, 3.6930545613359127`*^9}, {
   3.6930546007604437`*^9, 3.693054607122087*^9}, {3.693054641261045*^9, 
   3.693054857694087*^9}, {3.693054903383515*^9, 3.6930549474328117`*^9}, {
   3.693055113719404*^9, 3.69305513840091*^9}, {3.693055203537573*^9, 
   3.693055232954796*^9}, {3.693055265200624*^9, 3.6930552898851643`*^9}, {
   3.69305540819308*^9, 3.693055430397374*^9}, {3.693055536427356*^9, 
   3.693055863010399*^9}, {3.693055915449649*^9, 3.693055999312592*^9}, {
   3.693056074203416*^9, 3.693056126462825*^9}, {3.693056195967531*^9, 
   3.693056246808093*^9}, {3.69305631012903*^9, 3.6930563672995987`*^9}, {
   3.6930564856131144`*^9, 3.693056485798176*^9}, {3.6930565379357853`*^9, 
   3.69305654630711*^9}, {3.6930566146369257`*^9, 3.693056679250395*^9}, {
   3.693056750339642*^9, 3.6930567505106993`*^9}, {3.693056798349337*^9, 
   3.693056818067618*^9}, {3.693056891300253*^9, 3.693056924119499*^9}, {
   3.693057070181118*^9, 3.693057099907482*^9}, {3.693057208904001*^9, 
   3.693057243984415*^9}, {3.6930572976766157`*^9, 3.693057318961821*^9}, {
   3.6930574126342173`*^9, 3.6930574137719*^9}, {3.6930575577594833`*^9, 
   3.693057573648085*^9}, {3.693058053914707*^9, 3.6930580899880953`*^9}, {
   3.693058663828006*^9, 3.693058672134955*^9}, {3.693058727787236*^9, 
   3.693058791957576*^9}, {3.693058831029983*^9, 3.693059120318348*^9}, {
   3.693059248451273*^9, 3.693059262416727*^9}, {3.693059351113315*^9, 
   3.6930595641285963`*^9}, {3.693059608835979*^9, 3.6930596669699593`*^9}, {
   3.693059697639933*^9, 3.693059804517172*^9}, {3.693059834639045*^9, 
   3.693059877948975*^9}, {3.693059941178082*^9, 3.693060061302651*^9}, {
   3.6930601113130293`*^9, 3.693060143582856*^9}, {3.693060366020711*^9, 
   3.6930603854214983`*^9}, {3.6930604318886766`*^9, 3.693060499381096*^9}, {
   3.693060537838725*^9, 3.6930605658642197`*^9}, {3.693060601051972*^9, 
   3.693060644487432*^9}, {3.693060739346099*^9, 3.693060750087974*^9}, {
   3.6930608137367277`*^9, 3.693060876489101*^9}, {3.6930609652674103`*^9, 
   3.6930609674443293`*^9}, {3.6930610938281384`*^9, 
   3.6930611026517973`*^9}, {3.693061173284713*^9, 3.693061191961561*^9}, 
   3.693061285243404*^9, {3.693061342649482*^9, 3.693061372270933*^9}, {
   3.6930615429217987`*^9, 3.6930615775776176`*^9}, {3.6930624967231283`*^9, 
   3.693062507345529*^9}, {3.693062563472591*^9, 3.6930625809343357`*^9}, {
   3.69306261496224*^9, 3.693062615150552*^9}, {3.693062671536558*^9, 
   3.693062710423375*^9}, {3.693071227346558*^9, 3.693071288141233*^9}, {
   3.693071334677724*^9, 3.693071390112626*^9}, {3.69307182168369*^9, 
   3.693071936292676*^9}, {3.693072013075275*^9, 3.693072013735444*^9}, 
   3.693072082518261*^9, {3.6930721345460463`*^9, 3.69307215048368*^9}, {
   3.693072240447193*^9, 3.693072242524199*^9}, {3.693072448693985*^9, 
   3.693072525051388*^9}, {3.693072942288536*^9, 3.693073074628038*^9}, {
   3.6930732089186983`*^9, 3.693073209944261*^9}, {3.6930732422243853`*^9, 
   3.6930733247443523`*^9}, {3.693073590399542*^9, 3.693073591593123*^9}, {
   3.693073959750828*^9, 3.693073976095565*^9}, {3.6930748749817038`*^9, 
   3.693074884171232*^9}, {3.693075057369563*^9, 3.6930750577130003`*^9}, {
   3.6930756994084044`*^9, 3.693075721337537*^9}, {3.693075879386992*^9, 
   3.693075886440406*^9}, {3.6930767659299192`*^9, 3.693076788531416*^9}, {
   3.693084816992085*^9, 3.693084836890408*^9}, {3.6930851359344273`*^9, 
   3.693085248615204*^9}, {3.6931505120200233`*^9, 3.693150549516508*^9}, {
   3.69315463804643*^9, 3.693154784872526*^9}, {3.693154823622563*^9, 
   3.693154863525506*^9}, {3.693154950182019*^9, 3.693154957062367*^9}, {
   3.693154988316123*^9, 3.693154991037552*^9}, {3.693155100825718*^9, 
   3.693155527135467*^9}, {3.693155624476469*^9, 3.693155664015511*^9}, {
   3.693155725507128*^9, 3.693155728025545*^9}, {3.6931561320276318`*^9, 
   3.6931561677176943`*^9}, {3.693156437809937*^9, 3.693156438447435*^9}, {
   3.6931638507945833`*^9, 3.6931639096531*^9}, {3.6931651899942503`*^9, 
   3.6931652129213657`*^9}, {3.69316549137155*^9, 3.6931655015828133`*^9}, {
   3.695571385375996*^9, 3.695571399008079*^9}, {3.6955714433091927`*^9, 
   3.695571699518469*^9}, {3.695571764695207*^9, 3.695571777106923*^9}, {
   3.695572001116344*^9, 3.695572025203179*^9}, {3.695573401591444*^9, 
   3.6955734035470037`*^9}, {3.6955736147067547`*^9, 
   3.6955736227782393`*^9}, {3.6955737309844723`*^9, 3.695573733048504*^9}, {
   3.695573832301334*^9, 3.6955739125356007`*^9}, {3.695574014366733*^9, 
   3.695574019353423*^9}, {3.695574055167633*^9, 3.695574064228211*^9}, {
   3.695574256523291*^9, 3.695574265874119*^9}, {3.6955748184212112`*^9, 
   3.695574893453096*^9}, {3.695574966780485*^9, 3.695575188330288*^9}, {
   3.6955752325912113`*^9, 3.6955754072858353`*^9}, {3.6955756377361*^9, 
   3.6955756380291986`*^9}, {3.695575781436108*^9, 3.695575793639586*^9}, {
   3.69557591148094*^9, 3.695575915043709*^9}, {3.695575949168371*^9, 
   3.695575951596314*^9}, {3.695576224424418*^9, 3.695576230627212*^9}, {
   3.695576910985971*^9, 3.695576912735147*^9}, {3.695585824559379*^9, 
   3.695585889494177*^9}, {3.6955864204212017`*^9, 3.695586443783008*^9}, {
   3.695586560514812*^9, 3.6955866251076317`*^9}, {3.695586698108268*^9, 
   3.695586698567525*^9}, {3.695586760139966*^9, 3.695586813511051*^9}, {
   3.6955882930689287`*^9, 3.695588330571602*^9}, {3.695588566025671*^9, 
   3.695588634887001*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["old", "Subsection",
 CellChangeTimes->{{3.6930564341012077`*^9, 3.693056435858036*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgIntOLD", "[", 
   RowBox[{"curvelist_", ",", "ffunc_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "\[Xi]_"}], "}"}], ",", "nnff_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ff", ",", "fa", ",", "ipow", ",", "irep", ",", "g", ",", "d", ",", "n", 
      ",", "z", ",", "B", ",", "\n", "\[Omega]", ",", "\[Omega]q", ",", 
      "\[Omega]r", ",", "v", ",", "u", ",", "k", ",", "expp", ",", "m", ",", 
      "w", ",", "t", ",", "b", ",", "ratpart", ",", 
      RowBox[{"logpart", "=", "0"}], ",", "rempart", ",", 
      RowBox[{"rem2part", "=", "0"}], ",", "Ci", ",", "dd", ",", "res", ",", 
      "fac", ",", "alpha", ",", "coeff", ",", "mat", ",", "resl", ",", 
      "indices", ",", "r", ",", "\n", "DATA", ",", "RES", ",", "IDEAL", ",", 
      "BR", ",", "nBR", ",", "succ", ",", "fpiece", ",", "logterm", ",", 
      "fpiecemlogd", ",", "normres", ",", "mm", ",", "res\[Phi]", ",", 
      "res\[Infinity]", ",", "cap\[Phi]", ",", "cap\[Infinity]", ",", "cap", 
      ",", "mat2", ",", "\n", "toEtaBar", ",", "fromEtaBar", ",", "toEpsilon",
       ",", "fromEpsilon", ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", 
      "diff1stkind", ",", "diff2ndkind", ",", "diff3rdkind", ",", 
      "derInEtaBar", ",", "\n", "ibasis", ",", "imat", ",", "irord", ",", 
      "itrace", ",", "iprod", ",", "nprod", ",", "id", ",", "nd", ",", 
      "idisc", ",", "idiff", ",", "new\[Omega]", ",", "jsf", ",", "isf", ",", 
      "ibadred", ",", "\n", "jbadred", ",", "divisor", ",", "idealk", ",", 
      "respiece", ",", "reslist", ",", "roots", ",", "ggroup", ",", 
      "new\[Theta]", ",", "newnf", ",", "rbasis", ",", "rel", ",", "rmat", 
      ",", "div", ",", 
      RowBox[{"\[Delta]rz", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[Delta]z", ",", "flogd", ",",
       "newrmp"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"SetTime", "[", "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", "\"\<starting\>\"", "]"}], ";", "\n", "\t", 
     RowBox[{"fa", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToFunctionAlgebra", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nnff"}], "]"}], "&"}], 
        ",", "curvelist"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Which", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "fa", "]"}], "===", "0"}], ",", " ", 
       RowBox[{"fa", "=", 
        RowBox[{"ToFunctionAlgebraFromTraceTimesDiff", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", "1"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"{", "1", "}"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", "0", "}"}], "}"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nnff"}], "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"Length", "[", "fa", "]"}], "===", "1"}], ",", " ", 
       RowBox[{"fa", "=", 
        RowBox[{
        "fa", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{
        RowBox[{"Length", "[", "fa", "]"}], ">", "1"}], ",", " ", 
       RowBox[{"fa", "=", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FunctionAlgebraCompositum", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"First", "[", "fa", "]"}], ",", 
          RowBox[{"Rest", "[", "fa", "]"}]}], "]"}]}]}], "\n", "\t", "]"}], 
     ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<function algebra: \>\"", ",", "fa"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"fa", "=", 
      RowBox[{"FunctionAlgebraComponents", "[", "fa", "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<components: \>\"", ",", "fa"}], "]"}], ";", "\n", "\n", 
     "\t", 
     RowBox[{"ff", "=", 
      RowBox[{"fa", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"nf", "=", 
      RowBox[{"ff", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ipow", ",", "irep", ",", "imat", ",", "itrace", ",", "iprod", ",", 
        "id", ",", "irord"}], "}"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "ff"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "3"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "irord", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "idisc", ",", "idiff", ",", "isf", ",", "ibadred", ",", "\n", "\t\t", 
        "toEtaBar", ",", "fromEtaBar", ",", "toEpsilon", ",", "fromEpsilon", 
        ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", "\n", "\t\t", 
        "diff1stkind", ",", "diff2ndkind", ",", "diff3rdkind"}], "}"}], "=", 
      RowBox[{"FunctionFieldInfo", "[", "ff", "]"}]}], ";", "\n", "\n", "\n", 
     "\t", 
     RowBox[{"ibasis", "=", 
      RowBox[{"PolyMatrixInverse", "[", 
       RowBox[{
        RowBox[{
        "imat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ibasis", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "imat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
         
         RowBox[{
         "ibasis", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "*", 
        RowBox[{
         RowBox[{
         "ibasis", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ".", "ipow"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"ParseFunction", "[", 
       RowBox[{"ffunc", ",", "ff"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ratpart", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}], ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integral basis: \>\"", ",", "ibasis"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"\[Omega]", ",", "ff"}], "]"}]}], "]"}], ";", "\n", "\t", 
     "\n", 
     RowBox[{
     "TimePrint", "[", "\"\<starting hermite reduction at finite places \>\"",
       "]"}], ";", "\n", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"PolyFactorSquareFree", "[", 
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", "x", ",", "nf"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "=", 
           RowBox[{
            RowBox[{"Length", "[", "v", "]"}], "-", "1"}]}], ")"}], ">", 
         "0"}]}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t", 
        
        RowBox[{"u", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"v", "^", 
              RowBox[{"(", 
               RowBox[{"k", "+", "1"}], ")"}]}], ",", "x", ",", "nf"}], "]"}],
            ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"w", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PolyGCD", "[", 
            RowBox[{
             RowBox[{"id", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"u", "*", "v"}], ",", "x", ",", "nf"}], "]"}], ",", 
             "x", ",", "nf"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"t", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"w", "*", "u", "*", "v"}], ",", "x", ",", "nf"}], "]"}], 
           ",", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"B", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"t", "*", 
             RowBox[{"Transpose", "[", 
              RowBox[{"id", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "-", 
            RowBox[{"k", "*", "w", "*", "u", "*", 
             RowBox[{"D", "[", 
              RowBox[{"v", ",", "x"}], "]"}], "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ",", "x", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"B", "=", 
         RowBox[{
          RowBox[{"PolyGaussJordanReduceMod", "[", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "B", "]"}], ",", 
                 RowBox[{"w", "*", 
                  RowBox[{
                  "\[Omega]", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], "]"}], ",", "x"}], 
             "]"}], ",", "x", ",", "v", ",", "nf"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"w", "*", 
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"B", ",", "x"}], "]"}], "*", "w", "*", "u", "*", 
               "v"}], "+", 
              RowBox[{"t", "*", 
               RowBox[{"B", ".", 
                RowBox[{"id", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "-", 
              
              RowBox[{"k", "*", "B", "*", "w", "*", "u", "*", 
               RowBox[{"D", "[", 
                RowBox[{"v", ",", "x"}], "]"}]}]}], ")"}]}], ",", "x", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "v", ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
           
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"w", "*", "u", "*", 
            RowBox[{"v", "^", "k"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{"PolyNormalizeFraction", "[", 
          RowBox[{"\[Omega]", ",", "x", ",", "nf", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"ratpart", "=", 
         RowBox[{"PiecePlus", "[", 
          RowBox[{"x", ",", "ratpart", ",", 
           RowBox[{"{", 
            RowBox[{"B", ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"v", "^", "k"}], ",", "x", ",", "nf"}], "]"}]}], "}"}],
            ",", "nf"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ratpart: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
          "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
          "*", 
         RowBox[{
          RowBox[{
          "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ".", "ibasis"}]}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand after finite hermite reduction: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}], ";", "\n", "\n", 
     RowBox[{
     "TimePrint", "[", 
      "\"\<starting hermite reduction at infinite places \>\"", "]"}], ";", 
     "\n", "\t", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            ".", "toEpsilonBar"}], ",", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"\[Omega]r", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", "n"}], "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Omega]q", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "\[Omega]r", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "}"}], "=", 
        RowBox[{"PolyQuotientRemainder", "[", 
         RowBox[{
          RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "x", ",", "nf"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]q", ".", 
           RowBox[{
           "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{
          "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"resl", "=", 
      RowBox[{"CalcResidues", "[", 
       RowBox[{"\[Omega]q", ",", "diff3rdkind", ",", "irord", ",", 
        RowBox[{"id", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "toEtaBar", ",", "toEpsilonBar", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<resl: \>\"", ",", "resl"}], "]"}], ";"}], "*)"}], "\n", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff3rdkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"PiecePlus", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]r", ".", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"resl", ".", "diff3rdkind", ".", 
             RowBox[{
             "fromEtaBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]r", ".", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", "nf", ",", 
          
          RowBox[{"{", "1", "}"}]}], "]"}]}]}], "\n", "\t", "]"}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";"}], "*)"}],
      "\n", "\t", 
     RowBox[{"derInEtaBar", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{"#", ",", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}], "&"}], ",", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
           "toEtaBar"}], ",", "x", ",", "nf"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{"#", ",", "x", ",", "nf"}], "]"}], ",", 
           RowBox[{
           "\[Omega]q", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "x", ",", "nf"}], "]"}], "&"}], 
        ",", 
        RowBox[{
         RowBox[{
         "\[Omega]q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ".", "toEtaBar"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Omega]q", "-", 
         RowBox[{"resl", ".", "diff3rdkind"}]}], ",", "x", ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "\[Omega]q", "}"}], ",", "diff1stkind", ",", 
        "diff2ndkind"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat2", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", "\[Omega]q"}], 
           "]"}], "+", "2", "-", "irord"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"indices", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "irord", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "===", "0"}], ",", "1", ",", "0"}],
              "]"}], ",", 
            RowBox[{"r", "-", 
             RowBox[{
             "irord", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"mat", ",", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "*", 
                RowBox[{"x", "^", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "*", 
                RowBox[{
                "toEtaBar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"x", "^", "j"}], "*", 
                RowBox[{
                "derInEtaBar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], 
             "]"}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"mat2", ",", 
            RowBox[{
             RowBox[{"x", "^", "j"}], "*", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "n", "]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";"}]}], "\n", "\t", "]"}], ",", "indices", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"coeff", "=", 
      RowBox[{"PolyNumRowNullSpace", "[", 
       RowBox[{"mat", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "coeff", "]"}], "===", "1"}], "&&", 
        RowBox[{
         RowBox[{"coeff", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=!=", "0"}]}], 
       ",", "\"\<problem coeff infinite hermite\>\""}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"coeff", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NumCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumRecp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"coeff", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
             "nf"}], "]"}], "*", "#"}], ",", "nf"}], "]"}], "&"}], "/@", 
       RowBox[{"Rest", "[", 
        RowBox[{
        "coeff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff1stkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"\[Omega]", "=", 
         RowBox[{"PiecePlus", "[", 
          RowBox[{"x", ",", "\[Omega]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"coeff", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"Length", "[", "diff1stkind", "]"}]}], 
               "\[RightDoubleBracket]"}], ".", "diff1stkind", ".", 
              RowBox[{
              "fromEtaBar", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
             "fromEtaBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"coeff", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"coeff", ",", 
           RowBox[{"Length", "[", "diff1stkind", "]"}]}], "]"}]}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff2ndkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"rem2part", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{
                "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"diff2ndkind", ".", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"rem2part", "=", 
         RowBox[{
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "diff2ndkind", "]"}]}], 
           "\[RightDoubleBracket]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Int2ndKindPiece", "/@", "rem2part"}], ")"}]}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"coeff", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"coeff", ",", 
           RowBox[{"Length", "[", "diff2ndkind", "]"}]}], "]"}]}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"ratpart", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"x", ",", "ratpart", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coeff", ".", "mat2"}], ",", "1"}], "}"}], ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"rempart", "=", "\[Omega]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ratpart: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"ratpart", ",", "ff"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<rem2part: \>\"", ",", "rem2part"}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand after infinite hermite reduction: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "rempart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "rempart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"rempart", ",", "ff"}], "]"}]}], "]"}], ";", "\n", "\n", "\n",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "compute", " ", "the", " ", "log", " ", "terms", " ", "for",
        " ", "integrand", " ", 
       RowBox[{"omega", ".", " ", "this"}], " ", "can", " ", "fail", " ", 
       "so", " ", "the", " ", "remaining", " ", "unintegrated", " ", 
       "portion", " ", "is", " ", "stored", " ", "in", " ", "rempart"}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "*", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ".", "ibasis"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<everything done\>\"", "]"}]}], "]"}], ";", 
     "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"functions", " ", "that", " ", "captures", " ", "residues"}], 
      " ", "*)"}], "\n", "\t", 
     RowBox[{"cap\[Phi]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Phi]", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"x", ",", "cap\[Phi]", ",", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"x", ",", 
          RowBox[{
          "iprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
           RowBox[{"-", "z"}], "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ",", "nf"}], 
         "]"}], ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Infinity]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"x", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "irord", "-", 
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{
                 "\[Omega]", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ")"}]}]}], "/.", 
           RowBox[{"x", "\[Rule]", 
            RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], "]"}],
         ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Infinity]", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"\[Xi]", ",", "cap\[Infinity]", ",", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"\[Xi]", ",", 
          RowBox[{
          "iprod", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "*", 
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"Exponent", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Omega]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ")"}]}]}],
              "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
           "]"}], ",", "nf"}], "]"}], ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"cap", "=", 
      RowBox[{"{", 
       RowBox[{"cap\[Phi]", ",", "cap\[Infinity]"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"TimePrint", "[", 
        RowBox[{"\"\<cap finite: \>\"", ",", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{
           "cap\[Phi]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}], ",", "\"\< * \>\"", ",", 
         RowBox[{
          RowBox[{
          "cap\[Phi]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"TimePrint", "[", 
        RowBox[{"\"\<cap infinite: \>\"", ",", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{
           "cap\[Infinity]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}], ",", "\"\< * \>\"", ",", 
         RowBox[{
          RowBox[{
          "cap\[Infinity]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}], ";"}], "*)"}], "\n", "\n",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "interpolate", " ", "polynomials", " ", "that", " ", "captures", " ", 
       "residues"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"res\[Phi]", "=", 
      RowBox[{"PolyGaussJordanReduce", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pp", "===", "0"}], ",", "1", ",", 
            RowBox[{"pp", "<", 
             RowBox[{"n", "+", "1"}]}], ",", 
            RowBox[{"zz", "^", "pp"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"PieceNorm", "[", 
              RowBox[{"x", ",", 
               RowBox[{
               "iprod", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"cap\[Phi]", "/.", 
                RowBox[{"z", "\[Rule]", "zz"}]}], ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", "0", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "\n", "\t", ",", "x", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Phi]", "=", 
      RowBox[{"PolyNormalizeVector", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res\[Phi]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"n", "+", "2"}]}], "\[RightDoubleBracket]"}], "/", 
             RowBox[{"res\[Phi]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            "x", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "x", ",", 
        "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Infinity]", "=", 
      RowBox[{"PolyGaussJordanReduce", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pp", "===", "0"}], ",", "1", ",", 
            RowBox[{"pp", "<", 
             RowBox[{"n", "+", "1"}]}], ",", 
            RowBox[{"zz", "^", "pp"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"PieceNorm", "[", 
              RowBox[{"\[Xi]", ",", 
               RowBox[{
               "iprod", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"cap\[Infinity]", "/.", 
                RowBox[{"z", "\[Rule]", "zz"}]}], ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", "0", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "\n", "\t", ",", 
        "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Infinity]", "=", 
      RowBox[{"PolyNormalizeVector", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res\[Infinity]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"n", "+", "2"}]}], "\[RightDoubleBracket]"}], "/", 
             RowBox[{"res\[Infinity]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            "\[Xi]", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "\[Xi]", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues finite: \>\"", ",", 
       RowBox[{"res\[Phi]", ".", 
        RowBox[{"#", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}]}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues infinite: \>\"", ",", 
       RowBox[{"res\[Infinity]", ".", 
        RowBox[{"#", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}]}]}], "]"}], ";", "\n", "\n", "\t", 
     
     RowBox[{"BR", "=", 
      RowBox[{"RES", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "isf", "]"}], ",", "2"}], "}"}]}], 
        "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], "}"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", ">", "1"}], ",", 
           RowBox[{"IdealPlus", "[", 
            RowBox[{"x", ",", 
             RowBox[{"BR", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"isf", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", "nf"}],
             "]"}], ",", 
           RowBox[{"IdealMakePrimeTo", "[", 
            RowBox[{"x", ",", 
             RowBox[{
             "iprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"BR", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "idiff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "nf"}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"isf", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{
         "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"DivisorNorm", "[", 
          RowBox[{
           RowBox[{
           "BR", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{"RES", "\[LeftDoubleBracket]", 
           RowBox[{"r", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "===",
           "1", "===", 
          RowBox[{"RES", "\[LeftDoubleBracket]", 
           RowBox[{"r", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
         "]"}], ";", "\n", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TimePrint", "[", 
           RowBox[{
           "\"\<BR\[LeftDoubleBracket]\>\"", ",", "r", ",", 
            "\"\<\[RightDoubleBracket]: \>\"", ",", 
            RowBox[{"DivisorPrint", "[", 
             RowBox[{
             "BR", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
             "]"}], ",", "\"\< , norm of B\[LeftDoubleBracket]\>\"", ",", "r",
             ",", "\"\<\[RightDoubleBracket]: \>\"", ",", 
            RowBox[{"Factor", "[", 
             RowBox[{
             "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
             "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"res\[Phi]", ".", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "/", "r"}], ")"}], "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "n"}], "]"}]}]}], ",", 
             RowBox[{"PolyMakeSquareFree", "[", 
              RowBox[{
               RowBox[{"RES", "\[LeftDoubleBracket]", 
                RowBox[{"r", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", "x", ",", "nf"}], "]"}], ",", "x"}], "]"}], ",", "z", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyRemoveCommonFactors", "[", 
          RowBox[{
           RowBox[{"PolyMakeSquareFree", "[", 
            RowBox[{
             RowBox[{"RES", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", "z", 
             ",", "nf"}], "]"}], ",", "z", ",", "z", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"res\[Infinity]", ".", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "/", "r"}], ")"}], "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "n"}], "]"}]}]}], ",", 
             RowBox[{"PolyMakeSquareFree", "[", 
              RowBox[{
               RowBox[{"RES", "\[LeftDoubleBracket]", 
                RowBox[{"r", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", "\[Xi]", ",", "nf"}], "]"}], ",", "\[Xi]"}], "]"}], ",", 
           "z", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyRemoveCommonFactors", "[", 
          RowBox[{
           RowBox[{"PolyMakeSquareFree", "[", 
            RowBox[{
             RowBox[{"RES", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", "z", 
             ",", "nf"}], "]"}], ",", "z", ",", "z", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{
         "\"\<residues from ramification index \>\"", ",", "r", ",", 
          "\"\<: \>\"", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
             "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"z", "\[Rule]", "#"}]}], "]"}], "&"}]}], "]"}], ";"}], 
       "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", 
         RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"next", " ", "get", " ", "a", " ", "Q"}], "-", 
       RowBox[{"basis", " ", "for", " ", "the", " ", "Q"}], "-", 
       RowBox[{"span", " ", "of", " ", "the", " ", "residues"}]}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z"}], "]"}], "===", 
        "0"}], ",", 
       RowBox[{"Goto", "[", "\"\<no poles\>\"", "]"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roots", ",", "new\[Theta]", ",", "newnf", ",", "newrmp"}], 
       "}"}], "=", 
      RowBox[{"SplittingField", "[", 
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z", ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<new\[Theta], newnf: \>\"", ",", 
       RowBox[{"{", 
        RowBox[{"new\[Theta]", ",", "newnf"}], "}"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<newrmp: \>\"", ",", "newrmp"}], "]"}], ";", "\n", "\t", 
     "\n", "\t", 
     RowBox[{"roots", "=", 
      RowBox[{"roots", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rmat", ",", "rbasis"}], "}"}], "=", 
      RowBox[{"QBasisForQSpan", "[", 
       RowBox[{"roots", ",", "newnf", ",", "nf", ",", "new\[Theta]"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues: \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "roots", "}"}], "]"}], "]"}], ",", "\"\< = \>\"", ",", 
       RowBox[{"MatrixForm", "[", "rmat", "]"}], ",", "\"\< . \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "rbasis", "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "combine", " ", "divisors", " ", "and", " ", "test", " ", "if", " ", 
       "they", " ", "are", " ", "torsion"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"rempart", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "/.", 
         RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}]}], ",", "x", ",", 
        "newnf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"nprod", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"iprod", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"nd", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"id", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"nBR", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"BR", "/.", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], "}"}]}], ",", "x", 
        ",", "newnf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<***** looking at residue basis element \>\"", ",", 
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\"\< *****\>\""}], "]"}], ";", "\n", "\t\t", 
        RowBox[{"div", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
          "}"}]}], ";", "\n", "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], 
               "}"}]}], "}"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"Do", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "roots", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/", "r"}]}]}], "}"}]}], ",", 
                 "x", ",", "newnf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"nBR", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"nBR", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipal", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    "nprod", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "newnf"}], "]"}], ",", 
                   "newnf"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "roots", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/", "r"}]}]}], "}"}]}], ",", 
                 "\[Xi]", ",", "newnf"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"nBR", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"\[Xi]", ",", 
                   RowBox[{"nBR", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipalLocal", "[", 
                    RowBox[{"\[Xi]", ",", 
                    RowBox[{
                    "nprod", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "newnf"}], "]"}], ",", 
                   "newnf"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"\[Delta]z", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{"\[Delta]z", ",", "\[Delta]rz", ",", 
                 RowBox[{"iprod", "/.", 
                  RowBox[{"{", 
                   RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], "}"}]}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}],
               ";"}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "1", ",", 
               RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"DivisorPower", "[", 
             RowBox[{"\[Delta]z", ",", 
              RowBox[{"rmat", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
              "nprod", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}], 
           ";", "\n", "\t\t\t", 
           RowBox[{"div", "=", 
            RowBox[{"DivisorTimes", "[", 
             RowBox[{"div", ",", "\[Delta]z", ",", "nprod", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}], 
           ";"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<divisor \[Delta][\>\"", ",", 
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\"\<]: \>\"", ",", 
          RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"succ", ",", "fpiece", ",", "idealk"}], "}"}], "=", 
         RowBox[{"DivisorIsTorsion", "[", 
          RowBox[{"div", ",", "nprod", ",", "irord", ",", 
           RowBox[{"ibadred", "/.", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", "\[Rule]", "new\[Theta]"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "newnf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"succ", ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"logpart", "+=", 
            RowBox[{
             RowBox[{"PolyCollectExt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "rbasis", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "/", "idealk"}], ",", "x", ",", 
               "newnf", ",", "nf", ",", "newrmp"}], "]"}], "*", 
             RowBox[{"LogPiece", "[", 
              RowBox[{"PolyCollectExt", "[", 
               RowBox[{
               "fpiece", ",", "x", ",", "newnf", ",", "nf", ",", "newrmp"}], 
               "]"}], "]"}]}]}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDiff", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "nprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
              "nd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "fpiece", ",", "newnf"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDivide", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "nprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               ",", "flogd", ",", "fpiece", ",", "newnf"}], "]"}]}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"rempart", "=", 
            RowBox[{"PieceMulAdd", "[", 
             RowBox[{"x", ",", "rempart", ",", "flogd", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                "rbasis", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "/", "idealk"}], ",", "newnf"}],
              "]"}]}], ";"}]}], "\n", "\t\t", "]"}], ";"}], "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "rbasis", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\n", "\n", "\n", 
     RowBox[{"Label", "[", "\"\<no poles\>\"", "]"}], ";", "\n", "\n", 
     RowBox[{"Label", "[", "\"\<everything done\>\"", "]"}], ";", "\n", "\t", 
     
     RowBox[{
      RowBox[{
       RowBox[{"Piece", "[", "ratpart", "]"}], "+", "rem2part", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"newrmp", ",", "#"}], "]"}], "<", "2"}], ",", "logpart", 
         ",", 
         RowBox[{"RootEvaluate", "[", 
          RowBox[{"newrmp", ",", "logpart"}], "]"}]}], "]"}], "+", 
       RowBox[{"IntPiece", "[", "rempart", "]"}]}], "/.", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Piece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"PrintFunction", "[", 
          RowBox[{"expr", ",", "ff"}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"LogPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Log", "[", 
          RowBox[{"PrintFunction", "[", 
           RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Int2ndKindPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Int2ndKind", "[", 
          RowBox[{"PrintFunction", "[", 
           RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"IntPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Int", "[", 
          RowBox[{"PrintFunction", "[", 
           RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}]}], "\n", "\t", 
       "}"}]}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.664212532872252*^9, 3.664212534137127*^9}, {
   3.664212606041318*^9, 3.664212635898057*^9}, {3.664212673570942*^9, 
   3.664212796651765*^9}, {3.664212980171906*^9, 3.664212984740302*^9}, {
   3.664213024538394*^9, 3.6642130261080103`*^9}, {3.6642131064047728`*^9, 
   3.664213107777946*^9}, {3.664213150332472*^9, 3.664213153627995*^9}, {
   3.664213237332255*^9, 3.664213616328086*^9}, {3.66421365695045*^9, 
   3.664213767927772*^9}, 3.664213916190226*^9, {3.6642139585182056`*^9, 
   3.664214050668518*^9}, {3.664214200793009*^9, 3.6642142112026777`*^9}, {
   3.664214313316427*^9, 3.664214427682917*^9}, {3.6642179942693*^9, 
   3.664218010504815*^9}, {3.664219366389348*^9, 3.6642193835637503`*^9}, {
   3.664219664324823*^9, 3.664219667613105*^9}, {3.664219787305357*^9, 
   3.664219790516656*^9}, {3.6642212066471357`*^9, 3.664221223164415*^9}, {
   3.664226079262866*^9, 3.6642260983578663`*^9}, {3.664226146286866*^9, 
   3.664226156496866*^9}, {3.664227406963628*^9, 3.6642274203478274`*^9}, {
   3.664227617050002*^9, 3.664227620520002*^9}, {3.6642284248058863`*^9, 
   3.6642284252798862`*^9}, {3.66422873105949*^9, 3.66422873261942*^9}, {
   3.6642288189459467`*^9, 3.6642288258720355`*^9}, {3.6642290253301573`*^9, 
   3.664229056100157*^9}, {3.664229170633157*^9, 3.664229174185157*^9}, {
   3.664229434047418*^9, 3.664229464954418*^9}, {3.664229495348418*^9, 
   3.664229495513418*^9}, {3.6642298627589693`*^9, 3.6642299040503163`*^9}, {
   3.66422997683665*^9, 3.6642299866642094`*^9}, {3.664230045099187*^9, 
   3.6642300709160285`*^9}, {3.6642301253731847`*^9, 
   3.6642301370258617`*^9}, {3.664230168286859*^9, 3.66423016870804*^9}, {
   3.6642304852334366`*^9, 3.664230489772833*^9}, {3.6643177782313747`*^9, 
   3.6643177832699485`*^9}, {3.664326076212344*^9, 3.664326119079221*^9}, {
   3.664326153304085*^9, 3.6643261674214516`*^9}, {3.6643262113022823`*^9, 
   3.66432621403216*^9}, {3.664326406028344*^9, 3.6643266552583604`*^9}, {
   3.664326713630941*^9, 3.664326948416005*^9}, {3.664327026802488*^9, 
   3.664327102006713*^9}, {3.6643271572282352`*^9, 3.664327183653449*^9}, {
   3.6643272138224955`*^9, 3.6643272425720053`*^9}, {3.6643277182414603`*^9, 
   3.6643277915581703`*^9}, {3.6643278275457554`*^9, 
   3.6643278679479427`*^9}, {3.664327910050453*^9, 3.664328039228256*^9}, {
   3.664328074654267*^9, 3.664328153071948*^9}, {3.6643284247302785`*^9, 
   3.664328503411089*^9}, {3.6643285550175915`*^9, 3.664328585289039*^9}, {
   3.6643286367395835`*^9, 3.6643287140642843`*^9}, {3.6643288248419905`*^9, 
   3.6643289054997654`*^9}, {3.664328967595802*^9, 3.6643289680013523`*^9}, {
   3.664329659049317*^9, 3.664329680014776*^9}, {3.6643298460069275`*^9, 
   3.6643302196257615`*^9}, {3.6643303408479223`*^9, 
   3.6643303812969065`*^9}, {3.664330413244273*^9, 3.6643304294831443`*^9}, {
   3.664330508992777*^9, 3.664330521908997*^9}, {3.6643305828242636`*^9, 
   3.6643307045456014`*^9}, {3.664330857652731*^9, 3.664330863892451*^9}, {
   3.664330918926781*^9, 3.6643309196755476`*^9}, {3.664330957129467*^9, 
   3.6643309651163087`*^9}, {3.6643311090822487`*^9, 3.664331117583867*^9}, {
   3.664331218355345*^9, 3.6643312191353097`*^9}, {3.6643314559014854`*^9, 
   3.6643314585845647`*^9}, {3.6643316421571274`*^9, 
   3.6643317057710724`*^9}, {3.664331798384117*^9, 3.6643318450104246`*^9}, {
   3.6643319260019903`*^9, 3.6643320081947017`*^9}, {3.664332236272067*^9, 
   3.664332285409862*^9}, {3.6643324268175163`*^9, 3.664332665689597*^9}, {
   3.664332698104943*^9, 3.6643327310506644`*^9}, {3.664332783620305*^9, 
   3.664332806551276*^9}, {3.6643328394190016`*^9, 3.664332894983708*^9}, {
   3.6643333767889605`*^9, 3.6643334246320143`*^9}, {3.664333533312337*^9, 
   3.6643335553350973`*^9}, {3.664333613445097*^9, 3.664333623898097*^9}, {
   3.664333709004097*^9, 3.664333783574097*^9}, {3.6643340549224424`*^9, 
   3.6643340934995117`*^9}, 3.664334292842966*^9, {3.664334340701618*^9, 
   3.664334372960971*^9}, {3.6643344647316527`*^9, 3.664334537112405*^9}, {
   3.6643346467910833`*^9, 3.664334650066936*^9}, {3.664334752179954*^9, 
   3.664334765033777*^9}, {3.6643348035328493`*^9, 3.664334804328414*^9}, {
   3.6643348657272587`*^9, 3.664334867833164*^9}, {3.664334899016165*^9, 
   3.6643349425226126`*^9}, {3.664334978650591*^9, 3.6643350512029357`*^9}, {
   3.664335118669908*^9, 3.6643351250344224`*^9}, {3.6643351725342913`*^9, 
   3.66433520331171*^9}, {3.6643352379109573`*^9, 3.6643352388001175`*^9}, {
   3.6643352907457867`*^9, 3.664335293850047*^9}, {3.664335566510212*^9, 
   3.664335611670185*^9}, {3.66433606972803*^9, 3.6643362009181433`*^9}, {
   3.664336315962981*^9, 3.6643363257281427`*^9}, {3.664336445327976*^9, 
   3.6643364458427525`*^9}, {3.664336583756164*^9, 3.664336641398325*^9}, {
   3.664336677876667*^9, 3.664336704482931*^9}, {3.664336747261936*^9, 
   3.664336747480276*^9}, {3.664336788372202*^9, 3.6643368542952256`*^9}, {
   3.6643368843949265`*^9, 3.664336885049946*^9}, {3.6643369315942907`*^9, 
   3.6643369543517723`*^9}, {3.6643370349934325`*^9, 
   3.6643370457716503`*^9}, {3.6643370957944365`*^9, 3.664337191753648*^9}, {
   3.664337296780368*^9, 3.6643373242966514`*^9}, {3.6643373745091887`*^9, 
   3.6643373894840364`*^9}, {3.6643374738735447`*^9, 
   3.6643376821681013`*^9}, {3.66433776626285*^9, 3.664337883584937*^9}, {
   3.6643379531734147`*^9, 3.6643380736312094`*^9}, {3.6643381041746387`*^9, 
   3.6643382091891265`*^9}, {3.664338347289729*^9, 3.6643383592231936`*^9}, {
   3.6643383919661245`*^9, 3.664338446626072*^9}, 3.664338519849186*^9, {
   3.66433858683258*^9, 3.6643385954433937`*^9}, {3.664338653379194*^9, 
   3.664338698944749*^9}, {3.6643387314380913`*^9, 3.664339021101493*^9}, {
   3.66433905970976*^9, 3.66433916045004*^9}, {3.664339603267369*^9, 
   3.66433962886582*^9}, 3.664339732601165*^9, {3.6643401613947234`*^9, 
   3.664340166308503*^9}, 3.6643404370499535`*^9, 3.66434047523704*^9, {
   3.664340525248396*^9, 3.664340532174485*^9}, {3.664340599969043*^9, 
   3.66434060895424*^9}, {3.6643406537710285`*^9, 3.664340677045184*^9}, {
   3.6643407493323402`*^9, 3.6643409496273527`*^9}, {3.664340981652715*^9, 
   3.6643410006370635`*^9}, {3.6643410406648674`*^9, 
   3.6643411137475877`*^9}, {3.664341160779477*^9, 3.664341226343335*^9}, {
   3.6643412660591526`*^9, 3.6643412817676477`*^9}, {3.6643413998855476`*^9, 
   3.664341431552127*^9}, {3.6643416447945576`*^9, 3.6643416845571733`*^9}, {
   3.6643417261137085`*^9, 3.6643417420249944`*^9}, {3.6643417750955105`*^9, 
   3.6643418366503487`*^9}, {3.664341899187942*^9, 3.6643418992971373`*^9}, {
   3.6643420303156576`*^9, 3.664342125081405*^9}, {3.6643428494972982`*^9, 
   3.6643429279617767`*^9}, {3.6643450279009733`*^9, 
   3.6643450336557865`*^9}, {3.6643451731555243`*^9, 
   3.6643452709861803`*^9}, {3.664345622203965*^9, 3.6643458357703342`*^9}, {
   3.6643465518697834`*^9, 3.664346569855776*^9}, {3.66434662348617*^9, 
   3.664346847492118*^9}, {3.6643469277817144`*^9, 3.6643469843915744`*^9}, {
   3.66434705535279*^9, 3.66434717435985*^9}, {3.6643473695070925`*^9, 
   3.664347381487355*^9}, {3.664347424900207*^9, 3.6643474307499447`*^9}, 
   3.6643477789107213`*^9, {3.664347852414623*^9, 3.6643479188988395`*^9}, {
   3.664347972778822*^9, 3.664348000264788*^9}, {3.6643480341464677`*^9, 
   3.664348037749906*^9}, {3.6643483279748826`*^9, 3.6643483334658365`*^9}, {
   3.6643486438451085`*^9, 3.664348663375432*^9}, {3.6643498146349707`*^9, 
   3.664349826100456*^9}, {3.6643498588433867`*^9, 3.6643498610740867`*^9}, {
   3.6643757690161266`*^9, 3.6643757703341265`*^9}, {3.6643759686961775`*^9, 
   3.6643759824391603`*^9}, {3.6643760733206825`*^9, 3.664376083444628*^9}, {
   3.6643766283437767`*^9, 3.664376643880679*^9}, {3.6643766815841875`*^9, 
   3.664377077612928*^9}, {3.6643771549854555`*^9, 3.6643772545869865`*^9}, {
   3.664377303272402*^9, 3.664377321882366*^9}, {3.664377621576118*^9, 
   3.664377669910857*^9}, {3.6643784206024437`*^9, 3.6643786065149016`*^9}, {
   3.664378645263563*^9, 3.664378683481848*^9}, {3.6643787269258986`*^9, 
   3.6643787757985053`*^9}, {3.6643788182598*^9, 3.6643788941503944`*^9}, {
   3.66437899346207*^9, 3.6643790368084106`*^9}, {3.6643790691875763`*^9, 
   3.6643790881780653`*^9}, {3.6643791324721327`*^9, 3.664379150345394*^9}, {
   3.6643792641997137`*^9, 3.664379333997941*^9}, {3.664379376377523*^9, 
   3.664379627762089*^9}, {3.664379658135396*^9, 3.6643797377736797`*^9}, {
   3.6643797728147697`*^9, 3.664379776755887*^9}, {3.664379808314254*^9, 
   3.6643801182673388`*^9}, 3.664380411370533*^9, {3.664380448339326*^9, 
   3.664380462606845*^9}, {3.664383760702175*^9, 3.664383858917156*^9}, {
   3.664383896962658*^9, 3.664383924080016*^9}, {3.664384211934972*^9, 
   3.664384212105555*^9}, {3.66438436031212*^9, 3.664384365252325*^9}, {
   3.664384397459055*^9, 3.6643843975947638`*^9}, {3.664384640170249*^9, 
   3.6643846443418503`*^9}, {3.664384734260508*^9, 3.6643849106069517`*^9}, {
   3.6643849767097607`*^9, 3.664385082392219*^9}, {3.664385139682694*^9, 
   3.664385300087737*^9}, {3.6643853979268103`*^9, 3.664385443123356*^9}, {
   3.6643854948266582`*^9, 3.6643856070534563`*^9}, {3.664386942667128*^9, 
   3.664386969395652*^9}, {3.664387006378991*^9, 3.6643870917364197`*^9}, {
   3.664387263931241*^9, 3.664387264044447*^9}, {3.664389126059265*^9, 
   3.6643891551634502`*^9}, {3.6643893173171997`*^9, 3.664389326301079*^9}, {
   3.664389835391206*^9, 3.6643898394696217`*^9}, {3.6643960326953487`*^9, 
   3.6643960577408257`*^9}, {3.6643965913813143`*^9, 3.664396606623172*^9}, {
   3.664396989969396*^9, 3.664397001291065*^9}, {3.66439703413992*^9, 
   3.664397040164289*^9}, {3.664397101694104*^9, 3.664397110083139*^9}, {
   3.6643995516362343`*^9, 3.664399552497649*^9}, {3.664399770573741*^9, 
   3.664399770751679*^9}, {3.6643999302177267`*^9, 3.6643999305382032`*^9}, {
   3.66439996232821*^9, 3.664399988753824*^9}, {3.664400217571435*^9, 
   3.664400224777541*^9}, 3.6644003184102993`*^9, {3.6644012324341917`*^9, 
   3.664401232664691*^9}, {3.664401313756671*^9, 3.664401340646018*^9}, {
   3.6644013841076593`*^9, 3.664401482782634*^9}, {3.664401550424164*^9, 
   3.66440155095263*^9}, {3.66440171265205*^9, 3.664401715834909*^9}, 
   3.664402425661371*^9, {3.6644026941977253`*^9, 3.664402874066979*^9}, 
   3.664402915316906*^9, {3.664403020086631*^9, 3.664403112821315*^9}, {
   3.664403145311193*^9, 3.664403199847135*^9}, {3.664403230750238*^9, 
   3.664403263097908*^9}, 3.664403296656249*^9, {3.6644107103867083`*^9, 
   3.6644107346280203`*^9}, {3.6644107662790003`*^9, 3.664410770412814*^9}, 
   3.664410807585946*^9, {3.6644109061267242`*^9, 3.664410906688299*^9}, {
   3.664411038486785*^9, 3.6644110489383163`*^9}, {3.6644114117156367`*^9, 
   3.6644115415330114`*^9}, {3.6644116084696074`*^9, 3.6644116138825645`*^9}, 
   3.664411693969371*^9, {3.6644117244221363`*^9, 3.664411739101136*^9}, {
   3.664411942582136*^9, 3.664412006703658*^9}, {3.6644129133436637`*^9, 
   3.6644129139364367`*^9}, {3.6644129852564363`*^9, 3.664413001105325*^9}, {
   3.664413041382718*^9, 3.6644130837816153`*^9}, {3.6644131273816586`*^9, 
   3.6644132034126472`*^9}, {3.664413334462366*^9, 3.6644133463022346`*^9}, {
   3.664413470847046*^9, 3.6644134817353573`*^9}, {3.664413576594701*^9, 
   3.664413578794202*^9}, {3.664413651455742*^9, 3.6644137192347*^9}, 
   3.664413845859901*^9, {3.6644140937816095`*^9, 3.6644141028136044`*^9}, {
   3.664414150516264*^9, 3.6644142674330173`*^9}, {3.664414363524705*^9, 
   3.6644143705755887`*^9}, {3.664414418481039*^9, 3.6644144224120626`*^9}, {
   3.664414457089307*^9, 3.6644144603027625`*^9}, 3.664414996731491*^9, {
   3.664415032219898*^9, 3.66441503284387*^9}, {3.664415213873747*^9, 
   3.6644152176019793`*^9}, {3.6644152486289873`*^9, 3.664415306081209*^9}, {
   3.6644251916161156`*^9, 3.6644252075430007`*^9}, {3.664425261407384*^9, 
   3.664425330980262*^9}, 3.6644253769825974`*^9, {3.6644254578649683`*^9, 
   3.664425460095668*^9}, {3.664425499608695*^9, 3.664425502182579*^9}, {
   3.664425572878607*^9, 3.6644256355565944`*^9}, {3.6644256805605745`*^9, 
   3.664425753440504*^9}, {3.664425945436689*^9, 3.664425945920267*^9}, 
   3.6644264153188033`*^9, {3.6644264508540087`*^9, 3.6644264577488995`*^9}, {
   3.664426551422696*^9, 3.6644265669439993`*^9}, 3.6644268087175503`*^9, {
   3.664427312403348*^9, 3.6644273134485006`*^9}, {3.664427346425421*^9, 
   3.5791013177018394`*^9}, {3.579101392644371*^9, 3.5791013988687816`*^9}, {
   3.579101446246065*^9, 3.5791014482116685`*^9}, {3.5791014790841227`*^9, 
   3.579101497913356*^9}, {3.5791015468818417`*^9, 3.579101551109449*^9}, {
   3.5791016212783723`*^9, 3.579101638235602*^9}, {3.5791017748762417`*^9, 
   3.579101953168955*^9}, {3.5791019890802183`*^9, 3.5791020738663673`*^9}, {
   3.579102338910833*^9, 3.579102393152128*^9}, {3.5791024441018176`*^9, 
   3.57910244552142*^9}, {3.5791025065643272`*^9, 3.5791025214311533`*^9}, {
   3.5791043399107475`*^9, 3.579104417052883*^9}, {3.579104531182683*^9, 
   3.5791045626791387`*^9}, {3.5791045958759966`*^9, 3.579104631350459*^9}, {
   3.5791046817541475`*^9, 3.5791047467126617`*^9}, 3.579104849875643*^9, {
   3.579104903352537*^9, 3.579104904288539*^9}, {3.5791051745902133`*^9, 
   3.5791053151308603`*^9}, {3.579105370760558*^9, 3.5791053887317896`*^9}, {
   3.579105419058243*^9, 3.579105430493063*^9}, {3.5791055073231974`*^9, 
   3.5791055226112247`*^9}, {3.57910557120531*^9, 3.5791056117341814`*^9}, {
   3.579105709546353*^9, 3.579105811976133*^9}, {3.579105856607811*^9, 
   3.579105862988222*^9}, {3.579105980487629*^9, 3.579106019659298*^9}, {
   3.579106092839026*^9, 3.5791061032754445`*^9}, {3.579106176876374*^9, 
   3.5791061785143766`*^9}, {3.579106421843604*^9, 3.5791064232788067`*^9}, {
   3.579106484274914*^9, 3.5791065150225677`*^9}, {3.5791076138692374`*^9, 
   3.579107664312126*^9}, {3.5791077211334267`*^9, 3.579107722490629*^9}, {
   3.664503247769308*^9, 3.6645032616203794`*^9}, {3.6645036302909627`*^9, 
   3.6645036683861923`*^9}, {3.6645037395845146`*^9, 3.664503739804515*^9}, {
   3.664629866262273*^9, 3.664629873358823*^9}, {3.664720573962131*^9, 
   3.664720578230155*^9}, {3.6647208633741426`*^9, 3.6647208635218678`*^9}, {
   3.664721042366081*^9, 3.579143475264558*^9}, {3.5791435233594427`*^9, 
   3.579143526526248*^9}, {3.66491768720894*^9, 3.6649177005461483`*^9}, {
   3.664919372174645*^9, 3.66491944521907*^9}, {3.6649195482031803`*^9, 
   3.664919549809482*^9}, {3.6649196617555428`*^9, 3.6649197093849173`*^9}, {
   3.664923062831766*^9, 3.5792237225545096`*^9}, 3.579223807231458*^9, {
   3.57922984547178*^9, 3.5792299406019135`*^9}, {3.5792303061324253`*^9, 
   3.5792303685325127`*^9}, {3.579230399797556*^9, 3.57923042399759*^9}, {
   3.579230461212642*^9, 3.5792304704926553`*^9}, {3.579230505897705*^9, 
   3.579230507317707*^9}, {3.5792307420181007`*^9, 3.57923075606812*^9}, {
   3.579230927998516*^9, 3.5792309478865457`*^9}, {3.5792311054944077`*^9, 
   3.5792312797448964`*^9}, {3.5792313098450336`*^9, 
   3.5792313915201535`*^9}, {3.579231439251319*^9, 3.579231456917346*^9}, {
   3.5792318921564484`*^9, 3.579231988959591*^9}, 3.5792320481136785`*^9, 
   3.579232172913862*^9, {3.5792322238779364`*^9, 3.579232244380966*^9}, {
   3.5792322865210285`*^9, 3.579232298944047*^9}, {3.5792325059433503`*^9, 
   3.5792325324963884`*^9}, {3.5792326084515*^9, 3.5792326085815*^9}, {
   3.5792326565525703`*^9, 3.5792326603025756`*^9}, {3.5792327478537045`*^9, 
   3.5792327543637133`*^9}, {3.5792328333638296`*^9, 
   3.5792329074169383`*^9}, {3.579233000379075*^9, 3.579233056257156*^9}, {
   3.579233093841211*^9, 3.5792332008523674`*^9}, {3.57923323673742*^9, 
   3.57923325055344*^9}, {3.5792333531985903`*^9, 3.579233356187596*^9}, {
   3.5792335770259185`*^9, 3.5792335772459188`*^9}, {3.5792397554574556`*^9, 
   3.579239766502275*^9}, {3.579364712455144*^9, 3.5793647640444345`*^9}, {
   3.5793687257416515`*^9, 3.579368754811692*^9}, {3.579368892981886*^9, 
   3.579368893501887*^9}, {3.5793689881870193`*^9, 3.579369072197137*^9}, {
   3.579370071958536*^9, 3.5793700850185547`*^9}, {3.5793704449790587`*^9, 
   3.579370448429064*^9}, {3.5793704907841225`*^9, 3.5793704909141235`*^9}, {
   3.57938280729539*^9, 3.5793828234102182`*^9}, {3.579382881376321*^9, 
   3.5793829720374813`*^9}, {3.579387756430097*^9, 3.579387812610796*^9}, {
   3.5793878496814613`*^9, 3.5793878517406654`*^9}, {3.5793880440752044`*^9, 
   3.579388053388421*^9}, {3.5793884485957603`*^9, 3.5793885025632553`*^9}, {
   3.5793885946170177`*^9, 3.5793885950382185`*^9}, {3.57938874684389*^9, 
   3.5793887487158937`*^9}, {3.5793889544038544`*^9, 3.579389010548353*^9}, {
   3.579389055351632*^9, 3.5793890609520416`*^9}, {3.5793891074245234`*^9, 
   3.5793891313861656`*^9}, 3.5793891883262653`*^9, {3.579389244595564*^9, 
   3.5793892674028044`*^9}, {3.5793896831591344`*^9, 
   3.5793896930183516`*^9}, {3.5793898857410903`*^9, 
   3.5793898938999047`*^9}, {3.57939072840777*^9, 3.579390765442236*^9}, 
   3.5793909777898083`*^9, {3.579391077005983*^9, 3.579391215222225*^9}, {
   3.5793913484932594`*^9, 3.579391368804495*^9}, {3.5793914127341723`*^9, 
   3.5793914453382297`*^9}, {3.579393121093173*^9, 3.579393121217973*^9}, {
   3.579393188656892*^9, 3.579393191589697*^9}, {3.665155653170054*^9, 
   3.6651556727274923`*^9}, {3.6651560002713537`*^9, 3.665156001965193*^9}, {
   3.6651589674245234`*^9, 3.665159022854332*^9}, {3.665159079341106*^9, 
   3.665159079594887*^9}, {3.665175898742531*^9, 3.665176006117669*^9}, {
   3.6651761466108522`*^9, 3.66517617448067*^9}, {3.665176215033832*^9, 
   3.6651762214801283`*^9}, {3.665176324260211*^9, 3.6651763463521967`*^9}, {
   3.665176439805685*^9, 3.665176494671886*^9}, {3.665176540715707*^9, 
   3.665176545345071*^9}, {3.6651769645154247`*^9, 3.665177073039266*^9}, {
   3.665177117927754*^9, 3.665177122068222*^9}, {3.66517716000613*^9, 
   3.665177170966887*^9}, {3.66517725772668*^9, 3.6651772831153584`*^9}, {
   3.665177368537176*^9, 3.665177369900372*^9}, {3.665177414027041*^9, 
   3.665177419107461*^9}, {3.665177570479567*^9, 3.6651775710785303`*^9}, {
   3.665177842230053*^9, 3.665178021633629*^9}, {3.665178054676456*^9, 
   3.6651780838024282`*^9}, {3.665178128396652*^9, 3.665178130312084*^9}, {
   3.665178160411717*^9, 3.665178163185104*^9}, {3.665178291773486*^9, 
   3.665178429955662*^9}, {3.66517847509582*^9, 3.665178487596607*^9}, {
   3.6651785309254303`*^9, 3.665178532154665*^9}, {3.6651796829158792`*^9, 
   3.665179725896727*^9}, {3.6651797559956713`*^9, 3.665179767238926*^9}, {
   3.6651806988191757`*^9, 3.665180718058815*^9}, {3.6651807618301783`*^9, 
   3.665180784048107*^9}, {3.665181245976635*^9, 3.665181254735407*^9}, {
   3.665181291055862*^9, 3.665181508031505*^9}, {3.6651815393371143`*^9, 
   3.579479331706009*^9}, {3.5794793901749115`*^9, 3.5794794078185425`*^9}, {
   3.57947947455546*^9, 3.579479545083184*^9}, {3.5794795812908473`*^9, 
   3.57947962261532*^9}, {3.5794796622237897`*^9, 3.579479663627792*^9}, {
   3.579481043044615*^9, 3.5794810538398337`*^9}, {3.5794812249097342`*^9, 
   3.579481237732957*^9}, {3.579481414964868*^9, 3.579481623755635*^9}, {
   3.5794816777005296`*^9, 3.5794817146569943`*^9}, {3.579482129789324*^9, 
   3.5794821439697485`*^9}, 3.579482507060386*^9, {3.5794827182223573`*^9, 
   3.579482806814913*^9}, {3.5794828410569725`*^9, 3.5794830413457246`*^9}, {
   3.5794831083322425`*^9, 3.5794832929273663`*^9}, {3.57948332350342*^9, 
   3.579483389039135*^9}, {3.579483496070923*^9, 3.579483539204999*^9}, {
   3.5794838091946735`*^9, 3.579483876181191*^9}, {3.5794844516506014`*^9, 
   3.5794846343425226`*^9}, {3.579484734307498*^9, 3.579484757520339*^9}, {
   3.579485124261383*^9, 3.579485124994584*^9}, {3.5794852007951174`*^9, 
   3.5794852944576817`*^9}, {3.579485409944685*^9, 3.5794854574623685`*^9}, {
   3.6653134899628363`*^9, 3.665313524236817*^9}, {3.6653154456770267`*^9, 
   3.665315470154439*^9}, {3.665315709748488*^9, 3.6653157318080473`*^9}, {
   3.665321492750957*^9, 3.66532149637994*^9}, {3.665321561875204*^9, 
   3.6653215791445837`*^9}, {3.665321609907619*^9, 3.665321621956912*^9}, {
   3.6653217984375668`*^9, 3.665321803579092*^9}, {3.665321841796953*^9, 
   3.665321896566659*^9}, {3.66532206659762*^9, 3.665322147249268*^9}, {
   3.665322218510642*^9, 3.665322247829217*^9}, {3.665322470755147*^9, 
   3.66532247349922*^9}, {3.665322517033276*^9, 3.665322518215*^9}, {
   3.665322561482271*^9, 3.665322740882722*^9}, 3.6653227939524612`*^9, {
   3.6653228318135767`*^9, 3.665322888216897*^9}, {3.665323029497397*^9, 
   3.665323037134194*^9}, {3.665323111403577*^9, 3.6653231414408903`*^9}, {
   3.6653232005189857`*^9, 3.665323267261189*^9}, {3.665323315486537*^9, 
   3.665323329126897*^9}, {3.665323392861702*^9, 3.665323402250762*^9}, {
   3.6653234467881813`*^9, 3.665323448028338*^9}, {3.665323511779586*^9, 
   3.665323534156535*^9}, {3.6653235865539017`*^9, 3.665323607787244*^9}, {
   3.665323738271916*^9, 3.665323743091112*^9}, {3.665323885641737*^9, 
   3.665323892112851*^9}, {3.665329081556306*^9, 3.665329113900915*^9}, {
   3.665329166611368*^9, 3.6653293028235893`*^9}, {3.665350373587636*^9, 
   3.665350390815228*^9}, {3.6653506768511467`*^9, 3.665350685323389*^9}, {
   3.6653508131047993`*^9, 3.665350888393527*^9}, {3.6653512165275106`*^9, 
   3.665351217006035*^9}, {3.665351759558442*^9, 3.665351762218141*^9}, 
   3.665351849839781*^9, 3.665353026230669*^9, {3.665353291936214*^9, 
   3.665353337669775*^9}, {3.6655971433220797`*^9, 3.665597149248451*^9}, {
   3.665597207010466*^9, 3.665597242300131*^9}, {3.665597394934321*^9, 
   3.665597401921382*^9}, {3.665597447544096*^9, 3.665597460961033*^9}, {
   3.665597594568564*^9, 3.665597623081333*^9}, {3.665597735490238*^9, 
   3.665597807316535*^9}, {3.6655978649447193`*^9, 3.665598002249653*^9}, {
   3.665598033495433*^9, 3.6655980657396717`*^9}, {3.665598109807536*^9, 
   3.6655981508259277`*^9}, {3.665598203555045*^9, 3.665598252782692*^9}, {
   3.665598356912704*^9, 3.665598361309401*^9}, {3.665598463189866*^9, 
   3.665598473122675*^9}, {3.665598621205535*^9, 3.665598621390462*^9}, {
   3.665598705250464*^9, 3.6655987176638327`*^9}, {3.665598796094378*^9, 
   3.665598797104491*^9}, {3.665598862901514*^9, 3.665598874899393*^9}, {
   3.6655989452118387`*^9, 3.66559896638507*^9}, {3.665599022034453*^9, 
   3.665599026161664*^9}, {3.665599060198173*^9, 3.665599110026639*^9}, {
   3.6655992008323812`*^9, 3.665599201190422*^9}, {3.665599248686144*^9, 
   3.665599281021172*^9}, {3.665599369176877*^9, 3.665599373286728*^9}, {
   3.665600365175962*^9, 3.66560036904633*^9}, {3.665600418370668*^9, 
   3.665600455628646*^9}, {3.6656006940784903`*^9, 3.665600772884461*^9}, {
   3.6656009120914593`*^9, 3.665600979176784*^9}, {3.6656011483079557`*^9, 
   3.665601150533061*^9}, {3.6656020132627907`*^9, 3.665602076980567*^9}, {
   3.665602329361817*^9, 3.665602395121551*^9}, {3.665602724011647*^9, 
   3.665602729507799*^9}, {3.665605393439917*^9, 3.665605395151613*^9}, {
   3.665605440207925*^9, 3.665605471825378*^9}, {3.665605761129209*^9, 
   3.665605761625153*^9}, {3.665606079106227*^9, 3.665606146049346*^9}, {
   3.665606188300271*^9, 3.6656062360626583`*^9}, {3.665606270331736*^9, 
   3.665606438443535*^9}, {3.665606736041679*^9, 3.6656068128263693`*^9}, {
   3.6656068510385113`*^9, 3.665606864860598*^9}, {3.665681652171296*^9, 
   3.665681653200533*^9}, {3.665689891694409*^9, 3.66568989319173*^9}, {
   3.6656901034428043`*^9, 3.6656901062625017`*^9}, {3.665693501677679*^9, 
   3.665693524429576*^9}, {3.665693564431335*^9, 3.6656935827419653`*^9}, {
   3.665693707051228*^9, 3.665694087999135*^9}, {3.665694268163025*^9, 
   3.665694309641535*^9}, {3.6656944009875593`*^9, 3.66569441302559*^9}, {
   3.665694498231357*^9, 3.6656945275347147`*^9}, {3.6656946416057167`*^9, 
   3.665694678564864*^9}, {3.665694905628598*^9, 3.665694912728559*^9}, {
   3.665695222459715*^9, 3.665695224843157*^9}, 3.6656986370095797`*^9, {
   3.665699088076789*^9, 3.665699241016527*^9}, {3.665699640236145*^9, 
   3.6656996407020483`*^9}, {3.665699884344429*^9, 3.665699957907641*^9}, {
   3.665700115561656*^9, 3.6657001191877413`*^9}, {3.665700155788245*^9, 
   3.6657001618574743`*^9}, {3.665700195984644*^9, 3.665700220143198*^9}, {
   3.665700366928344*^9, 3.665700732983986*^9}, 3.665700764837831*^9, {
   3.6657008113700323`*^9, 3.665700926285343*^9}, {3.665700997928211*^9, 
   3.6657009984078293`*^9}, {3.665701061681903*^9, 3.665701104486109*^9}, {
   3.6657011385226927`*^9, 3.665701190584838*^9}, {3.665701255267782*^9, 
   3.665701278409162*^9}, {3.665701342599245*^9, 3.665701481118869*^9}, {
   3.6657015385841513`*^9, 3.6657017179545383`*^9}, {3.665701769078926*^9, 
   3.665701888253008*^9}, {3.665701935443767*^9, 3.6657019597985764`*^9}, {
   3.6657020723770533`*^9, 3.665702084171494*^9}, {3.665702573867591*^9, 
   3.6657026188025417`*^9}, {3.6657026545885477`*^9, 3.665702689931941*^9}, {
   3.665702827352335*^9, 3.665702988729731*^9}, {3.6657030336834497`*^9, 
   3.6657030338029957`*^9}, {3.665703084840172*^9, 3.6657031303167877`*^9}, {
   3.6657039338444366`*^9, 3.665703985391467*^9}, 3.665704071897051*^9, {
   3.665704219384921*^9, 3.6657042650977*^9}, {3.6657062486045856`*^9, 
   3.6657062731751423`*^9}, {3.665706488680977*^9, 3.665706497846725*^9}, {
   3.665706557385262*^9, 3.6657065955420732`*^9}, {3.665706659125029*^9, 
   3.665706717827986*^9}, {3.665706833477236*^9, 3.665706852795672*^9}, {
   3.6657068998439627`*^9, 3.665706968793736*^9}, {3.665790324530241*^9, 
   3.665790352707738*^9}, {3.665865139713608*^9, 3.665865145733716*^9}, {
   3.665865658153097*^9, 3.6658656760089207`*^9}, {3.665865891892643*^9, 
   3.66586589709544*^9}, 3.665868398954199*^9, {3.665868449409255*^9, 
   3.665868453788254*^9}, {3.665868536591917*^9, 3.6658686244239483`*^9}, {
   3.665868692235895*^9, 3.665868696723549*^9}, {3.665868979992255*^9, 
   3.6658691681117353`*^9}, {3.665869391990374*^9, 3.665869392609748*^9}, {
   3.665869451986679*^9, 3.665869647855419*^9}, {3.665869678615595*^9, 
   3.6658696797772007`*^9}, {3.665869953631968*^9, 3.6658700967795353`*^9}, {
   3.665870134912058*^9, 3.6658701354876633`*^9}, {3.66587030179252*^9, 
   3.665870306276498*^9}, {3.665870368194807*^9, 3.665870412684149*^9}, {
   3.6658704451696253`*^9, 3.665870445558105*^9}, {3.665870610745554*^9, 
   3.665870614829775*^9}, {3.6658706749717607`*^9, 3.6658707062470303`*^9}, {
   3.665870784696785*^9, 3.665870807466365*^9}, {3.6658708963128653`*^9, 
   3.66587091203292*^9}, {3.6658715841140833`*^9, 3.665871594328886*^9}, {
   3.665871629434697*^9, 3.665871631133875*^9}, {3.665871853516376*^9, 
   3.6658718704438*^9}, {3.665871918495844*^9, 3.6658719871520767`*^9}, {
   3.665872082273636*^9, 3.665872137330187*^9}, {3.6658730781544237`*^9, 
   3.665873119959405*^9}, {3.665873437520224*^9, 3.6658735668223124`*^9}, {
   3.665873894973858*^9, 3.6658739475112343`*^9}, {3.665874144644248*^9, 
   3.665874147235568*^9}, {3.665874187191638*^9, 3.665874230107746*^9}, {
   3.665874276303273*^9, 3.665874297614599*^9}, {3.665874512402281*^9, 
   3.665874597354937*^9}, {3.6658746286177053`*^9, 3.665874632480824*^9}, {
   3.66587492581561*^9, 3.665874954181077*^9}, 3.665875001073769*^9, {
   3.6658755974594193`*^9, 3.665875625617578*^9}, {3.665876299531551*^9, 
   3.665876300332575*^9}, {3.665877916978876*^9, 3.665877919028028*^9}, {
   3.665877954220109*^9, 3.665878133230411*^9}, {3.665878258128646*^9, 
   3.665878263798297*^9}, {3.665878706574479*^9, 3.6658787083177423`*^9}, {
   3.665882011409841*^9, 3.6658820127864227`*^9}, {3.665882752570901*^9, 
   3.66588276097088*^9}, {3.665883580315637*^9, 3.665883581696229*^9}, {
   3.665883636681488*^9, 3.6658836865725183`*^9}, {3.665883969869603*^9, 
   3.665884095174905*^9}, {3.665884155071184*^9, 3.665884155871152*^9}, {
   3.665884228883156*^9, 3.665884355434701*^9}, {3.665884472895742*^9, 
   3.665884533073042*^9}, {3.6658848850188932`*^9, 3.6658849125626497`*^9}, {
   3.665884944332057*^9, 3.665884957080426*^9}, {3.665885015237363*^9, 
   3.6658850608334923`*^9}, {3.665885097241433*^9, 3.6658851881491737`*^9}, {
   3.6658853128573914`*^9, 3.665885335274982*^9}, {3.665887137448464*^9, 
   3.665887168959024*^9}, {3.665887251379233*^9, 3.665887342512764*^9}, {
   3.665887835473682*^9, 3.6658878356560497`*^9}, {3.6658924989186153`*^9, 
   3.665892507350218*^9}, {3.665892578367231*^9, 3.665892631584573*^9}, {
   3.66589268300835*^9, 3.665892714746752*^9}, {3.665892911778453*^9, 
   3.665892913889247*^9}, {3.665892987499146*^9, 3.665892989996941*^9}, {
   3.665893708452713*^9, 3.665893709763442*^9}, {3.665898708634221*^9, 
   3.6658987228642063`*^9}, {3.665898761887792*^9, 3.665898780660562*^9}, {
   3.665899002450149*^9, 3.665899029529838*^9}, {3.665899479143351*^9, 
   3.665899541344997*^9}, {3.665899578215353*^9, 3.665899578961142*^9}, {
   3.665900095240148*^9, 3.665900104379044*^9}, {3.665900577006373*^9, 
   3.6659005786048603`*^9}, 3.665900623516251*^9, {3.665901077557097*^9, 
   3.665901134214118*^9}, {3.665901863613731*^9, 3.6659019457543364`*^9}, {
   3.665902521311644*^9, 3.665902599772499*^9}, {3.665902730143436*^9, 
   3.6659027419439898`*^9}, 3.6659028201822443`*^9, {3.666037150145627*^9, 
   3.666037150451673*^9}, {3.666037229488202*^9, 3.666037267535159*^9}, 
   3.666037308450042*^9, {3.666037349072899*^9, 3.666037380807584*^9}, {
   3.666037420746769*^9, 3.666037491538063*^9}, {3.666037531684462*^9, 
   3.666037576001148*^9}, {3.666037769448628*^9, 3.666037809220265*^9}, {
   3.666037904225234*^9, 3.666037935874713*^9}, 3.6660380140592623`*^9, {
   3.666038476185831*^9, 3.6660384763564043`*^9}, {3.666038935218671*^9, 
   3.666039200621087*^9}, {3.66603923268151*^9, 3.6660392949363403`*^9}, {
   3.666039349399706*^9, 3.666039401096746*^9}, {3.666039543112743*^9, 
   3.6660395480826683`*^9}, {3.66603967130055*^9, 3.6660396827510138`*^9}, {
   3.666039769824173*^9, 3.666039771458899*^9}, {3.6660398131393547`*^9, 
   3.666039814083852*^9}, {3.666039867043582*^9, 3.66603991530625*^9}, {
   3.666040066706558*^9, 3.666040075319833*^9}, {3.666040109668653*^9, 
   3.666040109925047*^9}, {3.666040219371112*^9, 3.666040361749082*^9}, {
   3.6660404127155867`*^9, 3.6660404407699947`*^9}, {3.6660405018436193`*^9, 
   3.6660405089296827`*^9}, {3.6660433346380253`*^9, 
   3.6660433386078167`*^9}, {3.66604367719058*^9, 3.666043717352191*^9}, {
   3.666043756453107*^9, 3.666043931103705*^9}, 3.6660440046829042`*^9, {
   3.666044040843101*^9, 3.666044085945198*^9}, {3.666044169481512*^9, 
   3.666044248972769*^9}, {3.666044281813225*^9, 3.666044495224635*^9}, 
   3.6660445414628897`*^9, {3.6660445831447783`*^9, 3.666044701265811*^9}, {
   3.6660447358350554`*^9, 3.666044756977395*^9}, {3.6660479505526953`*^9, 
   3.6660480841622057`*^9}, {3.666048281152564*^9, 3.666048283822213*^9}, {
   3.666048343815414*^9, 3.666048344682542*^9}, {3.666048438811541*^9, 
   3.6660484406356707`*^9}, {3.6660485616407423`*^9, 3.666048689720387*^9}, {
   3.666048752484268*^9, 3.666049015765583*^9}, {3.6660491922365627`*^9, 
   3.666049200834278*^9}, {3.66604925757692*^9, 3.666049418781931*^9}, {
   3.666049484715513*^9, 3.5803420560652266`*^9}, {3.5803429490731955`*^9, 
   3.5803429758896427`*^9}, {3.580344137202482*^9, 3.5803442110374117`*^9}, {
   3.5803442633131037`*^9, 3.580344324590011*^9}, {3.5803443595028725`*^9, 
   3.5803443718736944`*^9}, {3.5803444107021627`*^9, 3.580344417612975*^9}, {
   3.5803447347004642`*^9, 3.5803447537948976`*^9}, {3.5803447987853765`*^9, 
   3.580344807614992*^9}, {3.5803450311321845`*^9, 3.5803450612402377`*^9}, {
   3.580345318094689*^9, 3.580345319888692*^9}, {3.580345567570327*^9, 
   3.5803455684439287`*^9}, {3.5803456005643845`*^9, 
   3.5803456170068135`*^9}, {3.5803459417369843`*^9, 3.580345955496208*^9}, {
   3.580346553133258*^9, 3.5803465653948793`*^9}, {3.580346641727256*^9, 
   3.5803466522522707`*^9}, {3.5803467073023477`*^9, 
   3.5803467672124314`*^9}, {3.5803468636675663`*^9, 3.580346932532663*^9}, {
   3.580347012662775*^9, 3.5803470673378515`*^9}, {3.580347142442957*^9, 
   3.580347171882998*^9}, {3.5803472335480843`*^9, 3.580347235913088*^9}, {
   3.5803472889061956`*^9, 3.580347311856228*^9}, {3.580347542631551*^9, 
   3.580347610461646*^9}, {3.580347721766802*^9, 3.580347725466807*^9}, {
   3.5803478366869626`*^9, 3.5803478792120223`*^9}, {3.5803482799525833`*^9, 
   3.580348280742584*^9}, {3.580348410497766*^9, 3.5803484280077906`*^9}, {
   3.580348718193197*^9, 3.5803488265533485`*^9}, {3.580349356754091*^9, 
   3.580349386539132*^9}, {3.5803494810742645`*^9, 3.5803494836792684`*^9}, {
   3.58034953498434*^9, 3.5803495398593473`*^9}, {3.666101808077424*^9, 
   3.6661018144142323`*^9}, {3.6661024297856283`*^9, 
   3.6661024795395393`*^9}, {3.6661039559410267`*^9, 3.666103957516128*^9}, 
   3.6661042400265493`*^9, {3.666104414189391*^9, 3.666104536003034*^9}, {
   3.666104754476179*^9, 3.66610478551643*^9}, {3.6661048476546907`*^9, 
   3.666104849692499*^9}, {3.666104911590177*^9, 3.666104936957725*^9}, {
   3.666105093848118*^9, 3.666105125761047*^9}, {3.666105367958047*^9, 
   3.666105379766624*^9}, {3.666105495640685*^9, 3.6661055100203257`*^9}, {
   3.666105608076226*^9, 3.666105643289493*^9}, {3.6661057019181747`*^9, 
   3.66610574529812*^9}, {3.666105857851609*^9, 3.666105880837557*^9}, {
   3.666105957100266*^9, 3.666105958700961*^9}, {3.666106051677517*^9, 
   3.6661061481292686`*^9}, {3.666106207479895*^9, 3.666106362466343*^9}, {
   3.666106418026594*^9, 3.666106420439664*^9}, {3.666106451547317*^9, 
   3.666106481441969*^9}, {3.666106891808302*^9, 3.666106908147484*^9}, {
   3.666106962826207*^9, 3.666106968216902*^9}, {3.6661070587780647`*^9, 
   3.666107074286203*^9}, {3.6661071179394093`*^9, 3.666107148085794*^9}, 
   3.666107469129162*^9, {3.666107518232059*^9, 3.6661075437991667`*^9}, {
   3.666107972873678*^9, 3.6661079846334343`*^9}, {3.666108128862115*^9, 
   3.666108129593753*^9}, {3.6661083816691837`*^9, 3.666108392131956*^9}, {
   3.66610877202522*^9, 3.6661087816369667`*^9}, {3.6661089058855267`*^9, 
   3.666108912049205*^9}, {3.6661089756440277`*^9, 3.666108975953759*^9}, {
   3.666109025307495*^9, 3.666109060597085*^9}, {3.666109759883691*^9, 
   3.666109776381238*^9}, {3.6661098074582*^9, 3.666109819074924*^9}, {
   3.6661099319129963`*^9, 3.666109934807321*^9}, {3.6661099842085447`*^9, 
   3.6661099861404867`*^9}, {3.666110191353816*^9, 3.666110200627686*^9}, {
   3.6661102648430967`*^9, 3.666110333857682*^9}, {3.666110364371251*^9, 
   3.666110386642127*^9}, {3.66611045241293*^9, 3.666110509443203*^9}, {
   3.666110607446733*^9, 3.666110679611784*^9}, {3.6661115248234377`*^9, 
   3.666111529886622*^9}, {3.666111589643422*^9, 3.6661115927722263`*^9}, {
   3.666111627325886*^9, 3.6661116421063757`*^9}, {3.666123956699181*^9, 
   3.666123963281376*^9}, {3.666309068198161*^9, 3.66630917440235*^9}, 
   3.666309237026218*^9, {3.666311228721856*^9, 3.6663112349551086`*^9}, {
   3.66631151492458*^9, 3.6663115243054123`*^9}, {3.666311612238721*^9, 
   3.666311615991064*^9}, {3.66631165196097*^9, 3.666311661330872*^9}, {
   3.666311771712078*^9, 3.666311779752164*^9}, {3.666311893323347*^9, 
   3.6663118984300337`*^9}, {3.666311936541479*^9, 3.666311964261833*^9}, {
   3.666312171759823*^9, 3.666312239304304*^9}, {3.66631235866142*^9, 
   3.666312371350051*^9}, {3.666312555258019*^9, 3.666312556860293*^9}, {
   3.666312594429336*^9, 3.666312632467145*^9}, {3.666312709242042*^9, 
   3.666312781807611*^9}, {3.666312819133191*^9, 3.666312821591724*^9}, {
   3.6663129610900497`*^9, 3.666312994652301*^9}, {3.666313030740884*^9, 
   3.6663130541313553`*^9}, {3.6663133554789124`*^9, 
   3.6663134008231487`*^9}, {3.66631454566315*^9, 3.666314546300149*^9}, {
   3.6663149844627323`*^9, 3.66631506602845*^9}, {3.666315262215528*^9, 
   3.666315262460557*^9}, {3.666315295827529*^9, 3.666315297147341*^9}, {
   3.666317862198415*^9, 3.6663178751192617`*^9}, {3.666317974252252*^9, 
   3.66631798464154*^9}, {3.6663189391887283`*^9, 3.66631894427914*^9}, {
   3.6663272760498753`*^9, 3.6663272769490347`*^9}, {3.666368162564871*^9, 
   3.666368223394017*^9}, {3.666368311784597*^9, 3.666368328183453*^9}, {
   3.666368706350466*^9, 3.666368765503977*^9}, 3.666368852287282*^9, {
   3.666455659937731*^9, 3.666455674217162*^9}, {3.666456470100747*^9, 
   3.666456471547996*^9}, {3.666475999744268*^9, 3.581179742490941*^9}, {
   3.666965552001648*^9, 3.66696559847363*^9}, {3.666965634013054*^9, 
   3.6669656342548018`*^9}, {3.666965843318424*^9, 3.666965866715043*^9}, {
   3.666965955069276*^9, 3.666966108819721*^9}, {3.6669661392374887`*^9, 
   3.6669662209530287`*^9}, {3.666966318987899*^9, 3.666966323419108*^9}, {
   3.666966698605213*^9, 3.666966746983933*^9}, {3.6669668767637367`*^9, 
   3.666966971410186*^9}, {3.666967631846241*^9, 3.666967666122058*^9}, {
   3.66696779421314*^9, 3.666967800544138*^9}, {3.666969650067123*^9, 
   3.666969651086574*^9}, {3.666969682421054*^9, 3.666969683057621*^9}, {
   3.6669697377982807`*^9, 3.666969745781939*^9}, {3.6669836384736347`*^9, 
   3.6669836646978083`*^9}, {3.666983797831324*^9, 3.6669837983015757`*^9}, {
   3.66698816555665*^9, 3.6669881656672907`*^9}, {3.666988586736762*^9, 
   3.666988618751822*^9}, {3.666988730492195*^9, 3.66698873336271*^9}, {
   3.6669890784636717`*^9, 3.666989078757585*^9}, {3.66698916173917*^9, 
   3.666989162093769*^9}, {3.666992143108715*^9, 3.666992143410687*^9}, {
   3.667167074895195*^9, 3.667167076074875*^9}, {3.667167108070867*^9, 
   3.66716716571815*^9}, {3.667167220521873*^9, 3.667167225347169*^9}, {
   3.667167315246868*^9, 3.667167317715488*^9}, 3.667231355771237*^9, {
   3.667337718543992*^9, 3.667337817932954*^9}, {3.667658502330854*^9, 
   3.667658527687475*^9}, {3.6676751668651237`*^9, 3.667675168207584*^9}, {
   3.667675240553527*^9, 3.667675299017297*^9}, {3.667675344725163*^9, 
   3.667675355677205*^9}, {3.667675410406062*^9, 3.667675421553164*^9}, {
   3.667743285240264*^9, 3.667743492444006*^9}, {3.6677435259284163`*^9, 
   3.667743541876462*^9}, {3.667743595262018*^9, 3.6677436132534122`*^9}, {
   3.6677436938816347`*^9, 3.667743773887302*^9}, {3.6677440115805807`*^9, 
   3.667744025271256*^9}, {3.6677440938831263`*^9, 3.6677440950896397`*^9}, {
   3.6677441561507587`*^9, 3.6677441580413322`*^9}, {3.667744220556978*^9, 
   3.667744231837758*^9}, {3.6677444313626547`*^9, 3.667744434063169*^9}, {
   3.667744516779023*^9, 3.667744643647962*^9}, {3.667764809978861*^9, 
   3.6677648123342533`*^9}, {3.667765684274218*^9, 3.66776568799426*^9}, {
   3.686161232696477*^9, 3.686161232727941*^9}, 3.686168038751679*^9, 
   3.68617432782675*^9, 3.686174402429064*^9, {3.686179713980443*^9, 
   3.686179731428941*^9}, 3.686180573959531*^9, {3.686180652055667*^9, 
   3.6861806530267687`*^9}, {3.686180714725923*^9, 3.686180755528062*^9}, {
   3.6861807893138027`*^9, 3.6861808315636673`*^9}, {3.6861808861171427`*^9, 
   3.6861809873200397`*^9}, {3.6861810318539457`*^9, 
   3.6861811146227922`*^9}, {3.6861813155948753`*^9, 
   3.6861813157699203`*^9}, {3.686181400768738*^9, 3.686181402071125*^9}, {
   3.686181488516592*^9, 3.686181491351005*^9}, {3.68618194241949*^9, 
   3.686181953408875*^9}, {3.686182092223156*^9, 3.686182101359419*^9}, {
   3.6861821478818007`*^9, 3.686182216248911*^9}, {3.686182297830338*^9, 
   3.686182323701356*^9}, {3.686604572585741*^9, 3.6866045928817883`*^9}, {
   3.686604839075553*^9, 3.686604848185595*^9}, {3.6866048902784452`*^9, 
   3.686604913513763*^9}, {3.6866050291221313`*^9, 3.686605036476383*^9}, {
   3.686605129755805*^9, 3.68660514054278*^9}, {3.686605236455162*^9, 
   3.686605236562976*^9}, {3.686605384236857*^9, 3.686605384852517*^9}, {
   3.686605940441584*^9, 3.68660602218412*^9}, {3.6866061347747726`*^9, 
   3.686606147543593*^9}, {3.686606182652628*^9, 3.686606401223754*^9}, {
   3.686606462295817*^9, 3.686606474255134*^9}, {3.6866065378928022`*^9, 
   3.6866065620574083`*^9}, {3.686606632341873*^9, 3.6866066396212273`*^9}, {
   3.686606834884595*^9, 3.686607039925128*^9}, {3.6866070806254053`*^9, 
   3.6866071128104267`*^9}, {3.686607167298065*^9, 3.6866071729080677`*^9}, {
   3.6866072097290087`*^9, 3.686607228022265*^9}, {3.6866072650517073`*^9, 
   3.686607328981977*^9}, {3.686607375132942*^9, 3.686607479903754*^9}, {
   3.6866075313767767`*^9, 3.686607573973699*^9}, {3.686607626610609*^9, 
   3.686607628815261*^9}, {3.68660775367885*^9, 3.686607757890417*^9}, {
   3.686607804778028*^9, 3.686607831333942*^9}, {3.686607863453535*^9, 
   3.6866079343448353`*^9}, {3.686607988047798*^9, 3.686608026171172*^9}, {
   3.686608089553258*^9, 3.686608232025366*^9}, {3.68660830608589*^9, 
   3.686608392608004*^9}, {3.686608457254394*^9, 3.686608469622452*^9}, {
   3.686608502881422*^9, 3.68660855721325*^9}, {3.686608596383472*^9, 
   3.686608683200881*^9}, {3.686608716960815*^9, 3.686608812442046*^9}, {
   3.686608844072626*^9, 3.686608930086144*^9}, {3.686608973647263*^9, 
   3.6866089839005547`*^9}, {3.6866090501054163`*^9, 3.686609055209485*^9}, {
   3.686609124429887*^9, 3.686609153642488*^9}, {3.6866092164061213`*^9, 
   3.686609236247623*^9}, {3.686609286884295*^9, 3.68660929683291*^9}, {
   3.686609349454844*^9, 3.6866093972413607`*^9}, {3.6866094285279617`*^9, 
   3.686609460859208*^9}, {3.686609498036242*^9, 3.68660954747716*^9}, {
   3.6866095801446466`*^9, 3.686609580811314*^9}, {3.686609616184421*^9, 
   3.686609618574543*^9}, {3.6866096908845663`*^9, 3.686609691482627*^9}, {
   3.686609725198*^9, 3.686609762005104*^9}, {3.686609798336321*^9, 
   3.68660981368498*^9}, {3.686624922268877*^9, 3.686624946684607*^9}, {
   3.6866511218922567`*^9, 3.686651214058462*^9}, {3.6866512816949987`*^9, 
   3.686651282110014*^9}, {3.686651385266314*^9, 3.686651385675201*^9}, {
   3.6866514637576733`*^9, 3.686651467567219*^9}, {3.686651936830863*^9, 
   3.686651959895007*^9}, 3.686652073762205*^9, {3.686652544311936*^9, 
   3.6866525588568153`*^9}, {3.6866531327662573`*^9, 
   3.6866531456658373`*^9}, {3.686653182780698*^9, 3.686653253335429*^9}, {
   3.6866532899066153`*^9, 3.6866533347164288`*^9}, {3.68665338174746*^9, 
   3.6866533897062263`*^9}, {3.686653635486319*^9, 3.686653658846141*^9}, {
   3.6866538965042553`*^9, 3.6866539673461437`*^9}, {3.686654018548437*^9, 
   3.686654083953383*^9}, {3.6866541140687428`*^9, 3.6866541171984*^9}, {
   3.686654154371064*^9, 3.6866541561432447`*^9}, {3.686654194256715*^9, 
   3.686654231548008*^9}, {3.686654261680113*^9, 3.686654263618539*^9}, {
   3.686654443022056*^9, 3.686654444503558*^9}, {3.686654496365649*^9, 
   3.6866545206337433`*^9}, {3.6866546345309896`*^9, 
   3.6866546396191387`*^9}, {3.6866546725242853`*^9, 
   3.6866547053327227`*^9}, {3.686654848347542*^9, 3.686654848518978*^9}, {
   3.686654904561698*^9, 3.6866549555998363`*^9}, {3.686655106576477*^9, 
   3.686655112183008*^9}, {3.6866656589166317`*^9, 3.686665661737069*^9}, {
   3.686665714308938*^9, 3.686665717288529*^9}, {3.68788984927495*^9, 
   3.687889851452046*^9}, {3.6878899619151373`*^9, 3.687889964163999*^9}, {
   3.687890523902821*^9, 3.6878905260413857`*^9}, {3.68789067851256*^9, 
   3.6878907281946898`*^9}, {3.687891848594905*^9, 3.687891848728903*^9}, {
   3.687891895275734*^9, 3.687891912206829*^9}, {3.687892160709991*^9, 
   3.687892176260622*^9}, {3.687892209846271*^9, 3.68789226228833*^9}, {
   3.6878923253277597`*^9, 3.687892327409419*^9}, {3.687892767598171*^9, 
   3.687892773529532*^9}, {3.68789427037936*^9, 3.6878942989574957`*^9}, {
   3.687894458636754*^9, 3.687894491577156*^9}, {3.687895727434269*^9, 
   3.68789577072791*^9}, {3.687895817095004*^9, 3.687895896606386*^9}, {
   3.687895959167659*^9, 3.687896081396837*^9}, {3.688069518129613*^9, 
   3.688069528292594*^9}, {3.688069730889783*^9, 3.6880697313983707`*^9}, {
   3.688069842927936*^9, 3.688069844026939*^9}, {3.688070105367819*^9, 
   3.68807012067618*^9}, {3.688070662079383*^9, 3.6880706636576433`*^9}, {
   3.6880706947671022`*^9, 3.688070702023712*^9}, {3.688070740032238*^9, 
   3.6880707617068357`*^9}, {3.688070989681781*^9, 3.6880710258038263`*^9}, {
   3.688071117704007*^9, 3.688071180734871*^9}, {3.6880715634246883`*^9, 
   3.688071578544895*^9}, {3.68807168958871*^9, 3.688071744613975*^9}, {
   3.6880718451466703`*^9, 3.688071855780793*^9}, {3.688071897215568*^9, 
   3.688071902752385*^9}, {3.68807195261271*^9, 3.688071997525037*^9}, 
   3.688072041806848*^9, {3.6880726281665373`*^9, 3.688072726248879*^9}, {
   3.688072803085725*^9, 3.6880728282714033`*^9}, {3.688073077108385*^9, 
   3.6880731041848288`*^9}, {3.688073377096032*^9, 3.688073418155999*^9}, {
   3.688073516187398*^9, 3.688073524662923*^9}, {3.688074741359592*^9, 
   3.688074775703458*^9}, {3.6880748364723883`*^9, 3.6880749971015673`*^9}, {
   3.688075028248296*^9, 3.688075068826088*^9}, 3.68807514680929*^9, {
   3.688075196129966*^9, 3.688075226771421*^9}, 3.688075448740116*^9, {
   3.6880755717486887`*^9, 3.688075601685951*^9}, {3.688075695368294*^9, 
   3.688075697020276*^9}, {3.6880758806038933`*^9, 3.68807588621663*^9}, {
   3.688076075164824*^9, 3.688076082099997*^9}, 3.6880761187740393`*^9, {
   3.688076248981687*^9, 3.6880763124258223`*^9}, 3.6880763554385242`*^9, {
   3.688076436672988*^9, 3.688076438546679*^9}, {3.6880764948892593`*^9, 
   3.6880765423309593`*^9}, {3.6880766282675943`*^9, 3.6880766798511744`*^9}, 
   3.688076732918498*^9, {3.688076932869195*^9, 3.688076988441168*^9}, {
   3.688077123984116*^9, 3.688077148393693*^9}, {3.6880772660782747`*^9, 
   3.688077322038952*^9}, {3.688077438051421*^9, 3.6880774391331797`*^9}, {
   3.688077561064191*^9, 3.688077578773262*^9}, {3.688077803676054*^9, 
   3.6880778094076843`*^9}, {3.6880779054779673`*^9, 3.688077982682579*^9}, {
   3.688128588727724*^9, 3.68812861396348*^9}, {3.688128667514781*^9, 
   3.688128712933608*^9}, 3.688128772606694*^9, {3.6881288063030577`*^9, 
   3.688128821922142*^9}, {3.6881295176719713`*^9, 3.688129559859549*^9}, {
   3.688129607245014*^9, 3.688129612378593*^9}, {3.6881296558616858`*^9, 
   3.68812965675839*^9}, {3.688129687624982*^9, 3.68812972446953*^9}, {
   3.688129770392906*^9, 3.688129780252713*^9}, {3.688129814110176*^9, 
   3.6881298258182592`*^9}, {3.688129976655026*^9, 3.688130005727783*^9}, {
   3.688130101558576*^9, 3.688130120132637*^9}, {3.688130205131669*^9, 
   3.688130218078484*^9}, {3.688130299915304*^9, 3.6881303017350616`*^9}, {
   3.688130390339808*^9, 3.68813043131682*^9}, {3.688130496430684*^9, 
   3.688130524661128*^9}, {3.68813068726856*^9, 3.688130689338272*^9}, {
   3.6881307499079647`*^9, 3.688130752341775*^9}, {3.688130787849409*^9, 
   3.688130849028646*^9}, {3.688130888709774*^9, 3.688130936114859*^9}, {
   3.68813816174189*^9, 3.688138170903564*^9}, {3.688138372318707*^9, 
   3.5760967253749447`*^9}, {3.576096758366832*^9, 3.5760967616870213`*^9}, {
   3.5760968100807896`*^9, 3.5760968602296576`*^9}, {3.576096902295064*^9, 
   3.5760970547427835`*^9}, {3.5760970948530774`*^9, 
   3.5760971372125006`*^9}, {3.5760971843331957`*^9, 3.576097237140216*^9}, {
   3.576097330626563*^9, 3.576097345802431*^9}, {3.5760973926201086`*^9, 
   3.576097444009048*^9}, 3.576097549347073*^9, {3.576097687730988*^9, 
   3.5760977393219385`*^9}, {3.576097779136216*^9, 3.576097821035613*^9}, {
   3.5760979307388873`*^9, 3.576097942529562*^9}, {3.5760979883861847`*^9, 
   3.5760980125455666`*^9}, {3.576098068448764*^9, 3.576098127490141*^9}, {
   3.5760981942409587`*^9, 3.5760982268808255`*^9}, {3.5760983665428143`*^9, 
   3.576098377991469*^9}, {3.5760984081511936`*^9, 3.576098459693142*^9}, {
   3.576098492124997*^9, 3.576098498757376*^9}, {3.576098540364756*^9, 
   3.576098616788127*^9}, {3.5760987060282316`*^9, 3.576098707387309*^9}, {
   3.576098747556607*^9, 3.5760987915411224`*^9}, {3.5760990362951217`*^9, 
   3.576099079960619*^9}, {3.576099111433419*^9, 3.576099127313328*^9}, {
   3.5760992089609976`*^9, 3.5760992100810614`*^9}, {3.5760992590328617`*^9, 
   3.57609926127999*^9}, {3.576099299200159*^9, 3.576099361199705*^9}, {
   3.5760994038481445`*^9, 3.5760994182949705`*^9}, {3.576099516302576*^9, 
   3.576099520437813*^9}, {3.57609969277267*^9, 3.5760997145479155`*^9}, {
   3.5760999037397366`*^9, 3.5760999145233536`*^9}, {3.576099963724168*^9, 
   3.576099976226883*^9}, {3.5761000131389937`*^9, 3.576100019147338*^9}, {
   3.5761000584645863`*^9, 3.5761000596036515`*^9}, {3.576100271544774*^9, 
   3.5761002813443346`*^9}, {3.5761003355124326`*^9, 
   3.5761003491292114`*^9}, {3.5761003949438314`*^9, 
   3.5761004073185396`*^9}, {3.576100499495812*^9, 3.576100512956582*^9}, {
   3.5761005535259023`*^9, 3.5761005911420536`*^9}, {3.576100694006937*^9, 
   3.576100699285239*^9}, 3.576100739916563*^9, {3.5761007868622484`*^9, 
   3.57610078723627*^9}, {3.576100818324048*^9, 3.576100820731186*^9}, {
   3.5761012065710163`*^9, 3.5761012391858816`*^9}, {3.5761013503312387`*^9, 
   3.5761013524123583`*^9}, {3.5761015747040725`*^9, 3.576101578217273*^9}, {
   3.576101622065781*^9, 3.5761016470232086`*^9}, {3.5761016923208*^9, 
   3.576101725141677*^9}, {3.576101818069992*^9, 3.5761018326618266`*^9}, {
   3.57610192502911*^9, 3.576101959813099*^9}, {3.5761020054527097`*^9, 
   3.576102008110862*^9}, {3.576102051908367*^9, 3.576102052731414*^9}, {
   3.5761020948388224`*^9, 3.576102095124839*^9}, {3.576102187194105*^9, 
   3.5761021963456283`*^9}, {3.5761097806124234`*^9, 
   3.5761097866917715`*^9}, {3.576109872131658*^9, 3.5761099241476336`*^9}, {
   3.5761101756910205`*^9, 3.576110186066614*^9}, {3.576110267408266*^9, 
   3.576110272431554*^9}, {3.576110447637575*^9, 3.576110504045801*^9}, {
   3.5761107798315754`*^9, 3.576110811775402*^9}, {3.5761108489265275`*^9, 
   3.576110855766919*^9}, {3.5761109198605847`*^9, 3.576110923734806*^9}, {
   3.5761109669322767`*^9, 3.5761110031883507`*^9}, {3.5761110440266867`*^9, 
   3.5761110908663654`*^9}, {3.5761111470515795`*^9, 
   3.5761111601713295`*^9}, {3.576111193698247*^9, 3.5761112416099873`*^9}, {
   3.576111291713854*^9, 3.576111304451582*^9}, {3.5761113533283777`*^9, 
   3.5761113669131546`*^9}, {3.576111545094346*^9, 3.5761116549326286`*^9}, {
   3.5761119701476574`*^9, 3.5761119877866664`*^9}, {3.5761688857363553`*^9, 
   3.5761688980915766`*^9}, {3.57617007277364*^9, 3.576170081353655*^9}, {
   3.5761701214301257`*^9, 3.5761703178188705`*^9}, {3.5761703622165484`*^9, 
   3.5761703777229757`*^9}, {3.5761705250028343`*^9, 
   3.5761705431612663`*^9}, {3.576171107695058*^9, 3.5761711214230824`*^9}, {
   3.5761711543235397`*^9, 3.5761711672559624`*^9}, {3.5761712149140463`*^9, 
   3.5761712154288473`*^9}, 3.5761712634301314`*^9, {3.5761712944585857`*^9, 
   3.5761713667023125`*^9}, {3.5761731973031282`*^9, 
   3.5761732436508093`*^9}, {3.5761761777975636`*^9, 3.5761762281700516`*^9}, 
   3.5761763701459007`*^9, {3.57617691636526*^9, 3.5761769416529045`*^9}, {
   3.5761769904809904`*^9, 3.576176990808591*^9}, {3.5761771186196156`*^9, 
   3.5761771304600363`*^9}, {3.576177505734296*^9, 3.5761775222391243`*^9}, {
   3.576177553454779*^9, 3.5761775696944075`*^9}, {3.5761776071656733`*^9, 
   3.5761776504557495`*^9}, {3.5761776824670057`*^9, 
   3.5761776994554358`*^9}, {3.6764753916909094`*^9, 
   3.6764754058640285`*^9}, {3.6764755827525487`*^9, 3.671110076052392*^9}, {
   3.6711101736953945`*^9, 3.671110202508254*^9}, {3.671110252587079*^9, 
   3.6711102555245996`*^9}, {3.6711103158407545`*^9, 3.671110350623521*^9}, {
   3.6711103892646613`*^9, 3.6711104854905653`*^9}, {3.6711105561488276`*^9, 
   3.671110627868544*^9}, {3.6711109172232876`*^9, 3.6711109192545404`*^9}, {
   3.6711109841147895`*^9, 3.6711109910524044`*^9}, {3.6711110215371675`*^9, 
   3.671111049881299*^9}, {3.671111141017798*^9, 3.6711112779582787`*^9}, {
   3.671112928464212*^9, 3.6711129378081093`*^9}, {3.671113024496771*^9, 
   3.67111311376429*^9}, {3.671113166030636*^9, 3.6711131704837885`*^9}, {
   3.6711132907359877`*^9, 3.671113413785203*^9}, {3.671113467723427*^9, 
   3.6711134901299944`*^9}, {3.6711135404004316`*^9, 
   3.6711135480099373`*^9}, {3.6711136425534415`*^9, 3.671113674397592*^9}, {
   3.6711138495321264`*^9, 3.6711139248925123`*^9}, {3.6711140721742506`*^9, 
   3.671114103915152*^9}, {3.671114152751012*^9, 3.671114221423802*^9}, {
   3.671114268067738*^9, 3.6711144016831784`*^9}, {3.6711148456316853`*^9, 
   3.6711148537411623`*^9}, {3.671114902491825*^9, 3.671115268888678*^9}, {
   3.6711153504684434`*^9, 3.6711153519684663`*^9}, {3.6711154136255627`*^9, 
   3.671115424469457*^9}, {3.671115462516823*^9, 3.671115463688733*^9}, {
   3.6711155781605453`*^9, 3.6711155815668216`*^9}, {3.671115692506523*^9, 
   3.671115709053619*^9}, {3.6711157767576485`*^9, 3.671115798945447*^9}, {
   3.6711158378053412`*^9, 3.6711158703220844`*^9}, {3.671115927713481*^9, 
   3.671115933213564*^9}, {3.6711159779641757`*^9, 3.671116067669088*^9}, {
   3.671116122935433*^9, 3.671116141873209*^9}, {3.671116295000949*^9, 
   3.6711162951728463`*^9}, {3.6711163540798874`*^9, 3.671116391908498*^9}, {
   3.6711164353354855`*^9, 3.671116482266651*^9}, {3.6711165143452134`*^9, 
   3.6711167705835743`*^9}, {3.6711168342570257`*^9, 
   3.6711169312270823`*^9}, {3.671117109870815*^9, 3.671117240545141*^9}, {
   3.671117479423916*^9, 3.671117497018606*^9}, {3.671117887181388*^9, 
   3.6711178891345453`*^9}, {3.671117948838473*^9, 3.6711180739971848`*^9}, {
   3.67111820026451*^9, 3.671118266203624*^9}, {3.6711183229231143`*^9, 
   3.671118836401189*^9}, {3.67111887451105*^9, 3.6711190430610504`*^9}, {
   3.6711191013899574`*^9, 3.6711191326723137`*^9}, {3.6711192560801997`*^9, 
   3.671119314206683*^9}, {3.6711193529884777`*^9, 3.6711193551134853`*^9}, 
   3.671119387160787*^9, {3.6711195143350983`*^9, 3.671119653165064*^9}, {
   3.6711196898069086`*^9, 3.6711196907131724`*^9}, {3.671120043422419*^9, 
   3.6711203432396317`*^9}, {3.671120444413951*^9, 3.671120481148797*^9}, {
   3.6711205144773707`*^9, 3.6711205633217754`*^9}, {3.671120623604535*^9, 
   3.6711206237451725`*^9}, {3.6711207007618284`*^9, 
   3.6711207339653993`*^9}, {3.6711208281864862`*^9, 3.671120830405261*^9}, {
   3.6711210090176387`*^9, 3.671121010955145*^9}, {3.671121111972833*^9, 
   3.671121121972967*^9}, {3.671121403197027*^9, 3.6711214161503344`*^9}, {
   3.6711214642603545`*^9, 3.6711214645572357`*^9}, {3.671121915018779*^9, 
   3.6711219218313694`*^9}, {3.6711227788689327`*^9, 
   3.6711228388853426`*^9}, {3.671122990935305*^9, 3.671123022060741*^9}, {
   3.67112305676431*^9, 3.6711230585612307`*^9}, {3.6711230900460277`*^9, 
   3.6711231785790973`*^9}, {3.6711232654396534`*^9, 
   3.6711233028002234`*^9}, {3.671123353504029*^9, 3.6711233637541666`*^9}, {
   3.671123848017502*^9, 3.6711239336941385`*^9}, 3.6711240055445914`*^9, {
   3.6711242376354504`*^9, 3.671124549780929*^9}, {3.6711246795639925`*^9, 
   3.671124758025755*^9}, {3.671124838244173*^9, 3.6711248653539124`*^9}, {
   3.671124926663797*^9, 3.671125052106284*^9}, {3.671125218962278*^9, 
   3.671125240837566*^9}, {3.671133753639351*^9, 3.6711338673919754`*^9}, {
   3.671133907939396*^9, 3.6711339756757517`*^9}, {3.6711340412547297`*^9, 
   3.67113408442719*^9}, {3.6711341597417707`*^9, 3.67113417635139*^9}, 
   3.671134226633317*^9, {3.6711342835871773`*^9, 3.671134312088653*^9}, {
   3.6711361734194703`*^9, 3.6711361783414288`*^9}, {3.6711364617943525`*^9, 
   3.6711365119350967`*^9}, {3.6711365650903563`*^9, 3.671136632057279*^9}, {
   3.6711369017172413`*^9, 3.6711369024985037`*^9}, {3.671137230628478*^9, 
   3.671137238550432*^9}, {3.671137269256397*^9, 3.671137296242665*^9}, {
   3.671137424643697*^9, 3.671137492936301*^9}, {3.6711376589998713`*^9, 
   3.6711377398112583`*^9}, {3.671137786653102*^9, 3.671137824991395*^9}, {
   3.671137890456905*^9, 3.6711379340072517`*^9}, {3.671140536745322*^9, 
   3.67114056718195*^9}, {3.6711409584703193`*^9, 3.67114097529126*^9}, {
   3.6711410275239196`*^9, 3.6711412221961603`*^9}, {3.6711455717156854`*^9, 
   3.6711455741219873`*^9}, {3.6711458153124866`*^9, 3.6711458166094*^9}, {
   3.6711459035098577`*^9, 3.6711459149787626`*^9}, {3.6711462172152195`*^9, 
   3.6711462794471846`*^9}, {3.6711470598047066`*^9, 
   3.6711471043344755`*^9}, {3.6711471544183064`*^9, 
   3.6711471545745597`*^9}, {3.6711472751839733`*^9, 
   3.6711472939820824`*^9}, {3.6711492488311615`*^9, 3.671149267206436*^9}, {
   3.6711497678939524`*^9, 3.6711497749409227`*^9}, {3.6711498099569025`*^9, 
   3.671149829195449*^9}, {3.671192313186693*^9, 3.6711923142492065`*^9}, {
   3.6711924633144217`*^9, 3.671192464173807*^9}, {3.671192547159296*^9, 
   3.671192548815568*^9}, {3.671193324786928*^9, 3.6711933429277987`*^9}, {
   3.6711952191897297`*^9, 3.671195250783904*^9}, {3.671195283268734*^9, 
   3.6711953528641043`*^9}, {3.6711954925995646`*^9, 
   3.6711954972715025`*^9}, {3.671195662336218*^9, 3.671195664258099*^9}, {
   3.671195932574959*^9, 3.6711959344499617`*^9}, {3.6711961045623503`*^9, 
   3.6711961164062405`*^9}, {3.6711961531567335`*^9, 3.671196163235013*^9}, {
   3.6711962465024624`*^9, 3.6711962603151474`*^9}, {3.6711963104876957`*^9, 
   3.671196311393937*^9}, {3.6711975235719604`*^9, 3.6711975280407696`*^9}, {
   3.671197616258892*^9, 3.6711976236652417`*^9}, 3.693012834560267*^9, {
   3.693052780978923*^9, 3.693052781400919*^9}, {3.693164666038664*^9, 
   3.693164670394699*^9}, {3.695571069763994*^9, 3.6955711067719193`*^9}, {
   3.6955711645598803`*^9, 3.676405178351653*^9}, {3.676405245908652*^9, 
   3.676405246955539*^9}, {3.6764053279998627`*^9, 3.67640533576557*^9}, {
   3.676405381424409*^9, 3.6764054268468914`*^9}, {3.6764055158127193`*^9, 
   3.6764055201096334`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["parse", "Subsection",
 CellChangeTimes->{{3.6930564341012077`*^9, 3.693056435858036*^9}, {
  3.701787716226556*^9, 3.701787716722344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"iIntegrate", "[", 
   RowBox[{"ffunc_", ",", "x_Symbol", ",", "\[Theta]_Symbol"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ff", ",", "ipow", ",", "irep", ",", "g", ",", "d", ",", "n", ",", "z", 
      ",", "B", ",", "nf", ",", "ext", ",", "\[Theta]2", ",", "\n", 
      "\[Omega]", ",", "\[Omega]q", ",", "\[Omega]r", ",", "v", ",", "u", ",",
       "k", ",", "expp", ",", "m", ",", "w", ",", "t", ",", "b", ",", 
      "ratpart", ",", 
      RowBox[{"logpart", "=", "0"}], ",", "rempart", ",", 
      RowBox[{"rem2part", "=", "0"}], ",", "Ci", ",", "dd", ",", "res", ",", 
      "fac", ",", "alpha", ",", "coeff", ",", "mat", ",", "\n", "resl", ",", 
      "indices", ",", "r", ",", "\n", "DATA", ",", "RES", ",", "IDEAL", ",", 
      "BR", ",", "nBR", ",", "succ", ",", "fpiece", ",", "logterm", ",", 
      "fpiecemlogd", ",", "normres", ",", "mm", ",", "res\[Phi]", ",", 
      "res\[Infinity]", ",", "cap\[Phi]", ",", "cap\[Infinity]", ",", "cap", 
      ",", "mat2", ",", "\n", "toEtaBar", ",", "fromEtaBar", ",", "toEpsilon",
       ",", "fromEpsilon", ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", 
      "\n", "diff1stkind", ",", "diff2ndkind", ",", "diff3rdkind", ",", 
      "derInEtaBar", ",", "\n", "ibasis", ",", "imat", ",", "irord", ",", 
      "itrace", ",", "iprod", ",", "nprod", ",", "id", ",", "nd", ",", 
      "idisc", ",", "idiff", ",", "new\[Omega]", ",", "jsf", ",", "isf", ",", 
      "ibadred", ",", "\n", "jbadred", ",", "divisor", ",", "idealk", ",", 
      "respiece", ",", "reslist", ",", "roots", ",", "ggroup", ",", 
      "new\[Theta]", ",", "nf2", ",", "rbasis", ",", "rel", ",", "\n", "rmat",
       ",", "div", ",", 
      RowBox[{"\[Delta]rz", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[Delta]z", ",", "flogd", ",",
       "rmp20", ",", "\[Xi]"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"\[Xi]", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{
        RowBox[{"SymbolName", "[", "x", "]"}], "<>", "\"\<i\>\""}], "]"}]}], 
     ";", "\n", "\t", 
     RowBox[{"SetTime", "[", "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", "\"\<starting\>\"", "]"}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "ff"}], "}"}], "=", 
      RowBox[{"ParseExpression", "[", 
       RowBox[{"ffunc", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "\[Theta]"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ff: \>\"", ",", "ff"}], "]"}], ";", "\n", "\t", 
     RowBox[{"nf", "=", 
      RowBox[{"ff", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ipow", ",", "irep", ",", "imat", ",", "itrace", ",", "iprod", ",", 
        "id", ",", "irord"}], "}"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "ff"}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "3"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "irord", "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "idisc", ",", "idiff", ",", "isf", ",", "ibadred", ",", "\n", "\t\t", 
        "toEtaBar", ",", "fromEtaBar", ",", "toEpsilon", ",", "fromEpsilon", 
        ",", "toEpsilonBar", ",", "fromEpsilonBar", ",", "\n", "\t\t", 
        "diff1stkind", ",", "diff2ndkind", ",", "diff3rdkind"}], "}"}], "=", 
      RowBox[{"FunctionFieldInfo", "[", "ff", "]"}]}], ";", "\n", "\n", "\n", 
     "\t", 
     RowBox[{"ibasis", "=", 
      RowBox[{"PolyMatrixInverse", "[", 
       RowBox[{
        RowBox[{
        "imat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ibasis", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "imat", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
         
         RowBox[{
         "ibasis", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "*", 
        RowBox[{
         RowBox[{
         "ibasis", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ".", "ipow"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ratpart", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}], ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integral basis: \>\"", ",", "ibasis"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"\[Omega]", ",", "ff"}], "]"}]}], "]"}], ";", "\n", "\t", 
     "\n", 
     RowBox[{
     "TimePrint", "[", "\"\<starting hermite reduction at finite places \>\"",
       "]"}], ";", "\n", "\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"PolyFactorSquareFree", "[", 
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", "x", ",", "nf"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "=", 
           RowBox[{
            RowBox[{"Length", "[", "v", "]"}], "-", "1"}]}], ")"}], ">", 
         "0"}]}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", "\t\t", 
        
        RowBox[{"u", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"v", "^", 
              RowBox[{"(", 
               RowBox[{"k", "+", "1"}], ")"}]}], ",", "x", ",", "nf"}], "]"}],
            ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"w", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"PolyGCD", "[", 
            RowBox[{
             RowBox[{"id", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"u", "*", "v"}], ",", "x", ",", "nf"}], "]"}], ",", 
             "x", ",", "nf"}], "]"}], ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"t", "=", 
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{
             RowBox[{"w", "*", "u", "*", "v"}], ",", "x", ",", "nf"}], "]"}], 
           ",", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"B", "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"t", "*", 
             RowBox[{"Transpose", "[", 
              RowBox[{"id", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
            "-", 
            RowBox[{"k", "*", "w", "*", "u", "*", 
             RowBox[{"D", "[", 
              RowBox[{"v", ",", "x"}], "]"}], "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], ",", "x", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"B", "=", 
         RowBox[{
          RowBox[{"PolyGaussJordanReduceMod", "[", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "B", "]"}], ",", 
                 RowBox[{"w", "*", 
                  RowBox[{
                  "\[Omega]", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}]}], "]"}], "]"}], ",", "x"}], 
             "]"}], ",", "x", ",", "v", ",", "nf"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"w", "*", 
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"B", ",", "x"}], "]"}], "*", "w", "*", "u", "*", 
               "v"}], "+", 
              RowBox[{"t", "*", 
               RowBox[{"B", ".", 
                RowBox[{"id", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "-", 
              
              RowBox[{"k", "*", "B", "*", "w", "*", "u", "*", 
               RowBox[{"D", "[", 
                RowBox[{"v", ",", "x"}], "]"}]}]}], ")"}]}], ",", "x", ",", 
           "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyDivide", "[", 
             RowBox[{"#", ",", "v", ",", "x", ",", "nf"}], "]"}], "&"}], ",", 
           
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{
         "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"w", "*", "u", "*", 
            RowBox[{"v", "^", "k"}]}], ",", "x", ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{"PolyNormalizeFraction", "[", 
          RowBox[{"\[Omega]", ",", "x", ",", "nf", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"ratpart", "=", 
         RowBox[{"PiecePlus", "[", 
          RowBox[{"x", ",", "ratpart", ",", 
           RowBox[{"{", 
            RowBox[{"B", ",", 
             RowBox[{"PolyCollect", "[", 
              RowBox[{
               RowBox[{"v", "^", "k"}], ",", "x", ",", "nf"}], "]"}]}], "}"}],
            ",", "nf"}], "]"}]}], ";"}]}], "\n", "\t", "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ratpart: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
          "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
          "*", 
         RowBox[{
          RowBox[{
          "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ".", "ibasis"}]}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand after finite hermite reduction: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}], ";", "\n", "\n", 
     RowBox[{
     "TimePrint", "[", 
      "\"\<starting hermite reduction at infinite places \>\"", "]"}], ";", 
     "\n", "\t", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            ".", "toEpsilonBar"}], ",", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"\[Omega]r", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", "n"}], "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Omega]q", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "\[Omega]r", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "}"}], "=", 
        RowBox[{"PolyQuotientRemainder", "[", 
         RowBox[{
          RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "x", ",", "nf"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"PolyNormalizeFraction", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]q", ".", 
           RowBox[{
           "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{
          "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"resl", "=", 
      RowBox[{"CalcResidues", "[", 
       RowBox[{"\[Omega]q", ",", "diff3rdkind", ",", "irord", ",", 
        RowBox[{"id", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "toEtaBar", ",", "toEpsilonBar", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<resl: \>\"", ",", "resl"}], "]"}], ";"}], "*)"}], "\n", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff3rdkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"PiecePlus", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]r", ".", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"resl", ".", "diff3rdkind", ".", 
             RowBox[{
             "fromEtaBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"PolyNormalizeFraction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Omega]r", ".", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "*", 
             RowBox[{
             "fromEpsilonBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}], ",", "x", ",", "nf", ",", 
          
          RowBox[{"{", "1", "}"}]}], "]"}]}]}], "\n", "\t", "]"}], ";", "\n", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Omega]: \>\"", ",", "\[Omega]"}], "]"}], ";"}], "*)"}],
      "\n", "\t", 
     RowBox[{"derInEtaBar", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{"#", ",", 
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "x", ",",
            "nf"}], "]"}], "&"}], ",", 
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"id", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
           "toEtaBar"}], ",", "x", ",", "nf"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PolyDivide", "[", 
          RowBox[{
           RowBox[{"PolyCollect", "[", 
            RowBox[{"#", ",", "x", ",", "nf"}], "]"}], ",", 
           RowBox[{
           "\[Omega]q", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ",", "x", ",", "nf"}], "]"}], "&"}], 
        ",", 
        RowBox[{
         RowBox[{
         "\[Omega]q", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ".", "toEtaBar"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"\[Omega]q", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Omega]q", "-", 
         RowBox[{"resl", ".", "diff3rdkind"}]}], ",", "x", ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "\[Omega]q", "}"}], ",", "diff1stkind", ",", 
        "diff2ndkind"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"mat2", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t", 
     RowBox[{"r", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "x"}], "]"}], "&"}], ",", "\[Omega]q"}], 
           "]"}], "+", "2", "-", "irord"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"indices", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "irord", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "===", "0"}], ",", "1", ",", "0"}],
              "]"}], ",", 
            RowBox[{"r", "-", 
             RowBox[{
             "irord", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"Apply", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], ",", "\n", "\t\t", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"mat", ",", 
            RowBox[{"PolyCollect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "*", 
                RowBox[{"x", "^", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "*", 
                RowBox[{
                "toEtaBar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"x", "^", "j"}], "*", 
                RowBox[{
                "derInEtaBar", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ",", "x", ",", "nf"}], 
             "]"}]}], "]"}], ";", "\n", "\t\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"mat2", ",", 
            RowBox[{
             RowBox[{"x", "^", "j"}], "*", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "n", "]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";"}]}], "\n", "\t", "]"}], ",", "indices", ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"coeff", "=", 
      RowBox[{"PolyNumRowNullSpace", "[", 
       RowBox[{"mat", ",", "x", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "coeff", "]"}], "===", "1"}], "&&", 
        RowBox[{
         RowBox[{"coeff", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=!=", "0"}]}], 
       ",", "\"\<problem coeff infinite hermite\>\""}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"coeff", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NumCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NumRecp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"coeff", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
             "nf"}], "]"}], "*", "#"}], ",", "nf"}], "]"}], "&"}], "/@", 
       RowBox[{"Rest", "[", 
        RowBox[{
        "coeff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff1stkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"\[Omega]", "=", 
         RowBox[{"PiecePlus", "[", 
          RowBox[{"x", ",", "\[Omega]", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"coeff", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"Length", "[", "diff1stkind", "]"}]}], 
               "\[RightDoubleBracket]"}], ".", "diff1stkind", ".", 
              RowBox[{
              "fromEtaBar", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
             "fromEtaBar", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "}"}], ",", "nf"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"coeff", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"coeff", ",", 
           RowBox[{"Length", "[", "diff1stkind", "]"}]}], "]"}]}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "diff2ndkind", "]"}], ">", "0"}], ",", "\n", 
       "\t\t", 
       RowBox[{
        RowBox[{"rem2part", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PolyNormalizeFraction", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{
                "fromEtaBar", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", "x", ",", "nf", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"diff2ndkind", ".", 
            RowBox[{
            "fromEtaBar", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"rem2part", "=", 
         RowBox[{
          RowBox[{"coeff", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", 
            RowBox[{"Length", "[", "diff2ndkind", "]"}]}], 
           "\[RightDoubleBracket]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Int2ndKindPiece", "/@", "rem2part"}], ")"}]}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"coeff", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"coeff", ",", 
           RowBox[{"Length", "[", "diff2ndkind", "]"}]}], "]"}]}], ";"}]}], 
      "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"ratpart", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"x", ",", "ratpart", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"coeff", ".", "mat2"}], ",", "1"}], "}"}], ",", "nf"}], 
       "]"}]}], ";", "\n", "\t", 
     RowBox[{"rempart", "=", "\[Omega]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ratpart: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "ratpart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "ratpart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"ratpart", ",", "ff"}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<rem2part: \>\"", ",", "rem2part"}], "]"}], ";", "\n", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand after infinite hermite reduction: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "rempart", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "rempart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"PrintFunction", "[", 
        RowBox[{"rempart", ",", "ff"}], "]"}]}], "]"}], ";", "\n", "\n", "\n",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "compute", " ", "the", " ", "log", " ", "terms", " ", "for",
        " ", "integrand", " ", 
       RowBox[{"omega", ".", " ", "this"}], " ", "can", " ", "fail", " ", 
       "so", " ", "the", " ", "remaining", " ", "unintegrated", " ", 
       "portion", " ", "is", " ", "stored", " ", "in", " ", "rempart"}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<integrand: \>\"", ",", 
       RowBox[{"1", "/", 
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ",", "\"\<*\>\"", ",", 
       RowBox[{
       "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\"\<  \>\"", ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "*", 
         RowBox[{
          RowBox[{
          "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ".", "ibasis"}]}], "]"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", "n"}], "]"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<everything done\>\"", "]"}]}], "]"}], ";", 
     "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{"functions", " ", "that", " ", "captures", " ", "residues"}], 
      " ", "*)"}], "\n", "\t", 
     RowBox[{"cap\[Phi]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\[Omega]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Phi]", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"x", ",", "cap\[Phi]", ",", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"x", ",", 
          RowBox[{
          "iprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
           RowBox[{"-", "z"}], "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "\[Omega]", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ",", "nf"}], 
         "]"}], ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Infinity]", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PolyCollect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"x", "^", 
             RowBox[{"(", 
              RowBox[{"1", "+", "irord", "-", 
               RowBox[{"Exponent", "[", 
                RowBox[{
                 RowBox[{
                 "\[Omega]", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ")"}]}]}], "/.", 
           RowBox[{"x", "\[Rule]", 
            RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], "]"}],
         ",", "1"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"cap\[Infinity]", "=", 
      RowBox[{"PiecePlus", "[", 
       RowBox[{"\[Xi]", ",", "cap\[Infinity]", ",", 
        RowBox[{"MakeBaseElement", "[", 
         RowBox[{"\[Xi]", ",", 
          RowBox[{
          "iprod", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "*", 
              RowBox[{
              "\[Omega]", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "*", 
              RowBox[{"x", "^", 
               RowBox[{"(", 
                RowBox[{"-", 
                 RowBox[{"Exponent", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Omega]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "x"}], "]"}]}], ")"}]}]}],
              "/.", 
             RowBox[{"x", "\[Rule]", 
              RowBox[{"1", "/", "\[Xi]"}]}]}], ",", "\[Xi]", ",", "nf"}], 
           "]"}], ",", "nf"}], "]"}], ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"cap", "=", 
      RowBox[{"{", 
       RowBox[{"cap\[Phi]", ",", "cap\[Infinity]"}], "}"}]}], ";", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"TimePrint", "[", 
        RowBox[{"\"\<cap finite: \>\"", ",", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{
           "cap\[Phi]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}], ",", "\"\< * \>\"", ",", 
         RowBox[{
          RowBox[{
          "cap\[Phi]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"TimePrint", "[", 
        RowBox[{"\"\<cap infinite: \>\"", ",", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{
           "cap\[Infinity]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}], ",", "\"\< * \>\"", ",", 
         RowBox[{
          RowBox[{
          "cap\[Infinity]", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"z", "\[Rule]", "#"}]}]}], "]"}], ";"}], "*)"}], "\n", "\n",
      "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "interpolate", " ", "polynomials", " ", "that", " ", "captures", " ", 
       "residues"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"res\[Phi]", "=", 
      RowBox[{"PolyGaussJordanReduce", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pp", "===", "0"}], ",", "1", ",", 
            RowBox[{"pp", "<", 
             RowBox[{"n", "+", "1"}]}], ",", 
            RowBox[{"zz", "^", "pp"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"PieceNorm", "[", 
              RowBox[{"x", ",", 
               RowBox[{
               "iprod", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"cap\[Phi]", "/.", 
                RowBox[{"z", "\[Rule]", "zz"}]}], ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", "0", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "\n", "\t", ",", "x", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Phi]", "=", 
      RowBox[{"PolyNormalizeVector", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res\[Phi]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"n", "+", "2"}]}], "\[RightDoubleBracket]"}], "/", 
             RowBox[{"res\[Phi]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            "x", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "x", ",", 
        "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Infinity]", "=", 
      RowBox[{"PolyGaussJordanReduce", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pp", "===", "0"}], ",", "1", ",", 
            RowBox[{"pp", "<", 
             RowBox[{"n", "+", "1"}]}], ",", 
            RowBox[{"zz", "^", "pp"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"PieceNorm", "[", 
              RowBox[{"\[Xi]", ",", 
               RowBox[{
               "iprod", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"cap\[Infinity]", "/.", 
                RowBox[{"z", "\[Rule]", "zz"}]}], ",", "nf"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"zz", ",", "0", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pp", ",", "0", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "\n", "\t", ",", 
        "\[Xi]", ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"res\[Infinity]", "=", 
      RowBox[{"PolyNormalizeVector", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PolyCollect", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"res\[Infinity]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"n", "+", "2"}]}], "\[RightDoubleBracket]"}], "/", 
             RowBox[{"res\[Infinity]", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"i", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            "\[Xi]", ",", "nf"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "\[Xi]", 
        ",", "nf"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues finite: \>\"", ",", 
       RowBox[{"res\[Phi]", ".", 
        RowBox[{"#", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}]}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues infinite: \>\"", ",", 
       RowBox[{"res\[Infinity]", ".", 
        RowBox[{"#", "^", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "n"}], "]"}]}]}]}], "]"}], ";", "\n", "\n", "\t", 
     
     RowBox[{"BR", "=", 
      RowBox[{"RES", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "isf", "]"}], ",", "2"}], "}"}]}], 
        "]"}]}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "\[Omega]", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ",", "1"}], "}"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"r", ">", "1"}], ",", 
           RowBox[{"IdealPlus", "[", 
            RowBox[{"x", ",", 
             RowBox[{"BR", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"isf", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", "nf"}],
             "]"}], ",", 
           RowBox[{"IdealMakePrimeTo", "[", 
            RowBox[{"x", ",", 
             RowBox[{
             "iprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"BR", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "idiff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", "nf"}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"BR", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"isf", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{
         "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"DivisorNorm", "[", 
          RowBox[{
           RowBox[{
           "BR", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf"}], "]"}]}], ";", 
        RowBox[{"assert", "[", 
         RowBox[{
          RowBox[{"RES", "\[LeftDoubleBracket]", 
           RowBox[{"r", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], "===",
           "1", "===", 
          RowBox[{"RES", "\[LeftDoubleBracket]", 
           RowBox[{"r", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
         "]"}], ";", "\n", "\t\t", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TimePrint", "[", 
           RowBox[{
           "\"\<BR\[LeftDoubleBracket]\>\"", ",", "r", ",", 
            "\"\<\[RightDoubleBracket]: \>\"", ",", 
            RowBox[{"DivisorPrint", "[", 
             RowBox[{
             "BR", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
             "]"}], ",", "\"\< , norm of B\[LeftDoubleBracket]\>\"", ",", "r",
             ",", "\"\<\[RightDoubleBracket]: \>\"", ",", 
            RowBox[{"Factor", "[", 
             RowBox[{
             "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], 
             "]"}]}], "]"}], ";"}], "*)"}], "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"res\[Phi]", ".", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "/", "r"}], ")"}], "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "n"}], "]"}]}]}], ",", 
             RowBox[{"PolyMakeSquareFree", "[", 
              RowBox[{
               RowBox[{"RES", "\[LeftDoubleBracket]", 
                RowBox[{"r", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", "x", ",", "nf"}], "]"}], ",", "x"}], "]"}], ",", "z", ",",
            "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyRemoveCommonFactors", "[", 
          RowBox[{
           RowBox[{"PolyMakeSquareFree", "[", 
            RowBox[{
             RowBox[{"RES", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", "z", 
             ",", "nf"}], "]"}], ",", "z", ",", "z", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyCollect", "[", 
          RowBox[{
           RowBox[{"Resultant", "[", 
            RowBox[{
             RowBox[{"res\[Infinity]", ".", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", "/", "r"}], ")"}], "^", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "n"}], "]"}]}]}], ",", 
             RowBox[{"PolyMakeSquareFree", "[", 
              RowBox[{
               RowBox[{"RES", "\[LeftDoubleBracket]", 
                RowBox[{"r", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
               ",", "\[Xi]", ",", "nf"}], "]"}], ",", "\[Xi]"}], "]"}], ",", 
           "z", ",", "nf"}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{
         RowBox[{"RES", "\[LeftDoubleBracket]", 
          RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"PolyRemoveCommonFactors", "[", 
          RowBox[{
           RowBox[{"PolyMakeSquareFree", "[", 
            RowBox[{
             RowBox[{"RES", "\[LeftDoubleBracket]", 
              RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", "z", 
             ",", "nf"}], "]"}], ",", "z", ",", "z", ",", "nf"}], "]"}]}], 
        ";", "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{
         "\"\<residues from ramification index \>\"", ",", "r", ",", 
          "\"\<: \>\"", ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
             "RES", "\[LeftDoubleBracket]", "r", "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"z", "\[Rule]", "#"}]}], "]"}], "&"}]}], "]"}], ";"}], 
       "\n", "\t", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "1", ",", 
         RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"next", " ", "get", " ", "a", " ", "Q"}], "-", 
       RowBox[{"basis", " ", "for", " ", "the", " ", "Q"}], "-", 
       RowBox[{"span", " ", "of", " ", "the", " ", "residues"}]}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z"}], "]"}], "===", 
        "0"}], ",", 
       RowBox[{"Goto", "[", "\"\<no poles\>\"", "]"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nf2", ",", "roots", ",", "ext"}], "}"}], "=", 
      RowBox[{"NumExtendSplit", "[", 
       RowBox[{
        RowBox[{"Times", "@@", 
         RowBox[{"Flatten", "[", "RES", "]"}]}], ",", "z", ",", "nf", ",", 
        "\[Theta]2"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ext", ",", 
       RowBox[{
        RowBox[{"PolyFactor", "[", 
         RowBox[{
          RowBox[{
          "nf2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          
          RowBox[{
          "nf2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
          "nf"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ";", 
     "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<roots: \>\"", ",", "roots"}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<nf2: \>\"", ",", "nf2"}], "]"}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<ext: \>\"", ",", "ext"}], "]"}], ";", "\n", "\t", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rmat", ",", "rbasis"}], "}"}], "=", 
      RowBox[{"NumQBasis", "[", 
       RowBox[{"roots", ",", "nf2"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"TimePrint", "[", 
      RowBox[{"\"\<residues: \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "roots", "}"}], "]"}], "]"}], ",", "\"\< = \>\"", ",", 
       RowBox[{"MatrixForm", "[", "rmat", "]"}], ",", "\"\< . \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "rbasis", "}"}], "]"}], "]"}]}], "]"}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Goto", "[", "\"\<everything done\>\"", "]"}], ";"}], "*)"}], 
     "\n", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "combine", " ", "divisors", " ", "and", " ", "test", " ", "if", " ", 
       "they", " ", "are", " ", "torsion"}], " ", "*)"}], "\n", "\t", 
     RowBox[{"rempart", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "/.", 
         RowBox[{
         "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",",
         "x", ",", "nf2"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"nprod", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"iprod", "/.", 
         RowBox[{
         "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf2"}], "]"}]}], ";", "\n",
      "\t", 
     RowBox[{"nd", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"id", "/.", 
         RowBox[{
         "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf2"}], "]"}]}], ";", "\n",
      "\t", 
     RowBox[{"nBR", "=", 
      RowBox[{"PolyCollect", "[", 
       RowBox[{
        RowBox[{"BR", "/.", 
         RowBox[{
         "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",",
         "x", ",", "nf2"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Do", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<***** looking at residue basis element \>\"", ",", 
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\"\< *****\>\""}], "]"}], ";", "\n", "\t\t", 
        RowBox[{"div", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}]}], 
          "}"}]}], ";", "\n", "\t\t", 
        RowBox[{"Do", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"IdentityMatrix", "[", "n", "]"}], ",", "1"}], 
               "}"}]}], "}"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"Do", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "ext", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "roots", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/", "r"}]}]}], "}"}]}], ",", 
                 "x", ",", "nf2"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"nBR", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"nBR", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipal", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    "nprod", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "nf2"}], "]"}], ",", 
                   "nf2"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"PolyCollect", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "cap", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "ext", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "roots", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "/", "r"}]}]}], "}"}]}], ",", 
                 "\[Xi]", ",", "nf2"}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
               "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"\[Delta]rz", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
                 RowBox[{"nBR", "\[LeftDoubleBracket]", 
                  RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"IdealPlus", "[", 
                  RowBox[{"\[Xi]", ",", 
                   RowBox[{"nBR", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IdealMakePrincipalLocal", "[", 
                    RowBox[{"\[Xi]", ",", 
                    RowBox[{
                    "nprod", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "\[Delta]rz", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "nf2"}], "]"}], ",", 
                   "nf2"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
              RowBox[{"\[Delta]z", "=", 
               RowBox[{"DivisorTimes", "[", 
                RowBox[{"\[Delta]z", ",", "\[Delta]rz", ",", 
                 RowBox[{"iprod", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                   "ext", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf2"}], "]"}]}], 
              ";"}], "\n", "\t\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "1", ",", 
               RowBox[{"Length", "[", "isf", "]"}]}], "}"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<\[Delta]z: \>\"", ",", 
             RowBox[{"DivisorPrint", "[", "\[Delta]z", "]"}]}], "]"}], ";", 
           "\n", "\t\t\t", 
           RowBox[{"\[Delta]z", "=", 
            RowBox[{"DivisorPower", "[", 
             RowBox[{"\[Delta]z", ",", 
              RowBox[{"rmat", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
              "nprod", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf2"}], "]"}]}], ";",
            "\n", "\t\t\t", 
           RowBox[{"div", "=", 
            RowBox[{"DivisorTimes", "[", 
             RowBox[{"div", ",", "\[Delta]z", ",", "nprod", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf2"}], "]"}]}], 
           ";"}], "\n", "\t\t", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "roots", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", "\t\t", 
        RowBox[{"TimePrint", "[", 
         RowBox[{"\"\<divisor \[Delta][\>\"", ",", 
          RowBox[{
          "rbasis", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\"\<]: \>\"", ",", 
          RowBox[{"DivisorPrint", "[", "div", "]"}]}], "]"}], ";", "\n", 
        "\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"succ", ",", "fpiece", ",", "idealk"}], "}"}], "=", 
         RowBox[{"DivisorIsTorsion", "[", 
          RowBox[{"div", ",", "nprod", ",", "irord", ",", 
           RowBox[{"ibadred", "/.", 
            RowBox[{
            "ext", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "\[Xi]"}], "}"}], ",", "nf2"}], "]"}]}], ";", 
        "\n", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{"succ", ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"logpart", "+=", 
            RowBox[{"LogPiece", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "rbasis", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], "/", "idealk"}], ",", "fpiece", 
              ",", "nf2", ",", "ext"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDiff", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "nprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
              "nd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "fpiece", ",", "nf2"}], "]"}]}], ";", "\n", "\t\t\t", 
           RowBox[{"flogd", "=", 
            RowBox[{"PieceDivide", "[", 
             RowBox[{"x", ",", 
              RowBox[{
              "nprod", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               ",", "flogd", ",", "fpiece", ",", "nf2"}], "]"}]}], ";", "\n", 
           "\t\t\t", 
           RowBox[{"rempart", "=", 
            RowBox[{"PieceMulAdd", "[", 
             RowBox[{"x", ",", "rempart", ",", "flogd", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                "rbasis", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "/", "idealk"}], ",", "nf2"}], 
             "]"}]}]}], "\n", "\t\t", ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<divisor not torsion\>\"", "]"}], 
           ";"}]}], "\n", "\t\t\t", "\n", "\t\t", "]"}], ";"}], "\n", "\t", 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "rbasis", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "rempart", " ", "should", " ", "have", " ", "no", " ", "poles", " ", 
       "and", " ", "be", " ", "defined", " ", "over", " ", "nf0"}], " ", 
      "*)"}], "\n", "\t", 
     RowBox[{"(*", "\n", "\t", 
      RowBox[{
       RowBox[{"rempart", "=", 
        RowBox[{"PolyNumReduce", "[", 
         RowBox[{"rempart", ",", "x", ",", "nf", ",", "nf2", ",", "ext"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"assert", "[", 
        RowBox[{
         RowBox[{"rempart", "=!=", "$Failed"}], ",", 
         "\"\<remainder is not defined over nf0\>\""}], "]"}], ";"}], "*)"}], 
     "\n", "\n", "\n", 
     RowBox[{"Label", "[", "\"\<no poles\>\"", "]"}], ";", "\n", "\n", 
     RowBox[{"Label", "[", "\"\<everything done\>\"", "]"}], ";", "\n", "\t", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Piece", "[", "ratpart", "]"}], "+", "rem2part", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{
              RowBox[{
              "ext", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", "\[Theta]2"}], "]"}], "<", "2"}], ",", "logpart", ",", 
           RowBox[{"RootEvaluate", "[", 
            RowBox[{
             RowBox[{
             "ext", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "logpart"}], "]"}]}], "]"}], "+", 
         RowBox[{"IntPiece", "[", "rempart", "]"}]}], "/.", 
        RowBox[{"{", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Piece", "[", "expr_", "]"}], "\[RuleDelayed]", 
           RowBox[{"PrintFunction", "[", 
            RowBox[{"expr", ",", "ff"}], "]"}]}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"LogPiece", "[", 
            RowBox[{"fact_", ",", "expr_", ",", "a_", ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"ConstFuncPrintExt", "[", 
             RowBox[{"fact", ",", "ff", ",", "a", ",", "b"}], "]"}], "*", 
            RowBox[{"Log", "[", 
             RowBox[{"FuncPrintExt", "[", 
              RowBox[{"expr", ",", "ff", ",", "a", ",", "b"}], "]"}], 
             "]"}]}]}], ",", "\n", "\t\t", 
          RowBox[{
           RowBox[{"Int2ndKindPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
           RowBox[{"Int2ndKind", "[", 
            RowBox[{"PrintFunction", "[", 
             RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}], ",", "\n", "\t\t", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"IntPiece", "[", "expr_", "]"}], "\[RuleDelayed]", 
             RowBox[{"Int", "[", 
              RowBox[{"PrintFunction", "[", 
               RowBox[{"expr", ",", "ff"}], "]"}], "]"}]}], ","}], "*)"}], 
          "\n", "\t\t", 
          RowBox[{"0", "\[Rule]", "0"}]}], "\n", "\t", "}"}]}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Theta]2", "\[Rule]", "#"}], "}"}]}]}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.664212532872252*^9, 3.664212534137127*^9}, {
   3.664212606041318*^9, 3.664212635898057*^9}, {3.664212673570942*^9, 
   3.664212796651765*^9}, {3.664212980171906*^9, 3.664212984740302*^9}, {
   3.664213024538394*^9, 3.6642130261080103`*^9}, {3.6642131064047728`*^9, 
   3.664213107777946*^9}, {3.664213150332472*^9, 3.664213153627995*^9}, {
   3.664213237332255*^9, 3.664213616328086*^9}, {3.66421365695045*^9, 
   3.664213767927772*^9}, 3.664213916190226*^9, {3.6642139585182056`*^9, 
   3.664214050668518*^9}, {3.664214200793009*^9, 3.6642142112026777`*^9}, {
   3.664214313316427*^9, 3.664214427682917*^9}, {3.6642179942693*^9, 
   3.664218010504815*^9}, {3.664219366389348*^9, 3.6642193835637503`*^9}, {
   3.664219664324823*^9, 3.664219667613105*^9}, {3.664219787305357*^9, 
   3.664219790516656*^9}, {3.6642212066471357`*^9, 3.664221223164415*^9}, {
   3.664226079262866*^9, 3.6642260983578663`*^9}, {3.664226146286866*^9, 
   3.664226156496866*^9}, {3.664227406963628*^9, 3.6642274203478274`*^9}, {
   3.664227617050002*^9, 3.664227620520002*^9}, {3.6642284248058863`*^9, 
   3.6642284252798862`*^9}, {3.66422873105949*^9, 3.66422873261942*^9}, {
   3.6642288189459467`*^9, 3.6642288258720355`*^9}, {3.6642290253301573`*^9, 
   3.664229056100157*^9}, {3.664229170633157*^9, 3.664229174185157*^9}, {
   3.664229434047418*^9, 3.664229464954418*^9}, {3.664229495348418*^9, 
   3.664229495513418*^9}, {3.6642298627589693`*^9, 3.6642299040503163`*^9}, {
   3.66422997683665*^9, 3.6642299866642094`*^9}, {3.664230045099187*^9, 
   3.6642300709160285`*^9}, {3.6642301253731847`*^9, 
   3.6642301370258617`*^9}, {3.664230168286859*^9, 3.66423016870804*^9}, {
   3.6642304852334366`*^9, 3.664230489772833*^9}, {3.6643177782313747`*^9, 
   3.6643177832699485`*^9}, {3.664326076212344*^9, 3.664326119079221*^9}, {
   3.664326153304085*^9, 3.6643261674214516`*^9}, {3.6643262113022823`*^9, 
   3.66432621403216*^9}, {3.664326406028344*^9, 3.6643266552583604`*^9}, {
   3.664326713630941*^9, 3.664326948416005*^9}, {3.664327026802488*^9, 
   3.664327102006713*^9}, {3.6643271572282352`*^9, 3.664327183653449*^9}, {
   3.6643272138224955`*^9, 3.6643272425720053`*^9}, {3.6643277182414603`*^9, 
   3.6643277915581703`*^9}, {3.6643278275457554`*^9, 
   3.6643278679479427`*^9}, {3.664327910050453*^9, 3.664328039228256*^9}, {
   3.664328074654267*^9, 3.664328153071948*^9}, {3.6643284247302785`*^9, 
   3.664328503411089*^9}, {3.6643285550175915`*^9, 3.664328585289039*^9}, {
   3.6643286367395835`*^9, 3.6643287140642843`*^9}, {3.6643288248419905`*^9, 
   3.6643289054997654`*^9}, {3.664328967595802*^9, 3.6643289680013523`*^9}, {
   3.664329659049317*^9, 3.664329680014776*^9}, {3.6643298460069275`*^9, 
   3.6643302196257615`*^9}, {3.6643303408479223`*^9, 
   3.6643303812969065`*^9}, {3.664330413244273*^9, 3.6643304294831443`*^9}, {
   3.664330508992777*^9, 3.664330521908997*^9}, {3.6643305828242636`*^9, 
   3.6643307045456014`*^9}, {3.664330857652731*^9, 3.664330863892451*^9}, {
   3.664330918926781*^9, 3.6643309196755476`*^9}, {3.664330957129467*^9, 
   3.6643309651163087`*^9}, {3.6643311090822487`*^9, 3.664331117583867*^9}, {
   3.664331218355345*^9, 3.6643312191353097`*^9}, {3.6643314559014854`*^9, 
   3.6643314585845647`*^9}, {3.6643316421571274`*^9, 
   3.6643317057710724`*^9}, {3.664331798384117*^9, 3.6643318450104246`*^9}, {
   3.6643319260019903`*^9, 3.6643320081947017`*^9}, {3.664332236272067*^9, 
   3.664332285409862*^9}, {3.6643324268175163`*^9, 3.664332665689597*^9}, {
   3.664332698104943*^9, 3.6643327310506644`*^9}, {3.664332783620305*^9, 
   3.664332806551276*^9}, {3.6643328394190016`*^9, 3.664332894983708*^9}, {
   3.6643333767889605`*^9, 3.6643334246320143`*^9}, {3.664333533312337*^9, 
   3.6643335553350973`*^9}, {3.664333613445097*^9, 3.664333623898097*^9}, {
   3.664333709004097*^9, 3.664333783574097*^9}, {3.6643340549224424`*^9, 
   3.6643340934995117`*^9}, 3.664334292842966*^9, {3.664334340701618*^9, 
   3.664334372960971*^9}, {3.6643344647316527`*^9, 3.664334537112405*^9}, {
   3.6643346467910833`*^9, 3.664334650066936*^9}, {3.664334752179954*^9, 
   3.664334765033777*^9}, {3.6643348035328493`*^9, 3.664334804328414*^9}, {
   3.6643348657272587`*^9, 3.664334867833164*^9}, {3.664334899016165*^9, 
   3.6643349425226126`*^9}, {3.664334978650591*^9, 3.6643350512029357`*^9}, {
   3.664335118669908*^9, 3.6643351250344224`*^9}, {3.6643351725342913`*^9, 
   3.66433520331171*^9}, {3.6643352379109573`*^9, 3.6643352388001175`*^9}, {
   3.6643352907457867`*^9, 3.664335293850047*^9}, {3.664335566510212*^9, 
   3.664335611670185*^9}, {3.66433606972803*^9, 3.6643362009181433`*^9}, {
   3.664336315962981*^9, 3.6643363257281427`*^9}, {3.664336445327976*^9, 
   3.6643364458427525`*^9}, {3.664336583756164*^9, 3.664336641398325*^9}, {
   3.664336677876667*^9, 3.664336704482931*^9}, {3.664336747261936*^9, 
   3.664336747480276*^9}, {3.664336788372202*^9, 3.6643368542952256`*^9}, {
   3.6643368843949265`*^9, 3.664336885049946*^9}, {3.6643369315942907`*^9, 
   3.6643369543517723`*^9}, {3.6643370349934325`*^9, 
   3.6643370457716503`*^9}, {3.6643370957944365`*^9, 3.664337191753648*^9}, {
   3.664337296780368*^9, 3.6643373242966514`*^9}, {3.6643373745091887`*^9, 
   3.6643373894840364`*^9}, {3.6643374738735447`*^9, 
   3.6643376821681013`*^9}, {3.66433776626285*^9, 3.664337883584937*^9}, {
   3.6643379531734147`*^9, 3.6643380736312094`*^9}, {3.6643381041746387`*^9, 
   3.6643382091891265`*^9}, {3.664338347289729*^9, 3.6643383592231936`*^9}, {
   3.6643383919661245`*^9, 3.664338446626072*^9}, 3.664338519849186*^9, {
   3.66433858683258*^9, 3.6643385954433937`*^9}, {3.664338653379194*^9, 
   3.664338698944749*^9}, {3.6643387314380913`*^9, 3.664339021101493*^9}, {
   3.66433905970976*^9, 3.66433916045004*^9}, {3.664339603267369*^9, 
   3.66433962886582*^9}, 3.664339732601165*^9, {3.6643401613947234`*^9, 
   3.664340166308503*^9}, 3.6643404370499535`*^9, 3.66434047523704*^9, {
   3.664340525248396*^9, 3.664340532174485*^9}, {3.664340599969043*^9, 
   3.66434060895424*^9}, {3.6643406537710285`*^9, 3.664340677045184*^9}, {
   3.6643407493323402`*^9, 3.6643409496273527`*^9}, {3.664340981652715*^9, 
   3.6643410006370635`*^9}, {3.6643410406648674`*^9, 
   3.6643411137475877`*^9}, {3.664341160779477*^9, 3.664341226343335*^9}, {
   3.6643412660591526`*^9, 3.6643412817676477`*^9}, {3.6643413998855476`*^9, 
   3.664341431552127*^9}, {3.6643416447945576`*^9, 3.6643416845571733`*^9}, {
   3.6643417261137085`*^9, 3.6643417420249944`*^9}, {3.6643417750955105`*^9, 
   3.6643418366503487`*^9}, {3.664341899187942*^9, 3.6643418992971373`*^9}, {
   3.6643420303156576`*^9, 3.664342125081405*^9}, {3.6643428494972982`*^9, 
   3.6643429279617767`*^9}, {3.6643450279009733`*^9, 
   3.6643450336557865`*^9}, {3.6643451731555243`*^9, 
   3.6643452709861803`*^9}, {3.664345622203965*^9, 3.6643458357703342`*^9}, {
   3.6643465518697834`*^9, 3.664346569855776*^9}, {3.66434662348617*^9, 
   3.664346847492118*^9}, {3.6643469277817144`*^9, 3.6643469843915744`*^9}, {
   3.66434705535279*^9, 3.66434717435985*^9}, {3.6643473695070925`*^9, 
   3.664347381487355*^9}, {3.664347424900207*^9, 3.6643474307499447`*^9}, 
   3.6643477789107213`*^9, {3.664347852414623*^9, 3.6643479188988395`*^9}, {
   3.664347972778822*^9, 3.664348000264788*^9}, {3.6643480341464677`*^9, 
   3.664348037749906*^9}, {3.6643483279748826`*^9, 3.6643483334658365`*^9}, {
   3.6643486438451085`*^9, 3.664348663375432*^9}, {3.6643498146349707`*^9, 
   3.664349826100456*^9}, {3.6643498588433867`*^9, 3.6643498610740867`*^9}, {
   3.6643757690161266`*^9, 3.6643757703341265`*^9}, {3.6643759686961775`*^9, 
   3.6643759824391603`*^9}, {3.6643760733206825`*^9, 3.664376083444628*^9}, {
   3.6643766283437767`*^9, 3.664376643880679*^9}, {3.6643766815841875`*^9, 
   3.664377077612928*^9}, {3.6643771549854555`*^9, 3.6643772545869865`*^9}, {
   3.664377303272402*^9, 3.664377321882366*^9}, {3.664377621576118*^9, 
   3.664377669910857*^9}, {3.6643784206024437`*^9, 3.6643786065149016`*^9}, {
   3.664378645263563*^9, 3.664378683481848*^9}, {3.6643787269258986`*^9, 
   3.6643787757985053`*^9}, {3.6643788182598*^9, 3.6643788941503944`*^9}, {
   3.66437899346207*^9, 3.6643790368084106`*^9}, {3.6643790691875763`*^9, 
   3.6643790881780653`*^9}, {3.6643791324721327`*^9, 3.664379150345394*^9}, {
   3.6643792641997137`*^9, 3.664379333997941*^9}, {3.664379376377523*^9, 
   3.664379627762089*^9}, {3.664379658135396*^9, 3.6643797377736797`*^9}, {
   3.6643797728147697`*^9, 3.664379776755887*^9}, {3.664379808314254*^9, 
   3.6643801182673388`*^9}, 3.664380411370533*^9, {3.664380448339326*^9, 
   3.664380462606845*^9}, {3.664383760702175*^9, 3.664383858917156*^9}, {
   3.664383896962658*^9, 3.664383924080016*^9}, {3.664384211934972*^9, 
   3.664384212105555*^9}, {3.66438436031212*^9, 3.664384365252325*^9}, {
   3.664384397459055*^9, 3.6643843975947638`*^9}, {3.664384640170249*^9, 
   3.6643846443418503`*^9}, {3.664384734260508*^9, 3.6643849106069517`*^9}, {
   3.6643849767097607`*^9, 3.664385082392219*^9}, {3.664385139682694*^9, 
   3.664385300087737*^9}, {3.6643853979268103`*^9, 3.664385443123356*^9}, {
   3.6643854948266582`*^9, 3.6643856070534563`*^9}, {3.664386942667128*^9, 
   3.664386969395652*^9}, {3.664387006378991*^9, 3.6643870917364197`*^9}, {
   3.664387263931241*^9, 3.664387264044447*^9}, {3.664389126059265*^9, 
   3.6643891551634502`*^9}, {3.6643893173171997`*^9, 3.664389326301079*^9}, {
   3.664389835391206*^9, 3.6643898394696217`*^9}, {3.6643960326953487`*^9, 
   3.6643960577408257`*^9}, {3.6643965913813143`*^9, 3.664396606623172*^9}, {
   3.664396989969396*^9, 3.664397001291065*^9}, {3.66439703413992*^9, 
   3.664397040164289*^9}, {3.664397101694104*^9, 3.664397110083139*^9}, {
   3.6643995516362343`*^9, 3.664399552497649*^9}, {3.664399770573741*^9, 
   3.664399770751679*^9}, {3.6643999302177267`*^9, 3.6643999305382032`*^9}, {
   3.66439996232821*^9, 3.664399988753824*^9}, {3.664400217571435*^9, 
   3.664400224777541*^9}, 3.6644003184102993`*^9, {3.6644012324341917`*^9, 
   3.664401232664691*^9}, {3.664401313756671*^9, 3.664401340646018*^9}, {
   3.6644013841076593`*^9, 3.664401482782634*^9}, {3.664401550424164*^9, 
   3.66440155095263*^9}, {3.66440171265205*^9, 3.664401715834909*^9}, 
   3.664402425661371*^9, {3.6644026941977253`*^9, 3.664402874066979*^9}, 
   3.664402915316906*^9, {3.664403020086631*^9, 3.664403112821315*^9}, {
   3.664403145311193*^9, 3.664403199847135*^9}, {3.664403230750238*^9, 
   3.664403263097908*^9}, 3.664403296656249*^9, {3.6644107103867083`*^9, 
   3.6644107346280203`*^9}, {3.6644107662790003`*^9, 3.664410770412814*^9}, 
   3.664410807585946*^9, {3.6644109061267242`*^9, 3.664410906688299*^9}, {
   3.664411038486785*^9, 3.6644110489383163`*^9}, {3.6644114117156367`*^9, 
   3.6644115415330114`*^9}, {3.6644116084696074`*^9, 3.6644116138825645`*^9}, 
   3.664411693969371*^9, {3.6644117244221363`*^9, 3.664411739101136*^9}, {
   3.664411942582136*^9, 3.664412006703658*^9}, {3.6644129133436637`*^9, 
   3.6644129139364367`*^9}, {3.6644129852564363`*^9, 3.664413001105325*^9}, {
   3.664413041382718*^9, 3.6644130837816153`*^9}, {3.6644131273816586`*^9, 
   3.6644132034126472`*^9}, {3.664413334462366*^9, 3.6644133463022346`*^9}, {
   3.664413470847046*^9, 3.6644134817353573`*^9}, {3.664413576594701*^9, 
   3.664413578794202*^9}, {3.664413651455742*^9, 3.6644137192347*^9}, 
   3.664413845859901*^9, {3.6644140937816095`*^9, 3.6644141028136044`*^9}, {
   3.664414150516264*^9, 3.6644142674330173`*^9}, {3.664414363524705*^9, 
   3.6644143705755887`*^9}, {3.664414418481039*^9, 3.6644144224120626`*^9}, {
   3.664414457089307*^9, 3.6644144603027625`*^9}, 3.664414996731491*^9, {
   3.664415032219898*^9, 3.66441503284387*^9}, {3.664415213873747*^9, 
   3.6644152176019793`*^9}, {3.6644152486289873`*^9, 3.664415306081209*^9}, {
   3.6644251916161156`*^9, 3.6644252075430007`*^9}, {3.664425261407384*^9, 
   3.664425330980262*^9}, 3.6644253769825974`*^9, {3.6644254578649683`*^9, 
   3.664425460095668*^9}, {3.664425499608695*^9, 3.664425502182579*^9}, {
   3.664425572878607*^9, 3.6644256355565944`*^9}, {3.6644256805605745`*^9, 
   3.664425753440504*^9}, {3.664425945436689*^9, 3.664425945920267*^9}, 
   3.6644264153188033`*^9, {3.6644264508540087`*^9, 3.6644264577488995`*^9}, {
   3.664426551422696*^9, 3.6644265669439993`*^9}, 3.6644268087175503`*^9, {
   3.664427312403348*^9, 3.6644273134485006`*^9}, {3.664427346425421*^9, 
   3.5791013177018394`*^9}, {3.579101392644371*^9, 3.5791013988687816`*^9}, {
   3.579101446246065*^9, 3.5791014482116685`*^9}, {3.5791014790841227`*^9, 
   3.579101497913356*^9}, {3.5791015468818417`*^9, 3.579101551109449*^9}, {
   3.5791016212783723`*^9, 3.579101638235602*^9}, {3.5791017748762417`*^9, 
   3.579101953168955*^9}, {3.5791019890802183`*^9, 3.5791020738663673`*^9}, {
   3.579102338910833*^9, 3.579102393152128*^9}, {3.5791024441018176`*^9, 
   3.57910244552142*^9}, {3.5791025065643272`*^9, 3.5791025214311533`*^9}, {
   3.5791043399107475`*^9, 3.579104417052883*^9}, {3.579104531182683*^9, 
   3.5791045626791387`*^9}, {3.5791045958759966`*^9, 3.579104631350459*^9}, {
   3.5791046817541475`*^9, 3.5791047467126617`*^9}, 3.579104849875643*^9, {
   3.579104903352537*^9, 3.579104904288539*^9}, {3.5791051745902133`*^9, 
   3.5791053151308603`*^9}, {3.579105370760558*^9, 3.5791053887317896`*^9}, {
   3.579105419058243*^9, 3.579105430493063*^9}, {3.5791055073231974`*^9, 
   3.5791055226112247`*^9}, {3.57910557120531*^9, 3.5791056117341814`*^9}, {
   3.579105709546353*^9, 3.579105811976133*^9}, {3.579105856607811*^9, 
   3.579105862988222*^9}, {3.579105980487629*^9, 3.579106019659298*^9}, {
   3.579106092839026*^9, 3.5791061032754445`*^9}, {3.579106176876374*^9, 
   3.5791061785143766`*^9}, {3.579106421843604*^9, 3.5791064232788067`*^9}, {
   3.579106484274914*^9, 3.5791065150225677`*^9}, {3.5791076138692374`*^9, 
   3.579107664312126*^9}, {3.5791077211334267`*^9, 3.579107722490629*^9}, {
   3.664503247769308*^9, 3.6645032616203794`*^9}, {3.6645036302909627`*^9, 
   3.6645036683861923`*^9}, {3.6645037395845146`*^9, 3.664503739804515*^9}, {
   3.664629866262273*^9, 3.664629873358823*^9}, {3.664720573962131*^9, 
   3.664720578230155*^9}, {3.6647208633741426`*^9, 3.6647208635218678`*^9}, {
   3.664721042366081*^9, 3.579143475264558*^9}, {3.5791435233594427`*^9, 
   3.579143526526248*^9}, {3.66491768720894*^9, 3.6649177005461483`*^9}, {
   3.664919372174645*^9, 3.66491944521907*^9}, {3.6649195482031803`*^9, 
   3.664919549809482*^9}, {3.6649196617555428`*^9, 3.6649197093849173`*^9}, {
   3.664923062831766*^9, 3.5792237225545096`*^9}, 3.579223807231458*^9, {
   3.57922984547178*^9, 3.5792299406019135`*^9}, {3.5792303061324253`*^9, 
   3.5792303685325127`*^9}, {3.579230399797556*^9, 3.57923042399759*^9}, {
   3.579230461212642*^9, 3.5792304704926553`*^9}, {3.579230505897705*^9, 
   3.579230507317707*^9}, {3.5792307420181007`*^9, 3.57923075606812*^9}, {
   3.579230927998516*^9, 3.5792309478865457`*^9}, {3.5792311054944077`*^9, 
   3.5792312797448964`*^9}, {3.5792313098450336`*^9, 
   3.5792313915201535`*^9}, {3.579231439251319*^9, 3.579231456917346*^9}, {
   3.5792318921564484`*^9, 3.579231988959591*^9}, 3.5792320481136785`*^9, 
   3.579232172913862*^9, {3.5792322238779364`*^9, 3.579232244380966*^9}, {
   3.5792322865210285`*^9, 3.579232298944047*^9}, {3.5792325059433503`*^9, 
   3.5792325324963884`*^9}, {3.5792326084515*^9, 3.5792326085815*^9}, {
   3.5792326565525703`*^9, 3.5792326603025756`*^9}, {3.5792327478537045`*^9, 
   3.5792327543637133`*^9}, {3.5792328333638296`*^9, 
   3.5792329074169383`*^9}, {3.579233000379075*^9, 3.579233056257156*^9}, {
   3.579233093841211*^9, 3.5792332008523674`*^9}, {3.57923323673742*^9, 
   3.57923325055344*^9}, {3.5792333531985903`*^9, 3.579233356187596*^9}, {
   3.5792335770259185`*^9, 3.5792335772459188`*^9}, {3.5792397554574556`*^9, 
   3.579239766502275*^9}, {3.579364712455144*^9, 3.5793647640444345`*^9}, {
   3.5793687257416515`*^9, 3.579368754811692*^9}, {3.579368892981886*^9, 
   3.579368893501887*^9}, {3.5793689881870193`*^9, 3.579369072197137*^9}, {
   3.579370071958536*^9, 3.5793700850185547`*^9}, {3.5793704449790587`*^9, 
   3.579370448429064*^9}, {3.5793704907841225`*^9, 3.5793704909141235`*^9}, {
   3.57938280729539*^9, 3.5793828234102182`*^9}, {3.579382881376321*^9, 
   3.5793829720374813`*^9}, {3.579387756430097*^9, 3.579387812610796*^9}, {
   3.5793878496814613`*^9, 3.5793878517406654`*^9}, {3.5793880440752044`*^9, 
   3.579388053388421*^9}, {3.5793884485957603`*^9, 3.5793885025632553`*^9}, {
   3.5793885946170177`*^9, 3.5793885950382185`*^9}, {3.57938874684389*^9, 
   3.5793887487158937`*^9}, {3.5793889544038544`*^9, 3.579389010548353*^9}, {
   3.579389055351632*^9, 3.5793890609520416`*^9}, {3.5793891074245234`*^9, 
   3.5793891313861656`*^9}, 3.5793891883262653`*^9, {3.579389244595564*^9, 
   3.5793892674028044`*^9}, {3.5793896831591344`*^9, 
   3.5793896930183516`*^9}, {3.5793898857410903`*^9, 
   3.5793898938999047`*^9}, {3.57939072840777*^9, 3.579390765442236*^9}, 
   3.5793909777898083`*^9, {3.579391077005983*^9, 3.579391215222225*^9}, {
   3.5793913484932594`*^9, 3.579391368804495*^9}, {3.5793914127341723`*^9, 
   3.5793914453382297`*^9}, {3.579393121093173*^9, 3.579393121217973*^9}, {
   3.579393188656892*^9, 3.579393191589697*^9}, {3.665155653170054*^9, 
   3.6651556727274923`*^9}, {3.6651560002713537`*^9, 3.665156001965193*^9}, {
   3.6651589674245234`*^9, 3.665159022854332*^9}, {3.665159079341106*^9, 
   3.665159079594887*^9}, {3.665175898742531*^9, 3.665176006117669*^9}, {
   3.6651761466108522`*^9, 3.66517617448067*^9}, {3.665176215033832*^9, 
   3.6651762214801283`*^9}, {3.665176324260211*^9, 3.6651763463521967`*^9}, {
   3.665176439805685*^9, 3.665176494671886*^9}, {3.665176540715707*^9, 
   3.665176545345071*^9}, {3.6651769645154247`*^9, 3.665177073039266*^9}, {
   3.665177117927754*^9, 3.665177122068222*^9}, {3.66517716000613*^9, 
   3.665177170966887*^9}, {3.66517725772668*^9, 3.6651772831153584`*^9}, {
   3.665177368537176*^9, 3.665177369900372*^9}, {3.665177414027041*^9, 
   3.665177419107461*^9}, {3.665177570479567*^9, 3.6651775710785303`*^9}, {
   3.665177842230053*^9, 3.665178021633629*^9}, {3.665178054676456*^9, 
   3.6651780838024282`*^9}, {3.665178128396652*^9, 3.665178130312084*^9}, {
   3.665178160411717*^9, 3.665178163185104*^9}, {3.665178291773486*^9, 
   3.665178429955662*^9}, {3.66517847509582*^9, 3.665178487596607*^9}, {
   3.6651785309254303`*^9, 3.665178532154665*^9}, {3.6651796829158792`*^9, 
   3.665179725896727*^9}, {3.6651797559956713`*^9, 3.665179767238926*^9}, {
   3.6651806988191757`*^9, 3.665180718058815*^9}, {3.6651807618301783`*^9, 
   3.665180784048107*^9}, {3.665181245976635*^9, 3.665181254735407*^9}, {
   3.665181291055862*^9, 3.665181508031505*^9}, {3.6651815393371143`*^9, 
   3.579479331706009*^9}, {3.5794793901749115`*^9, 3.5794794078185425`*^9}, {
   3.57947947455546*^9, 3.579479545083184*^9}, {3.5794795812908473`*^9, 
   3.57947962261532*^9}, {3.5794796622237897`*^9, 3.579479663627792*^9}, {
   3.579481043044615*^9, 3.5794810538398337`*^9}, {3.5794812249097342`*^9, 
   3.579481237732957*^9}, {3.579481414964868*^9, 3.579481623755635*^9}, {
   3.5794816777005296`*^9, 3.5794817146569943`*^9}, {3.579482129789324*^9, 
   3.5794821439697485`*^9}, 3.579482507060386*^9, {3.5794827182223573`*^9, 
   3.579482806814913*^9}, {3.5794828410569725`*^9, 3.5794830413457246`*^9}, {
   3.5794831083322425`*^9, 3.5794832929273663`*^9}, {3.57948332350342*^9, 
   3.579483389039135*^9}, {3.579483496070923*^9, 3.579483539204999*^9}, {
   3.5794838091946735`*^9, 3.579483876181191*^9}, {3.5794844516506014`*^9, 
   3.5794846343425226`*^9}, {3.579484734307498*^9, 3.579484757520339*^9}, {
   3.579485124261383*^9, 3.579485124994584*^9}, {3.5794852007951174`*^9, 
   3.5794852944576817`*^9}, {3.579485409944685*^9, 3.5794854574623685`*^9}, {
   3.6653134899628363`*^9, 3.665313524236817*^9}, {3.6653154456770267`*^9, 
   3.665315470154439*^9}, {3.665315709748488*^9, 3.6653157318080473`*^9}, {
   3.665321492750957*^9, 3.66532149637994*^9}, {3.665321561875204*^9, 
   3.6653215791445837`*^9}, {3.665321609907619*^9, 3.665321621956912*^9}, {
   3.6653217984375668`*^9, 3.665321803579092*^9}, {3.665321841796953*^9, 
   3.665321896566659*^9}, {3.66532206659762*^9, 3.665322147249268*^9}, {
   3.665322218510642*^9, 3.665322247829217*^9}, {3.665322470755147*^9, 
   3.66532247349922*^9}, {3.665322517033276*^9, 3.665322518215*^9}, {
   3.665322561482271*^9, 3.665322740882722*^9}, 3.6653227939524612`*^9, {
   3.6653228318135767`*^9, 3.665322888216897*^9}, {3.665323029497397*^9, 
   3.665323037134194*^9}, {3.665323111403577*^9, 3.6653231414408903`*^9}, {
   3.6653232005189857`*^9, 3.665323267261189*^9}, {3.665323315486537*^9, 
   3.665323329126897*^9}, {3.665323392861702*^9, 3.665323402250762*^9}, {
   3.6653234467881813`*^9, 3.665323448028338*^9}, {3.665323511779586*^9, 
   3.665323534156535*^9}, {3.6653235865539017`*^9, 3.665323607787244*^9}, {
   3.665323738271916*^9, 3.665323743091112*^9}, {3.665323885641737*^9, 
   3.665323892112851*^9}, {3.665329081556306*^9, 3.665329113900915*^9}, {
   3.665329166611368*^9, 3.6653293028235893`*^9}, {3.665350373587636*^9, 
   3.665350390815228*^9}, {3.6653506768511467`*^9, 3.665350685323389*^9}, {
   3.6653508131047993`*^9, 3.665350888393527*^9}, {3.6653512165275106`*^9, 
   3.665351217006035*^9}, {3.665351759558442*^9, 3.665351762218141*^9}, 
   3.665351849839781*^9, 3.665353026230669*^9, {3.665353291936214*^9, 
   3.665353337669775*^9}, {3.6655971433220797`*^9, 3.665597149248451*^9}, {
   3.665597207010466*^9, 3.665597242300131*^9}, {3.665597394934321*^9, 
   3.665597401921382*^9}, {3.665597447544096*^9, 3.665597460961033*^9}, {
   3.665597594568564*^9, 3.665597623081333*^9}, {3.665597735490238*^9, 
   3.665597807316535*^9}, {3.6655978649447193`*^9, 3.665598002249653*^9}, {
   3.665598033495433*^9, 3.6655980657396717`*^9}, {3.665598109807536*^9, 
   3.6655981508259277`*^9}, {3.665598203555045*^9, 3.665598252782692*^9}, {
   3.665598356912704*^9, 3.665598361309401*^9}, {3.665598463189866*^9, 
   3.665598473122675*^9}, {3.665598621205535*^9, 3.665598621390462*^9}, {
   3.665598705250464*^9, 3.6655987176638327`*^9}, {3.665598796094378*^9, 
   3.665598797104491*^9}, {3.665598862901514*^9, 3.665598874899393*^9}, {
   3.6655989452118387`*^9, 3.66559896638507*^9}, {3.665599022034453*^9, 
   3.665599026161664*^9}, {3.665599060198173*^9, 3.665599110026639*^9}, {
   3.6655992008323812`*^9, 3.665599201190422*^9}, {3.665599248686144*^9, 
   3.665599281021172*^9}, {3.665599369176877*^9, 3.665599373286728*^9}, {
   3.665600365175962*^9, 3.66560036904633*^9}, {3.665600418370668*^9, 
   3.665600455628646*^9}, {3.6656006940784903`*^9, 3.665600772884461*^9}, {
   3.6656009120914593`*^9, 3.665600979176784*^9}, {3.6656011483079557`*^9, 
   3.665601150533061*^9}, {3.6656020132627907`*^9, 3.665602076980567*^9}, {
   3.665602329361817*^9, 3.665602395121551*^9}, {3.665602724011647*^9, 
   3.665602729507799*^9}, {3.665605393439917*^9, 3.665605395151613*^9}, {
   3.665605440207925*^9, 3.665605471825378*^9}, {3.665605761129209*^9, 
   3.665605761625153*^9}, {3.665606079106227*^9, 3.665606146049346*^9}, {
   3.665606188300271*^9, 3.6656062360626583`*^9}, {3.665606270331736*^9, 
   3.665606438443535*^9}, {3.665606736041679*^9, 3.6656068128263693`*^9}, {
   3.6656068510385113`*^9, 3.665606864860598*^9}, {3.665681652171296*^9, 
   3.665681653200533*^9}, {3.665689891694409*^9, 3.66568989319173*^9}, {
   3.6656901034428043`*^9, 3.6656901062625017`*^9}, {3.665693501677679*^9, 
   3.665693524429576*^9}, {3.665693564431335*^9, 3.6656935827419653`*^9}, {
   3.665693707051228*^9, 3.665694087999135*^9}, {3.665694268163025*^9, 
   3.665694309641535*^9}, {3.6656944009875593`*^9, 3.66569441302559*^9}, {
   3.665694498231357*^9, 3.6656945275347147`*^9}, {3.6656946416057167`*^9, 
   3.665694678564864*^9}, {3.665694905628598*^9, 3.665694912728559*^9}, {
   3.665695222459715*^9, 3.665695224843157*^9}, 3.6656986370095797`*^9, {
   3.665699088076789*^9, 3.665699241016527*^9}, {3.665699640236145*^9, 
   3.6656996407020483`*^9}, {3.665699884344429*^9, 3.665699957907641*^9}, {
   3.665700115561656*^9, 3.6657001191877413`*^9}, {3.665700155788245*^9, 
   3.6657001618574743`*^9}, {3.665700195984644*^9, 3.665700220143198*^9}, {
   3.665700366928344*^9, 3.665700732983986*^9}, 3.665700764837831*^9, {
   3.6657008113700323`*^9, 3.665700926285343*^9}, {3.665700997928211*^9, 
   3.6657009984078293`*^9}, {3.665701061681903*^9, 3.665701104486109*^9}, {
   3.6657011385226927`*^9, 3.665701190584838*^9}, {3.665701255267782*^9, 
   3.665701278409162*^9}, {3.665701342599245*^9, 3.665701481118869*^9}, {
   3.6657015385841513`*^9, 3.6657017179545383`*^9}, {3.665701769078926*^9, 
   3.665701888253008*^9}, {3.665701935443767*^9, 3.6657019597985764`*^9}, {
   3.6657020723770533`*^9, 3.665702084171494*^9}, {3.665702573867591*^9, 
   3.6657026188025417`*^9}, {3.6657026545885477`*^9, 3.665702689931941*^9}, {
   3.665702827352335*^9, 3.665702988729731*^9}, {3.6657030336834497`*^9, 
   3.6657030338029957`*^9}, {3.665703084840172*^9, 3.6657031303167877`*^9}, {
   3.6657039338444366`*^9, 3.665703985391467*^9}, 3.665704071897051*^9, {
   3.665704219384921*^9, 3.6657042650977*^9}, {3.6657062486045856`*^9, 
   3.6657062731751423`*^9}, {3.665706488680977*^9, 3.665706497846725*^9}, {
   3.665706557385262*^9, 3.6657065955420732`*^9}, {3.665706659125029*^9, 
   3.665706717827986*^9}, {3.665706833477236*^9, 3.665706852795672*^9}, {
   3.6657068998439627`*^9, 3.665706968793736*^9}, {3.665790324530241*^9, 
   3.665790352707738*^9}, {3.665865139713608*^9, 3.665865145733716*^9}, {
   3.665865658153097*^9, 3.6658656760089207`*^9}, {3.665865891892643*^9, 
   3.66586589709544*^9}, 3.665868398954199*^9, {3.665868449409255*^9, 
   3.665868453788254*^9}, {3.665868536591917*^9, 3.6658686244239483`*^9}, {
   3.665868692235895*^9, 3.665868696723549*^9}, {3.665868979992255*^9, 
   3.6658691681117353`*^9}, {3.665869391990374*^9, 3.665869392609748*^9}, {
   3.665869451986679*^9, 3.665869647855419*^9}, {3.665869678615595*^9, 
   3.6658696797772007`*^9}, {3.665869953631968*^9, 3.6658700967795353`*^9}, {
   3.665870134912058*^9, 3.6658701354876633`*^9}, {3.66587030179252*^9, 
   3.665870306276498*^9}, {3.665870368194807*^9, 3.665870412684149*^9}, {
   3.6658704451696253`*^9, 3.665870445558105*^9}, {3.665870610745554*^9, 
   3.665870614829775*^9}, {3.6658706749717607`*^9, 3.6658707062470303`*^9}, {
   3.665870784696785*^9, 3.665870807466365*^9}, {3.6658708963128653`*^9, 
   3.66587091203292*^9}, {3.6658715841140833`*^9, 3.665871594328886*^9}, {
   3.665871629434697*^9, 3.665871631133875*^9}, {3.665871853516376*^9, 
   3.6658718704438*^9}, {3.665871918495844*^9, 3.6658719871520767`*^9}, {
   3.665872082273636*^9, 3.665872137330187*^9}, {3.6658730781544237`*^9, 
   3.665873119959405*^9}, {3.665873437520224*^9, 3.6658735668223124`*^9}, {
   3.665873894973858*^9, 3.6658739475112343`*^9}, {3.665874144644248*^9, 
   3.665874147235568*^9}, {3.665874187191638*^9, 3.665874230107746*^9}, {
   3.665874276303273*^9, 3.665874297614599*^9}, {3.665874512402281*^9, 
   3.665874597354937*^9}, {3.6658746286177053`*^9, 3.665874632480824*^9}, {
   3.66587492581561*^9, 3.665874954181077*^9}, 3.665875001073769*^9, {
   3.6658755974594193`*^9, 3.665875625617578*^9}, {3.665876299531551*^9, 
   3.665876300332575*^9}, {3.665877916978876*^9, 3.665877919028028*^9}, {
   3.665877954220109*^9, 3.665878133230411*^9}, {3.665878258128646*^9, 
   3.665878263798297*^9}, {3.665878706574479*^9, 3.6658787083177423`*^9}, {
   3.665882011409841*^9, 3.6658820127864227`*^9}, {3.665882752570901*^9, 
   3.66588276097088*^9}, {3.665883580315637*^9, 3.665883581696229*^9}, {
   3.665883636681488*^9, 3.6658836865725183`*^9}, {3.665883969869603*^9, 
   3.665884095174905*^9}, {3.665884155071184*^9, 3.665884155871152*^9}, {
   3.665884228883156*^9, 3.665884355434701*^9}, {3.665884472895742*^9, 
   3.665884533073042*^9}, {3.6658848850188932`*^9, 3.6658849125626497`*^9}, {
   3.665884944332057*^9, 3.665884957080426*^9}, {3.665885015237363*^9, 
   3.6658850608334923`*^9}, {3.665885097241433*^9, 3.6658851881491737`*^9}, {
   3.6658853128573914`*^9, 3.665885335274982*^9}, {3.665887137448464*^9, 
   3.665887168959024*^9}, {3.665887251379233*^9, 3.665887342512764*^9}, {
   3.665887835473682*^9, 3.6658878356560497`*^9}, {3.6658924989186153`*^9, 
   3.665892507350218*^9}, {3.665892578367231*^9, 3.665892631584573*^9}, {
   3.66589268300835*^9, 3.665892714746752*^9}, {3.665892911778453*^9, 
   3.665892913889247*^9}, {3.665892987499146*^9, 3.665892989996941*^9}, {
   3.665893708452713*^9, 3.665893709763442*^9}, {3.665898708634221*^9, 
   3.6658987228642063`*^9}, {3.665898761887792*^9, 3.665898780660562*^9}, {
   3.665899002450149*^9, 3.665899029529838*^9}, {3.665899479143351*^9, 
   3.665899541344997*^9}, {3.665899578215353*^9, 3.665899578961142*^9}, {
   3.665900095240148*^9, 3.665900104379044*^9}, {3.665900577006373*^9, 
   3.6659005786048603`*^9}, 3.665900623516251*^9, {3.665901077557097*^9, 
   3.665901134214118*^9}, {3.665901863613731*^9, 3.6659019457543364`*^9}, {
   3.665902521311644*^9, 3.665902599772499*^9}, {3.665902730143436*^9, 
   3.6659027419439898`*^9}, 3.6659028201822443`*^9, {3.666037150145627*^9, 
   3.666037150451673*^9}, {3.666037229488202*^9, 3.666037267535159*^9}, 
   3.666037308450042*^9, {3.666037349072899*^9, 3.666037380807584*^9}, {
   3.666037420746769*^9, 3.666037491538063*^9}, {3.666037531684462*^9, 
   3.666037576001148*^9}, {3.666037769448628*^9, 3.666037809220265*^9}, {
   3.666037904225234*^9, 3.666037935874713*^9}, 3.6660380140592623`*^9, {
   3.666038476185831*^9, 3.6660384763564043`*^9}, {3.666038935218671*^9, 
   3.666039200621087*^9}, {3.66603923268151*^9, 3.6660392949363403`*^9}, {
   3.666039349399706*^9, 3.666039401096746*^9}, {3.666039543112743*^9, 
   3.6660395480826683`*^9}, {3.66603967130055*^9, 3.6660396827510138`*^9}, {
   3.666039769824173*^9, 3.666039771458899*^9}, {3.6660398131393547`*^9, 
   3.666039814083852*^9}, {3.666039867043582*^9, 3.66603991530625*^9}, {
   3.666040066706558*^9, 3.666040075319833*^9}, {3.666040109668653*^9, 
   3.666040109925047*^9}, {3.666040219371112*^9, 3.666040361749082*^9}, {
   3.6660404127155867`*^9, 3.6660404407699947`*^9}, {3.6660405018436193`*^9, 
   3.6660405089296827`*^9}, {3.6660433346380253`*^9, 
   3.6660433386078167`*^9}, {3.66604367719058*^9, 3.666043717352191*^9}, {
   3.666043756453107*^9, 3.666043931103705*^9}, 3.6660440046829042`*^9, {
   3.666044040843101*^9, 3.666044085945198*^9}, {3.666044169481512*^9, 
   3.666044248972769*^9}, {3.666044281813225*^9, 3.666044495224635*^9}, 
   3.6660445414628897`*^9, {3.6660445831447783`*^9, 3.666044701265811*^9}, {
   3.6660447358350554`*^9, 3.666044756977395*^9}, {3.6660479505526953`*^9, 
   3.6660480841622057`*^9}, {3.666048281152564*^9, 3.666048283822213*^9}, {
   3.666048343815414*^9, 3.666048344682542*^9}, {3.666048438811541*^9, 
   3.6660484406356707`*^9}, {3.6660485616407423`*^9, 3.666048689720387*^9}, {
   3.666048752484268*^9, 3.666049015765583*^9}, {3.6660491922365627`*^9, 
   3.666049200834278*^9}, {3.66604925757692*^9, 3.666049418781931*^9}, {
   3.666049484715513*^9, 3.5803420560652266`*^9}, {3.5803429490731955`*^9, 
   3.5803429758896427`*^9}, {3.580344137202482*^9, 3.5803442110374117`*^9}, {
   3.5803442633131037`*^9, 3.580344324590011*^9}, {3.5803443595028725`*^9, 
   3.5803443718736944`*^9}, {3.5803444107021627`*^9, 3.580344417612975*^9}, {
   3.5803447347004642`*^9, 3.5803447537948976`*^9}, {3.5803447987853765`*^9, 
   3.580344807614992*^9}, {3.5803450311321845`*^9, 3.5803450612402377`*^9}, {
   3.580345318094689*^9, 3.580345319888692*^9}, {3.580345567570327*^9, 
   3.5803455684439287`*^9}, {3.5803456005643845`*^9, 
   3.5803456170068135`*^9}, {3.5803459417369843`*^9, 3.580345955496208*^9}, {
   3.580346553133258*^9, 3.5803465653948793`*^9}, {3.580346641727256*^9, 
   3.5803466522522707`*^9}, {3.5803467073023477`*^9, 
   3.5803467672124314`*^9}, {3.5803468636675663`*^9, 3.580346932532663*^9}, {
   3.580347012662775*^9, 3.5803470673378515`*^9}, {3.580347142442957*^9, 
   3.580347171882998*^9}, {3.5803472335480843`*^9, 3.580347235913088*^9}, {
   3.5803472889061956`*^9, 3.580347311856228*^9}, {3.580347542631551*^9, 
   3.580347610461646*^9}, {3.580347721766802*^9, 3.580347725466807*^9}, {
   3.5803478366869626`*^9, 3.5803478792120223`*^9}, {3.5803482799525833`*^9, 
   3.580348280742584*^9}, {3.580348410497766*^9, 3.5803484280077906`*^9}, {
   3.580348718193197*^9, 3.5803488265533485`*^9}, {3.580349356754091*^9, 
   3.580349386539132*^9}, {3.5803494810742645`*^9, 3.5803494836792684`*^9}, {
   3.58034953498434*^9, 3.5803495398593473`*^9}, {3.666101808077424*^9, 
   3.6661018144142323`*^9}, {3.6661024297856283`*^9, 
   3.6661024795395393`*^9}, {3.6661039559410267`*^9, 3.666103957516128*^9}, 
   3.6661042400265493`*^9, {3.666104414189391*^9, 3.666104536003034*^9}, {
   3.666104754476179*^9, 3.66610478551643*^9}, {3.6661048476546907`*^9, 
   3.666104849692499*^9}, {3.666104911590177*^9, 3.666104936957725*^9}, {
   3.666105093848118*^9, 3.666105125761047*^9}, {3.666105367958047*^9, 
   3.666105379766624*^9}, {3.666105495640685*^9, 3.6661055100203257`*^9}, {
   3.666105608076226*^9, 3.666105643289493*^9}, {3.6661057019181747`*^9, 
   3.66610574529812*^9}, {3.666105857851609*^9, 3.666105880837557*^9}, {
   3.666105957100266*^9, 3.666105958700961*^9}, {3.666106051677517*^9, 
   3.6661061481292686`*^9}, {3.666106207479895*^9, 3.666106362466343*^9}, {
   3.666106418026594*^9, 3.666106420439664*^9}, {3.666106451547317*^9, 
   3.666106481441969*^9}, {3.666106891808302*^9, 3.666106908147484*^9}, {
   3.666106962826207*^9, 3.666106968216902*^9}, {3.6661070587780647`*^9, 
   3.666107074286203*^9}, {3.6661071179394093`*^9, 3.666107148085794*^9}, 
   3.666107469129162*^9, {3.666107518232059*^9, 3.6661075437991667`*^9}, {
   3.666107972873678*^9, 3.6661079846334343`*^9}, {3.666108128862115*^9, 
   3.666108129593753*^9}, {3.6661083816691837`*^9, 3.666108392131956*^9}, {
   3.66610877202522*^9, 3.6661087816369667`*^9}, {3.6661089058855267`*^9, 
   3.666108912049205*^9}, {3.6661089756440277`*^9, 3.666108975953759*^9}, {
   3.666109025307495*^9, 3.666109060597085*^9}, {3.666109759883691*^9, 
   3.666109776381238*^9}, {3.6661098074582*^9, 3.666109819074924*^9}, {
   3.6661099319129963`*^9, 3.666109934807321*^9}, {3.6661099842085447`*^9, 
   3.6661099861404867`*^9}, {3.666110191353816*^9, 3.666110200627686*^9}, {
   3.6661102648430967`*^9, 3.666110333857682*^9}, {3.666110364371251*^9, 
   3.666110386642127*^9}, {3.66611045241293*^9, 3.666110509443203*^9}, {
   3.666110607446733*^9, 3.666110679611784*^9}, {3.6661115248234377`*^9, 
   3.666111529886622*^9}, {3.666111589643422*^9, 3.6661115927722263`*^9}, {
   3.666111627325886*^9, 3.6661116421063757`*^9}, {3.666123956699181*^9, 
   3.666123963281376*^9}, {3.666309068198161*^9, 3.66630917440235*^9}, 
   3.666309237026218*^9, {3.666311228721856*^9, 3.6663112349551086`*^9}, {
   3.66631151492458*^9, 3.6663115243054123`*^9}, {3.666311612238721*^9, 
   3.666311615991064*^9}, {3.66631165196097*^9, 3.666311661330872*^9}, {
   3.666311771712078*^9, 3.666311779752164*^9}, {3.666311893323347*^9, 
   3.6663118984300337`*^9}, {3.666311936541479*^9, 3.666311964261833*^9}, {
   3.666312171759823*^9, 3.666312239304304*^9}, {3.66631235866142*^9, 
   3.666312371350051*^9}, {3.666312555258019*^9, 3.666312556860293*^9}, {
   3.666312594429336*^9, 3.666312632467145*^9}, {3.666312709242042*^9, 
   3.666312781807611*^9}, {3.666312819133191*^9, 3.666312821591724*^9}, {
   3.6663129610900497`*^9, 3.666312994652301*^9}, {3.666313030740884*^9, 
   3.6663130541313553`*^9}, {3.6663133554789124`*^9, 
   3.6663134008231487`*^9}, {3.66631454566315*^9, 3.666314546300149*^9}, {
   3.6663149844627323`*^9, 3.66631506602845*^9}, {3.666315262215528*^9, 
   3.666315262460557*^9}, {3.666315295827529*^9, 3.666315297147341*^9}, {
   3.666317862198415*^9, 3.6663178751192617`*^9}, {3.666317974252252*^9, 
   3.66631798464154*^9}, {3.6663189391887283`*^9, 3.66631894427914*^9}, {
   3.6663272760498753`*^9, 3.6663272769490347`*^9}, {3.666368162564871*^9, 
   3.666368223394017*^9}, {3.666368311784597*^9, 3.666368328183453*^9}, {
   3.666368706350466*^9, 3.666368765503977*^9}, 3.666368852287282*^9, {
   3.666455659937731*^9, 3.666455674217162*^9}, {3.666456470100747*^9, 
   3.666456471547996*^9}, {3.666475999744268*^9, 3.581179742490941*^9}, {
   3.666965552001648*^9, 3.66696559847363*^9}, {3.666965634013054*^9, 
   3.6669656342548018`*^9}, {3.666965843318424*^9, 3.666965866715043*^9}, {
   3.666965955069276*^9, 3.666966108819721*^9}, {3.6669661392374887`*^9, 
   3.6669662209530287`*^9}, {3.666966318987899*^9, 3.666966323419108*^9}, {
   3.666966698605213*^9, 3.666966746983933*^9}, {3.6669668767637367`*^9, 
   3.666966971410186*^9}, {3.666967631846241*^9, 3.666967666122058*^9}, {
   3.66696779421314*^9, 3.666967800544138*^9}, {3.666969650067123*^9, 
   3.666969651086574*^9}, {3.666969682421054*^9, 3.666969683057621*^9}, {
   3.6669697377982807`*^9, 3.666969745781939*^9}, {3.6669836384736347`*^9, 
   3.6669836646978083`*^9}, {3.666983797831324*^9, 3.6669837983015757`*^9}, {
   3.66698816555665*^9, 3.6669881656672907`*^9}, {3.666988586736762*^9, 
   3.666988618751822*^9}, {3.666988730492195*^9, 3.66698873336271*^9}, {
   3.6669890784636717`*^9, 3.666989078757585*^9}, {3.66698916173917*^9, 
   3.666989162093769*^9}, {3.666992143108715*^9, 3.666992143410687*^9}, {
   3.667167074895195*^9, 3.667167076074875*^9}, {3.667167108070867*^9, 
   3.66716716571815*^9}, {3.667167220521873*^9, 3.667167225347169*^9}, {
   3.667167315246868*^9, 3.667167317715488*^9}, 3.667231355771237*^9, {
   3.667337718543992*^9, 3.667337817932954*^9}, {3.667658502330854*^9, 
   3.667658527687475*^9}, {3.6676751668651237`*^9, 3.667675168207584*^9}, {
   3.667675240553527*^9, 3.667675299017297*^9}, {3.667675344725163*^9, 
   3.667675355677205*^9}, {3.667675410406062*^9, 3.667675421553164*^9}, {
   3.667743285240264*^9, 3.667743492444006*^9}, {3.6677435259284163`*^9, 
   3.667743541876462*^9}, {3.667743595262018*^9, 3.6677436132534122`*^9}, {
   3.6677436938816347`*^9, 3.667743773887302*^9}, {3.6677440115805807`*^9, 
   3.667744025271256*^9}, {3.6677440938831263`*^9, 3.6677440950896397`*^9}, {
   3.6677441561507587`*^9, 3.6677441580413322`*^9}, {3.667744220556978*^9, 
   3.667744231837758*^9}, {3.6677444313626547`*^9, 3.667744434063169*^9}, {
   3.667744516779023*^9, 3.667744643647962*^9}, {3.667764809978861*^9, 
   3.6677648123342533`*^9}, {3.667765684274218*^9, 3.66776568799426*^9}, {
   3.686161232696477*^9, 3.686161232727941*^9}, 3.686168038751679*^9, 
   3.68617432782675*^9, 3.686174402429064*^9, {3.686179713980443*^9, 
   3.686179731428941*^9}, 3.686180573959531*^9, {3.686180652055667*^9, 
   3.6861806530267687`*^9}, {3.686180714725923*^9, 3.686180755528062*^9}, {
   3.6861807893138027`*^9, 3.6861808315636673`*^9}, {3.6861808861171427`*^9, 
   3.6861809873200397`*^9}, {3.6861810318539457`*^9, 
   3.6861811146227922`*^9}, {3.6861813155948753`*^9, 
   3.6861813157699203`*^9}, {3.686181400768738*^9, 3.686181402071125*^9}, {
   3.686181488516592*^9, 3.686181491351005*^9}, {3.68618194241949*^9, 
   3.686181953408875*^9}, {3.686182092223156*^9, 3.686182101359419*^9}, {
   3.6861821478818007`*^9, 3.686182216248911*^9}, {3.686182297830338*^9, 
   3.686182323701356*^9}, {3.686604572585741*^9, 3.6866045928817883`*^9}, {
   3.686604839075553*^9, 3.686604848185595*^9}, {3.6866048902784452`*^9, 
   3.686604913513763*^9}, {3.6866050291221313`*^9, 3.686605036476383*^9}, {
   3.686605129755805*^9, 3.68660514054278*^9}, {3.686605236455162*^9, 
   3.686605236562976*^9}, {3.686605384236857*^9, 3.686605384852517*^9}, {
   3.686605940441584*^9, 3.68660602218412*^9}, {3.6866061347747726`*^9, 
   3.686606147543593*^9}, {3.686606182652628*^9, 3.686606401223754*^9}, {
   3.686606462295817*^9, 3.686606474255134*^9}, {3.6866065378928022`*^9, 
   3.6866065620574083`*^9}, {3.686606632341873*^9, 3.6866066396212273`*^9}, {
   3.686606834884595*^9, 3.686607039925128*^9}, {3.6866070806254053`*^9, 
   3.6866071128104267`*^9}, {3.686607167298065*^9, 3.6866071729080677`*^9}, {
   3.6866072097290087`*^9, 3.686607228022265*^9}, {3.6866072650517073`*^9, 
   3.686607328981977*^9}, {3.686607375132942*^9, 3.686607479903754*^9}, {
   3.6866075313767767`*^9, 3.686607573973699*^9}, {3.686607626610609*^9, 
   3.686607628815261*^9}, {3.68660775367885*^9, 3.686607757890417*^9}, {
   3.686607804778028*^9, 3.686607831333942*^9}, {3.686607863453535*^9, 
   3.6866079343448353`*^9}, {3.686607988047798*^9, 3.686608026171172*^9}, {
   3.686608089553258*^9, 3.686608232025366*^9}, {3.68660830608589*^9, 
   3.686608392608004*^9}, {3.686608457254394*^9, 3.686608469622452*^9}, {
   3.686608502881422*^9, 3.68660855721325*^9}, {3.686608596383472*^9, 
   3.686608683200881*^9}, {3.686608716960815*^9, 3.686608812442046*^9}, {
   3.686608844072626*^9, 3.686608930086144*^9}, {3.686608973647263*^9, 
   3.6866089839005547`*^9}, {3.6866090501054163`*^9, 3.686609055209485*^9}, {
   3.686609124429887*^9, 3.686609153642488*^9}, {3.6866092164061213`*^9, 
   3.686609236247623*^9}, {3.686609286884295*^9, 3.68660929683291*^9}, {
   3.686609349454844*^9, 3.6866093972413607`*^9}, {3.6866094285279617`*^9, 
   3.686609460859208*^9}, {3.686609498036242*^9, 3.68660954747716*^9}, {
   3.6866095801446466`*^9, 3.686609580811314*^9}, {3.686609616184421*^9, 
   3.686609618574543*^9}, {3.6866096908845663`*^9, 3.686609691482627*^9}, {
   3.686609725198*^9, 3.686609762005104*^9}, {3.686609798336321*^9, 
   3.68660981368498*^9}, {3.686624922268877*^9, 3.686624946684607*^9}, {
   3.6866511218922567`*^9, 3.686651214058462*^9}, {3.6866512816949987`*^9, 
   3.686651282110014*^9}, {3.686651385266314*^9, 3.686651385675201*^9}, {
   3.6866514637576733`*^9, 3.686651467567219*^9}, {3.686651936830863*^9, 
   3.686651959895007*^9}, 3.686652073762205*^9, {3.686652544311936*^9, 
   3.6866525588568153`*^9}, {3.6866531327662573`*^9, 
   3.6866531456658373`*^9}, {3.686653182780698*^9, 3.686653253335429*^9}, {
   3.6866532899066153`*^9, 3.6866533347164288`*^9}, {3.68665338174746*^9, 
   3.6866533897062263`*^9}, {3.686653635486319*^9, 3.686653658846141*^9}, {
   3.6866538965042553`*^9, 3.6866539673461437`*^9}, {3.686654018548437*^9, 
   3.686654083953383*^9}, {3.6866541140687428`*^9, 3.6866541171984*^9}, {
   3.686654154371064*^9, 3.6866541561432447`*^9}, {3.686654194256715*^9, 
   3.686654231548008*^9}, {3.686654261680113*^9, 3.686654263618539*^9}, {
   3.686654443022056*^9, 3.686654444503558*^9}, {3.686654496365649*^9, 
   3.6866545206337433`*^9}, {3.6866546345309896`*^9, 
   3.6866546396191387`*^9}, {3.6866546725242853`*^9, 
   3.6866547053327227`*^9}, {3.686654848347542*^9, 3.686654848518978*^9}, {
   3.686654904561698*^9, 3.6866549555998363`*^9}, {3.686655106576477*^9, 
   3.686655112183008*^9}, {3.6866656589166317`*^9, 3.686665661737069*^9}, {
   3.686665714308938*^9, 3.686665717288529*^9}, {3.68788984927495*^9, 
   3.687889851452046*^9}, {3.6878899619151373`*^9, 3.687889964163999*^9}, {
   3.687890523902821*^9, 3.6878905260413857`*^9}, {3.68789067851256*^9, 
   3.6878907281946898`*^9}, {3.687891848594905*^9, 3.687891848728903*^9}, {
   3.687891895275734*^9, 3.687891912206829*^9}, {3.687892160709991*^9, 
   3.687892176260622*^9}, {3.687892209846271*^9, 3.68789226228833*^9}, {
   3.6878923253277597`*^9, 3.687892327409419*^9}, {3.687892767598171*^9, 
   3.687892773529532*^9}, {3.68789427037936*^9, 3.6878942989574957`*^9}, {
   3.687894458636754*^9, 3.687894491577156*^9}, {3.687895727434269*^9, 
   3.68789577072791*^9}, {3.687895817095004*^9, 3.687895896606386*^9}, {
   3.687895959167659*^9, 3.687896081396837*^9}, {3.688069518129613*^9, 
   3.688069528292594*^9}, {3.688069730889783*^9, 3.6880697313983707`*^9}, {
   3.688069842927936*^9, 3.688069844026939*^9}, {3.688070105367819*^9, 
   3.68807012067618*^9}, {3.688070662079383*^9, 3.6880706636576433`*^9}, {
   3.6880706947671022`*^9, 3.688070702023712*^9}, {3.688070740032238*^9, 
   3.6880707617068357`*^9}, {3.688070989681781*^9, 3.6880710258038263`*^9}, {
   3.688071117704007*^9, 3.688071180734871*^9}, {3.6880715634246883`*^9, 
   3.688071578544895*^9}, {3.68807168958871*^9, 3.688071744613975*^9}, {
   3.6880718451466703`*^9, 3.688071855780793*^9}, {3.688071897215568*^9, 
   3.688071902752385*^9}, {3.68807195261271*^9, 3.688071997525037*^9}, 
   3.688072041806848*^9, {3.6880726281665373`*^9, 3.688072726248879*^9}, {
   3.688072803085725*^9, 3.6880728282714033`*^9}, {3.688073077108385*^9, 
   3.6880731041848288`*^9}, {3.688073377096032*^9, 3.688073418155999*^9}, {
   3.688073516187398*^9, 3.688073524662923*^9}, {3.688074741359592*^9, 
   3.688074775703458*^9}, {3.6880748364723883`*^9, 3.6880749971015673`*^9}, {
   3.688075028248296*^9, 3.688075068826088*^9}, 3.68807514680929*^9, {
   3.688075196129966*^9, 3.688075226771421*^9}, 3.688075448740116*^9, {
   3.6880755717486887`*^9, 3.688075601685951*^9}, {3.688075695368294*^9, 
   3.688075697020276*^9}, {3.6880758806038933`*^9, 3.68807588621663*^9}, {
   3.688076075164824*^9, 3.688076082099997*^9}, 3.6880761187740393`*^9, {
   3.688076248981687*^9, 3.6880763124258223`*^9}, 3.6880763554385242`*^9, {
   3.688076436672988*^9, 3.688076438546679*^9}, {3.6880764948892593`*^9, 
   3.6880765423309593`*^9}, {3.6880766282675943`*^9, 3.6880766798511744`*^9}, 
   3.688076732918498*^9, {3.688076932869195*^9, 3.688076988441168*^9}, {
   3.688077123984116*^9, 3.688077148393693*^9}, {3.6880772660782747`*^9, 
   3.688077322038952*^9}, {3.688077438051421*^9, 3.6880774391331797`*^9}, {
   3.688077561064191*^9, 3.688077578773262*^9}, {3.688077803676054*^9, 
   3.6880778094076843`*^9}, {3.6880779054779673`*^9, 3.688077982682579*^9}, {
   3.688128588727724*^9, 3.68812861396348*^9}, {3.688128667514781*^9, 
   3.688128712933608*^9}, 3.688128772606694*^9, {3.6881288063030577`*^9, 
   3.688128821922142*^9}, {3.6881295176719713`*^9, 3.688129559859549*^9}, {
   3.688129607245014*^9, 3.688129612378593*^9}, {3.6881296558616858`*^9, 
   3.68812965675839*^9}, {3.688129687624982*^9, 3.68812972446953*^9}, {
   3.688129770392906*^9, 3.688129780252713*^9}, {3.688129814110176*^9, 
   3.6881298258182592`*^9}, {3.688129976655026*^9, 3.688130005727783*^9}, {
   3.688130101558576*^9, 3.688130120132637*^9}, {3.688130205131669*^9, 
   3.688130218078484*^9}, {3.688130299915304*^9, 3.6881303017350616`*^9}, {
   3.688130390339808*^9, 3.68813043131682*^9}, {3.688130496430684*^9, 
   3.688130524661128*^9}, {3.68813068726856*^9, 3.688130689338272*^9}, {
   3.6881307499079647`*^9, 3.688130752341775*^9}, {3.688130787849409*^9, 
   3.688130849028646*^9}, {3.688130888709774*^9, 3.688130936114859*^9}, {
   3.68813816174189*^9, 3.688138170903564*^9}, {3.688138372318707*^9, 
   3.5760967253749447`*^9}, {3.576096758366832*^9, 3.5760967616870213`*^9}, {
   3.5760968100807896`*^9, 3.5760968602296576`*^9}, {3.576096902295064*^9, 
   3.5760970547427835`*^9}, {3.5760970948530774`*^9, 
   3.5760971372125006`*^9}, {3.5760971843331957`*^9, 3.576097237140216*^9}, {
   3.576097330626563*^9, 3.576097345802431*^9}, {3.5760973926201086`*^9, 
   3.576097444009048*^9}, 3.576097549347073*^9, {3.576097687730988*^9, 
   3.5760977393219385`*^9}, {3.576097779136216*^9, 3.576097821035613*^9}, {
   3.5760979307388873`*^9, 3.576097942529562*^9}, {3.5760979883861847`*^9, 
   3.5760980125455666`*^9}, {3.576098068448764*^9, 3.576098127490141*^9}, {
   3.5760981942409587`*^9, 3.5760982268808255`*^9}, {3.5760983665428143`*^9, 
   3.576098377991469*^9}, {3.5760984081511936`*^9, 3.576098459693142*^9}, {
   3.576098492124997*^9, 3.576098498757376*^9}, {3.576098540364756*^9, 
   3.576098616788127*^9}, {3.5760987060282316`*^9, 3.576098707387309*^9}, {
   3.576098747556607*^9, 3.5760987915411224`*^9}, {3.5760990362951217`*^9, 
   3.576099079960619*^9}, {3.576099111433419*^9, 3.576099127313328*^9}, {
   3.5760992089609976`*^9, 3.5760992100810614`*^9}, {3.5760992590328617`*^9, 
   3.57609926127999*^9}, {3.576099299200159*^9, 3.576099361199705*^9}, {
   3.5760994038481445`*^9, 3.5760994182949705`*^9}, {3.576099516302576*^9, 
   3.576099520437813*^9}, {3.57609969277267*^9, 3.5760997145479155`*^9}, {
   3.5760999037397366`*^9, 3.5760999145233536`*^9}, {3.576099963724168*^9, 
   3.576099976226883*^9}, {3.5761000131389937`*^9, 3.576100019147338*^9}, {
   3.5761000584645863`*^9, 3.5761000596036515`*^9}, {3.576100271544774*^9, 
   3.5761002813443346`*^9}, {3.5761003355124326`*^9, 
   3.5761003491292114`*^9}, {3.5761003949438314`*^9, 
   3.5761004073185396`*^9}, {3.576100499495812*^9, 3.576100512956582*^9}, {
   3.5761005535259023`*^9, 3.5761005911420536`*^9}, {3.576100694006937*^9, 
   3.576100699285239*^9}, 3.576100739916563*^9, {3.5761007868622484`*^9, 
   3.57610078723627*^9}, {3.576100818324048*^9, 3.576100820731186*^9}, {
   3.5761012065710163`*^9, 3.5761012391858816`*^9}, {3.5761013503312387`*^9, 
   3.5761013524123583`*^9}, {3.5761015747040725`*^9, 3.576101578217273*^9}, {
   3.576101622065781*^9, 3.5761016470232086`*^9}, {3.5761016923208*^9, 
   3.576101725141677*^9}, {3.576101818069992*^9, 3.5761018326618266`*^9}, {
   3.57610192502911*^9, 3.576101959813099*^9}, {3.5761020054527097`*^9, 
   3.576102008110862*^9}, {3.576102051908367*^9, 3.576102052731414*^9}, {
   3.5761020948388224`*^9, 3.576102095124839*^9}, {3.576102187194105*^9, 
   3.5761021963456283`*^9}, {3.5761097806124234`*^9, 
   3.5761097866917715`*^9}, {3.576109872131658*^9, 3.5761099241476336`*^9}, {
   3.5761101756910205`*^9, 3.576110186066614*^9}, {3.576110267408266*^9, 
   3.576110272431554*^9}, {3.576110447637575*^9, 3.576110504045801*^9}, {
   3.5761107798315754`*^9, 3.576110811775402*^9}, {3.5761108489265275`*^9, 
   3.576110855766919*^9}, {3.5761109198605847`*^9, 3.576110923734806*^9}, {
   3.5761109669322767`*^9, 3.5761110031883507`*^9}, {3.5761110440266867`*^9, 
   3.5761110908663654`*^9}, {3.5761111470515795`*^9, 
   3.5761111601713295`*^9}, {3.576111193698247*^9, 3.5761112416099873`*^9}, {
   3.576111291713854*^9, 3.576111304451582*^9}, {3.5761113533283777`*^9, 
   3.5761113669131546`*^9}, {3.576111545094346*^9, 3.5761116549326286`*^9}, {
   3.5761119701476574`*^9, 3.5761119877866664`*^9}, {3.5761688857363553`*^9, 
   3.5761688980915766`*^9}, {3.57617007277364*^9, 3.576170081353655*^9}, {
   3.5761701214301257`*^9, 3.5761703178188705`*^9}, {3.5761703622165484`*^9, 
   3.5761703777229757`*^9}, {3.5761705250028343`*^9, 
   3.5761705431612663`*^9}, {3.576171107695058*^9, 3.5761711214230824`*^9}, {
   3.5761711543235397`*^9, 3.5761711672559624`*^9}, {3.5761712149140463`*^9, 
   3.5761712154288473`*^9}, 3.5761712634301314`*^9, {3.5761712944585857`*^9, 
   3.5761713667023125`*^9}, {3.5761731973031282`*^9, 
   3.5761732436508093`*^9}, {3.5761761777975636`*^9, 3.5761762281700516`*^9}, 
   3.5761763701459007`*^9, {3.57617691636526*^9, 3.5761769416529045`*^9}, {
   3.5761769904809904`*^9, 3.576176990808591*^9}, {3.5761771186196156`*^9, 
   3.5761771304600363`*^9}, {3.576177505734296*^9, 3.5761775222391243`*^9}, {
   3.576177553454779*^9, 3.5761775696944075`*^9}, {3.5761776071656733`*^9, 
   3.5761776504557495`*^9}, {3.5761776824670057`*^9, 
   3.5761776994554358`*^9}, {3.6764753916909094`*^9, 
   3.6764754058640285`*^9}, {3.6764755827525487`*^9, 3.671110076052392*^9}, {
   3.6711101736953945`*^9, 3.671110202508254*^9}, {3.671110252587079*^9, 
   3.6711102555245996`*^9}, {3.6711103158407545`*^9, 3.671110350623521*^9}, {
   3.6711103892646613`*^9, 3.6711104854905653`*^9}, {3.6711105561488276`*^9, 
   3.671110627868544*^9}, {3.6711109172232876`*^9, 3.6711109192545404`*^9}, {
   3.6711109841147895`*^9, 3.6711109910524044`*^9}, {3.6711110215371675`*^9, 
   3.671111049881299*^9}, {3.671111141017798*^9, 3.6711112779582787`*^9}, {
   3.671112928464212*^9, 3.6711129378081093`*^9}, {3.671113024496771*^9, 
   3.67111311376429*^9}, {3.671113166030636*^9, 3.6711131704837885`*^9}, {
   3.6711132907359877`*^9, 3.671113413785203*^9}, {3.671113467723427*^9, 
   3.6711134901299944`*^9}, {3.6711135404004316`*^9, 
   3.6711135480099373`*^9}, {3.6711136425534415`*^9, 3.671113674397592*^9}, {
   3.6711138495321264`*^9, 3.6711139248925123`*^9}, {3.6711140721742506`*^9, 
   3.671114103915152*^9}, {3.671114152751012*^9, 3.671114221423802*^9}, {
   3.671114268067738*^9, 3.6711144016831784`*^9}, {3.6711148456316853`*^9, 
   3.6711148537411623`*^9}, {3.671114902491825*^9, 3.671115268888678*^9}, {
   3.6711153504684434`*^9, 3.6711153519684663`*^9}, {3.6711154136255627`*^9, 
   3.671115424469457*^9}, {3.671115462516823*^9, 3.671115463688733*^9}, {
   3.6711155781605453`*^9, 3.6711155815668216`*^9}, {3.671115692506523*^9, 
   3.671115709053619*^9}, {3.6711157767576485`*^9, 3.671115798945447*^9}, {
   3.6711158378053412`*^9, 3.6711158703220844`*^9}, {3.671115927713481*^9, 
   3.671115933213564*^9}, {3.6711159779641757`*^9, 3.671116067669088*^9}, {
   3.671116122935433*^9, 3.671116141873209*^9}, {3.671116295000949*^9, 
   3.6711162951728463`*^9}, {3.6711163540798874`*^9, 3.671116391908498*^9}, {
   3.6711164353354855`*^9, 3.671116482266651*^9}, {3.6711165143452134`*^9, 
   3.6711167705835743`*^9}, {3.6711168342570257`*^9, 
   3.6711169312270823`*^9}, {3.671117109870815*^9, 3.671117240545141*^9}, {
   3.671117479423916*^9, 3.671117497018606*^9}, {3.671117887181388*^9, 
   3.6711178891345453`*^9}, {3.671117948838473*^9, 3.6711180739971848`*^9}, {
   3.67111820026451*^9, 3.671118266203624*^9}, {3.6711183229231143`*^9, 
   3.671118836401189*^9}, {3.67111887451105*^9, 3.6711190430610504`*^9}, {
   3.6711191013899574`*^9, 3.6711191326723137`*^9}, {3.6711192560801997`*^9, 
   3.671119314206683*^9}, {3.6711193529884777`*^9, 3.6711193551134853`*^9}, 
   3.671119387160787*^9, {3.6711195143350983`*^9, 3.671119653165064*^9}, {
   3.6711196898069086`*^9, 3.6711196907131724`*^9}, {3.671120043422419*^9, 
   3.6711203432396317`*^9}, {3.671120444413951*^9, 3.671120481148797*^9}, {
   3.6711205144773707`*^9, 3.6711205633217754`*^9}, {3.671120623604535*^9, 
   3.6711206237451725`*^9}, {3.6711207007618284`*^9, 
   3.6711207339653993`*^9}, {3.6711208281864862`*^9, 3.671120830405261*^9}, {
   3.6711210090176387`*^9, 3.671121010955145*^9}, {3.671121111972833*^9, 
   3.671121121972967*^9}, {3.671121403197027*^9, 3.6711214161503344`*^9}, {
   3.6711214642603545`*^9, 3.6711214645572357`*^9}, {3.671121915018779*^9, 
   3.6711219218313694`*^9}, {3.6711227788689327`*^9, 
   3.6711228388853426`*^9}, {3.671122990935305*^9, 3.671123022060741*^9}, {
   3.67112305676431*^9, 3.6711230585612307`*^9}, {3.6711230900460277`*^9, 
   3.6711231785790973`*^9}, {3.6711232654396534`*^9, 
   3.6711233028002234`*^9}, {3.671123353504029*^9, 3.6711233637541666`*^9}, {
   3.671123848017502*^9, 3.6711239336941385`*^9}, 3.6711240055445914`*^9, {
   3.6711242376354504`*^9, 3.671124549780929*^9}, {3.6711246795639925`*^9, 
   3.671124758025755*^9}, {3.671124838244173*^9, 3.6711248653539124`*^9}, {
   3.671124926663797*^9, 3.671125052106284*^9}, {3.671125218962278*^9, 
   3.671125240837566*^9}, {3.671133753639351*^9, 3.6711338673919754`*^9}, {
   3.671133907939396*^9, 3.6711339756757517`*^9}, {3.6711340412547297`*^9, 
   3.67113408442719*^9}, {3.6711341597417707`*^9, 3.67113417635139*^9}, 
   3.671134226633317*^9, {3.6711342835871773`*^9, 3.671134312088653*^9}, {
   3.6711361734194703`*^9, 3.6711361783414288`*^9}, {3.6711364617943525`*^9, 
   3.6711365119350967`*^9}, {3.6711365650903563`*^9, 3.671136632057279*^9}, {
   3.6711369017172413`*^9, 3.6711369024985037`*^9}, {3.671137230628478*^9, 
   3.671137238550432*^9}, {3.671137269256397*^9, 3.671137296242665*^9}, {
   3.671137424643697*^9, 3.671137492936301*^9}, {3.6711376589998713`*^9, 
   3.6711377398112583`*^9}, {3.671137786653102*^9, 3.671137824991395*^9}, {
   3.671137890456905*^9, 3.6711379340072517`*^9}, {3.671140536745322*^9, 
   3.67114056718195*^9}, {3.6711409584703193`*^9, 3.67114097529126*^9}, {
   3.6711410275239196`*^9, 3.6711412221961603`*^9}, {3.6711455717156854`*^9, 
   3.6711455741219873`*^9}, {3.6711458153124866`*^9, 3.6711458166094*^9}, {
   3.6711459035098577`*^9, 3.6711459149787626`*^9}, {3.6711462172152195`*^9, 
   3.6711462794471846`*^9}, {3.6711470598047066`*^9, 
   3.6711471043344755`*^9}, {3.6711471544183064`*^9, 
   3.6711471545745597`*^9}, {3.6711472751839733`*^9, 
   3.6711472939820824`*^9}, {3.6711492488311615`*^9, 3.671149267206436*^9}, {
   3.6711497678939524`*^9, 3.6711497749409227`*^9}, {3.6711498099569025`*^9, 
   3.671149829195449*^9}, {3.671192313186693*^9, 3.6711923142492065`*^9}, {
   3.6711924633144217`*^9, 3.671192464173807*^9}, {3.671192547159296*^9, 
   3.671192548815568*^9}, {3.671193324786928*^9, 3.6711933429277987`*^9}, {
   3.6711952191897297`*^9, 3.671195250783904*^9}, {3.671195283268734*^9, 
   3.6711953528641043`*^9}, {3.6711954925995646`*^9, 
   3.6711954972715025`*^9}, {3.671195662336218*^9, 3.671195664258099*^9}, {
   3.671195932574959*^9, 3.6711959344499617`*^9}, {3.6711961045623503`*^9, 
   3.6711961164062405`*^9}, {3.6711961531567335`*^9, 3.671196163235013*^9}, {
   3.6711962465024624`*^9, 3.6711962603151474`*^9}, {3.6711963104876957`*^9, 
   3.671196311393937*^9}, {3.6711975235719604`*^9, 3.6711975280407696`*^9}, {
   3.671197616258892*^9, 3.6711976236652417`*^9}, 3.693012834560267*^9, {
   3.693052780978923*^9, 3.693052781400919*^9}, {3.693164666038664*^9, 
   3.693164670394699*^9}, {3.695571069763994*^9, 3.6955711067719193`*^9}, {
   3.6955711645598803`*^9, 3.676405178351653*^9}, {3.676405245908652*^9, 
   3.676405246955539*^9}, {3.6764053279998627`*^9, 3.67640533576557*^9}, {
   3.676405381424409*^9, 3.6764054268468914`*^9}, {3.6764055158127193`*^9, 
   3.6764055201096334`*^9}, {3.701700492536763*^9, 3.701700493115601*^9}, {
   3.701700532728718*^9, 3.701700563872054*^9}, {3.701700837833049*^9, 
   3.701700944643931*^9}, {3.7017010185042562`*^9, 3.701701035168851*^9}, {
   3.701701106309122*^9, 3.701701108535466*^9}, {3.701702631346051*^9, 
   3.701702636838501*^9}, {3.7017029306100817`*^9, 3.701702992844742*^9}, {
   3.7017030849293823`*^9, 3.7017031388817987`*^9}, {3.701703216950118*^9, 
   3.701703226329063*^9}, {3.70170330311008*^9, 3.701703305070962*^9}, {
   3.701703556400333*^9, 3.701703592099249*^9}, {3.70170612891325*^9, 
   3.701706143034216*^9}, {3.701706197793605*^9, 3.701706201874152*^9}, {
   3.7017067859284773`*^9, 3.7017067960510674`*^9}, {3.701706870185651*^9, 
   3.701706920259171*^9}, {3.701785200670426*^9, 3.7017852098385468`*^9}, {
   3.701785262701898*^9, 3.701785306662465*^9}, {3.701785356949894*^9, 
   3.701785512174506*^9}, {3.7017856941617317`*^9, 3.7017857699988337`*^9}, {
   3.701785815894987*^9, 3.701785826694751*^9}, {3.701785905104847*^9, 
   3.701785958893424*^9}, 3.701785994838595*^9, {3.701786039351417*^9, 
   3.7017860497421503`*^9}, {3.7017864845769043`*^9, 3.701786490277169*^9}, {
   3.701786584593486*^9, 3.7017867109740963`*^9}, {3.701786750098269*^9, 
   3.701786754696526*^9}, {3.701786846592062*^9, 3.701786846764039*^9}, {
   3.701787036754314*^9, 3.7017870938020487`*^9}, {3.7017871552713614`*^9, 
   3.7017871620568237`*^9}, {3.701788196612524*^9, 3.701788296557715*^9}, {
   3.701788345255987*^9, 3.701788397043689*^9}, {3.701788575494433*^9, 
   3.701788576029533*^9}, {3.701788622178399*^9, 3.701788691897482*^9}, {
   3.701788725355932*^9, 3.701788726953898*^9}, {3.70178877197817*^9, 
   3.7017888019467373`*^9}, {3.701788888138633*^9, 3.701788980666855*^9}, {
   3.701789119403386*^9, 3.701789156470189*^9}, {3.701956767704192*^9, 
   3.701956796462199*^9}, {3.7019568277508307`*^9, 3.701956832406847*^9}, {
   3.701956916403516*^9, 3.7019569175135193`*^9}, {3.701957423101083*^9, 
   3.7019574634902983`*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1050, 1614},
WindowMargins->{{0, Automatic}, {Automatic, 12}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->""},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 451, 12, 65, "Input"],
Cell[1034, 36, 459, 16, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1530, 57, 376, 10, 58, "Input"],
Cell[1909, 69, 549, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2495, 92, 427, 11, 60, "Input"],
Cell[2925, 105, 2186, 68, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5148, 178, 453, 15, 84, "Input"],
Cell[5604, 195, 1707, 62, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7348, 262, 467, 14, 65, "Input"],
Cell[7818, 278, 1408, 44, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9263, 327, 212, 3, 93, "Title"],
Cell[9478, 332, 70, 1, 32, "Input"],
Cell[9551, 335, 17578, 406, 1432, "Input"],
Cell[CellGroupData[{
Cell[27154, 745, 7356, 196, 622, "Input"],
Cell[CellGroupData[{
Cell[34535, 945, 665, 19, 28, "Print"],
Cell[35203, 966, 666, 19, 28, "Print"],
Cell[35872, 987, 663, 19, 28, "Print"],
Cell[36538, 1008, 665, 19, 28, "Print"],
Cell[37206, 1029, 682, 20, 28, "Print"],
Cell[37891, 1051, 663, 19, 28, "Print"],
Cell[38557, 1072, 663, 19, 28, "Print"],
Cell[39223, 1093, 686, 20, 28, "Print"],
Cell[39912, 1115, 683, 20, 28, "Print"],
Cell[40598, 1137, 663, 19, 28, "Print"],
Cell[41264, 1158, 688, 20, 28, "Print"],
Cell[41955, 1180, 661, 19, 28, "Print"],
Cell[42619, 1201, 627, 19, 28, "Print"],
Cell[43249, 1222, 370, 13, 43, "Print"],
Cell[43622, 1237, 663, 19, 28, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44334, 1262, 13301, 330, 974, "Input"],
Cell[57638, 1594, 126, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57801, 1601, 12433, 325, 998, "Input"],
Cell[70237, 1928, 77, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70351, 1934, 804, 25, 54, "Input"],
Cell[71158, 1961, 1674, 54, 105, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[72881, 2021, 159, 2, 67, "Title"],
Cell[73043, 2025, 387, 11, 101, "Text"],
Cell[73433, 2038, 1984, 67, 250, "Text"],
Cell[CellGroupData[{
Cell[75442, 2109, 2455, 80, 616, "Input"],
Cell[77900, 2191, 383, 9, 150, "Output"]
}, Open  ]],
Cell[78298, 2203, 122, 1, 101, "Text"],
Cell[CellGroupData[{
Cell[78445, 2208, 1338, 43, 181, "Input"],
Cell[79786, 2253, 266, 8, 150, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80089, 2266, 757, 21, 145, "Input"],
Cell[CellGroupData[{
Cell[80871, 2291, 1257, 28, 137, "Print"],
Cell[82131, 2321, 731, 14, 262, "Print"],
Cell[82865, 2337, 821, 18, 262, "Print"],
Cell[83689, 2357, 1165, 30, 262, "Print"],
Cell[84857, 2389, 686, 14, 262, "Print"],
Cell[85546, 2405, 688, 14, 262, "Print"],
Cell[86237, 2421, 1471, 35, 262, "Print"],
Cell[87711, 2458, 694, 13, 262, "Print"],
Cell[88408, 2473, 632, 12, 262, "Print"],
Cell[89043, 2487, 835, 18, 262, "Print"],
Cell[89881, 2507, 1689, 38, 262, "Print"],
Cell[91573, 2547, 2800, 64, 262, "Print"],
Cell[94376, 2613, 715, 14, 262, "Print"],
Cell[95094, 2629, 849, 17, 262, "Print"],
Cell[95946, 2648, 1055, 24, 262, "Print"],
Cell[97004, 2674, 1059, 24, 262, "Print"],
Cell[98066, 2700, 1058, 25, 262, "Print"],
Cell[99127, 2727, 1214, 29, 262, "Print"],
Cell[100344, 2758, 2235, 50, 262, "Print"],
Cell[102582, 2810, 975, 20, 262, "Print"],
Cell[103560, 2832, 2484, 58, 262, "Print"],
Cell[106047, 2892, 896, 18, 262, "Print"],
Cell[106946, 2912, 4406, 107, 262, "Print"],
Cell[111355, 3021, 3522, 92, 262, "Print"],
Cell[114880, 3115, 538, 8, 262, "Print"],
Cell[115421, 3125, 1803, 38, 262, "Print"],
Cell[117227, 3165, 1968, 43, 262, "Print"],
Cell[119198, 3210, 1926, 41, 262, "Print"],
Cell[121127, 3253, 1863, 41, 262, "Print"],
Cell[122993, 3296, 908, 18, 262, "Print"],
Cell[123904, 3316, 1899, 41, 262, "Print"],
Cell[125806, 3359, 1833, 40, 262, "Print"],
Cell[127642, 3401, 878, 17, 262, "Print"],
Cell[128523, 3420, 1865, 41, 262, "Print"],
Cell[130391, 3463, 965, 22, 262, "Print"],
Cell[131359, 3487, 820, 16, 262, "Print"],
Cell[132182, 3505, 1001, 23, 262, "Print"],
Cell[133186, 3530, 1000, 23, 262, "Print"],
Cell[134189, 3555, 969, 22, 262, "Print"],
Cell[135161, 3579, 995, 23, 262, "Print"]
}, Closed]],
Cell[136171, 3605, 1489, 31, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137697, 3641, 634, 19, 145, "Input"],
Cell[CellGroupData[{
Cell[138356, 3664, 1276, 28, 137, "Print"],
Cell[139635, 3694, 806, 16, 262, "Print"],
Cell[140444, 3712, 950, 20, 262, "Print"],
Cell[141397, 3734, 1954, 51, 262, "Print"],
Cell[143354, 3787, 718, 14, 262, "Print"],
Cell[144075, 3803, 720, 14, 262, "Print"],
Cell[144798, 3819, 1656, 40, 262, "Print"],
Cell[146457, 3861, 713, 13, 262, "Print"],
Cell[147173, 3876, 653, 12, 262, "Print"],
Cell[147829, 3890, 981, 23, 262, "Print"],
Cell[148813, 3915, 1876, 42, 262, "Print"],
Cell[150692, 3959, 3966, 89, 262, "Print"],
Cell[154661, 4050, 782, 16, 262, "Print"],
Cell[155446, 4068, 922, 19, 262, "Print"],
Cell[156371, 4089, 1092, 25, 262, "Print"],
Cell[157466, 4116, 1094, 25, 262, "Print"],
Cell[158563, 4143, 1096, 25, 262, "Print"],
Cell[159662, 4170, 1485, 38, 262, "Print"],
Cell[161150, 4210, 2315, 50, 262, "Print"],
Cell[163468, 4262, 1017, 21, 262, "Print"],
Cell[164488, 4285, 2224, 48, 262, "Print"],
Cell[166715, 4335, 915, 18, 262, "Print"],
Cell[167633, 4355, 2621, 61, 262, "Print"],
Cell[170257, 4418, 915, 18, 262, "Print"],
Cell[171175, 4438, 7888, 191, 262, "Print"],
Cell[179066, 4631, 3581, 91, 262, "Print"],
Cell[182650, 4724, 1867, 39, 262, "Print"],
Cell[184520, 4765, 1974, 42, 262, "Print"],
Cell[186497, 4809, 1960, 41, 262, "Print"],
Cell[188460, 4852, 1866, 39, 262, "Print"],
Cell[190329, 4893, 867, 16, 262, "Print"],
Cell[191199, 4911, 1960, 41, 262, "Print"],
Cell[193162, 4954, 1868, 39, 262, "Print"],
Cell[195033, 4995, 867, 16, 262, "Print"],
Cell[195903, 5013, 1868, 39, 262, "Print"],
Cell[197774, 5054, 3843, 98, 262, "Print"],
Cell[201620, 5154, 557, 8, 262, "Print"],
Cell[202180, 5164, 2512, 55, 262, "Print"],
Cell[204695, 5221, 2682, 60, 262, "Print"],
Cell[207380, 5283, 2387, 52, 262, "Print"],
Cell[209770, 5337, 2650, 59, 262, "Print"],
Cell[212423, 5398, 2650, 59, 262, "Print"],
Cell[215076, 5459, 1926, 41, 262, "Print"],
Cell[217005, 5502, 927, 18, 262, "Print"],
Cell[217935, 5522, 2032, 43, 262, "Print"],
Cell[219970, 5567, 2252, 49, 262, "Print"],
Cell[222225, 5618, 2251, 49, 262, "Print"],
Cell[224479, 5669, 1896, 40, 262, "Print"],
Cell[226378, 5711, 897, 17, 262, "Print"],
Cell[227278, 5730, 1928, 41, 262, "Print"],
Cell[229209, 5773, 1646, 41, 262, "Print"],
Cell[230858, 5816, 876, 18, 262, "Print"],
Cell[231737, 5836, 1153, 27, 262, "Print"],
Cell[232893, 5865, 1187, 28, 262, "Print"],
Cell[234083, 5895, 1294, 33, 262, "Print"],
Cell[235380, 5930, 1234, 30, 262, "Print"],
Cell[236617, 5962, 1029, 23, 262, "Print"],
Cell[237649, 5987, 1232, 30, 262, "Print"]
}, Closed]],
Cell[238896, 6020, 1254, 32, 176, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240187, 6057, 557, 17, 145, "Input"],
Cell[CellGroupData[{
Cell[240769, 6078, 886, 22, 262, "Print"],
Cell[241658, 6102, 479, 12, 262, "Print"],
Cell[242140, 6116, 705, 18, 262, "Print"],
Cell[242848, 6136, 2806, 77, 262, "Print"],
Cell[245657, 6215, 343, 8, 262, "Print"],
Cell[246003, 6225, 345, 8, 262, "Print"],
Cell[246351, 6235, 1412, 37, 262, "Print"],
Cell[247766, 6274, 323, 7, 262, "Print"],
Cell[248092, 6283, 263, 6, 262, "Print"],
Cell[248358, 6291, 681, 20, 262, "Print"],
Cell[249042, 6313, 1672, 40, 262, "Print"],
Cell[250717, 6355, 4928, 114, 262, "Print"],
Cell[255648, 6471, 398, 10, 262, "Print"],
Cell[256049, 6483, 590, 14, 262, "Print"],
Cell[256642, 6499, 720, 19, 262, "Print"],
Cell[257365, 6520, 722, 19, 262, "Print"],
Cell[258090, 6541, 719, 19, 262, "Print"],
Cell[258812, 6562, 1324, 38, 262, "Print"],
Cell[260139, 6602, 2017, 46, 262, "Print"],
Cell[262159, 6650, 606, 14, 262, "Print"],
Cell[262768, 6666, 1909, 43, 262, "Print"],
Cell[264680, 6711, 527, 12, 262, "Print"],
Cell[265210, 6725, 1913, 43, 262, "Print"],
Cell[267126, 6770, 527, 12, 262, "Print"],
Cell[267656, 6784, 2360, 57, 262, "Print"],
Cell[270019, 6843, 527, 12, 262, "Print"],
Cell[270549, 6857, 9109, 219, 262, "Print"],
Cell[279661, 7078, 4084, 107, 262, "Print"],
Cell[283748, 7187, 169, 2, 262, "Print"],
Cell[283920, 7191, 1687, 37, 262, "Print"],
Cell[285610, 7230, 1871, 42, 262, "Print"],
Cell[287484, 7274, 1795, 40, 262, "Print"],
Cell[289282, 7316, 1823, 41, 262, "Print"],
Cell[291108, 7359, 1613, 37, 262, "Print"],
Cell[292724, 7398, 538, 12, 262, "Print"],
Cell[293265, 7412, 1686, 37, 262, "Print"],
Cell[294954, 7451, 1718, 38, 262, "Print"],
Cell[296675, 7491, 1582, 36, 262, "Print"],
Cell[298260, 7529, 509, 11, 262, "Print"],
Cell[298772, 7542, 1636, 38, 262, "Print"],
Cell[300411, 7582, 649, 17, 262, "Print"],
Cell[301063, 7601, 449, 10, 262, "Print"],
Cell[301515, 7613, 897, 25, 262, "Print"],
Cell[302415, 7640, 921, 26, 262, "Print"],
Cell[303339, 7668, 1461, 42, 262, "Print"],
Cell[304803, 7712, 1459, 42, 262, "Print"],
Cell[306265, 7756, 1463, 42, 262, "Print"],
Cell[307731, 7800, 1463, 42, 262, "Print"],
Cell[309197, 7844, 3977, 103, 262, "Print"],
Cell[313177, 7949, 167, 2, 262, "Print"],
Cell[313347, 7953, 1657, 36, 262, "Print"],
Cell[315007, 7991, 1818, 40, 262, "Print"],
Cell[316828, 8033, 1761, 39, 262, "Print"],
Cell[318592, 8074, 1791, 40, 262, "Print"],
Cell[320386, 8116, 1615, 37, 262, "Print"],
Cell[322004, 8155, 539, 12, 262, "Print"],
Cell[322546, 8169, 1763, 39, 262, "Print"],
Cell[324312, 8210, 1789, 40, 262, "Print"],
Cell[326104, 8252, 1615, 37, 262, "Print"],
Cell[327722, 8291, 539, 12, 262, "Print"],
Cell[328264, 8305, 1613, 37, 262, "Print"],
Cell[329880, 8344, 671, 18, 262, "Print"],
Cell[330554, 8364, 449, 10, 262, "Print"],
Cell[331006, 8376, 924, 26, 262, "Print"],
Cell[331933, 8404, 896, 25, 262, "Print"]
}, Open  ]],
Cell[332844, 8432, 1494, 44, 262, "Output"]
}, Closed]],
Cell[334353, 8479, 418, 12, 151, "Text"],
Cell[CellGroupData[{
Cell[334796, 8495, 633, 19, 145, "Input"],
Cell[CellGroupData[{
Cell[335454, 8518, 1082, 25, 262, "Print"],
Cell[336539, 8545, 528, 10, 262, "Print"],
Cell[337070, 8557, 619, 14, 262, "Print"],
Cell[337692, 8573, 996, 27, 262, "Print"],
Cell[338691, 8602, 483, 10, 262, "Print"],
Cell[339177, 8614, 487, 10, 262, "Print"],
Cell[339667, 8626, 1306, 32, 262, "Print"],
Cell[340976, 8660, 491, 9, 262, "Print"],
Cell[341470, 8671, 428, 8, 262, "Print"],
Cell[341901, 8681, 658, 15, 262, "Print"],
Cell[342562, 8698, 1533, 35, 262, "Print"],
Cell[344098, 8735, 2647, 61, 262, "Print"],
Cell[346748, 8798, 512, 10, 262, "Print"],
Cell[347263, 8810, 644, 13, 262, "Print"],
Cell[347910, 8825, 969, 25, 262, "Print"],
Cell[348882, 8852, 969, 25, 262, "Print"],
Cell[349854, 8879, 980, 25, 262, "Print"],
Cell[350837, 8906, 1165, 30, 262, "Print"],
Cell[352005, 8938, 2034, 46, 262, "Print"],
Cell[354042, 8986, 808, 17, 262, "Print"],
Cell[354853, 9005, 2356, 56, 262, "Print"],
Cell[357212, 9063, 691, 14, 262, "Print"],
Cell[357906, 9079, 4352, 105, 262, "Print"],
Cell[362261, 9186, 3442, 89, 262, "Print"],
Cell[365706, 9277, 335, 4, 262, "Print"],
Cell[366044, 9283, 1655, 36, 262, "Print"],
Cell[367702, 9321, 1814, 40, 262, "Print"],
Cell[369519, 9363, 1754, 38, 262, "Print"],
Cell[371276, 9403, 1662, 37, 262, "Print"],
Cell[372941, 9442, 705, 14, 262, "Print"],
Cell[373649, 9458, 1694, 37, 262, "Print"],
Cell[375346, 9497, 1630, 36, 262, "Print"],
Cell[376979, 9535, 677, 13, 262, "Print"],
Cell[377659, 9550, 1660, 37, 262, "Print"],
Cell[379322, 9589, 801, 19, 262, "Print"],
Cell[380126, 9610, 653, 14, 262, "Print"],
Cell[380782, 9626, 650, 13, 262, "Print"],
Cell[381435, 9641, 793, 19, 262, "Print"],
Cell[382231, 9662, 905, 22, 262, "Print"],
Cell[383139, 9686, 898, 23, 262, "Print"],
Cell[384040, 9711, 874, 22, 262, "Print"],
Cell[384917, 9735, 982, 25, 262, "Print"],
Cell[385902, 9762, 958, 24, 262, "Print"]
}, Open  ]],
Cell[386875, 9789, 914, 24, 262, "Output"]
}, Closed]],
Cell[387804, 9816, 259, 5, 88, "Text"],
Cell[CellGroupData[{
Cell[388088, 9825, 1200, 29, 150, "Input"],
Cell[CellGroupData[{
Cell[389313, 9858, 1723, 37, 262, "Print"],
Cell[391039, 9897, 1057, 18, 262, "Print"],
Cell[392099, 9917, 1150, 22, 262, "Print"],
Cell[393252, 9941, 1563, 36, 262, "Print"],
Cell[394818, 9979, 1011, 18, 262, "Print"],
Cell[395832, 9999, 1014, 18, 262, "Print"],
Cell[396849, 10019, 1920, 43, 262, "Print"],
Cell[398772, 10064, 1018, 17, 262, "Print"],
Cell[399793, 10083, 958, 16, 262, "Print"],
Cell[400754, 10101, 1227, 25, 262, "Print"],
Cell[401984, 10128, 2065, 43, 262, "Print"],
Cell[404052, 10173, 3177, 69, 262, "Print"],
Cell[407232, 10244, 1063, 19, 262, "Print"],
Cell[408298, 10265, 1173, 21, 262, "Print"],
Cell[409474, 10288, 2433, 57, 262, "Print"],
Cell[411910, 10347, 1878, 42, 262, "Print"],
Cell[413791, 10391, 1891, 44, 262, "Print"],
Cell[415685, 10437, 2766, 68, 262, "Print"],
Cell[418454, 10507, 3331, 76, 262, "Print"],
Cell[421788, 10585, 1495, 29, 262, "Print"],
Cell[423286, 10616, 2923, 64, 262, "Print"],
Cell[426212, 10682, 1222, 22, 262, "Print"],
Cell[427437, 10706, 7561, 180, 262, "Print"],
Cell[435001, 10888, 3270, 78, 262, "Print"],
Cell[438274, 10968, 2295, 47, 262, "Print"],
Cell[440572, 11017, 2396, 49, 262, "Print"],
Cell[442971, 11068, 2416, 50, 262, "Print"],
Cell[445390, 11120, 2129, 43, 262, "Print"],
Cell[447522, 11165, 1174, 20, 262, "Print"],
Cell[448699, 11187, 2410, 50, 262, "Print"],
Cell[451112, 11239, 2131, 43, 262, "Print"],
Cell[453246, 11284, 1174, 20, 262, "Print"],
Cell[454423, 11306, 2129, 43, 262, "Print"],
Cell[456555, 11351, 4230, 107, 262, "Print"],
Cell[460788, 11460, 862, 12, 262, "Print"],
Cell[461653, 11474, 2347, 48, 262, "Print"],
Cell[464003, 11524, 2532, 53, 262, "Print"],
Cell[466538, 11579, 2388, 49, 262, "Print"],
Cell[468929, 11630, 2189, 45, 262, "Print"],
Cell[471121, 11677, 1233, 22, 262, "Print"],
Cell[472357, 11701, 2390, 49, 262, "Print"],
Cell[474750, 11752, 2188, 45, 262, "Print"],
Cell[476941, 11799, 1234, 22, 262, "Print"],
Cell[478178, 11823, 2214, 46, 262, "Print"],
Cell[480395, 11871, 1381, 29, 262, "Print"],
Cell[481779, 11902, 1162, 21, 262, "Print"],
Cell[482944, 11925, 1484, 32, 262, "Print"],
Cell[484431, 11959, 1541, 34, 262, "Print"],
Cell[485975, 11995, 1566, 35, 262, "Print"],
Cell[487544, 12032, 1511, 33, 262, "Print"]
}, Open  ]],
Cell[489070, 12068, 1806, 49, 262, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[490913, 12122, 706, 22, 158, "Input"],
Cell[CellGroupData[{
Cell[491644, 12148, 1001, 27, 137, "Print"],
Cell[492648, 12177, 338, 8, 88, "Print"],
Cell[492989, 12187, 431, 12, 88, "Print"],
Cell[493423, 12201, 844, 26, 112, "Print"],
Cell[494270, 12229, 292, 8, 88, "Print"],
Cell[494565, 12239, 294, 8, 88, "Print"],
Cell[494862, 12249, 1201, 33, 187, "Print"],
Cell[496066, 12284, 299, 7, 82, "Print"],
Cell[496368, 12293, 241, 6, 82, "Print"],
Cell[496612, 12301, 510, 15, 137, "Print"],
Cell[497125, 12318, 1346, 33, 171, "Print"],
Cell[498474, 12353, 2459, 59, 171, "Print"],
Cell[500936, 12414, 344, 9, 88, "Print"],
Cell[501283, 12425, 456, 11, 88, "Print"],
Cell[501742, 12438, 1453, 40, 200, "Print"],
Cell[503198, 12480, 1386, 38, 200, "Print"],
Cell[504587, 12520, 1485, 41, 151, "Print"],
Cell[506075, 12563, 2829, 82, 332, "Print"],
Cell[508907, 12647, 2852, 72, 235, "Print"],
Cell[511762, 12721, 786, 20, 151, "Print"],
Cell[512551, 12743, 2200, 54, 171, "Print"],
Cell[514754, 12799, 503, 12, 82, "Print"],
Cell[515260, 12813, 6525, 161, 218, "Print"],
Cell[521788, 12976, 2547, 68, 332, "Print"],
Cell[524338, 13046, 1604, 38, 150, "Print"],
Cell[525945, 13086, 1705, 40, 150, "Print"],
Cell[527653, 13128, 1733, 41, 150, "Print"],
Cell[529389, 13171, 1410, 33, 137, "Print"],
Cell[530802, 13206, 455, 10, 88, "Print"],
Cell[531260, 13218, 1730, 41, 150, "Print"],
Cell[532993, 13261, 1410, 33, 137, "Print"],
Cell[534406, 13296, 455, 10, 88, "Print"],
Cell[534864, 13308, 1410, 33, 137, "Print"],
Cell[536277, 13343, 3254, 88, 327, "Print"],
Cell[539534, 13433, 145, 2, 82, "Print"],
Cell[539682, 13437, 2725, 64, 235, "Print"],
Cell[542410, 13503, 2886, 68, 235, "Print"],
Cell[545299, 13573, 2028, 47, 165, "Print"],
Cell[547330, 13622, 1440, 34, 137, "Print"],
Cell[548773, 13658, 487, 11, 88, "Print"],
Cell[549263, 13671, 2463, 57, 165, "Print"],
Cell[551729, 13730, 1470, 35, 137, "Print"],
Cell[553202, 13767, 517, 12, 101, "Print"],
Cell[553722, 13781, 1470, 35, 137, "Print"],
Cell[555195, 13818, 967, 27, 137, "Print"],
Cell[556165, 13847, 425, 10, 82, "Print"],
Cell[556593, 13859, 763, 21, 137, "Print"],
Cell[557359, 13882, 593, 16, 137, "Print"],
Cell[557955, 13900, 1027, 29, 151, "Print"],
Cell[558985, 13931, 1051, 30, 151, "Print"]
}, Open  ]],
Cell[560051, 13964, 837, 26, 132, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[560925, 13995, 758, 20, 137, "Input"],
Cell[561686, 14017, 923, 27, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[562646, 14049, 700, 21, 140, "Input"],
Cell[563349, 14072, 643, 18, 102, "Output"]
}, Open  ]],
Cell[564007, 14093, 860, 24, 226, "Text"],
Cell[CellGroupData[{
Cell[564892, 14121, 882, 24, 137, "Input"],
Cell[565777, 14147, 1598, 43, 228, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[567412, 14195, 851, 23, 137, "Input"],
Cell[568266, 14220, 1602, 43, 228, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[569917, 14269, 193, 3, 67, "Title"],
Cell[570113, 14274, 475, 6, 101, "Text"],
Cell[CellGroupData[{
Cell[570613, 14284, 631, 19, 145, "Input"],
Cell[571247, 14305, 780, 21, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[572064, 14331, 880, 26, 158, "Input"],
Cell[572947, 14359, 748, 20, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[573732, 14384, 1140, 32, 158, "Input"],
Cell[574875, 14418, 2255, 68, 452, "Output"]
}, Open  ]],
Cell[577145, 14489, 492, 6, 101, "Text"],
Cell[CellGroupData[{
Cell[577662, 14499, 719, 23, 145, "Input"],
Cell[578384, 14524, 620, 18, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[579041, 14547, 858, 24, 145, "Input"],
Cell[579902, 14573, 1329, 42, 285, "Output"]
}, Open  ]],
Cell[581246, 14618, 725, 18, 112, "Text"],
Cell[CellGroupData[{
Cell[581996, 14640, 1132, 27, 101, "Input"],
Cell[583131, 14669, 2876, 61, 245, "Output"]
}, Open  ]],
Cell[586022, 14733, 833, 20, 175, "Text"],
Cell[CellGroupData[{
Cell[586880, 14757, 607, 19, 145, "Input"],
Cell[587490, 14778, 780, 23, 175, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[588307, 14806, 687, 22, 135, "Input"],
Cell[588997, 14830, 1114, 35, 132, "Output"]
}, Open  ]],
Cell[590126, 14868, 543, 12, 112, "Text"],
Cell[CellGroupData[{
Cell[590694, 14884, 2020, 53, 282, "Input"],
Cell[592717, 14939, 880, 19, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[593634, 14963, 784, 22, 137, "Input"],
Cell[594421, 14987, 1354, 40, 226, "Output"]
}, Open  ]],
Cell[595790, 15030, 690, 18, 112, "Text"],
Cell[CellGroupData[{
Cell[596505, 15052, 1239, 28, 150, "Input"],
Cell[597747, 15082, 2393, 65, 352, "Output"]
}, Open  ]],
Cell[600155, 15150, 173, 4, 101, "Text"],
Cell[CellGroupData[{
Cell[600353, 15158, 707, 19, 145, "Input"],
Cell[601063, 15179, 1376, 34, 147, "Output"]
}, Open  ]],
Cell[602454, 15216, 181, 2, 101, "Text"],
Cell[CellGroupData[{
Cell[602660, 15222, 1565, 40, 237, "Input"],
Cell[604228, 15264, 5315, 130, 870, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[609580, 15399, 1522, 36, 158, "Input"],
Cell[611105, 15437, 1895, 53, 228, "Output"]
}, Open  ]],
Cell[613015, 15493, 328, 4, 101, "Text"],
Cell[CellGroupData[{
Cell[613368, 15501, 1578, 37, 158, "Input"],
Cell[614949, 15540, 719, 19, 132, "Output"]
}, Open  ]],
Cell[615683, 15562, 465, 6, 101, "Text"],
Cell[CellGroupData[{
Cell[616173, 15572, 1242, 29, 137, "Input"],
Cell[617418, 15603, 2120, 49, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[619575, 15657, 726, 22, 137, "Input"],
Cell[620304, 15681, 1365, 38, 228, "Output"]
}, Open  ]],
Cell[621684, 15722, 502, 8, 101, "Text"],
Cell[CellGroupData[{
Cell[622211, 15734, 1037, 26, 101, "Input"],
Cell[623251, 15762, 3990, 84, 283, "Output"]
}, Open  ]],
Cell[627256, 15849, 459, 8, 101, "Text"],
Cell[627718, 15859, 607, 19, 210, "DisplayFormula"],
Cell[CellGroupData[{
Cell[628350, 15882, 590, 19, 101, "Input"],
Cell[628943, 15903, 652, 18, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[629632, 15926, 1326, 31, 137, "Input"],
Cell[630961, 15959, 648, 15, 126, "Output"]
}, Open  ]],
Cell[631624, 15977, 760, 22, 175, "DisplayFormula"],
Cell[CellGroupData[{
Cell[632409, 16003, 705, 21, 145, "Input"],
Cell[633117, 16026, 1725, 51, 250, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[634879, 16082, 799, 25, 150, "Input"],
Cell[635681, 16109, 1210, 36, 126, "Output"]
}, Open  ]],
Cell[636906, 16148, 293, 7, 101, "Text"],
Cell[CellGroupData[{
Cell[637224, 16159, 1073, 36, 176, "Input"],
Cell[638300, 16197, 1694, 47, 277, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[640043, 16250, 89, 1, 67, "Title"],
Cell[CellGroupData[{
Cell[640157, 16255, 91, 1, 65, "Section"],
Cell[640251, 16258, 1572, 45, 262, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[641860, 16308, 150, 2, 51, "Section"],
Cell[642013, 16312, 672, 13, 121, "Text"],
Cell[CellGroupData[{
Cell[642710, 16329, 94, 1, 44, "Subsection"],
Cell[642807, 16332, 3579, 90, 477, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[646423, 16427, 96, 1, 36, "Subsection"],
Cell[646522, 16430, 9580, 226, 686, "Code"],
Cell[656105, 16658, 7259, 177, 639, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[663401, 16840, 172, 2, 36, "Subsection"],
Cell[663576, 16844, 2138, 51, 186, "Code"],
Cell[665717, 16897, 4462, 110, 331, "Input"],
Cell[670182, 17009, 5894, 157, 493, "Code"],
Cell[676079, 17168, 980, 28, 54, "Code"],
Cell[677062, 17198, 9245, 206, 660, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[686344, 17409, 202, 3, 36, "Subsection"],
Cell[686549, 17414, 13738, 333, 795, "Code"],
Cell[700290, 17749, 11473, 294, 988, "Code"],
Cell[CellGroupData[{
Cell[711788, 18047, 623, 15, 57, "Input"],
Cell[712414, 18064, 929, 21, 157, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[713380, 18090, 716, 18, 51, "Input"],
Cell[CellGroupData[{
Cell[714121, 18112, 903, 20, 262, "Print"],
Cell[715027, 18134, 1057, 23, 262, "Print"],
Cell[716087, 18159, 1415, 33, 262, "Print"]
}, Open  ]],
Cell[717517, 18195, 2229, 66, 262, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[719783, 18266, 991, 26, 51, "Input"],
Cell[CellGroupData[{
Cell[720799, 18296, 441, 11, 262, "Print"],
Cell[721243, 18309, 833, 22, 262, "Print"]
}, Open  ]],
Cell[722091, 18334, 1411, 41, 262, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[723539, 18380, 577, 16, 51, "Input"],
Cell[CellGroupData[{
Cell[724141, 18400, 464, 13, 262, "Print"],
Cell[724608, 18415, 647, 17, 262, "Print"],
Cell[725258, 18434, 1559, 38, 262, "Print"]
}, Open  ]],
Cell[726832, 18475, 11544, 335, 262, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[738413, 18815, 876, 22, 51, "Input"],
Cell[CellGroupData[{
Cell[739314, 18841, 949, 20, 262, "Print"],
Cell[740266, 18863, 1162, 25, 262, "Print"]
}, Open  ]],
Cell[741443, 18891, 1156, 34, 262, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[742636, 18930, 573, 16, 51, "Input"],
Cell[CellGroupData[{
Cell[743234, 18950, 488, 13, 78, "Print"],
Cell[743725, 18965, 671, 17, 88, "Print"],
Cell[744399, 18984, 914, 23, 88, "Print"]
}, Open  ]],
Cell[745328, 19010, 101, 1, 66, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[745466, 19016, 1368, 41, 74, "Input"],
Cell[CellGroupData[{
Cell[746859, 19061, 468, 12, 78, "Print"],
Cell[747330, 19075, 2097, 52, 226, "Print"]
}, Open  ]],
Cell[749442, 19130, 126, 2, 66, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[749605, 19137, 422, 12, 35, "Input"],
Cell[750030, 19151, 344, 11, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[750411, 19167, 813, 24, 58, "Input"],
Cell[751227, 19193, 811, 26, 52, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[752087, 19225, 95, 1, 36, "Subsection"],
Cell[752185, 19228, 6334, 157, 666, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[758556, 19390, 105, 1, 36, "Subsection"],
Cell[758664, 19393, 3399, 85, 1307, "Code"],
Cell[762066, 19480, 8920, 203, 1515, "Code"],
Cell[770989, 19685, 5903, 148, 1665, "Code"],
Cell[776895, 19835, 45561, 1038, 13018, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[822493, 20878, 91, 1, 36, "Subsection"],
Cell[822587, 20881, 72507, 1425, 3468, "Code"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[895143, 22312, 172, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[895340, 22318, 98, 1, 44, "Subsection"],
Cell[895441, 22321, 4982, 138, 530, "Code"],
Cell[900426, 22461, 3960, 105, 446, "Code"],
Cell[904389, 22568, 6715, 170, 774, "Code"],
Cell[911107, 22740, 71, 1, 32, "Input"],
Cell[911181, 22743, 5092, 103, 314, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[916310, 22851, 100, 1, 36, "Subsection"],
Cell[916413, 22854, 4620, 103, 444, "Code"],
Cell[921036, 22959, 1206, 30, 228, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[922279, 22994, 101, 1, 37, "Subsection"],
Cell[922383, 22997, 23430, 544, 1931, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[945850, 23546, 102, 1, 37, "Subsection"],
Cell[945955, 23549, 37263, 866, 2571, "Code"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[983267, 24421, 200, 3, 65, "Section"],
Cell[CellGroupData[{
Cell[983492, 24428, 106, 1, 45, "Subsection"],
Cell[983601, 24431, 1126, 27, 41, "Input"],
Cell[984730, 24460, 2373, 54, 95, "Input"],
Cell[987106, 24516, 46061, 1058, 2083, "Code"],
Cell[1033170, 25576, 1227, 35, 95, "Input"],
Cell[CellGroupData[{
Cell[1034422, 25615, 93, 1, 32, "Input"],
Cell[1034518, 25618, 2671, 91, 100, "Output"]
}, Open  ]],
Cell[1037204, 25712, 1443, 37, 118, "Input"],
Cell[CellGroupData[{
Cell[1038672, 25753, 1201, 24, 34, "Input"],
Cell[1039876, 25779, 2644, 89, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1042557, 25873, 172, 3, 34, "Input"],
Cell[1042732, 25878, 3292, 103, 103, "Output"]
}, Open  ]],
Cell[1046039, 25984, 37215, 778, 1876, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1083291, 26767, 100, 1, 36, "Subsection"],
Cell[1083394, 26770, 16932, 377, 777, "Code"],
Cell[1100329, 27149, 21833, 548, 1083, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1122199, 27702, 105, 1, 36, "Subsection"],
Cell[1122307, 27705, 605, 18, 41, "Input"],
Cell[1122915, 27725, 578, 17, 41, "Input"],
Cell[1123496, 27744, 599, 18, 41, "Input"],
Cell[1124098, 27764, 529, 14, 41, "Input"],
Cell[1124630, 27780, 710, 19, 41, "Input"],
Cell[1125343, 27801, 579, 17, 42, "Input"],
Cell[1125925, 27820, 779, 18, 41, "Input"],
Cell[1126707, 27840, 859, 20, 41, "Input"],
Cell[1127569, 27862, 574, 17, 41, "Input"],
Cell[1128146, 27881, 1088, 28, 41, "Input"],
Cell[1129237, 27911, 1102, 31, 41, "Input"],
Cell[1130342, 27944, 1479, 34, 41, "Input"],
Cell[1131824, 27980, 939, 25, 42, "Input"],
Cell[1132766, 28007, 52787, 1240, 3512, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1185590, 29252, 104, 1, 37, "Subsection"],
Cell[1185697, 29255, 26619, 637, 6241, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1212353, 29897, 100, 1, 36, "Subsection"],
Cell[1212456, 29900, 18272, 448, 3702, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1230765, 30353, 99, 1, 37, "Subsection"],
Cell[1230867, 30356, 28777, 690, 6118, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1259681, 31051, 157, 2, 37, "Subsection"],
Cell[1259841, 31055, 1313, 31, 57, "Input"],
Cell[CellGroupData[{
Cell[1261179, 31090, 968, 17, 34, "Input"],
Cell[1262150, 31109, 2128, 64, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1264315, 31178, 677, 14, 34, "Input"],
Cell[CellGroupData[{
Cell[1265017, 31196, 983, 23, 49, "Print"],
Cell[1266003, 31221, 952, 22, 49, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1267004, 31249, 3724, 77, 117, "Input"],
Cell[1270731, 31328, 4438, 77, 52, "Output"],
Cell[1275172, 31407, 4484, 78, 65, "Output"]
}, Open  ]],
Cell[1279671, 31488, 26288, 579, 1185, "Code"],
Cell[1305962, 32069, 11908, 314, 775, "Code"],
Cell[1317873, 32385, 11604, 270, 820, "Code"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1329526, 32661, 252, 3, 65, "Section"],
Cell[CellGroupData[{
Cell[1329803, 32668, 99, 1, 45, "Subsection"],
Cell[1329905, 32671, 450, 14, 66, "Input"],
Cell[1330358, 32687, 11329, 246, 952, "Code"],
Cell[1341690, 32935, 14904, 365, 1056, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1356631, 33305, 149, 2, 36, "Subsection"],
Cell[1356783, 33309, 20673, 468, 963, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1377493, 33782, 143, 2, 37, "Subsection"],
Cell[1377639, 33786, 5537, 122, 186, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1383213, 33913, 100, 1, 36, "Subsection"],
Cell[1383316, 33916, 43597, 831, 1625, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1426950, 34752, 94, 1, 36, "Subsection"],
Cell[1427047, 34755, 3334, 80, 262, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1430418, 34840, 101, 1, 37, "Subsection"],
Cell[1430522, 34843, 5507, 143, 262, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1436066, 34991, 91, 1, 36, "Subsection"],
Cell[1436160, 34994, 3358, 90, 941, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1439555, 35089, 144, 2, 36, "Subsection"],
Cell[1439702, 35093, 7743, 205, 262, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1447494, 35304, 142, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[1447661, 35310, 92, 1, 44, "Subsection"],
Cell[1447756, 35313, 7430, 129, 286, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1455223, 35447, 155, 2, 36, "Subsection"],
Cell[1455381, 35451, 11797, 295, 1071, "Code"],
Cell[1467181, 35748, 21426, 524, 1235, "Code"],
Cell[1488610, 36274, 9057, 227, 687, "Code"],
Cell[1497670, 36503, 617, 13, 76, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1498324, 36521, 125, 2, 37, "Subsection"],
Cell[CellGroupData[{
Cell[1498474, 36527, 1094, 30, 57, "Input"],
Cell[1499571, 36559, 756, 18, 44, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1500364, 36582, 1029, 26, 57, "Input"],
Cell[CellGroupData[{
Cell[1501418, 36612, 1225, 29, 101, "Print"],
Cell[1502646, 36643, 1165, 27, 101, "Print"],
Cell[1503814, 36672, 1170, 27, 93, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1505033, 36705, 1114, 31, 57, "Input"],
Cell[CellGroupData[{
Cell[1506172, 36740, 1316, 32, 86, "Print"],
Cell[1507491, 36774, 1444, 36, 77, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1508984, 36816, 2305, 49, 57, "Input"],
Cell[CellGroupData[{
Cell[1511314, 36869, 2460, 48, 86, "Print"],
Cell[1513777, 36919, 3113, 64, 84, "Print"],
Cell[1516893, 36985, 2994, 61, 84, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1519936, 37052, 2536, 68, 125, "Input"],
Cell[1522475, 37122, 11154, 237, 604, "Output"]
}, Open  ]],
Cell[1533644, 37362, 8112, 211, 537, "Code"],
Cell[1541759, 37575, 5990, 146, 645, "Code"],
Cell[1547752, 37723, 10864, 246, 708, "Code"],
Cell[CellGroupData[{
Cell[1558641, 37973, 477, 16, 34, "Input"],
Cell[1559121, 37991, 135, 3, 32, "Output"]
}, Open  ]],
Cell[1559271, 37997, 28956, 566, 1549, "Code"],
Cell[1588230, 38565, 13623, 341, 1035, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1601890, 38911, 151, 2, 44, "Subsection"],
Cell[1602044, 38915, 24276, 486, 1776, "Code"],
Cell[1626323, 39403, 24194, 520, 1536, "Code"],
Cell[1650520, 39925, 21141, 465, 1624, "Code"],
Cell[1671664, 40392, 19370, 440, 1513, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1691071, 40837, 150, 2, 37, "Subsection"],
Cell[1691224, 40841, 3598, 96, 206, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1694859, 40942, 147, 2, 37, "Subsection"],
Cell[1695009, 40946, 8142, 190, 383, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1703188, 41141, 99, 1, 37, "Subsection"],
Cell[1703290, 41144, 6771, 153, 623, "Code"],
Cell[1710064, 41299, 36728, 800, 2145, "Code"],
Cell[1746795, 42101, 1167, 31, 193, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1748011, 42138, 98, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[1748134, 42143, 99, 1, 45, "Subsection"],
Cell[1748236, 42146, 172812, 3437, 7985, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[1921085, 45588, 93, 1, 36, "Subsection"],
Cell[1921181, 45591, 117968, 2258, 4167, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[2039186, 47854, 144, 2, 37, "Subsection"],
Cell[2039333, 47858, 120098, 2285, 4276, "Code"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

